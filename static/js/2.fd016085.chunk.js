/*! For license information please see 2.fd016085.chunk.js.LICENSE.txt */
(this.webpackJsonpwebrtc_agora=this.webpackJsonpwebrtc_agora||[]).push([[2],[function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return v})),n.d(t,"b",(function(){return O})),n.d(t,"c",(function(){return k})),n.d(t,"d",(function(){return G})),n.d(t,"e",(function(){return C})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return c})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return Z})),n.d(t,"k",(function(){return j})),n.d(t,"l",(function(){return q})),n.d(t,"m",(function(){return h})),n.d(t,"n",(function(){return p})),n.d(t,"o",(function(){return Y})),n.d(t,"p",(function(){return ee})),n.d(t,"q",(function(){return m})),n.d(t,"r",(function(){return U})),n.d(t,"s",(function(){return _})),n.d(t,"t",(function(){return b})),n.d(t,"u",(function(){return w})),n.d(t,"v",(function(){return V})),n.d(t,"w",(function(){return T})),n.d(t,"x",(function(){return R})),n.d(t,"y",(function(){return g})),n.d(t,"z",(function(){return y})),n.d(t,"A",(function(){return I})),n.d(t,"B",(function(){return E})),n.d(t,"C",(function(){return S})),n.d(t,"D",(function(){return M})),n.d(t,"E",(function(){return D})),n.d(t,"F",(function(){return B})),n.d(t,"G",(function(){return W})),n.d(t,"H",(function(){return F})),n.d(t,"I",(function(){return $})),n.d(t,"J",(function(){return J})),n.d(t,"K",(function(){return x})),n.d(t,"L",(function(){return z})),n.d(t,"M",(function(){return Q})),n.d(t,"N",(function(){return X})),n.d(t,"O",(function(){return A}));var r=n(58),i=!1,o=!1,a="${JSCORE_VERSION}",s=function(e,t){if(!e)throw c(t)},c=function(e){return new Error("Firebase Database ("+a+") INTERNAL ASSERT FAILED: "+e)},u=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},l={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<e.length;i+=3){var o=e[i],a=i+1<e.length,s=a?e[i+1]:0,c=i+2<e.length,u=c?e[i+2]:0,l=o>>2,d=(3&o)<<4|s>>4,f=(15&s)<<2|u>>6,h=63&u;c||(h=64,a||(f=64)),r.push(n[l],n[d],n[f],n[h])}return r.join("")},encodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(u(e),t)},decodeString:function(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){for(var t=[],n=0,r=0;n<e.length;){var i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var a=((7&i)<<18|(63&(o=e[n++]))<<12|(63&(s=e[n++]))<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(a>>10)),t[r++]=String.fromCharCode(56320+(1023&a))}else{o=e[n++];var s=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&s)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray:function(e,t){this.init_();for(var n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<e.length;){var o=n[e.charAt(i++)],a=i<e.length?n[e.charAt(i)]:0,s=++i<e.length?n[e.charAt(i)]:64,c=++i<e.length?n[e.charAt(i)]:64;if(++i,null==o||null==a||null==s||null==c)throw Error();var u=o<<2|a>>4;if(r.push(u),64!==s){var l=a<<4&240|s>>2;if(r.push(l),64!==c){var d=s<<6&192|c;r.push(d)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}},d=function(e){var t=u(e);return l.encodeByteArray(t,!0)},f=function(e){try{return l.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function h(e){return p(void 0,e)}function p(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(var n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=p(e[n],t[n]));return e}var v=function(){function e(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.wrapCallback=function(e){var t=this;return function(n,r){n?t.reject(n):t.resolve(r),"function"===typeof e&&(t.promise.catch((function(){})),1===e.length?e(n):e(n,r))}},e}();function m(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function g(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(m())}function y(){try{return"[object process]"===Object.prototype.toString.call(e.process)}catch(t){return!1}}function _(){return"object"===typeof self&&self.self===self}function b(){var e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function E(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function w(){return m().indexOf("Electron/")>=0}function T(){var e=m();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function S(){return m().indexOf("MSAppHost/")>=0}function I(){return!0===i||!0===o}function R(){return"indexedDB"in self&&null!=indexedDB}function A(){return new Promise((function(e,t){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=function(){i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=function(){n=!1},i.onerror=function(){var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(o){t(o)}}))}function C(){return!(!navigator||!navigator.cookieEnabled)}var k=function(e){function t(n,r,i){var o=e.call(this,r)||this;return o.code=n,o.customData=i,o.name="FirebaseError",Object.setPrototypeOf(o,t.prototype),Error.captureStackTrace&&Error.captureStackTrace(o,O.prototype.create),o}return Object(r.a)(t,e),t}(Error),O=function(){function e(e,t,n){this.service=e,this.serviceName=t,this.errors=n}return e.prototype.create=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=t[0]||{},i=this.service+"/"+e,o=this.errors[e],a=o?N(o,r):"Error",s=this.serviceName+": "+a+" ("+i+").",c=new k(i,s,r);return c},e}();function N(e,t){return e.replace(P,(function(e,n){var r=t[n];return null!=r?String(r):"<"+n+"?>"}))}var P=/\{\$([^}]+)}/g;function D(e){return JSON.parse(e)}function x(e){return JSON.stringify(e)}var L=function(e){var t={},n={},r={},i="";try{var o=e.split(".");t=D(f(o[0])||""),n=D(f(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(a){}return{header:t,claims:n,data:r,signature:i}},M=function(e){var t=L(e).claims;return!!t&&"object"===typeof t&&t.hasOwnProperty("iat")},U=function(e){var t=L(e).claims;return"object"===typeof t&&!0===t.admin};function j(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function F(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function V(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function B(e,t,n){var r={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function W(e){for(var t=[],n=function(e,n){Array.isArray(n)?n.forEach((function(n){t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))})):t.push(encodeURIComponent(e)+"="+encodeURIComponent(n))},r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];n(o[0],o[1])}return t.length?"&"+t.join("&"):""}var G=function(){function e(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(e,t){t||(t=0);var n=this.W_;if("string"===typeof e)for(var r=0;r<16;r++)n[r]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(r=0;r<16;r++)n[r]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}var o,a,s=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],d=this.chain_[4];for(r=0;r<80;r++){r<40?r<20?(o=l^c&(u^l),a=1518500249):(o=c^u^l,a=1859775393):r<60?(o=c&u|l&(c|u),a=2400959708):(o=c^u^l,a=3395469782);i=(s<<5|s>>>27)+o+d+a+n[r]&4294967295;d=l,l=u,u=4294967295&(c<<30|c>>>2),c=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+d&4294967295},e.prototype.update=function(e,t){if(null!=e){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<t;){if(0===o)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"===typeof e){for(;r<t;)if(i[o]=e.charCodeAt(r),++r,++o===this.blockSize){this.compress_(i),o=0;break}}else for(;r<t;)if(i[o]=e[r],++r,++o===this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=t}},e.prototype.digest=function(){var e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&t,t/=256;this.compress_(this.buf_);var r=0;for(n=0;n<5;n++)for(var i=24;i>=0;i-=8)e[r]=this.chain_[n]>>i&255,++r;return e},e}();function q(e,t){var n=new K(e,t);return n.subscribe.bind(n)}var K=function(){function e(e,t){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((function(){e(n)})).catch((function(e){n.error(e)}))}return e.prototype.next=function(e){this.forEachObserver((function(t){t.next(e)}))},e.prototype.error=function(e){this.forEachObserver((function(t){t.error(e)})),this.close(e)},e.prototype.complete=function(){this.forEachObserver((function(e){e.complete()})),this.close()},e.prototype.subscribe=function(e,t,n){var r,i=this;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");void 0===(r=function(e,t){if("object"!==typeof e||null===e)return!1;for(var n=0,r=t;n<r.length;n++){var i=r[n];if(i in e&&"function"===typeof e[i])return!0}return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n}).next&&(r.next=H),void 0===r.error&&(r.error=H),void 0===r.complete&&(r.complete=H);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(e){}})),this.observers.push(r),o},e.prototype.unsubscribeOne=function(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},e.prototype.forEachObserver=function(e){if(!this.finalized)for(var t=0;t<this.observers.length;t++)this.sendOne(t,e)},e.prototype.sendOne=function(e,t){var n=this;this.task.then((function(){if(void 0!==n.observers&&void 0!==n.observers[e])try{t(n.observers[e])}catch(r){"undefined"!==typeof console&&console.error&&console.error(r)}}))},e.prototype.close=function(e){var t=this;this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((function(){t.observers=void 0,t.onNoObservers=void 0})))},e}();function H(){}var z=function(e,t,n,r){var i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i)throw new Error(e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".")};function Y(e,t){return e+" failed: "+t+" argument "}function Q(e,t,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(Y(e,t)+"must be a valid function.")}function X(e,t,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(Y(e,t)+"must be a valid context object.")}var J=function(e){for(var t=[],n=0,r=0;r<e.length;r++){var i=e.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,s(r<e.length,"Surrogate pair missing trail surrogate."),i=65536+(o<<10)+(e.charCodeAt(r)-56320)}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},$=function(e){for(var t=0,n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};function Z(e,t,n){void 0===t&&(t=1e3),void 0===n&&(n=2);var r=t*Math.pow(n,e),i=Math.round(.5*r*(Math.random()-.5)*2);return Math.min(144e5,r+i)}function ee(e){return e&&e._delegate?e._delegate:e}}).call(this,n(33))},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function o(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function a(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function s(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}Object.create},function(e,t,n){"use strict";e.exports=n(61)},function(e,t,n){"use strict";e.exports=n(69)},function(e,t,n){"use strict";n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return y})),n.d(t,"c",(function(){return U})),n.d(t,"d",(function(){return E})),n.d(t,"e",(function(){return u})),n.d(t,"f",(function(){return F})),n.d(t,"g",(function(){return H})),n.d(t,"h",(function(){return V})),n.d(t,"i",(function(){return Q})),n.d(t,"j",(function(){return te})),n.d(t,"k",(function(){return ne})),n.d(t,"l",(function(){return ee})),n.d(t,"m",(function(){return re})),n.d(t,"n",(function(){return x})),n.d(t,"o",(function(){return N})),n.d(t,"p",(function(){return M})),n.d(t,"q",(function(){return W})),n.d(t,"r",(function(){return D})),n.d(t,"s",(function(){return ie})),n.d(t,"t",(function(){return $})),n.d(t,"u",(function(){return X})),n.d(t,"v",(function(){return J})),n.d(t,"w",(function(){return j})),n.d(t,"x",(function(){return B})),n.d(t,"y",(function(){return l})),n.d(t,"z",(function(){return G})),n.d(t,"A",(function(){return P})),n.d(t,"B",(function(){return q})),n.d(t,"C",(function(){return K})),n.d(t,"D",(function(){return z})),n.d(t,"E",(function(){return _})),n.d(t,"F",(function(){return R})),n.d(t,"G",(function(){return s})),n.d(t,"H",(function(){return I})),n.d(t,"I",(function(){return b})),n.d(t,"J",(function(){return O})),n.d(t,"K",(function(){return p})),n.d(t,"L",(function(){return d})),n.d(t,"M",(function(){return g})),n.d(t,"N",(function(){return h})),n.d(t,"O",(function(){return S})),n.d(t,"P",(function(){return c})),n.d(t,"Q",(function(){return f})),n.d(t,"R",(function(){return A})),n.d(t,"S",(function(){return T})),n.d(t,"T",(function(){return w}));var r=n(11),i=n(12),o=n(6),a=n(40),s=function(e){return function(){return e}}(!0),c=function(){};var u=function(e){return e};"function"===typeof Symbol&&Symbol.asyncIterator&&Symbol.asyncIterator;function l(e,t,n){if(!t(e))throw new Error(n)}var d=function(e,t){Object(i.a)(e,t),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach((function(n){e[n]=t[n]}))},f=function(e,t){var n;return(n=[]).concat.apply(n,t.map(e))};function h(e,t){var n=e.indexOf(t);n>=0&&e.splice(n,1)}function p(e){var t=!1;return function(){t||(t=!0,e())}}var v=function(e){throw e},m=function(e){return{value:e,done:!0}};function g(e,t,n){void 0===t&&(t=v),void 0===n&&(n="iterator");var r={meta:{name:n},next:e,throw:t,return:m,isSagaIterator:!0};return"undefined"!==typeof Symbol&&(r[Symbol.iterator]=function(){return r}),r}function y(e,t){var n=t.sagaStack;console.error(e),console.error(n)}var _=function(e){return new Error("\n  redux-saga: Error checking hooks detected an inconsistent state. This is likely a bug\n  in redux-saga code and not yours. Thanks for reporting this in the project's github repo.\n  Error: "+e+"\n")},b=function(e){return Array.apply(null,new Array(e))},E=function(e){return function(t){return e(Object.defineProperty(t,r.f,{value:!0}))}},w=function(e){return e===r.k},T=function(e){return e===r.j},S=function(e){return w(e)||T(e)};function I(e,t){var n=Object.keys(e),r=n.length;var i,a=0,s=Object(o.a)(e)?b(r):{},u={};return n.forEach((function(e){var n=function(n,o){i||(o||S(n)?(t.cancel(),t(n,o)):(s[e]=n,++a===r&&(i=!0,t(s))))};n.cancel=c,u[e]=n})),t.cancel=function(){i||(i=!0,n.forEach((function(e){return u[e].cancel()})))},u}function R(e){return{name:e.name||"anonymous",location:A(e)}}function A(e){return e[r.g]}var C={isEmpty:s,put:c,take:c};function k(e,t){void 0===e&&(e=10);var n=new Array(e),r=0,i=0,o=0,a=function(t){n[i]=t,i=(i+1)%e,r++},s=function(){if(0!=r){var t=n[o];return n[o]=null,r--,o=(o+1)%e,t}},c=function(){for(var e=[];r;)e.push(s());return e};return{isEmpty:function(){return 0==r},put:function(s){var u;if(r<e)a(s);else switch(t){case 1:throw new Error("Channel's Buffer overflow!");case 3:n[i]=s,o=i=(i+1)%e;break;case 4:u=2*e,n=c(),r=n.length,i=n.length,o=0,n.length=u,e=u,a(s)}},take:s,flush:c}}var O=function(){return C},N=function(e){return k(e,3)},P=function(e){return k(e,4)},D="TAKE",x="PUT",L="ALL",M="RACE",U="CALL",j="CPS",F="FORK",V="JOIN",B="CANCEL",W="SELECT",G="ACTION_CHANNEL",q="CANCELLED",K="FLUSH",H="GET_CONTEXT",z="SET_CONTEXT",Y=function(e,t){var n;return(n={})[r.c]=!0,n.combinator=!1,n.type=e,n.payload=t,n};function Q(e,t){return void 0===e&&(e="*"),Object(o.i)(e)?Y(D,{pattern:e}):Object(o.f)(e)&&Object(o.g)(t)&&Object(o.i)(t)?Y(D,{channel:e,pattern:t}):Object(o.b)(e)?Y(D,{channel:e}):void 0}function X(e,t){return Object(o.n)(t)&&(t=e,e=void 0),Y(x,{channel:e,action:t})}function J(e){var t=Y(L,e);return t.combinator=!0,t}function $(e){var t=Y(M,e);return t.combinator=!0,t}function Z(e,t){var n,r=null;return Object(o.d)(e)?n=e:(Object(o.a)(e)?(r=e[0],n=e[1]):(r=e.context,n=e.fn),r&&Object(o.k)(n)&&Object(o.d)(r[n])&&(n=r[n])),{context:r,fn:n,args:t}}function ee(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Y(U,Z(e,n))}function te(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Y(F,Z(e,n))}function ne(e){return void 0===e&&(e=r.h),Y(B,e)}function re(e,t){return Y(G,{pattern:e,buffer:t})}var ie=ee.bind(null,a.a)},function(e,t,n){"use strict";var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;Object.create;var i,o,a=n(0),s=n(16),c=n(14),u=((i={})["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",i["bad-app-name"]="Illegal App name: '{$appName}",i["duplicate-app"]="Firebase App named '{$appName}' already exists",i["app-deleted"]="Firebase App named '{$appName}' already deleted",i["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",i["invalid-log-argument"]="First argument to `onLog` must be null or a function.",i),l=new a.b("app","Firebase",u),d="@firebase/app",f="[DEFAULT]",h=((o={})[d]="fire-core",o["@firebase/analytics"]="fire-analytics",o["@firebase/auth"]="fire-auth",o["@firebase/database"]="fire-rtdb",o["@firebase/functions"]="fire-fn",o["@firebase/installations"]="fire-iid",o["@firebase/messaging"]="fire-fcm",o["@firebase/performance"]="fire-perf",o["@firebase/remote-config"]="fire-rc",o["@firebase/storage"]="fire-gcs",o["@firebase/firestore"]="fire-fst",o["fire-js"]="fire-js",o["firebase-wrapper"]="fire-js-all",o),p=new c.b("@firebase/app"),v=function(){function e(e,t,n){var r=this;this.firebase_=n,this.isDeleted_=!1,this.name_=t.name,this.automaticDataCollectionEnabled_=t.automaticDataCollectionEnabled||!1,this.options_=Object(a.m)(e),this.container=new s.b(t.name),this._addComponent(new s.a("app",(function(){return r}),"PUBLIC")),this.firebase_.INTERNAL.components.forEach((function(e){return r._addComponent(e)}))}return Object.defineProperty(e.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),e.prototype.delete=function(){var e=this;return new Promise((function(t){e.checkDestroyed_(),t()})).then((function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map((function(e){return e.delete()})))})).then((function(){e.isDeleted_=!0}))},e.prototype._getService=function(e,t){return void 0===t&&(t=f),this.checkDestroyed_(),this.container.getProvider(e).getImmediate({identifier:t})},e.prototype._removeServiceInstance=function(e,t){void 0===t&&(t=f),this.container.getProvider(e).clearInstance(t)},e.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(t){p.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,t)}},e.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},e.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},e.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw l.create("app-deleted",{appName:this.name_})},e}();v.prototype.name&&v.prototype.options||v.prototype.delete||console.log("dc");var m=function e(){var t=function(e){var t={},n=new Map,r={__esModule:!0,initializeApp:function(n,i){void 0===i&&(i={}),"object"===typeof i&&null!==i||(i={name:i});var o=i;void 0===o.name&&(o.name=f);var s=o.name;if("string"!==typeof s||!s)throw l.create("bad-app-name",{appName:String(s)});if(Object(a.k)(t,s))throw l.create("duplicate-app",{appName:s});var c=new e(n,o,r);return t[s]=c,c},app:i,registerVersion:function(e,t,n){var r,i=null!==(r=h[e])&&void 0!==r?r:e;n&&(i+="-"+n);var a=i.match(/\s|\//),c=t.match(/\s|\//);if(a||c){var u=['Unable to register library "'+i+'" with version "'+t+'":'];return a&&u.push('library name "'+i+'" contains illegal characters (whitespace or "/")'),a&&c&&u.push("and"),c&&u.push('version name "'+t+'" contains illegal characters (whitespace or "/")'),void p.warn(u.join(" "))}o(new s.a(i+"-version",(function(){return{library:i,version:t}}),"VERSION"))},setLogLevel:c.c,onLog:function(e,t){if(null!==e&&"function"!==typeof e)throw l.create("invalid-log-argument");Object(c.d)(e,t)},apps:null,SDK_VERSION:"8.4.0",INTERNAL:{registerComponent:o,removeApp:function(e){delete t[e]},components:n,useAsService:function(e,t){return"serverAuth"===t?null:t}}};function i(e){if(e=e||f,!Object(a.k)(t,e))throw l.create("no-app",{appName:e});return t[e]}function o(o){var s=o.name;if(n.has(s))return p.debug("There were multiple attempts to register component "+s+"."),"PUBLIC"===o.type?r[s]:null;if(n.set(s,o),"PUBLIC"===o.type){var c=function(e){if(void 0===e&&(e=i()),"function"!==typeof e[s])throw l.create("invalid-app-argument",{appName:s});return e[s]()};void 0!==o.serviceProps&&Object(a.n)(c,o.serviceProps),r[s]=c,e.prototype[s]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this._getService.bind(this,s).apply(this,o.multipleInstances?e:[])}}for(var u=0,d=Object.keys(t);u<d.length;u++){var f=d[u];t[f]._addComponent(o)}return"PUBLIC"===o.type?r[s]:null}return r.default=r,Object.defineProperty(r,"apps",{get:function(){return Object.keys(t).map((function(e){return t[e]}))}}),i.App=e,r}(v);return t.INTERNAL=r(r({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){Object(a.n)(t,e)},createSubscribe:a.l,ErrorFactory:a.b,deepExtend:a.n}),t}(),g=function(){function e(e){this.container=e}return e.prototype.getPlatformInfoString=function(){return this.container.getProviders().map((function(e){if(function(e){var t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){var t=e.getImmediate();return t.library+"/"+t.version}return null})).filter((function(e){return e})).join(" ")},e}();if(Object(a.s)()&&void 0!==self.firebase){p.warn("\n    Warning: Firebase is already defined in the global scope. Please make sure\n    Firebase library is only loaded once.\n  ");var y=self.firebase.SDK_VERSION;y&&y.indexOf("LITE")>=0&&p.warn("\n    Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n    ")}var _=m.initializeApp;m.initializeApp=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return Object(a.z)()&&p.warn('\n      Warning: This is a browser-targeted Firebase bundle but it appears it is being\n      run in a Node environment.  If running in a Node environment, make sure you\n      are using the bundle specified by the "main" field in package.json.\n      \n      If you are using Webpack, you can specify "main" as the first item in\n      "resolve.mainFields":\n      https://webpack.js.org/configuration/resolve/#resolvemainfields\n      \n      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"\n      as the first item in "mainFields", e.g. [\'main\', \'module\'].\n      https://github.com/rollup/@rollup/plugin-node-resolve\n      '),_.apply(void 0,e)};var b,E,w=m;(b=w).INTERNAL.registerComponent(new s.a("platform-logger",(function(e){return new g(e)}),"PRIVATE")),b.registerVersion(d,"0.6.20",E),b.registerVersion("fire-js","");t.a=w},function(e,t,n){"use strict";n.d(t,"a",(function(){return c})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return g})),n.d(t,"d",(function(){return a})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return m})),n.d(t,"g",(function(){return o})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return l})),n.d(t,"k",(function(){return s})),n.d(t,"l",(function(){return p})),n.d(t,"m",(function(){return v})),n.d(t,"n",(function(){return i}));var r=n(11),i=function(e){return null===e||void 0===e},o=function(e){return null!==e&&void 0!==e},a=function(e){return"function"===typeof e},s=function(e){return"string"===typeof e},c=Array.isArray,u=function(e){return e&&!c(e)&&"object"===typeof e},l=function(e){return e&&a(e.then)},d=function(e){return e&&a(e.next)&&a(e.throw)},f=function e(t){return t&&(s(t)||v(t)||a(t)||c(t)&&t.every(e))},h=function(e){return e&&a(e.take)&&a(e.close)},p=function(e){return a(e)&&e.hasOwnProperty("toString")},v=function(e){return Boolean(e)&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype},m=function(e){return h(e)&&e[r.e]},g=function(e){return e&&e[r.c]}},function(e,t,n){"use strict";n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return o})),n.d(t,"e",(function(){return a})),n.d(t,"c",(function(){return s})),n.d(t,"d",(function(){return c}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;function a(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}Object.create},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(41);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";function r(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return De}));var r=n(32),i=n(2),o=n.n(i),a=n(54),s=n.n(a),c=n(55),u=n(56),l=n(49),d=n(29),f=n.n(d);function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var p=function(e,t){for(var n=[e[0]],r=0,i=t.length;r<i;r+=1)n.push(t[r],e[r+1]);return n},v=function(e){return null!==e&&"object"==typeof e&&"[object Object]"===(e.toString?e.toString():Object.prototype.toString.call(e))&&!Object(r.typeOf)(e)},m=Object.freeze([]),g=Object.freeze({});function y(e){return"function"==typeof e}function _(e){return e.displayName||e.name||"Component"}function b(e){return e&&"string"==typeof e.styledComponentId}var E="undefined"!=typeof e&&(Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).REACT_APP_SC_ATTR||Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).SC_ATTR)||"data-styled",w="undefined"!=typeof window&&"HTMLElement"in window,T=Boolean("boolean"==typeof SC_DISABLE_SPEEDY?SC_DISABLE_SPEEDY:"undefined"!=typeof e&&void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).REACT_APP_SC_DISABLE_SPEEDY&&""!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).REACT_APP_SC_DISABLE_SPEEDY?"false"!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).REACT_APP_SC_DISABLE_SPEEDY&&Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).REACT_APP_SC_DISABLE_SPEEDY:"undefined"!=typeof e&&void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).SC_DISABLE_SPEEDY&&""!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).SC_DISABLE_SPEEDY&&("false"!==Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).SC_DISABLE_SPEEDY&&Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).SC_DISABLE_SPEEDY)),S={};function I(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw new Error("An error occurred. See https://git.io/JUIaE#"+e+" for more information."+(n.length>0?" Args: "+n.join(", "):""))}var R=function(){function e(e){this.groupSizes=new Uint32Array(512),this.length=512,this.tag=e}var t=e.prototype;return t.indexOfGroup=function(e){for(var t=0,n=0;n<e;n++)t+=this.groupSizes[n];return t},t.insertRules=function(e,t){if(e>=this.groupSizes.length){for(var n=this.groupSizes,r=n.length,i=r;e>=i;)(i<<=1)<0&&I(16,""+e);this.groupSizes=new Uint32Array(i),this.groupSizes.set(n),this.length=i;for(var o=r;o<i;o++)this.groupSizes[o]=0}for(var a=this.indexOfGroup(e+1),s=0,c=t.length;s<c;s++)this.tag.insertRule(a,t[s])&&(this.groupSizes[e]++,a++)},t.clearGroup=function(e){if(e<this.length){var t=this.groupSizes[e],n=this.indexOfGroup(e),r=n+t;this.groupSizes[e]=0;for(var i=n;i<r;i++)this.tag.deleteRule(n)}},t.getGroup=function(e){var t="";if(e>=this.length||0===this.groupSizes[e])return t;for(var n=this.groupSizes[e],r=this.indexOfGroup(e),i=r+n,o=r;o<i;o++)t+=this.tag.getRule(o)+"/*!sc*/\n";return t},e}(),A=new Map,C=new Map,k=1,O=function(e){if(A.has(e))return A.get(e);for(;C.has(k);)k++;var t=k++;return A.set(e,t),C.set(t,e),t},N=function(e){return C.get(e)},P=function(e,t){A.set(e,t),C.set(t,e)},D="style["+E+'][data-styled-version="5.2.3"]',x=new RegExp("^"+E+'\\.g(\\d+)\\[id="([\\w\\d-]+)"\\].*?"([^"]*)'),L=function(e,t,n){for(var r,i=n.split(","),o=0,a=i.length;o<a;o++)(r=i[o])&&e.registerName(t,r)},M=function(e,t){for(var n=t.innerHTML.split("/*!sc*/\n"),r=[],i=0,o=n.length;i<o;i++){var a=n[i].trim();if(a){var s=a.match(x);if(s){var c=0|parseInt(s[1],10),u=s[2];0!==c&&(P(u,c),L(e,u,s[3]),e.getTag().insertRules(c,r)),r.length=0}else r.push(a)}}},U=function(){return"undefined"!=typeof window&&void 0!==window.__webpack_nonce__?window.__webpack_nonce__:null},j=function(e){var t=document.head,n=e||t,r=document.createElement("style"),i=function(e){for(var t=e.childNodes,n=t.length;n>=0;n--){var r=t[n];if(r&&1===r.nodeType&&r.hasAttribute(E))return r}}(n),o=void 0!==i?i.nextSibling:null;r.setAttribute(E,"active"),r.setAttribute("data-styled-version","5.2.3");var a=U();return a&&r.setAttribute("nonce",a),n.insertBefore(r,o),r},F=function(){function e(e){var t=this.element=j(e);t.appendChild(document.createTextNode("")),this.sheet=function(e){if(e.sheet)return e.sheet;for(var t=document.styleSheets,n=0,r=t.length;n<r;n++){var i=t[n];if(i.ownerNode===e)return i}I(17)}(t),this.length=0}var t=e.prototype;return t.insertRule=function(e,t){try{return this.sheet.insertRule(t,e),this.length++,!0}catch(e){return!1}},t.deleteRule=function(e){this.sheet.deleteRule(e),this.length--},t.getRule=function(e){var t=this.sheet.cssRules[e];return void 0!==t&&"string"==typeof t.cssText?t.cssText:""},e}(),V=function(){function e(e){var t=this.element=j(e);this.nodes=t.childNodes,this.length=0}var t=e.prototype;return t.insertRule=function(e,t){if(e<=this.length&&e>=0){var n=document.createTextNode(t),r=this.nodes[e];return this.element.insertBefore(n,r||null),this.length++,!0}return!1},t.deleteRule=function(e){this.element.removeChild(this.nodes[e]),this.length--},t.getRule=function(e){return e<this.length?this.nodes[e].textContent:""},e}(),B=function(){function e(e){this.rules=[],this.length=0}var t=e.prototype;return t.insertRule=function(e,t){return e<=this.length&&(this.rules.splice(e,0,t),this.length++,!0)},t.deleteRule=function(e){this.rules.splice(e,1),this.length--},t.getRule=function(e){return e<this.length?this.rules[e]:""},e}(),W=w,G={isServer:!w,useCSSOMInjection:!T},q=function(){function e(e,t,n){void 0===e&&(e=g),void 0===t&&(t={}),this.options=h({},G,{},e),this.gs=t,this.names=new Map(n),!this.options.isServer&&w&&W&&(W=!1,function(e){for(var t=document.querySelectorAll(D),n=0,r=t.length;n<r;n++){var i=t[n];i&&"active"!==i.getAttribute(E)&&(M(e,i),i.parentNode&&i.parentNode.removeChild(i))}}(this))}e.registerId=function(e){return O(e)};var t=e.prototype;return t.reconstructWithOptions=function(t,n){return void 0===n&&(n=!0),new e(h({},this.options,{},t),this.gs,n&&this.names||void 0)},t.allocateGSInstance=function(e){return this.gs[e]=(this.gs[e]||0)+1},t.getTag=function(){return this.tag||(this.tag=(n=(t=this.options).isServer,r=t.useCSSOMInjection,i=t.target,e=n?new B(i):r?new F(i):new V(i),new R(e)));var e,t,n,r,i},t.hasNameForId=function(e,t){return this.names.has(e)&&this.names.get(e).has(t)},t.registerName=function(e,t){if(O(e),this.names.has(e))this.names.get(e).add(t);else{var n=new Set;n.add(t),this.names.set(e,n)}},t.insertRules=function(e,t,n){this.registerName(e,t),this.getTag().insertRules(O(e),n)},t.clearNames=function(e){this.names.has(e)&&this.names.get(e).clear()},t.clearRules=function(e){this.getTag().clearGroup(O(e)),this.clearNames(e)},t.clearTag=function(){this.tag=void 0},t.toString=function(){return function(e){for(var t=e.getTag(),n=t.length,r="",i=0;i<n;i++){var o=N(i);if(void 0!==o){var a=e.names.get(o),s=t.getGroup(i);if(void 0!==a&&0!==s.length){var c=E+".g"+i+'[id="'+o+'"]',u="";void 0!==a&&a.forEach((function(e){e.length>0&&(u+=e+",")})),r+=""+s+c+'{content:"'+u+'"}/*!sc*/\n'}}}return r}(this)},e}(),K=/(a)(d)/gi,H=function(e){return String.fromCharCode(e+(e>25?39:97))};function z(e){var t,n="";for(t=Math.abs(e);t>52;t=t/52|0)n=H(t%52)+n;return(H(t%52)+n).replace(K,"$1-$2")}var Y=function(e,t){for(var n=t.length;n;)e=33*e^t.charCodeAt(--n);return e},Q=function(e){return Y(5381,e)};function X(e){for(var t=0;t<e.length;t+=1){var n=e[t];if(y(n)&&!b(n))return!1}return!0}var J=Q("5.2.3"),$=function(){function e(e,t,n){this.rules=e,this.staticRulesId="",this.isStatic=(void 0===n||n.isStatic)&&X(e),this.componentId=t,this.baseHash=Y(J,t),this.baseStyle=n,q.registerId(t)}return e.prototype.generateAndInjectStyles=function(e,t,n){var r=this.componentId,i=[];if(this.baseStyle&&i.push(this.baseStyle.generateAndInjectStyles(e,t,n)),this.isStatic&&!n.hash)if(this.staticRulesId&&t.hasNameForId(r,this.staticRulesId))i.push(this.staticRulesId);else{var o=me(this.rules,e,t,n).join(""),a=z(Y(this.baseHash,o.length)>>>0);if(!t.hasNameForId(r,a)){var s=n(o,"."+a,void 0,r);t.insertRules(r,a,s)}i.push(a),this.staticRulesId=a}else{for(var c=this.rules.length,u=Y(this.baseHash,n.hash),l="",d=0;d<c;d++){var f=this.rules[d];if("string"==typeof f)l+=f;else if(f){var h=me(f,e,t,n),p=Array.isArray(h)?h.join(""):h;u=Y(u,p+d),l+=p}}if(l){var v=z(u>>>0);if(!t.hasNameForId(r,v)){var m=n(l,"."+v,void 0,r);t.insertRules(r,v,m)}i.push(v)}}return i.join(" ")},e}(),Z=/^\s*\/\/.*$/gm,ee=[":","[",".","#"];function te(e){var t,n,r,i,o=void 0===e?g:e,a=o.options,s=void 0===a?g:a,u=o.plugins,l=void 0===u?m:u,d=new c.a(s),f=[],h=function(e){function t(t){if(t)try{e(t+"}")}catch(e){}}return function(n,r,i,o,a,s,c,u,l,d){switch(n){case 1:if(0===l&&64===r.charCodeAt(0))return e(r+";"),"";break;case 2:if(0===u)return r+"/*|*/";break;case 3:switch(u){case 102:case 112:return e(i[0]+r),"";default:return r+(0===d?"/*|*/":"")}case-2:r.split("/*|*/}").forEach(t)}}}((function(e){f.push(e)})),p=function(e,r,o){return 0===r&&-1!==ee.indexOf(o[n.length])||o.match(i)?e:"."+t};function v(e,o,a,s){void 0===s&&(s="&");var c=e.replace(Z,""),u=o&&a?a+" "+o+" { "+c+" }":c;return t=s,n=o,r=new RegExp("\\"+n+"\\b","g"),i=new RegExp("(\\"+n+"\\b){2,}"),d(a||!o?"":o,u)}return d.use([].concat(l,[function(e,t,i){2===e&&i.length&&i[0].lastIndexOf(n)>0&&(i[0]=i[0].replace(r,p))},h,function(e){if(-2===e){var t=f;return f=[],t}}])),v.hash=l.length?l.reduce((function(e,t){return t.name||I(15),Y(e,t.name)}),5381).toString():"",v}var ne=o.a.createContext(),re=(ne.Consumer,o.a.createContext()),ie=(re.Consumer,new q),oe=te();function ae(){return Object(i.useContext)(ne)||ie}function se(){return Object(i.useContext)(re)||oe}function ce(e){var t=Object(i.useState)(e.stylisPlugins),n=t[0],r=t[1],a=ae(),c=Object(i.useMemo)((function(){var t=a;return e.sheet?t=e.sheet:e.target&&(t=t.reconstructWithOptions({target:e.target},!1)),e.disableCSSOMInjection&&(t=t.reconstructWithOptions({useCSSOMInjection:!1})),t}),[e.disableCSSOMInjection,e.sheet,e.target]),u=Object(i.useMemo)((function(){return te({options:{prefix:!e.disableVendorPrefixes},plugins:n})}),[e.disableVendorPrefixes,n]);return Object(i.useEffect)((function(){s()(n,e.stylisPlugins)||r(e.stylisPlugins)}),[e.stylisPlugins]),o.a.createElement(ne.Provider,{value:c},o.a.createElement(re.Provider,{value:u},e.children))}var ue=function(){function e(e,t){var n=this;this.inject=function(e,t){void 0===t&&(t=oe);var r=n.name+t.hash;e.hasNameForId(n.id,r)||e.insertRules(n.id,r,t(n.rules,r,"@keyframes"))},this.toString=function(){return I(12,String(n.name))},this.name=e,this.id="sc-keyframes-"+e,this.rules=t}return e.prototype.getName=function(e){return void 0===e&&(e=oe),this.name+e.hash},e}(),le=/([A-Z])/,de=/([A-Z])/g,fe=/^ms-/,he=function(e){return"-"+e.toLowerCase()};function pe(e){return le.test(e)?e.replace(de,he).replace(fe,"-ms-"):e}var ve=function(e){return null==e||!1===e||""===e};function me(e,t,n,r){if(Array.isArray(e)){for(var i,o=[],a=0,s=e.length;a<s;a+=1)""!==(i=me(e[a],t,n,r))&&(Array.isArray(i)?o.push.apply(o,i):o.push(i));return o}return ve(e)?"":b(e)?"."+e.styledComponentId:y(e)?"function"!=typeof(c=e)||c.prototype&&c.prototype.isReactComponent||!t?e:me(e(t),t,n,r):e instanceof ue?n?(e.inject(n,r),e.getName(r)):e:v(e)?function e(t,n){var r,i,o=[];for(var a in t)t.hasOwnProperty(a)&&!ve(t[a])&&(v(t[a])?o.push.apply(o,e(t[a],a)):y(t[a])?o.push(pe(a)+":",t[a],";"):o.push(pe(a)+": "+(r=a,(null==(i=t[a])||"boolean"==typeof i||""===i?"":"number"!=typeof i||0===i||r in u.a?String(i).trim():i+"px")+";")));return n?[n+" {"].concat(o,["}"]):o}(e):e.toString();var c}function ge(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return y(e)||v(e)?me(p(m,[e].concat(n))):0===n.length&&1===e.length&&"string"==typeof e[0]?e:me(p(e,n))}new Set;var ye=function(e,t,n){return void 0===n&&(n=g),e.theme!==n.theme&&e.theme||t||n.theme},_e=/[!"#$%&'()*+,./:;<=>?@[\\\]^`{|}~-]+/g,be=/(^-|-$)/g;function Ee(e){return e.replace(_e,"-").replace(be,"")}var we=function(e){return z(Q(e)>>>0)};function Te(e){return"string"==typeof e&&!0}var Se=function(e){return"function"==typeof e||"object"==typeof e&&null!==e&&!Array.isArray(e)},Ie=function(e){return"__proto__"!==e&&"constructor"!==e&&"prototype"!==e};function Re(e,t,n){var r=e[n];Se(t)&&Se(r)?Ae(r,t):e[n]=t}function Ae(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];if(Se(a))for(var s in a)Ie(s)&&Re(e,a[s],s)}return e}var Ce=o.a.createContext();Ce.Consumer;var ke={};function Oe(e,t,n){var r=b(e),a=!Te(e),s=t.attrs,c=void 0===s?m:s,u=t.componentId,d=void 0===u?function(e,t){var n="string"!=typeof e?"sc":Ee(e);ke[n]=(ke[n]||0)+1;var r=n+"-"+we("5.2.3"+n+ke[n]);return t?t+"-"+r:r}(t.displayName,t.parentComponentId):u,p=t.displayName,v=void 0===p?function(e){return Te(e)?"styled."+e:"Styled("+_(e)+")"}(e):p,E=t.displayName&&t.componentId?Ee(t.displayName)+"-"+t.componentId:t.componentId||d,w=r&&e.attrs?Array.prototype.concat(e.attrs,c).filter(Boolean):c,T=t.shouldForwardProp;r&&e.shouldForwardProp&&(T=t.shouldForwardProp?function(n,r){return e.shouldForwardProp(n,r)&&t.shouldForwardProp(n,r)}:e.shouldForwardProp);var S,I=new $(n,E,r?e.componentStyle:void 0),R=I.isStatic&&0===c.length,A=function(e,t){return function(e,t,n,r){var o=e.attrs,a=e.componentStyle,s=e.defaultProps,c=e.foldedComponentIds,u=e.shouldForwardProp,d=e.styledComponentId,f=e.target,p=function(e,t,n){void 0===e&&(e=g);var r=h({},t,{theme:e}),i={};return n.forEach((function(e){var t,n,o,a=e;for(t in y(a)&&(a=a(r)),a)r[t]=i[t]="className"===t?(n=i[t],o=a[t],n&&o?n+" "+o:n||o):a[t]})),[r,i]}(ye(t,Object(i.useContext)(Ce),s)||g,t,o),v=p[0],m=p[1],_=function(e,t,n,r){var i=ae(),o=se();return t?e.generateAndInjectStyles(g,i,o):e.generateAndInjectStyles(n,i,o)}(a,r,v),b=n,E=m.$as||t.$as||m.as||t.as||f,w=Te(E),T=m!==t?h({},t,{},m):t,S={};for(var I in T)"$"!==I[0]&&"as"!==I&&("forwardedAs"===I?S.as=T[I]:(u?u(I,l.a):!w||Object(l.a)(I))&&(S[I]=T[I]));return t.style&&m.style!==t.style&&(S.style=h({},t.style,{},m.style)),S.className=Array.prototype.concat(c,d,_!==d?_:null,t.className,m.className).filter(Boolean).join(" "),S.ref=b,Object(i.createElement)(E,S)}(S,e,t,R)};return A.displayName=v,(S=o.a.forwardRef(A)).attrs=w,S.componentStyle=I,S.displayName=v,S.shouldForwardProp=T,S.foldedComponentIds=r?Array.prototype.concat(e.foldedComponentIds,e.styledComponentId):m,S.styledComponentId=E,S.target=r?e.target:e,S.withComponent=function(e){var r=t.componentId,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(t,["componentId"]),o=r&&r+"-"+(Te(e)?e:Ee(_(e)));return Oe(e,h({},i,{attrs:w,componentId:o}),n)},Object.defineProperty(S,"defaultProps",{get:function(){return this._foldedDefaultProps},set:function(t){this._foldedDefaultProps=r?Ae({},e.defaultProps,t):t}}),S.toString=function(){return"."+S.styledComponentId},a&&f()(S,e,{attrs:!0,componentStyle:!0,displayName:!0,foldedComponentIds:!0,shouldForwardProp:!0,styledComponentId:!0,target:!0,withComponent:!0}),S}var Ne=function(e){return function e(t,n,i){if(void 0===i&&(i=g),!Object(r.isValidElementType)(n))return I(1,String(n));var o=function(){return t(n,i,ge.apply(void 0,arguments))};return o.withConfig=function(r){return e(t,n,h({},i,{},r))},o.attrs=function(r){return e(t,n,h({},i,{attrs:Array.prototype.concat(i.attrs,r).filter(Boolean)}))},o}(Oe,e)};["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","marker","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"].forEach((function(e){Ne[e]=Ne(e)}));var Pe=function(){function e(e,t){this.rules=e,this.componentId=t,this.isStatic=X(e),q.registerId(this.componentId+1)}var t=e.prototype;return t.createStyles=function(e,t,n,r){var i=r(me(this.rules,t,n,r).join(""),""),o=this.componentId+e;n.insertRules(o,o,i)},t.removeStyles=function(e,t){t.clearRules(this.componentId+e)},t.renderStyles=function(e,t,n,r){e>2&&q.registerId(this.componentId+e),this.removeStyles(e,n),this.createStyles(e,t,n,r)},e}();function De(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=ge.apply(void 0,[e].concat(n)),s="sc-global-"+we(JSON.stringify(a)),c=new Pe(a,s);function u(e){var t=ae(),n=se(),r=Object(i.useContext)(Ce),o=Object(i.useRef)(t.allocateGSInstance(s)).current;return Object(i.useLayoutEffect)((function(){return l(o,e,t,r,n),function(){return c.removeStyles(o,t)}}),[o,e,t,r,n]),null}function l(e,t,n,r,i){if(c.isStatic)c.renderStyles(e,S,n,i);else{var o=h({},t,{theme:ye(t,r,u.defaultProps)});c.renderStyles(e,o,n,i)}}return o.a.memo(u)}!function(){function e(){var e=this;this._emitSheetCSS=function(){var t=e.instance.toString(),n=U();return"<style "+[n&&'nonce="'+n+'"',E+'="true"','data-styled-version="5.2.3"'].filter(Boolean).join(" ")+">"+t+"</style>"},this.getStyleTags=function(){return e.sealed?I(2):e._emitSheetCSS()},this.getStyleElement=function(){var t;if(e.sealed)return I(2);var n=((t={})[E]="",t["data-styled-version"]="5.2.3",t.dangerouslySetInnerHTML={__html:e.instance.toString()},t),r=U();return r&&(n.nonce=r),[o.a.createElement("style",h({},n,{key:"sc-0-0"}))]},this.seal=function(){e.sealed=!0},this.instance=new q({isServer:!0}),this.sealed=!1}var t=e.prototype;t.collectStyles=function(e){return this.sealed?I(2):o.a.createElement(ce,{sheet:this.instance},e)},t.interleaveWithNodeStream=function(e){return I(3)}}();t.b=Ne}).call(this,n(38))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o})),n.d(t,"c",(function(){return a})),n.d(t,"d",(function(){return s})),n.d(t,"e",(function(){return c})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return p})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"j",(function(){return f})),n.d(t,"k",(function(){return h}));var r=function(e){return"@@redux-saga/"+e},i=r("CANCEL_PROMISE"),o=r("CHANNEL_END"),a=r("IO"),s=r("MATCH"),c=r("MULTICAST"),u=r("SAGA_ACTION"),l=r("SELF_CANCELLATION"),d=r("TASK"),f=r("TASK_CANCEL"),h=r("TERMINATE"),p=r("LOCATION")},function(e,t,n){"use strict";function r(){return(r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,"a",(function(){return r}))},function(e,t,n){e.exports=n(73)},function(e,t,n){"use strict";function r(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var i;n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return h}));var o,a=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(o||(o={}));var s={debug:o.DEBUG,verbose:o.VERBOSE,info:o.INFO,warn:o.WARN,error:o.ERROR,silent:o.SILENT},c=o.INFO,u=((i={})[o.DEBUG]="log",i[o.VERBOSE]="log",i[o.INFO]="info",i[o.WARN]="warn",i[o.ERROR]="error",i),l=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];if(!(t<e.logLevel)){var o=(new Date).toISOString(),a=u[t];if(!a)throw new Error("Attempted to log a message with an invalid logType (value: "+t+")");console[a].apply(console,r(["["+o+"]  "+e.name+":"],n))}},d=function(){function e(e){this.name=e,this._logLevel=c,this._logHandler=l,this._userLogHandler=null,a.push(this)}return Object.defineProperty(e.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in o))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),e.prototype.setLogLevel=function(e){this._logLevel="string"===typeof e?s[e]:e},Object.defineProperty(e.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.DEBUG],e)),this._logHandler.apply(this,r([this,o.DEBUG],e))},e.prototype.log=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.VERBOSE],e)),this._logHandler.apply(this,r([this,o.VERBOSE],e))},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.INFO],e)),this._logHandler.apply(this,r([this,o.INFO],e))},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.WARN],e)),this._logHandler.apply(this,r([this,o.WARN],e))},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._userLogHandler&&this._userLogHandler.apply(this,r([this,o.ERROR],e)),this._logHandler.apply(this,r([this,o.ERROR],e))},e}();function f(e){a.forEach((function(t){t.setLogLevel(e)}))}function h(e,t){for(var n=function(n){var r=null;t&&t.level&&(r=s[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=[],a=2;a<arguments.length;a++)i[a-2]=arguments[a];var s=i.map((function(e){if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((function(e){return e})).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:o[n].toLowerCase(),message:s,args:i,type:t.name})}},r=0,i=a;r<i.length;r++){n(i[r])}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(27);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){Object(r.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}},function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return h})),n.d(t,"c",(function(){return f}));var r=function(){return(r=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function i(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function o(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}Object.create;function a(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function s(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}Object.create;var u=n(0),l=function(){function e(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return e.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},e.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},e.prototype.setServiceProps=function(e){return this.serviceProps=e,this},e.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},e}(),d="[DEFAULT]",f=function(){function e(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map}return e.prototype.get=function(e){void 0===e&&(e=d);var t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){var n=new u.a;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{var r=this.getOrInitializeService({instanceIdentifier:t});r&&n.resolve(r)}catch(i){}}return this.instancesDeferred.get(t).promise},e.prototype.getImmediate=function(e){var t=r({identifier:d,optional:!1},e),n=t.identifier,i=t.optional,o=this.normalizeInstanceIdentifier(n);if(!this.isInitialized(o)&&!this.shouldAutoInitialize()){if(i)return null;throw Error("Service "+this.name+" is not available")}try{return this.getOrInitializeService({instanceIdentifier:o})}catch(a){if(i)return null;throw a}},e.prototype.getComponent=function(){return this.component},e.prototype.setComponent=function(e){var t,n;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:d})}catch(h){}try{for(var r=a(this.instancesDeferred.entries()),i=r.next();!i.done;i=r.next()){var o=s(i.value,2),c=o[0],u=o[1],l=this.normalizeInstanceIdentifier(c);try{var f=this.getOrInitializeService({instanceIdentifier:l});u.resolve(f)}catch(h){}}}catch(p){t={error:p}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}}},e.prototype.clearInstance=function(e){void 0===e&&(e=d),this.instancesDeferred.delete(e),this.instances.delete(e)},e.prototype.delete=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(c(c([],s(e.filter((function(e){return"INTERNAL"in e})).map((function(e){return e.INTERNAL.delete()})))),s(e.filter((function(e){return"_delete"in e})).map((function(e){return e._delete()})))))];case 1:return t.sent(),[2]}}))}))},e.prototype.isComponentSet=function(){return null!=this.component},e.prototype.isInitialized=function(e){return void 0===e&&(e=d),this.instances.has(e)},e.prototype.initialize=function(e){var t,n;void 0===e&&(e={});var r=e.instanceIdentifier,i=void 0===r?d:r,o=e.options,c=void 0===o?{}:o,u=this.normalizeInstanceIdentifier(i);if(this.isInitialized(u))throw Error(this.name+"("+u+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var l=this.getOrInitializeService({instanceIdentifier:u,options:c});try{for(var f=a(this.instancesDeferred.entries()),h=f.next();!h.done;h=f.next()){var p=s(h.value,2),v=p[0],m=p[1];u===this.normalizeInstanceIdentifier(v)&&m.resolve(l)}}catch(g){t={error:g}}finally{try{h&&!h.done&&(n=f.return)&&n.call(f)}finally{if(t)throw t.error}}return l},e.prototype.getOrInitializeService=function(e){var t,n=e.instanceIdentifier,r=e.options,i=void 0===r?{}:r,o=this.instances.get(n);if(!o&&this.component&&(o=this.component.instanceFactory(this.container,{instanceIdentifier:(t=n,t===d?void 0:t),options:i}),this.instances.set(n,o),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,o)}catch(a){}return o||null},e.prototype.normalizeInstanceIdentifier=function(e){return this.component?this.component.multipleInstances?e:d:e},e.prototype.shouldAutoInitialize=function(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode},e}();var h=function(){function e(e){this.name=e,this.providers=new Map}return e.prototype.addComponent=function(e){var t=this.getProvider(e.name);if(t.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);t.setComponent(e)},e.prototype.addOrOverwriteComponent=function(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},e.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var t=new f(e,this);return this.providers.set(e,t),t},e.prototype.getProviders=function(){return Array.from(this.providers.values())},e}()},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return b}));var r=n(2),i=n.n(r),o=(n(34),i.a.createContext(null));var a=function(e){e()},s={notify:function(){}};function c(){var e=a,t=null,n=null;return{clear:function(){t=null,n=null},notify:function(){e((function(){for(var e=t;e;)e.callback(),e=e.next}))},get:function(){for(var e=[],n=t;n;)e.push(n),n=n.next;return e},subscribe:function(e){var r=!0,i=n={callback:e,next:null,prev:n};return i.prev?i.prev.next=i:t=i,function(){r&&null!==t&&(r=!1,i.next?i.next.prev=i.prev:n=i.prev,i.prev?i.prev.next=i.next:t=i.next)}}}}var u=function(){function e(e,t){this.store=e,this.parentSub=t,this.unsubscribe=null,this.listeners=s,this.handleChangeWrapper=this.handleChangeWrapper.bind(this)}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.handleChangeWrapper=function(){this.onStateChange&&this.onStateChange()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.handleChangeWrapper):this.store.subscribe(this.handleChangeWrapper),this.listeners=c())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=s)},e}(),l="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement?r.useLayoutEffect:r.useEffect;var d=function(e){var t=e.store,n=e.context,a=e.children,s=Object(r.useMemo)((function(){var e=new u(t);return e.onStateChange=e.notifyNestedSubs,{store:t,subscription:e}}),[t]),c=Object(r.useMemo)((function(){return t.getState()}),[t]);l((function(){var e=s.subscription;return e.trySubscribe(),c!==t.getState()&&e.notifyNestedSubs(),function(){e.tryUnsubscribe(),e.onStateChange=null}}),[s,c]);var d=n||o;return i.a.createElement(d.Provider,{value:s},a)};n(12),n(22),n(29),n(32);n(26);function f(){return Object(r.useContext)(o)}function h(e){void 0===e&&(e=o);var t=e===o?f:function(){return Object(r.useContext)(e)};return function(){return t().store}}var p=h();function v(e){void 0===e&&(e=o);var t=e===o?p:h(e);return function(){return t().dispatch}}var m=v(),g=function(e,t){return e===t};function y(e){void 0===e&&(e=o);var t=e===o?f:function(){return Object(r.useContext)(e)};return function(e,n){void 0===n&&(n=g);var i=t(),o=function(e,t,n,i){var o,a=Object(r.useReducer)((function(e){return e+1}),0)[1],s=Object(r.useMemo)((function(){return new u(n,i)}),[n,i]),c=Object(r.useRef)(),d=Object(r.useRef)(),f=Object(r.useRef)(),h=Object(r.useRef)(),p=n.getState();try{if(e!==d.current||p!==f.current||c.current){var v=e(p);o=void 0!==h.current&&t(v,h.current)?h.current:v}else o=h.current}catch(m){throw c.current&&(m.message+="\nThe error may be correlated with this previous error:\n"+c.current.stack+"\n\n"),m}return l((function(){d.current=e,f.current=p,h.current=o,c.current=void 0})),l((function(){function e(){try{var e=d.current(n.getState());if(t(e,h.current))return;h.current=e}catch(m){c.current=m}a()}return s.onStateChange=e,s.trySubscribe(),e(),function(){return s.tryUnsubscribe()}}),[n,s]),o}(e,n,i.store,i.subscription);return Object(r.useDebugValue)(o),o}}var _,b=y(),E=n(39);_=E.unstable_batchedUpdates,a=_},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return iu})),n.d(t,"b",(function(){return su})),n.d(t,"c",(function(){return pu})),n.d(t,"d",(function(){return mu})),n.d(t,"e",(function(){return au})),n.d(t,"f",(function(){return ru})),n.d(t,"g",(function(){return lu})),n.d(t,"h",(function(){return _u})),n.d(t,"i",(function(){return yu})),n.d(t,"j",(function(){return Vs})),n.d(t,"k",(function(){return wu})),n.d(t,"l",(function(){return S})),n.d(t,"m",(function(){return Bs})),n.d(t,"n",(function(){return Tu})),n.d(t,"o",(function(){return cu})),n.d(t,"p",(function(){return Su})),n.d(t,"q",(function(){return Eu})),n.d(t,"r",(function(){return Qs})),n.d(t,"s",(function(){return nu})),n.d(t,"t",(function(){return vu}));var r=n(0),i=n(14),o=n(20),a=n(1),s=function(){function e(e,t){var n=this;this.previousValue=e,t&&(t.sequenceNumberHandler=function(e){return n.t(e)},this.i=function(e){return t.writeSequenceNumber(e)})}return e.prototype.t=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},e.prototype.next=function(){var e=++this.previousValue;return this.i&&this.i(e),e},e}();s.o=-1;var c={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},u=function(e){function t(t,n){var r=this;return(r=e.call(this,n)||this).code=t,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return Object(a.b)(t,e),t}(Error),l=new i.b("@firebase/firestore");function d(){return l.logLevel}function f(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l.logLevel<=i.a.DEBUG){var r=t.map(v);l.debug.apply(l,Object(a.d)(["Firestore (8.4.0): "+e],r))}}function h(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l.logLevel<=i.a.ERROR){var r=t.map(v);l.error.apply(l,Object(a.d)(["Firestore (8.4.0): "+e],r))}}function p(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(l.logLevel<=i.a.WARN){var r=t.map(v);l.warn.apply(l,Object(a.d)(["Firestore (8.4.0): "+e],r))}}function v(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(t){return e}var t}function m(e){void 0===e&&(e="Unexpected state");var t="FIRESTORE (8.4.0) INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function g(e,t){e||m()}function y(e,t){return e}function _(e){var t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(var r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}var b=function(){function e(){}return e.u=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";n.length<20;)for(var r=_(40),i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length));return n},e}();function E(e,t){return e<t?-1:e>t?1:0}function w(e,t,n){return e.length===t.length&&e.every((function(e,r){return n(e,t[r])}))}function T(e){return e+"\0"}var S=function(){function e(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new u(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new u(c.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new u(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new u(c.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return e.now=function(){return e.fromMillis(Date.now())},e.fromDate=function(t){return e.fromMillis(t.getTime())},e.fromMillis=function(t){var n=Math.floor(t/1e3);return new e(n,Math.floor(1e6*(t-1e3*n)))},e.prototype.toDate=function(){return new Date(this.toMillis())},e.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},e.prototype._compareTo=function(e){return this.seconds===e.seconds?E(this.nanoseconds,e.nanoseconds):E(this.seconds,e.seconds)},e.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},e.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},e.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},e.prototype.valueOf=function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},e}(),I=function(){function e(e){this.timestamp=e}return e.fromTimestamp=function(t){return new e(t)},e.min=function(){return new e(new S(0,0))},e.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},e.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},e.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},e.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},e.prototype.toTimestamp=function(){return this.timestamp},e}();function R(e){var t=0;for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function A(e,t){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function C(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}var k=function(){function e(e,t,n){void 0===t?t=0:t>e.length&&m(),void 0===n?n=e.length-t:n>e.length-t&&m(),this.segments=e,this.offset=t,this.len=n}return Object.defineProperty(e.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return 0===e.comparator(this,t)},e.prototype.child=function(t){var n=this.segments.slice(this.offset,this.limit());return t instanceof e?t.forEach((function(e){n.push(e)})):n.push(t),this.construct(n)},e.prototype.limit=function(){return this.offset+this.length},e.prototype.popFirst=function(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)},e.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},e.prototype.firstSegment=function(){return this.segments[this.offset]},e.prototype.lastSegment=function(){return this.get(this.length-1)},e.prototype.get=function(e){return this.segments[this.offset+e]},e.prototype.isEmpty=function(){return 0===this.length},e.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0},e.prototype.forEach=function(e){for(var t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])},e.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},e.comparator=function(e,t){for(var n=Math.min(e.length,t.length),r=0;r<n;r++){var i=e.get(r),o=t.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<t.length?-1:e.length>t.length?1:0},e}(),O=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.prototype.canonicalString=function(){return this.toArray().join("/")},t.prototype.toString=function(){return this.canonicalString()},t.fromString=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=[],i=0,o=e;i<o.length;i++){var a=o[i];if(a.indexOf("//")>=0)throw new u(c.INVALID_ARGUMENT,"Invalid segment ("+a+"). Paths must not contain // in them.");r.push.apply(r,a.split("/").filter((function(e){return e.length>0})))}return new t(r)},t.emptyPath=function(){return new t([])},t}(k),N=/^[_a-zA-Z][_a-zA-Z0-9]*$/,P=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.construct=function(e,n,r){return new t(e,n,r)},t.isValidIdentifier=function(e){return N.test(e)},t.prototype.canonicalString=function(){return this.toArray().map((function(e){return e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),t.isValidIdentifier(e)||(e="`"+e+"`"),e})).join(".")},t.prototype.toString=function(){return this.canonicalString()},t.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},t.keyField=function(){return new t(["__name__"])},t.fromServerFormat=function(e){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new u(c.INVALID_ARGUMENT,"Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<e.length;){var s=e[i];if("\\"===s){if(i+1===e.length)throw new u(c.INVALID_ARGUMENT,"Path has trailing escape character: "+e);var l=e[i+1];if("\\"!==l&&"."!==l&&"`"!==l)throw new u(c.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=l,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new u(c.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new t(n)},t.emptyPath=function(){return new t([])},t}(k),D=function(){function e(e){this.fields=e,e.sort(P.comparator)}return e.prototype.covers=function(e){for(var t=0,n=this.fields;t<n.length;t++)if(n[t].isPrefixOf(e))return!0;return!1},e.prototype.isEqual=function(e){return w(this.fields,e.fields,(function(e,t){return e.isEqual(t)}))},e}(),x=function(){function e(e){this.binaryString=e}return e.fromBase64String=function(t){return new e(atob(t))},e.fromUint8Array=function(t){return new e(function(e){for(var t="",n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(t))},e.prototype.toBase64=function(){return e=this.binaryString,btoa(e);var e},e.prototype.toUint8Array=function(){return function(e){for(var t=new Uint8Array(e.length),n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)},e.prototype.approximateByteSize=function(){return 2*this.binaryString.length},e.prototype.compareTo=function(e){return E(this.binaryString,e.binaryString)},e.prototype.isEqual=function(e){return this.binaryString===e.binaryString},e}();x.EMPTY_BYTE_STRING=new x("");var L=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function M(e){if(g(!!e),"string"==typeof e){var t=0,n=L.exec(e);if(g(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),t=Number(r)}var i=new Date(e);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:U(e.seconds),nanos:U(e.nanos)}}function U(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function j(e){return"string"==typeof e?x.fromBase64String(e):x.fromUint8Array(e)}function F(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function V(e){var t=e.mapValue.fields.__previous_value__;return F(t)?V(t):t}function B(e){var t=M(e.mapValue.fields.__local_write_time__.timestampValue);return new S(t.seconds,t.nanos)}function W(e){return null==e}function G(e){return 0===e&&1/e==-1/0}function q(e){return"number"==typeof e&&Number.isInteger(e)&&!G(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}var K=function(){function e(e){this.path=e}return e.fromPath=function(t){return new e(O.fromString(t))},e.fromName=function(t){return new e(O.fromString(t).popFirst(5))},e.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},e.prototype.isEqual=function(e){return null!==e&&0===O.comparator(this.path,e.path)},e.prototype.toString=function(){return this.path.toString()},e.comparator=function(e,t){return O.comparator(e.path,t.path)},e.isDocumentKey=function(e){return e.length%2==0},e.fromSegments=function(t){return new e(new O(t.slice()))},e}();function H(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?F(e)?4:10:m()}function z(e,t){var n=H(e);if(n!==H(t))return!1;switch(n){case 0:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return B(e).isEqual(B(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;var n=M(e.timestampValue),r=M(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return j(e.bytesValue).isEqual(j(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return U(e.geoPointValue.latitude)===U(t.geoPointValue.latitude)&&U(e.geoPointValue.longitude)===U(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return U(e.integerValue)===U(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){var n=U(e.doubleValue),r=U(t.doubleValue);return n===r?G(n)===G(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return w(e.arrayValue.values||[],t.arrayValue.values||[],z);case 10:return function(e,t){var n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(R(n)!==R(r))return!1;for(var i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!z(n[i],r[i])))return!1;return!0}(e,t);default:return m()}}function Y(e,t){return void 0!==(e.values||[]).find((function(e){return z(e,t)}))}function Q(e,t){var n=H(e),r=H(t);if(n!==r)return E(n,r);switch(n){case 0:return 0;case 1:return E(e.booleanValue,t.booleanValue);case 2:return function(e,t){var n=U(e.integerValue||e.doubleValue),r=U(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return X(e.timestampValue,t.timestampValue);case 4:return X(B(e),B(t));case 5:return E(e.stringValue,t.stringValue);case 6:return function(e,t){var n=j(e),r=j(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){for(var n=e.split("/"),r=t.split("/"),i=0;i<n.length&&i<r.length;i++){var o=E(n[i],r[i]);if(0!==o)return o}return E(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){var n=E(U(e.latitude),U(t.latitude));return 0!==n?n:E(U(e.longitude),U(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){for(var n=e.values||[],r=t.values||[],i=0;i<n.length&&i<r.length;++i){var o=Q(n[i],r[i]);if(o)return o}return E(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n=e.fields||{},r=Object.keys(n),i=t.fields||{},o=Object.keys(i);r.sort(),o.sort();for(var a=0;a<r.length&&a<o.length;++a){var s=E(r[a],o[a]);if(0!==s)return s;var c=Q(n[r[a]],i[o[a]]);if(0!==c)return c}return E(r.length,o.length)}(e.mapValue,t.mapValue);default:throw m()}}function X(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return E(e,t);var n=M(e),r=M(t),i=E(n.seconds,r.seconds);return 0!==i?i:E(n.nanos,r.nanos)}function J(e){return $(e)}function $(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){var t=M(e);return"time("+t.seconds+","+t.nanos+")"}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?j(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,K.fromName(n).toString()):"geoPointValue"in e?"geo("+(t=e.geoPointValue).latitude+","+t.longitude+")":"arrayValue"in e?function(e){for(var t="[",n=!0,r=0,i=e.values||[];r<i.length;r++)n?n=!1:t+=",",t+=$(i[r]);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){for(var t="{",n=!0,r=0,i=Object.keys(e.fields||{}).sort();r<i.length;r++){var o=i[r];n?n=!1:t+=",",t+=o+":"+$(e.fields[o])}return t+"}"}(e.mapValue):m();var t,n}function Z(e,t){return{referenceValue:"projects/"+e.projectId+"/databases/"+e.database+"/documents/"+t.path.canonicalString()}}function ee(e){return!!e&&"integerValue"in e}function te(e){return!!e&&"arrayValue"in e}function ne(e){return!!e&&"nullValue"in e}function re(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function ie(e){return!!e&&"mapValue"in e}var oe=function(){function e(e){this.overlayMap=new Map,this.partialValue=e}return e.empty=function(){return new e({mapValue:{}})},e.prototype.field=function(t){return e.extractNestedValue(this.buildProto(),t)},e.prototype.toProto=function(){return this.field(P.emptyPath())},e.prototype.set=function(e,t){this.setOverlay(e,t)},e.prototype.setAll=function(e){var t=this;e.forEach((function(e,n){e?t.set(n,e):t.delete(n)}))},e.prototype.delete=function(e){this.setOverlay(e,null)},e.prototype.isEqual=function(e){return z(this.buildProto(),e.buildProto())},e.prototype.setOverlay=function(e,t){for(var n=this.overlayMap,r=0;r<e.length-1;++r){var i=e.get(r),o=n.get(i);o instanceof Map?n=o:o&&10===H(o)?(o=new Map(Object.entries(o.mapValue.fields||{})),n.set(i,o),n=o):(o=new Map,n.set(i,o),n=o)}n.set(e.lastSegment(),t)},e.prototype.applyOverlay=function(t,n){var r=this,i=!1,o=e.extractNestedValue(this.partialValue,t),a=ie(o)?Object.assign({},o.mapValue.fields):{};return n.forEach((function(e,n){if(e instanceof Map){var o=r.applyOverlay(t.child(n),e);null!=o&&(a[n]=o,i=!0)}else null!==e?(a[n]=e,i=!0):a.hasOwnProperty(n)&&(delete a[n],i=!0)})),i?{mapValue:{fields:a}}:null},e.prototype.buildProto=function(){var e=this.applyOverlay(P.emptyPath(),this.overlayMap);return null!=e&&(this.partialValue=e,this.overlayMap.clear()),this.partialValue},e.extractNestedValue=function(e,t){if(t.isEmpty())return e;for(var n=e,r=0;r<t.length-1;++r){if(!n.mapValue.fields)return null;if(!ie(n=n.mapValue.fields[t.get(r)]))return null}return(n=(n.mapValue.fields||{})[t.lastSegment()])||null},e.prototype.clone=function(){return new e(this.buildProto())},e}();function ae(e){var t=[];return A(e.fields||{},(function(e,n){var r=new P([e]);if(ie(n)){var i=ae(n.mapValue).fields;if(0===i.length)t.push(r);else for(var o=0,a=i;o<a.length;o++){var s=a[o];t.push(r.child(s))}}else t.push(r)})),new D(t)}var se=function(){function e(e,t,n,r,i){this.key=e,this.documentType=t,this.version=n,this.data=r,this.documentState=i}return e.newInvalidDocument=function(t){return new e(t,0,I.min(),oe.empty(),0)},e.newFoundDocument=function(t,n,r){return new e(t,1,n,r,0)},e.newNoDocument=function(t,n){return new e(t,2,n,oe.empty(),0)},e.newUnknownDocument=function(t,n){return new e(t,3,n,oe.empty(),2)},e.prototype.convertToFoundDocument=function(e,t){return this.version=e,this.documentType=1,this.data=t,this.documentState=0,this},e.prototype.convertToNoDocument=function(e){return this.version=e,this.documentType=2,this.data=oe.empty(),this.documentState=0,this},e.prototype.convertToUnknownDocument=function(e){return this.version=e,this.documentType=3,this.data=oe.empty(),this.documentState=2,this},e.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},e.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(e.prototype,"hasLocalMutations",{get:function(){return 1===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasCommittedMutations",{get:function(){return 2===this.documentState},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),e.prototype.isValidDocument=function(){return 0!==this.documentType},e.prototype.isFoundDocument=function(){return 1===this.documentType},e.prototype.isNoDocument=function(){return 2===this.documentType},e.prototype.isUnknownDocument=function(){return 3===this.documentType},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)},e.prototype.clone=function(){return new e(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},e.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.toProto())+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},e}(),ce=function(e,t,n,r,i,o,a){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=o,this.endAt=a,this.h=null};function ue(e,t,n,r,i,o,a){return void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),new ce(e,t,n,r,i,o,a)}function le(e){var t=y(e);if(null===t.h){var n=t.path.canonicalString();null!==t.collectionGroup&&(n+="|cg:"+t.collectionGroup),n+="|f:",n+=t.filters.map((function(e){return function(e){return e.field.canonicalString()+e.op.toString()+J(e.value)}(e)})).join(","),n+="|ob:",n+=t.orderBy.map((function(e){return function(e){return e.field.canonicalString()+e.dir}(e)})).join(","),W(t.limit)||(n+="|l:",n+=t.limit),t.startAt&&(n+="|lb:",n+=Te(t.startAt)),t.endAt&&(n+="|ub:",n+=Te(t.endAt)),t.h=n}return t.h}function de(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(var n=0;n<e.orderBy.length;n++)if(!Ie(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(var r=0;r<e.filters.length;r++)if(i=e.filters[r],o=t.filters[r],i.op!==o.op||!i.field.isEqual(o.field)||!z(i.value,o.value))return!1;var i,o;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ae(e.startAt,t.startAt)&&Ae(e.endAt,t.endAt)}function fe(e){return K.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}var he=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).field=t,i.op=n,i.value=r,i}return Object(a.b)(t,e),t.create=function(e,n,r){return e.isKeyField()?"in"===n||"not-in"===n?this.l(e,n,r):new pe(e,n,r):"array-contains"===n?new ye(e,r):"in"===n?new _e(e,r):"not-in"===n?new be(e,r):"array-contains-any"===n?new Ee(e,r):new t(e,n,r)},t.l=function(e,t,n){return"in"===t?new ve(e,n):new me(e,n)},t.prototype.matches=function(e){var t=e.data.field(this.field);return"!="===this.op?null!==t&&this.m(Q(t,this.value)):null!==t&&H(this.value)===H(t)&&this.m(Q(t,this.value))},t.prototype.m=function(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return m()}},t.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},t}((function(){})),pe=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,r)||this).key=K.fromName(r.referenceValue),i}return Object(a.b)(t,e),t.prototype.matches=function(e){var t=K.comparator(e.key,this.key);return this.m(t)},t}(he),ve=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"in",n)||this).keys=ge("in",n),r}return Object(a.b)(t,e),t.prototype.matches=function(e){return this.keys.some((function(t){return t.isEqual(e.key)}))},t}(he),me=function(e){function t(t,n){var r=this;return(r=e.call(this,t,"not-in",n)||this).keys=ge("not-in",n),r}return Object(a.b)(t,e),t.prototype.matches=function(e){return!this.keys.some((function(t){return t.isEqual(e.key)}))},t}(he);function ge(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((function(e){return K.fromName(e.referenceValue)}))}var ye=function(e){function t(t,n){return e.call(this,t,"array-contains",n)||this}return Object(a.b)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return te(t)&&Y(t.arrayValue,this.value)},t}(he),_e=function(e){function t(t,n){return e.call(this,t,"in",n)||this}return Object(a.b)(t,e),t.prototype.matches=function(e){var t=e.data.field(this.field);return null!==t&&Y(this.value.arrayValue,t)},t}(he),be=function(e){function t(t,n){return e.call(this,t,"not-in",n)||this}return Object(a.b)(t,e),t.prototype.matches=function(e){if(Y(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var t=e.data.field(this.field);return null!==t&&!Y(this.value.arrayValue,t)},t}(he),Ee=function(e){function t(t,n){return e.call(this,t,"array-contains-any",n)||this}return Object(a.b)(t,e),t.prototype.matches=function(e){var t=this,n=e.data.field(this.field);return!(!te(n)||!n.arrayValue.values)&&n.arrayValue.values.some((function(e){return Y(t.value.arrayValue,e)}))},t}(he),we=function(e,t){this.position=e,this.before=t};function Te(e){return(e.before?"b":"a")+":"+e.position.map((function(e){return J(e)})).join(",")}var Se=function(e,t){void 0===t&&(t="asc"),this.field=e,this.dir=t};function Ie(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}function Re(e,t,n){for(var r=0,i=0;i<e.position.length;i++){var o=t[i],a=e.position[i];if(r=o.field.isKeyField()?K.comparator(K.fromName(a.referenceValue),n.key):Q(a,n.data.field(o.field)),"desc"===o.dir&&(r*=-1),0!==r)break}return e.before?r<=0:r<0}function Ae(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.before!==t.before||e.position.length!==t.position.length)return!1;for(var n=0;n<e.position.length;n++)if(!z(e.position[n],t.position[n]))return!1;return!0}var Ce=function(e,t,n,r,i,o,a,s){void 0===t&&(t=null),void 0===n&&(n=[]),void 0===r&&(r=[]),void 0===i&&(i=null),void 0===o&&(o="F"),void 0===a&&(a=null),void 0===s&&(s=null),this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=o,this.startAt=a,this.endAt=s,this.p=null,this.T=null,this.startAt,this.endAt};function ke(e,t,n,r,i,o,a,s){return new Ce(e,t,n,r,i,o,a,s)}function Oe(e){return new Ce(e)}function Ne(e){return!W(e.limit)&&"F"===e.limitType}function Pe(e){return!W(e.limit)&&"L"===e.limitType}function De(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function xe(e){for(var t=0,n=e.filters;t<n.length;t++){var r=n[t];if(r.g())return r.field}return null}function Le(e){return null!==e.collectionGroup}function Me(e){var t=y(e);if(null===t.p){t.p=[];var n=xe(t),r=De(t);if(null!==n&&null===r)n.isKeyField()||t.p.push(new Se(n)),t.p.push(new Se(P.keyField(),"asc"));else{for(var i=!1,o=0,a=t.explicitOrderBy;o<a.length;o++){var s=a[o];t.p.push(s),s.field.isKeyField()&&(i=!0)}if(!i){var c=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.p.push(new Se(P.keyField(),c))}}}return t.p}function Ue(e){var t=y(e);if(!t.T)if("F"===t.limitType)t.T=ue(t.path,t.collectionGroup,Me(t),t.filters,t.limit,t.startAt,t.endAt);else{for(var n=[],r=0,i=Me(t);r<i.length;r++){var o=i[r],a="desc"===o.dir?"asc":"desc";n.push(new Se(o.field,a))}var s=t.endAt?new we(t.endAt.position,!t.endAt.before):null,c=t.startAt?new we(t.startAt.position,!t.startAt.before):null;t.T=ue(t.path,t.collectionGroup,n,t.filters,t.limit,s,c)}return t.T}function je(e,t,n){return new Ce(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Fe(e,t){return de(Ue(e),Ue(t))&&e.limitType===t.limitType}function Ve(e){return le(Ue(e))+"|lt:"+e.limitType}function Be(e){return"Query(target="+function(e){var t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=", filters: ["+e.filters.map((function(e){return(t=e).field.canonicalString()+" "+t.op+" "+J(t.value);var t})).join(", ")+"]"),W(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=", orderBy: ["+e.orderBy.map((function(e){return function(e){return e.field.canonicalString()+" ("+e.dir+")"}(e)})).join(", ")+"]"),e.startAt&&(t+=", startAt: "+Te(e.startAt)),e.endAt&&(t+=", endAt: "+Te(e.endAt)),"Target("+t+")"}(Ue(e))+"; limitType="+e.limitType+")"}function We(e,t){return t.isFoundDocument()&&function(e,t){var n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):K.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(var n=0,r=e.explicitOrderBy;n<r.length;n++){var i=r[n];if(!i.field.isKeyField()&&null===t.data.field(i.field))return!1}return!0}(e,t)&&function(e,t){for(var n=0,r=e.filters;n<r.length;n++)if(!r[n].matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!Re(e.startAt,Me(e),t))&&(!e.endAt||!Re(e.endAt,Me(e),t))}(e,t)}function Ge(e){return function(t,n){for(var r=!1,i=0,o=Me(e);i<o.length;i++){var a=o[i],s=qe(a,t,n);if(0!==s)return s;r=r||a.field.isKeyField()}return 0}}function qe(e,t,n){var r=e.field.isKeyField()?K.comparator(t.key,n.key):function(e,t,n){var r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?Q(r,i):m()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return m()}}function Ke(e,t){if(e.I){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:G(t)?"-0":t}}function He(e){return{integerValue:""+e}}function ze(e,t){return q(t)?He(t):Ke(e,t)}var Ye=function(){this._=void 0};function Qe(e,t,n){return e instanceof $e?function(e,t){var n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Ze?et(e,t):e instanceof tt?nt(e,t):function(e,t){var n=Je(e,t),r=it(n)+it(e.A);return ee(n)&&ee(e.A)?He(r):Ke(e.R,r)}(e,t)}function Xe(e,t,n){return e instanceof Ze?et(e,t):e instanceof tt?nt(e,t):n}function Je(e,t){return e instanceof rt?ee(n=t)||function(e){return!!e&&"doubleValue"in e}(n)?t:{integerValue:0}:null;var n}var $e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t}(Ye),Ze=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(a.b)(t,e),t}(Ye);function et(e,t){for(var n=ot(t),r=function(e){n.some((function(t){return z(t,e)}))||n.push(e)},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var tt=function(e){function t(t){var n=this;return(n=e.call(this)||this).elements=t,n}return Object(a.b)(t,e),t}(Ye);function nt(e,t){for(var n=ot(t),r=function(e){n=n.filter((function(t){return!z(t,e)}))},i=0,o=e.elements;i<o.length;i++)r(o[i]);return{arrayValue:{values:n}}}var rt=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).R=t,r.A=n,r}return Object(a.b)(t,e),t}(Ye);function it(e){return U(e.integerValue||e.doubleValue)}function ot(e){return te(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}var at=function(e,t){this.field=e,this.transform=t},st=function(e,t){this.version=e,this.transformResults=t},ct=function(){function e(e,t){this.updateTime=e,this.exists=t}return e.none=function(){return new e},e.exists=function(t){return new e(void 0,t)},e.updateTime=function(t){return new e(t)},Object.defineProperty(e.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},e}();function ut(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}var lt=function(){};function dt(e,t,n){e instanceof mt?function(e,t,n){var r=e.value.clone(),i=_t(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof gt?function(e,t,n){if(ut(e.precondition,t)){var r=_t(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(yt(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}else t.convertToUnknownDocument(n.version)}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ft(e,t,n){e instanceof mt?function(e,t,n){if(ut(e.precondition,t)){var r=e.value.clone(),i=bt(e.fieldTransforms,n,t);r.setAll(i),t.convertToFoundDocument(vt(t),r).setHasLocalMutations()}}(e,t,n):e instanceof gt?function(e,t,n){if(ut(e.precondition,t)){var r=bt(e.fieldTransforms,n,t),i=t.data;i.setAll(yt(e)),i.setAll(r),t.convertToFoundDocument(vt(t),i).setHasLocalMutations()}}(e,t,n):function(e,t){ut(e.precondition,t)&&t.convertToNoDocument(I.min())}(e,t)}function ht(e,t){for(var n=null,r=0,i=e.fieldTransforms;r<i.length;r++){var o=i[r],a=t.data.field(o.field),s=Je(o.transform,a||null);null!=s&&(null==n&&(n=oe.empty()),n.set(o.field,s))}return n||null}function pt(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&w(e,t,(function(e,t){return function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Ze&&t instanceof Ze||e instanceof tt&&t instanceof tt?w(e.elements,t.elements,z):e instanceof rt&&t instanceof rt?z(e.A,t.A):e instanceof $e&&t instanceof $e}(e.transform,t.transform)}(e,t)}))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}function vt(e){return e.isFoundDocument()?e.version:I.min()}var mt=function(e){function t(t,n,r,i){void 0===i&&(i=[]);var o=this;return(o=e.call(this)||this).key=t,o.value=n,o.precondition=r,o.fieldTransforms=i,o.type=0,o}return Object(a.b)(t,e),t}(lt),gt=function(e){function t(t,n,r,i,o){void 0===o&&(o=[]);var a=this;return(a=e.call(this)||this).key=t,a.data=n,a.fieldMask=r,a.precondition=i,a.fieldTransforms=o,a.type=1,a}return Object(a.b)(t,e),t}(lt);function yt(e){var t=new Map;return e.fieldMask.fields.forEach((function(n){if(!n.isEmpty()){var r=e.data.field(n);t.set(n,r)}})),t}function _t(e,t,n){var r=new Map;g(e.length===n.length);for(var i=0;i<n.length;i++){var o=e[i],a=o.transform,s=t.data.field(o.field);r.set(o.field,Xe(a,s,n[i]))}return r}function bt(e,t,n){for(var r=new Map,i=0,o=e;i<o.length;i++){var a=o[i],s=a.transform,c=n.data.field(a.field);r.set(a.field,Qe(s,c,t))}return r}var Et,wt,Tt=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=2,r.fieldTransforms=[],r}return Object(a.b)(t,e),t}(lt),St=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).key=t,r.precondition=n,r.type=3,r.fieldTransforms=[],r}return Object(a.b)(t,e),t}(lt),It=function(e){this.count=e};function Rt(e){switch(e){case c.OK:return m();case c.CANCELLED:case c.UNKNOWN:case c.DEADLINE_EXCEEDED:case c.RESOURCE_EXHAUSTED:case c.INTERNAL:case c.UNAVAILABLE:case c.UNAUTHENTICATED:return!1;case c.INVALID_ARGUMENT:case c.NOT_FOUND:case c.ALREADY_EXISTS:case c.PERMISSION_DENIED:case c.FAILED_PRECONDITION:case c.ABORTED:case c.OUT_OF_RANGE:case c.UNIMPLEMENTED:case c.DATA_LOSS:return!0;default:return m()}}function At(e){if(void 0===e)return h("GRPC error has no .code"),c.UNKNOWN;switch(e){case Et.OK:return c.OK;case Et.CANCELLED:return c.CANCELLED;case Et.UNKNOWN:return c.UNKNOWN;case Et.DEADLINE_EXCEEDED:return c.DEADLINE_EXCEEDED;case Et.RESOURCE_EXHAUSTED:return c.RESOURCE_EXHAUSTED;case Et.INTERNAL:return c.INTERNAL;case Et.UNAVAILABLE:return c.UNAVAILABLE;case Et.UNAUTHENTICATED:return c.UNAUTHENTICATED;case Et.INVALID_ARGUMENT:return c.INVALID_ARGUMENT;case Et.NOT_FOUND:return c.NOT_FOUND;case Et.ALREADY_EXISTS:return c.ALREADY_EXISTS;case Et.PERMISSION_DENIED:return c.PERMISSION_DENIED;case Et.FAILED_PRECONDITION:return c.FAILED_PRECONDITION;case Et.ABORTED:return c.ABORTED;case Et.OUT_OF_RANGE:return c.OUT_OF_RANGE;case Et.UNIMPLEMENTED:return c.UNIMPLEMENTED;case Et.DATA_LOSS:return c.DATA_LOSS;default:return m()}}(wt=Et||(Et={}))[wt.OK=0]="OK",wt[wt.CANCELLED=1]="CANCELLED",wt[wt.UNKNOWN=2]="UNKNOWN",wt[wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",wt[wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",wt[wt.NOT_FOUND=5]="NOT_FOUND",wt[wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",wt[wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",wt[wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",wt[wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",wt[wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",wt[wt.ABORTED=10]="ABORTED",wt[wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",wt[wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",wt[wt.INTERNAL=13]="INTERNAL",wt[wt.UNAVAILABLE=14]="UNAVAILABLE",wt[wt.DATA_LOSS=15]="DATA_LOSS";var Ct=function(){function e(e,t){this.comparator=e,this.root=t||Ot.EMPTY}return e.prototype.insert=function(t,n){return new e(this.comparator,this.root.insert(t,n,this.comparator).copy(null,null,Ot.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Ot.BLACK,null,null))},e.prototype.get=function(e){for(var t=this.root;!t.isEmpty();){var n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null},e.prototype.indexOf=function(e){for(var t=0,n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1},e.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(e.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),e.prototype.minKey=function(){return this.root.minKey()},e.prototype.maxKey=function(){return this.root.maxKey()},e.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},e.prototype.forEach=function(e){this.inorderTraversal((function(t,n){return e(t,n),!1}))},e.prototype.toString=function(){var e=[];return this.inorderTraversal((function(t,n){return e.push(t+":"+n),!1})),"{"+e.join(", ")+"}"},e.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},e.prototype.getIterator=function(){return new kt(this.root,null,this.comparator,!1)},e.prototype.getIteratorFrom=function(e){return new kt(this.root,e,this.comparator,!1)},e.prototype.getReverseIterator=function(){return new kt(this.root,null,this.comparator,!0)},e.prototype.getReverseIteratorFrom=function(e){return new kt(this.root,e,this.comparator,!0)},e}(),kt=function(){function e(e,t,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!e.isEmpty();)if(i=t?n(e.key,t):1,r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return e.prototype.getNext=function(){var e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t},e.prototype.hasNext=function(){return this.nodeStack.length>0},e.prototype.peek=function(){if(0===this.nodeStack.length)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},e}(),Ot=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:e.EMPTY,this.right=null!=o?o:e.EMPTY,this.size=this.left.size+1+this.right.size}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},e.prototype.minKey=function(){return this.min().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()},e.prototype.removeMin=function(){if(this.left.isEmpty())return e.EMPTY;var t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),(t=t.copy(null,null,null,t.left.removeMin(),null)).fixUp()},e.prototype.remove=function(t,n){var r,i=this;if(n(t,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(t,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(t,i.key)){if(i.right.isEmpty())return e.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(t,n))}return i.fixUp()},e.prototype.isRed=function(){return this.color},e.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},e.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},e.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},e.prototype.rotateLeft=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},e.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw m();if(this.right.isRed())throw m();var e=this.left.check();if(e!==this.right.check())throw m();return e+(this.isRed()?0:1)},e}();Ot.EMPTY=null,Ot.RED=!0,Ot.BLACK=!1,Ot.EMPTY=new(function(){function e(){this.size=0}return Object.defineProperty(e.prototype,"key",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"left",{get:function(){throw m()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){throw m()},enumerable:!1,configurable:!0}),e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Ot(e,t)},e.prototype.remove=function(e,t){return this},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.isRed=function(){return!1},e.prototype.checkMaxDepth=function(){return!0},e.prototype.check=function(){return 0},e}());var Nt=function(){function e(e){this.comparator=e,this.data=new Ct(this.comparator)}return e.prototype.has=function(e){return null!==this.data.get(e)},e.prototype.first=function(){return this.data.minKey()},e.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(e.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),e.prototype.indexOf=function(e){return this.data.indexOf(e)},e.prototype.forEach=function(e){this.data.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.forEachInRange=function(e,t){for(var n=this.data.getIteratorFrom(e[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}},e.prototype.forEachWhile=function(e,t){var n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return},e.prototype.firstAfterOrEqual=function(e){var t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null},e.prototype.getIterator=function(){return new Pt(this.data.getIterator())},e.prototype.getIteratorFrom=function(e){return new Pt(this.data.getIteratorFrom(e))},e.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},e.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},e.prototype.isEmpty=function(){return this.data.isEmpty()},e.prototype.unionWith=function(e){var t=this;return t.size<e.size&&(t=e,e=this),e.forEach((function(e){t=t.add(e)})),t},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.data.getIterator(),r=t.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},e.prototype.toArray=function(){var e=[];return this.forEach((function(t){e.push(t)})),e},e.prototype.toString=function(){var e=[];return this.forEach((function(t){return e.push(t)})),"SortedSet("+e.toString()+")"},e.prototype.copy=function(t){var n=new e(this.comparator);return n.data=t,n},e}(),Pt=function(){function e(e){this.iter=e}return e.prototype.getNext=function(){return this.iter.getNext().key},e.prototype.hasNext=function(){return this.iter.hasNext()},e}(),Dt=new Ct(K.comparator);function xt(){return Dt}var Lt=new Ct(K.comparator);function Mt(){return Lt}var Ut=new Ct(K.comparator);function jt(){return Ut}var Ft=new Nt(K.comparator);function Vt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=Ft,r=0,i=e;r<i.length;r++){var o=i[r];n=n.add(o)}return n}var Bt=new Nt(E);function Wt(){return Bt}var Gt=function(){function e(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}return e.createSynthesizedRemoteEventForCurrentChange=function(t,n){var r=new Map;return r.set(t,qt.createSynthesizedTargetChangeForCurrentChange(t,n)),new e(I.min(),r,Wt(),xt(),Vt())},e}(),qt=function(){function e(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}return e.createSynthesizedTargetChangeForCurrentChange=function(t,n){return new e(x.EMPTY_BYTE_STRING,n,Vt(),Vt(),Vt())},e}(),Kt=function(e,t,n,r){this.v=e,this.removedTargetIds=t,this.key=n,this.P=r},Ht=function(e,t){this.targetId=e,this.V=t},zt=function(e,t,n,r){void 0===n&&(n=x.EMPTY_BYTE_STRING),void 0===r&&(r=null),this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r},Yt=function(){function e(){this.S=0,this.D=Jt(),this.C=x.EMPTY_BYTE_STRING,this.N=!1,this.F=!0}return Object.defineProperty(e.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"k",{get:function(){return 0!==this.S},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"O",{get:function(){return this.F},enumerable:!1,configurable:!0}),e.prototype.$=function(e){e.approximateByteSize()>0&&(this.F=!0,this.C=e)},e.prototype.M=function(){var e=Vt(),t=Vt(),n=Vt();return this.D.forEach((function(r,i){switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:m()}})),new qt(this.C,this.N,e,t,n)},e.prototype.L=function(){this.F=!1,this.D=Jt()},e.prototype.B=function(e,t){this.F=!0,this.D=this.D.insert(e,t)},e.prototype.q=function(e){this.F=!0,this.D=this.D.remove(e)},e.prototype.U=function(){this.S+=1},e.prototype.K=function(){this.S-=1},e.prototype.j=function(){this.F=!0,this.N=!0},e}(),Qt=function(){function e(e){this.W=e,this.G=new Map,this.H=xt(),this.J=Xt(),this.Y=new Nt(E)}return e.prototype.X=function(e){for(var t=0,n=e.v;t<n.length;t++){var r=n[t];e.P&&e.P.isFoundDocument()?this.Z(r,e.P):this.tt(r,e.key,e.P)}for(var i=0,o=e.removedTargetIds;i<o.length;i++)r=o[i],this.tt(r,e.key,e.P)},e.prototype.et=function(e){var t=this;this.forEachTarget(e,(function(n){var r=t.nt(n);switch(e.state){case 0:t.st(n)&&r.$(e.resumeToken);break;case 1:r.K(),r.k||r.L(),r.$(e.resumeToken);break;case 2:r.K(),r.k||t.removeTarget(n);break;case 3:t.st(n)&&(r.j(),r.$(e.resumeToken));break;case 4:t.st(n)&&(t.it(n),r.$(e.resumeToken));break;default:m()}}))},e.prototype.forEachTarget=function(e,t){var n=this;e.targetIds.length>0?e.targetIds.forEach(t):this.G.forEach((function(e,r){n.st(r)&&t(r)}))},e.prototype.rt=function(e){var t=e.targetId,n=e.V.count,r=this.ot(t);if(r){var i=r.target;if(fe(i))if(0===n){var o=new K(i.path);this.tt(t,o,se.newNoDocument(o,I.min()))}else g(1===n);else this.ct(t)!==n&&(this.it(t),this.Y=this.Y.add(t))}},e.prototype.ut=function(e){var t=this,n=new Map;this.G.forEach((function(r,i){var o=t.ot(i);if(o){if(r.current&&fe(o.target)){var a=new K(o.target.path);null!==t.H.get(a)||t.at(i,a)||t.tt(i,a,se.newNoDocument(a,e))}r.O&&(n.set(i,r.M()),r.L())}}));var r=Vt();this.J.forEach((function(e,n){var i=!0;n.forEachWhile((function(e){var n=t.ot(e);return!n||2===n.purpose||(i=!1,!1)})),i&&(r=r.add(e))}));var i=new Gt(e,n,this.Y,this.H,r);return this.H=xt(),this.J=Xt(),this.Y=new Nt(E),i},e.prototype.Z=function(e,t){if(this.st(e)){var n=this.at(e,t.key)?2:0;this.nt(e).B(t.key,n),this.H=this.H.insert(t.key,t),this.J=this.J.insert(t.key,this.ht(t.key).add(e))}},e.prototype.tt=function(e,t,n){if(this.st(e)){var r=this.nt(e);this.at(e,t)?r.B(t,1):r.q(t),this.J=this.J.insert(t,this.ht(t).delete(e)),n&&(this.H=this.H.insert(t,n))}},e.prototype.removeTarget=function(e){this.G.delete(e)},e.prototype.ct=function(e){var t=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size},e.prototype.U=function(e){this.nt(e).U()},e.prototype.nt=function(e){var t=this.G.get(e);return t||(t=new Yt,this.G.set(e,t)),t},e.prototype.ht=function(e){var t=this.J.get(e);return t||(t=new Nt(E),this.J=this.J.insert(e,t)),t},e.prototype.st=function(e){var t=null!==this.ot(e);return t||f("WatchChangeAggregator","Detected inactive target",e),t},e.prototype.ot=function(e){var t=this.G.get(e);return t&&t.k?null:this.W.lt(e)},e.prototype.it=function(e){var t=this;this.G.set(e,new Yt),this.W.getRemoteKeysForTarget(e).forEach((function(n){t.tt(e,n,null)}))},e.prototype.at=function(e,t){return this.W.getRemoteKeysForTarget(e).has(t)},e}();function Xt(){return new Ct(K.comparator)}function Jt(){return new Ct(K.comparator)}var $t={asc:"ASCENDING",desc:"DESCENDING"},Zt={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},en=function(e,t){this.databaseId=e,this.I=t};function tn(e,t){return e.I?new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+t.nanoseconds).slice(-9)+"Z":{seconds:""+t.seconds,nanos:t.nanoseconds}}function nn(e,t){return e.I?t.toBase64():t.toUint8Array()}function rn(e,t){return tn(e,t.toTimestamp())}function on(e){return g(!!e),I.fromTimestamp(function(e){var t=M(e);return new S(t.seconds,t.nanos)}(e))}function an(e,t){return function(e){return new O(["projects",e.projectId,"databases",e.database])}(e).child("documents").child(t).canonicalString()}function sn(e){var t=O.fromString(e);return g(Nn(t)),t}function cn(e,t){return an(e.databaseId,t.path)}function un(e,t){var n=sn(t);if(n.get(1)!==e.databaseId.projectId)throw new u(c.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new u(c.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new K(hn(n))}function ln(e,t){return an(e.databaseId,t)}function dn(e){var t=sn(e);return 4===t.length?O.emptyPath():hn(t)}function fn(e){return new O(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function hn(e){return g(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function pn(e,t,n){return{name:cn(e,t),fields:n.toProto().mapValue.fields}}function vn(e,t,n){var r=un(e,t.name),i=on(t.updateTime),o=new oe({mapValue:{fields:t.fields}}),a=se.newFoundDocument(r,i,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function mn(e,t){var n;if(t instanceof mt)n={update:pn(e,t.key,t.value)};else if(t instanceof Tt)n={delete:cn(e,t.key)};else if(t instanceof gt)n={update:pn(e,t.key,t.data),updateMask:On(t.fieldMask)};else{if(!(t instanceof St))return m();n={verify:cn(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((function(e){return function(e,t){var n=t.transform;if(n instanceof $e)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Ze)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof tt)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof rt)return{fieldPath:t.field.canonicalString(),increment:n.A};throw m()}(0,e)}))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:rn(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:m()}(e,t.precondition)),n}function gn(e,t){var n=t.currentDocument?function(e){return void 0!==e.updateTime?ct.updateTime(on(e.updateTime)):void 0!==e.exists?ct.exists(e.exists):ct.none()}(t.currentDocument):ct.none(),r=t.updateTransforms?t.updateTransforms.map((function(t){return function(e,t){var n=null;if("setToServerValue"in t)g("REQUEST_TIME"===t.setToServerValue),n=new $e;else if("appendMissingElements"in t){var r=t.appendMissingElements.values||[];n=new Ze(r)}else if("removeAllFromArray"in t){var i=t.removeAllFromArray.values||[];n=new tt(i)}else"increment"in t?n=new rt(e,t.increment):m();var o=P.fromServerFormat(t.fieldPath);return new at(o,n)}(e,t)})):[];if(t.update){t.update.name;var i=un(e,t.update.name),o=new oe({mapValue:{fields:t.update.fields}});if(t.updateMask){var a=function(e){var t=e.fieldPaths||[];return new D(t.map((function(e){return P.fromServerFormat(e)})))}(t.updateMask);return new gt(i,o,a,n,r)}return new mt(i,o,n,r)}if(t.delete){var s=un(e,t.delete);return new Tt(s,n)}if(t.verify){var c=un(e,t.verify);return new St(c,n)}return m()}function yn(e,t){return{documents:[ln(e,t.path)]}}function _n(e,t){var n={structuredQuery:{}},r=t.path;null!==t.collectionGroup?(n.parent=ln(e,r),n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(n.parent=ln(e,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var i=function(e){if(0!==e.length){var t=e.map((function(e){return function(e){if("=="===e.op){if(re(e.value))return{unaryFilter:{field:Rn(e.field),op:"IS_NAN"}};if(ne(e.value))return{unaryFilter:{field:Rn(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(re(e.value))return{unaryFilter:{field:Rn(e.field),op:"IS_NOT_NAN"}};if(ne(e.value))return{unaryFilter:{field:Rn(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rn(e.field),op:In(e.op),value:e.value}}}(e)}));return 1===t.length?t[0]:{compositeFilter:{op:"AND",filters:t}}}}(t.filters);i&&(n.structuredQuery.where=i);var o=function(e){if(0!==e.length)return e.map((function(e){return function(e){return{field:Rn(e.field),direction:Sn(e.dir)}}(e)}))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);var a=function(e,t){return e.I||W(t)?t:{value:t}}(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=wn(t.startAt)),t.endAt&&(n.structuredQuery.endAt=wn(t.endAt)),n}function bn(e){var t=dn(e.parent),n=e.structuredQuery,r=n.from?n.from.length:0,i=null;if(r>0){g(1===r);var o=n.from[0];o.allDescendants?i=o.collectionId:t=t.child(o.collectionId)}var a=[];n.where&&(a=En(n.where));var s=[];n.orderBy&&(s=n.orderBy.map((function(e){return function(e){return new Se(An(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)})));var c=null;n.limit&&(c=function(e){var t;return W(t="object"==typeof e?e.value:e)?null:t}(n.limit));var u=null;n.startAt&&(u=Tn(n.startAt));var l=null;return n.endAt&&(l=Tn(n.endAt)),ke(t,i,s,a,c,"F",u,l)}function En(e){return e?void 0!==e.unaryFilter?[kn(e)]:void 0!==e.fieldFilter?[Cn(e)]:void 0!==e.compositeFilter?e.compositeFilter.filters.map((function(e){return En(e)})).reduce((function(e,t){return e.concat(t)})):m():[]}function wn(e){return{before:e.before,values:e.position}}function Tn(e){var t=!!e.before,n=e.values||[];return new we(n,t)}function Sn(e){return $t[e]}function In(e){return Zt[e]}function Rn(e){return{fieldPath:e.canonicalString()}}function An(e){return P.fromServerFormat(e.fieldPath)}function Cn(e){return he.create(An(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return m()}}(e.fieldFilter.op),e.fieldFilter.value)}function kn(e){switch(e.unaryFilter.op){case"IS_NAN":var t=An(e.unaryFilter.field);return he.create(t,"==",{doubleValue:NaN});case"IS_NULL":var n=An(e.unaryFilter.field);return he.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=An(e.unaryFilter.field);return he.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var i=An(e.unaryFilter.field);return he.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return m()}}function On(e){var t=[];return e.fields.forEach((function(e){return t.push(e.canonicalString())})),{fieldPaths:t}}function Nn(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}function Pn(e){for(var t="",n=0;n<e.length;n++)t.length>0&&(t=xn(t)),t=Dn(e.get(n),t);return xn(t)}function Dn(e,t){for(var n=t,r=e.length,i=0;i<r;i++){var o=e.charAt(i);switch(o){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=o}}return n}function xn(e){return e+"\x01\x01"}function Ln(e){var t=e.length;if(g(t>=2),2===t)return g("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),O.emptyPath();for(var n=t-2,r=[],i="",o=0;o<t;){var a=e.indexOf("\x01",o);switch((a<0||a>n)&&m(),e.charAt(a+1)){case"\x01":var s=e.substring(o,a),c=void 0;0===i.length?c=s:(c=i+=s,i=""),r.push(c);break;case"\x10":i+=e.substring(o,a),i+="\0";break;case"\x11":i+=e.substring(o,a+1);break;default:m()}o=a+2}return new O(r)}var Mn=function(e,t){this.seconds=e,this.nanoseconds=t},Un=function(e,t,n){this.ownerId=e,this.allowTabSynchronization=t,this.leaseTimestampMs=n};Un.store="owner",Un.key="owner";var jn=function(e,t,n){this.userId=e,this.lastAcknowledgedBatchId=t,this.lastStreamToken=n};jn.store="mutationQueues",jn.keyPath="userId";var Fn=function(e,t,n,r,i){this.userId=e,this.batchId=t,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=i};Fn.store="mutations",Fn.keyPath="batchId",Fn.userMutationsIndex="userMutationsIndex",Fn.userMutationsKeyPath=["userId","batchId"];var Vn=function(){function e(){}return e.prefixForUser=function(e){return[e]},e.prefixForPath=function(e,t){return[e,Pn(t)]},e.key=function(e,t,n){return[e,Pn(t),n]},e}();Vn.store="documentMutations",Vn.PLACEHOLDER=new Vn;var Bn=function(e,t){this.path=e,this.readTime=t},Wn=function(e,t){this.path=e,this.version=t},Gn=function(e,t,n,r,i,o){this.unknownDocument=e,this.noDocument=t,this.document=n,this.hasCommittedMutations=r,this.readTime=i,this.parentPath=o};Gn.store="remoteDocuments",Gn.readTimeIndex="readTimeIndex",Gn.readTimeIndexPath="readTime",Gn.collectionReadTimeIndex="collectionReadTimeIndex",Gn.collectionReadTimeIndexPath=["parentPath","readTime"];var qn=function(e){this.byteSize=e};qn.store="remoteDocumentGlobal",qn.key="remoteDocumentGlobalKey";var Kn=function(e,t,n,r,i,o,a){this.targetId=e,this.canonicalId=t,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.lastLimboFreeSnapshotVersion=o,this.query=a};Kn.store="targets",Kn.keyPath="targetId",Kn.queryTargetsIndexName="queryTargetsIndex",Kn.queryTargetsKeyPath=["canonicalId","targetId"];var Hn=function(e,t,n){this.targetId=e,this.path=t,this.sequenceNumber=n};Hn.store="targetDocuments",Hn.keyPath=["targetId","path"],Hn.documentTargetsIndex="documentTargetsIndex",Hn.documentTargetsKeyPath=["path","targetId"];var zn=function(e,t,n,r){this.highestTargetId=e,this.highestListenSequenceNumber=t,this.lastRemoteSnapshotVersion=n,this.targetCount=r};zn.key="targetGlobalKey",zn.store="targetGlobal";var Yn=function(e,t){this.collectionId=e,this.parent=t};Yn.store="collectionParents",Yn.keyPath=["collectionId","parent"];var Qn=function(e,t,n,r){this.clientId=e,this.updateTimeMs=t,this.networkEnabled=n,this.inForeground=r};Qn.store="clientMetadata",Qn.keyPath="clientId";var Xn=function(e,t,n){this.bundleId=e,this.createTime=t,this.version=n};Xn.store="bundles",Xn.keyPath="bundleId";var Jn=function(e,t,n){this.name=e,this.readTime=t,this.bundledQuery=n};Jn.store="namedQueries",Jn.keyPath="name";var $n=Object(a.d)(Object(a.d)([],Object(a.d)(Object(a.d)([],Object(a.d)(Object(a.d)([],Object(a.d)(Object(a.d)([],[jn.store,Fn.store,Vn.store,Gn.store,Kn.store,Un.store,zn.store,Hn.store]),[Qn.store])),[qn.store])),[Yn.store])),[Xn.store,Jn.store]),Zn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",er=function(){function e(){this.onCommittedListeners=[]}return e.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},e.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach((function(e){return e()}))},e}(),tr=function(){var e=this;this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))},nr=function(){function e(e){var t=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((function(e){t.isDone=!0,t.result=e,t.nextCallback&&t.nextCallback(e)}),(function(e){t.isDone=!0,t.error=e,t.catchCallback&&t.catchCallback(e)}))}return e.prototype.catch=function(e){return this.next(void 0,e)},e.prototype.next=function(t,n){var r=this;return this.callbackAttached&&m(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(t,this.result):new e((function(e,i){r.nextCallback=function(n){r.wrapSuccess(t,n).next(e,i)},r.catchCallback=function(t){r.wrapFailure(n,t).next(e,i)}}))},e.prototype.toPromise=function(){var e=this;return new Promise((function(t,n){e.next(t,n)}))},e.prototype.wrapUserFunction=function(t){try{var n=t();return n instanceof e?n:e.resolve(n)}catch(t){return e.reject(t)}},e.prototype.wrapSuccess=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.resolve(n)},e.prototype.wrapFailure=function(t,n){return t?this.wrapUserFunction((function(){return t(n)})):e.reject(n)},e.resolve=function(t){return new e((function(e,n){e(t)}))},e.reject=function(t){return new e((function(e,n){n(t)}))},e.waitFor=function(t){return new e((function(e,n){var r=0,i=0,o=!1;t.forEach((function(t){++r,t.next((function(){++i,o&&i===r&&e()}),(function(e){return n(e)}))})),o=!0,i===r&&e()}))},e.or=function(t){for(var n=e.resolve(!1),r=function(t){n=n.next((function(n){return n?e.resolve(n):t()}))},i=0,o=t;i<o.length;i++)r(o[i]);return n},e.forEach=function(e,t){var n=this,r=[];return e.forEach((function(e,i){r.push(t.call(n,e,i))})),this.waitFor(r)},e}(),rr=function(){function e(e,t){var n=this;this.action=e,this.transaction=t,this.aborted=!1,this.ft=new tr,this.transaction.oncomplete=function(){n.ft.resolve()},this.transaction.onabort=function(){t.error?n.ft.reject(new ar(e,t.error)):n.ft.resolve()},this.transaction.onerror=function(t){var r=dr(t.target.error);n.ft.reject(new ar(e,r))}}return e.open=function(t,n,r,i){try{return new e(n,t.transaction(i,r))}catch(t){throw new ar(n,t)}},Object.defineProperty(e.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),e.prototype.abort=function(e){e&&this.ft.reject(e),this.aborted||(f("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},e.prototype.store=function(e){var t=this.transaction.objectStore(e);return new cr(t)},e}(),ir=function(){function t(e,n,i){this.name=e,this.version=n,this.wt=i,12.2===t._t(Object(r.q)())&&h("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(e){return f("SimpleDb","Removing database:",e),ur(window.indexedDB.deleteDatabase(e)).toPromise()},t.yt=function(){if("undefined"==typeof indexedDB)return!1;if(t.gt())return!0;var e=Object(r.q)(),n=t._t(e),i=0<n&&n<10,o=t.Et(e),a=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||i||a)},t.gt=function(){var t;return"undefined"!=typeof e&&"YES"===(null===(t=Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}))||void 0===t?void 0:t.Tt)},t.It=function(e,t){return e.store(t)},t._t=function(e){var t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)},t.Et=function(e){var t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)},t.prototype.At=function(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n=this;return Object(a.c)(this,(function(r){switch(r.label){case 0:return this.db?[3,2]:(f("SimpleDb","Opening database:",this.name),t=this,[4,new Promise((function(t,r){var i=indexedDB.open(n.name,n.version);i.onsuccess=function(e){var n=e.target.result;t(n)},i.onblocked=function(){r(new ar(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=function(t){var n=t.target.error;"VersionError"===n.name?r(new u(c.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):r(new ar(e,n))},i.onupgradeneeded=function(e){f("SimpleDb",'Database "'+n.name+'" requires upgrade from version:',e.oldVersion);var t=e.target.result;n.wt.Rt(t,i.transaction,e.oldVersion,n.version).next((function(){f("SimpleDb","Database upgrade to version "+n.version+" complete")}))}}))]);case 1:t.db=r.sent(),r.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(e){return n.bt(e)}),this.db)]}}))}))},t.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(t){return e(t)})},t.prototype.runTransaction=function(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o,s,c,u;return Object(a.c)(this,(function(l){switch(l.label){case 0:i="readonly"===t,o=0,s=function(){var t,s,u,l,d;return Object(a.c)(this,(function(a){switch(a.label){case 0:++o,a.label=1;case 1:return a.trys.push([1,4,,5]),[4,c.At(e)];case 2:return c.db=a.sent(),t=rr.open(c.db,e,i?"readonly":"readwrite",n),s=r(t).catch((function(e){return t.abort(e),nr.reject(e)})).toPromise(),u={},s.catch((function(){})),[4,t.dt];case 3:return[2,(u.value=(a.sent(),s),u)];case 4:return l=a.sent(),d="FirebaseError"!==l.name&&o<3,f("SimpleDb","Transaction failed with error:",l.message,"Retrying:",d),c.close(),d?[3,5]:[2,{value:Promise.reject(l)}];case 5:return[2]}}))},c=this,l.label=1;case 1:return[5,s()];case 2:if("object"==typeof(u=l.sent()))return[2,u.value];l.label=3;case 3:return[3,1];case 4:return[2]}}))}))},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),or=function(){function e(e){this.Pt=e,this.Vt=!1,this.St=null}return Object.defineProperty(e.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cursor",{set:function(e){this.Pt=e},enumerable:!1,configurable:!0}),e.prototype.done=function(){this.Vt=!0},e.prototype.Ct=function(e){this.St=e},e.prototype.delete=function(){return ur(this.Pt.delete())},e}(),ar=function(e){function t(t,n){var r=this;return(r=e.call(this,c.UNAVAILABLE,"IndexedDB transaction '"+t+"' failed: "+n)||this).name="IndexedDbTransactionError",r}return Object(a.b)(t,e),t}(u);function sr(e){return"IndexedDbTransactionError"===e.name}var cr=function(){function e(e){this.store=e}return e.prototype.put=function(e,t){var n;return void 0!==t?(f("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(f("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),ur(n)},e.prototype.add=function(e){return f("SimpleDb","ADD",this.store.name,e,e),ur(this.store.add(e))},e.prototype.get=function(e){var t=this;return ur(this.store.get(e)).next((function(n){return void 0===n&&(n=null),f("SimpleDb","GET",t.store.name,e,n),n}))},e.prototype.delete=function(e){return f("SimpleDb","DELETE",this.store.name,e),ur(this.store.delete(e))},e.prototype.count=function(){return f("SimpleDb","COUNT",this.store.name),ur(this.store.count())},e.prototype.Nt=function(e,t){var n=this.cursor(this.options(e,t)),r=[];return this.xt(n,(function(e,t){r.push(t)})).next((function(){return r}))},e.prototype.Ft=function(e,t){f("SimpleDb","DELETE ALL",this.store.name);var n=this.options(e,t);n.kt=!1;var r=this.cursor(n);return this.xt(r,(function(e,t,n){return n.delete()}))},e.prototype.Ot=function(e,t){var n;t?n=e:(n={},t=e);var r=this.cursor(n);return this.xt(r,t)},e.prototype.$t=function(e){var t=this.cursor({});return new nr((function(n,r){t.onerror=function(e){var t=dr(e.target.error);r(t)},t.onsuccess=function(t){var r=t.target.result;r?e(r.primaryKey,r.value).next((function(e){e?r.continue():n()})):n()}}))},e.prototype.xt=function(e,t){var n=[];return new nr((function(r,i){e.onerror=function(e){i(e.target.error)},e.onsuccess=function(e){var i=e.target.result;if(i){var o=new or(i),a=t(i.primaryKey,i.value,o);if(a instanceof nr){var s=a.catch((function(e){return o.done(),nr.reject(e)}));n.push(s)}o.isDone?r():null===o.Dt?i.continue():i.continue(o.Dt)}else r()}})).next((function(){return nr.waitFor(n)}))},e.prototype.options=function(e,t){var n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}},e.prototype.cursor=function(e){var t="next";if(e.reverse&&(t="prev"),e.index){var n=this.store.index(e.index);return e.kt?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)},e}();function ur(e){return new nr((function(t,n){e.onsuccess=function(e){var n=e.target.result;t(n)},e.onerror=function(e){var t=dr(e.target.error);n(t)}}))}var lr=!1;function dr(e){var t=ir._t(Object(r.q)());if(t>=12.2&&t<13){var n="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(n)>=0){var i=new u("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return lr||(lr=!0,setTimeout((function(){throw i}),0)),i}}return e}var fr=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Mt=t,r.currentSequenceNumber=n,r}return Object(a.b)(t,e),t}(er);function hr(e,t){var n=y(e);return ir.It(n.Mt,t)}var pr=function(){function e(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}return e.prototype.applyToRemoteDocument=function(e,t){for(var n=t.mutationResults,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(e.key)&&dt(i,e,n[r])}},e.prototype.applyToLocalView=function(e){for(var t=0,n=this.baseMutations;t<n.length;t++)(o=n[t]).key.isEqual(e.key)&&ft(o,e,this.localWriteTime);for(var r=0,i=this.mutations;r<i.length;r++){var o;(o=i[r]).key.isEqual(e.key)&&ft(o,e,this.localWriteTime)}},e.prototype.applyToLocalDocumentSet=function(e){var t=this;this.mutations.forEach((function(n){var r=e.get(n.key),i=r;t.applyToLocalView(i),r.isValidDocument()||i.convertToNoDocument(I.min())}))},e.prototype.keys=function(){return this.mutations.reduce((function(e,t){return e.add(t.key)}),Vt())},e.prototype.isEqual=function(e){return this.batchId===e.batchId&&w(this.mutations,e.mutations,(function(e,t){return pt(e,t)}))&&w(this.baseMutations,e.baseMutations,(function(e,t){return pt(e,t)}))},e}(),vr=function(){function e(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}return e.from=function(t,n,r){g(t.mutations.length===r.length);for(var i=jt(),o=t.mutations,a=0;a<o.length;a++)i=i.insert(o[a].key,r[a].version);return new e(t,n,r,i)},e}(),mr=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=I.min()),void 0===o&&(o=I.min()),void 0===a&&(a=x.EMPTY_BYTE_STRING),this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a}return e.prototype.withSequenceNumber=function(t){return new e(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},e.prototype.withResumeToken=function(t,n){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,t)},e.prototype.withLastLimboFreeSnapshotVersion=function(t){return new e(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken)},e}(),gr=function(e){this.Lt=e};function yr(e,t){if(t.document)return vn(e.Lt,t.document,!!t.hasCommittedMutations);if(t.noDocument){var n=K.fromSegments(t.noDocument.path),r=Tr(t.noDocument.readTime),i=se.newNoDocument(n,r);return t.hasCommittedMutations?i.setHasCommittedMutations():i}if(t.unknownDocument){var o=K.fromSegments(t.unknownDocument.path);return r=Tr(t.unknownDocument.version),se.newUnknownDocument(o,r)}return m()}function _r(e,t,n){var r=br(n),i=t.key.path.popLast().toArray();if(t.isFoundDocument()){var o=function(e,t){return{name:cn(e,t.key),fields:t.data.toProto().mapValue.fields,updateTime:tn(e,t.version.toTimestamp())}}(e.Lt,t),a=t.hasCommittedMutations;return new Gn(null,null,o,a,r,i)}if(t.isNoDocument()){var s=t.key.path.toArray(),c=wr(t.version);return a=t.hasCommittedMutations,new Gn(null,new Bn(s,c),null,a,r,i)}if(t.isUnknownDocument()){var u=t.key.path.toArray(),l=wr(t.version);return new Gn(new Wn(u,l),null,null,!0,r,i)}return m()}function br(e){var t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function Er(e){var t=new S(e[0],e[1]);return I.fromTimestamp(t)}function wr(e){var t=e.toTimestamp();return new Mn(t.seconds,t.nanoseconds)}function Tr(e){var t=new S(e.seconds,e.nanoseconds);return I.fromTimestamp(t)}function Sr(e,t){for(var n=(t.baseMutations||[]).map((function(t){return gn(e.Lt,t)})),r=0;r<t.mutations.length-1;++r){var i=t.mutations[r];if(r+1<t.mutations.length&&void 0!==t.mutations[r+1].transform){var o=t.mutations[r+1];i.updateTransforms=o.transform.fieldTransforms,t.mutations.splice(r+1,1),++r}}var a=t.mutations.map((function(t){return gn(e.Lt,t)})),s=S.fromMillis(t.localWriteTimeMs);return new pr(t.batchId,s,n,a)}function Ir(e){var t,n,r=Tr(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?Tr(e.lastLimboFreeSnapshotVersion):I.min();return void 0!==e.query.documents?(g(1===(n=e.query).documents.length),t=Ue(Oe(dn(n.documents[0])))):t=function(e){return Ue(bn(e))}(e.query),new mr(t,e.targetId,0,e.lastListenSequenceNumber,r,i,x.fromBase64String(e.resumeToken))}function Rr(e,t){var n,r=wr(t.snapshotVersion),i=wr(t.lastLimboFreeSnapshotVersion);n=fe(t.target)?yn(e.Lt,t.target):_n(e.Lt,t.target);var o=t.resumeToken.toBase64();return new Kn(t.targetId,le(t.target),r,o,t.sequenceNumber,i,n)}function Ar(e){var t=bn({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?je(t,t.limit,"L"):t}var Cr=function(){function e(){}return e.prototype.getBundleMetadata=function(e,t){return kr(e).get(t).next((function(e){if(e)return{id:(t=e).bundleId,createTime:Tr(t.createTime),version:t.version};var t}))},e.prototype.saveBundleMetadata=function(e,t){return kr(e).put({bundleId:(n=t).id,createTime:wr(on(n.createTime)),version:n.version});var n},e.prototype.getNamedQuery=function(e,t){return Or(e).get(t).next((function(e){if(e)return{name:(t=e).name,query:Ar(t.bundledQuery),readTime:Tr(t.readTime)};var t}))},e.prototype.saveNamedQuery=function(e,t){return Or(e).put(function(e){return{name:e.name,readTime:wr(on(e.readTime)),bundledQuery:e.bundledQuery}}(t))},e}();function kr(e){return hr(e,Xn.store)}function Or(e){return hr(e,Jn.store)}var Nr=function(){function e(){this.Bt=new Pr}return e.prototype.addToCollectionParentIndex=function(e,t){return this.Bt.add(t),nr.resolve()},e.prototype.getCollectionParents=function(e,t){return nr.resolve(this.Bt.getEntries(t))},e}(),Pr=function(){function e(){this.index={}}return e.prototype.add=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Nt(O.comparator),i=!r.has(n);return this.index[t]=r.add(n),i},e.prototype.has=function(e){var t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)},e.prototype.getEntries=function(e){return(this.index[e]||new Nt(O.comparator)).toArray()},e}(),Dr=function(){function e(){this.qt=new Pr}return e.prototype.addToCollectionParentIndex=function(e,t){var n=this;if(!this.qt.has(t)){var r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener((function(){n.qt.add(t)}));var o={collectionId:r,parent:Pn(i)};return xr(e).put(o)}return nr.resolve()},e.prototype.getCollectionParents=function(e,t){var n=[],r=IDBKeyRange.bound([t,""],[T(t),""],!1,!0);return xr(e).Nt(r).next((function(e){for(var r=0,i=e;r<i.length;r++){var o=i[r];if(o.collectionId!==t)break;n.push(Ln(o.parent))}return n}))},e}();function xr(e){return hr(e,Yn.store)}var Lr={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Mr=function(){function e(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}return e.withCacheSize=function(t){return new e(t,e.DEFAULT_COLLECTION_PERCENTILE,e.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},e}();function Ur(e,t,n){var r=e.store(Fn.store),i=e.store(Vn.store),o=[],a=IDBKeyRange.only(n.batchId),s=0,c=r.Ot({range:a},(function(e,t,n){return s++,n.delete()}));o.push(c.next((function(){g(1===s)})));for(var u=[],l=0,d=n.mutations;l<d.length;l++){var f=d[l],h=Vn.key(t,f.key.path,n.batchId);o.push(i.delete(h)),u.push(f.key)}return nr.waitFor(o).next((function(){return u}))}function jr(e){if(!e)return 0;var t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw m();t=e.noDocument}return JSON.stringify(t).length}Mr.DEFAULT_COLLECTION_PERCENTILE=10,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Mr.DEFAULT=new Mr(41943040,Mr.DEFAULT_COLLECTION_PERCENTILE,Mr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Mr.DISABLED=new Mr(-1,0,0);var Fr=function(){function e(e,t,n,r){this.userId=e,this.R=t,this.Ut=n,this.referenceDelegate=r,this.Qt={}}return e.Kt=function(t,n,r,i){return g(""!==t.uid),new e(t.isAuthenticated()?t.uid:"",n,r,i)},e.prototype.checkEmpty=function(e){var t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Br(e).Ot({index:Fn.userMutationsIndex,range:n},(function(e,n,r){t=!1,r.done()})).next((function(){return t}))},e.prototype.addMutationBatch=function(e,t,n,r){var i=this,o=Wr(e),a=Br(e);return a.add({}).next((function(s){g("number"==typeof s);for(var c=new pr(s,t,n,r),u=function(e,t,n){var r=n.baseMutations.map((function(t){return mn(e.Lt,t)})),i=n.mutations.map((function(t){return mn(e.Lt,t)}));return new Fn(t,n.batchId,n.localWriteTime.toMillis(),r,i)}(i.R,i.userId,c),l=[],d=new Nt((function(e,t){return E(e.canonicalString(),t.canonicalString())})),f=0,h=r;f<h.length;f++){var p=h[f],v=Vn.key(i.userId,p.key.path,s);d=d.add(p.key.path.popLast()),l.push(a.put(u)),l.push(o.put(v,Vn.PLACEHOLDER))}return d.forEach((function(t){l.push(i.Ut.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((function(){i.Qt[s]=c.keys()})),nr.waitFor(l).next((function(){return c}))}))},e.prototype.lookupMutationBatch=function(e,t){var n=this;return Br(e).get(t).next((function(e){return e?(g(e.userId===n.userId),Sr(n.R,e)):null}))},e.prototype.jt=function(e,t){var n=this;return this.Qt[t]?nr.resolve(this.Qt[t]):this.lookupMutationBatch(e,t).next((function(e){if(e){var r=e.keys();return n.Qt[t]=r,r}return null}))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=this,r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]),o=null;return Br(e).Ot({index:Fn.userMutationsIndex,range:i},(function(e,t,i){t.userId===n.userId&&(g(t.batchId>=r),o=Sr(n.R,t)),i.done()})).next((function(){return o}))},e.prototype.getHighestUnacknowledgedBatchId=function(e){var t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return Br(e).Ot({index:Fn.userMutationsIndex,range:t,reverse:!0},(function(e,t,r){n=t.batchId,r.done()})).next((function(){return n}))},e.prototype.getAllMutationBatches=function(e){var t=this,n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Br(e).Nt(Fn.userMutationsIndex,n).next((function(e){return e.map((function(e){return Sr(t.R,e)}))}))},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=Vn.prefixForPath(this.userId,t.path),i=IDBKeyRange.lowerBound(r),o=[];return Wr(e).Ot({range:i},(function(r,i,a){var s=r[0],c=r[1],u=r[2],l=Ln(c);if(s===n.userId&&t.path.isEqual(l))return Br(e).get(u).next((function(e){if(!e)throw m();g(e.userId===n.userId),o.push(Sr(n.R,e))}));a.done()})).next((function(){return o}))},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Nt(E),i=[];return t.forEach((function(t){var o=Vn.prefixForPath(n.userId,t.path),a=IDBKeyRange.lowerBound(o),s=Wr(e).Ot({range:a},(function(e,i,o){var a=e[0],s=e[1],c=e[2],u=Ln(s);a===n.userId&&t.path.isEqual(u)?r=r.add(c):o.done()}));i.push(s)})),nr.waitFor(i).next((function(){return n.Wt(e,r)}))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=this,r=t.path,i=r.length+1,o=Vn.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new Nt(E);return Wr(e).Ot({range:a},(function(e,t,o){var a=e[0],c=e[1],u=e[2],l=Ln(c);a===n.userId&&r.isPrefixOf(l)?l.length===i&&(s=s.add(u)):o.done()})).next((function(){return n.Wt(e,s)}))},e.prototype.Wt=function(e,t){var n=this,r=[],i=[];return t.forEach((function(t){i.push(Br(e).get(t).next((function(e){if(null===e)throw m();g(e.userId===n.userId),r.push(Sr(n.R,e))})))})),nr.waitFor(i).next((function(){return r}))},e.prototype.removeMutationBatch=function(e,t){var n=this;return Ur(e.Mt,this.userId,t).next((function(r){return e.addOnCommittedListener((function(){n.Gt(t.batchId)})),nr.forEach(r,(function(t){return n.referenceDelegate.markPotentiallyOrphaned(e,t)}))}))},e.prototype.Gt=function(e){delete this.Qt[e]},e.prototype.performConsistencyCheck=function(e){var t=this;return this.checkEmpty(e).next((function(n){if(!n)return nr.resolve();var r=IDBKeyRange.lowerBound(Vn.prefixForUser(t.userId)),i=[];return Wr(e).Ot({range:r},(function(e,n,r){if(e[0]===t.userId){var o=Ln(e[1]);i.push(o)}else r.done()})).next((function(){g(0===i.length)}))}))},e.prototype.containsKey=function(e,t){return Vr(e,this.userId,t)},e.prototype.zt=function(e){var t=this;return Gr(e).get(this.userId).next((function(e){return e||new jn(t.userId,-1,"")}))},e}();function Vr(e,t,n){var r=Vn.prefixForPath(t,n.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Wr(e).Ot({range:o,kt:!0},(function(e,n,r){var o=e[0],s=e[1];e[2],o===t&&s===i&&(a=!0),r.done()})).next((function(){return a}))}function Br(e){return hr(e,Fn.store)}function Wr(e){return hr(e,Vn.store)}function Gr(e){return hr(e,jn.store)}var qr=function(){function e(e){this.Ht=e}return e.prototype.next=function(){return this.Ht+=2,this.Ht},e.Jt=function(){return new e(0)},e.Yt=function(){return new e(-1)},e}(),Kr=function(){function e(e,t){this.referenceDelegate=e,this.R=t}return e.prototype.allocateTargetId=function(e){var t=this;return this.Xt(e).next((function(n){var r=new qr(n.highestTargetId);return n.highestTargetId=r.next(),t.Zt(e,n).next((function(){return n.highestTargetId}))}))},e.prototype.getLastRemoteSnapshotVersion=function(e){return this.Xt(e).next((function(e){return I.fromTimestamp(new S(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))}))},e.prototype.getHighestSequenceNumber=function(e){return this.Xt(e).next((function(e){return e.highestListenSequenceNumber}))},e.prototype.setTargetsMetadata=function(e,t,n){var r=this;return this.Xt(e).next((function(i){return i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),r.Zt(e,i)}))},e.prototype.addTargetData=function(e,t){var n=this;return this.te(e,t).next((function(){return n.Xt(e).next((function(r){return r.targetCount+=1,n.ee(t,r),n.Zt(e,r)}))}))},e.prototype.updateTargetData=function(e,t){return this.te(e,t)},e.prototype.removeTargetData=function(e,t){var n=this;return this.removeMatchingKeysForTargetId(e,t.targetId).next((function(){return Hr(e).delete(t.targetId)})).next((function(){return n.Xt(e)})).next((function(t){return g(t.targetCount>0),t.targetCount-=1,n.Zt(e,t)}))},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return Hr(e).Ot((function(a,s){var c=Ir(s);c.sequenceNumber<=t&&null===n.get(c.targetId)&&(i++,o.push(r.removeTargetData(e,c)))})).next((function(){return nr.waitFor(o)})).next((function(){return i}))},e.prototype.forEachTarget=function(e,t){return Hr(e).Ot((function(e,n){var r=Ir(n);t(r)}))},e.prototype.Xt=function(e){return zr(e).get(zn.key).next((function(e){return g(null!==e),e}))},e.prototype.Zt=function(e,t){return zr(e).put(zn.key,t)},e.prototype.te=function(e,t){return Hr(e).put(Rr(this.R,t))},e.prototype.ee=function(e,t){var n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n},e.prototype.getTargetCount=function(e){return this.Xt(e).next((function(e){return e.targetCount}))},e.prototype.getTargetData=function(e,t){var n=le(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return Hr(e).Ot({range:r,index:Kn.queryTargetsIndexName},(function(e,n,r){var o=Ir(n);de(t,o.target)&&(i=o,r.done())})).next((function(){return i}))},e.prototype.addMatchingKeys=function(e,t,n){var r=this,i=[],o=Yr(e);return t.forEach((function(t){var a=Pn(t.path);i.push(o.put(new Hn(n,a))),i.push(r.referenceDelegate.addReference(e,n,t))})),nr.waitFor(i)},e.prototype.removeMatchingKeys=function(e,t,n){var r=this,i=Yr(e);return nr.forEach(t,(function(t){var o=Pn(t.path);return nr.waitFor([i.delete([n,o]),r.referenceDelegate.removeReference(e,n,t)])}))},e.prototype.removeMatchingKeysForTargetId=function(e,t){var n=Yr(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Yr(e),i=Vt();return r.Ot({range:n,kt:!0},(function(e,t,n){var r=Ln(e[1]),o=new K(r);i=i.add(o)})).next((function(){return i}))},e.prototype.containsKey=function(e,t){var n=Pn(t.path),r=IDBKeyRange.bound([n],[T(n)],!1,!0),i=0;return Yr(e).Ot({index:Hn.documentTargetsIndex,kt:!0,range:r},(function(e,t,n){var r=e[0];e[1],0!==r&&(i++,n.done())})).next((function(){return i>0}))},e.prototype.lt=function(e,t){return Hr(e).get(t).next((function(e){return e?Ir(e):null}))},e}();function Hr(e){return hr(e,Kn.store)}function zr(e){return hr(e,zn.store)}function Yr(e){return hr(e,Hn.store)}function Qr(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){if(e.code!==c.FAILED_PRECONDITION||e.message!==Zn)throw e;return f("LocalStore","Unexpectedly lost primary lease"),[2]}))}))}function Xr(e,t){var n=e[0],r=e[1],i=t[0],o=t[1],a=E(n,i);return 0===a?E(r,o):a}var Jr=function(){function e(e){this.ne=e,this.buffer=new Nt(Xr),this.se=0}return e.prototype.ie=function(){return++this.se},e.prototype.re=function(e){var t=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(t);else{var n=this.buffer.last();Xr(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}},Object.defineProperty(e.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),e}(),$r=function(){function e(e,t){this.garbageCollector=e,this.asyncQueue=t,this.oe=!1,this.ce=null}return e.prototype.start=function(e){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.ue(e)},e.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(e.prototype,"started",{get:function(){return null!==this.ce},enumerable:!1,configurable:!0}),e.prototype.ue=function(e){var t=this,n=this.oe?3e5:6e4;f("LruGarbageCollector","Garbage collection scheduled in "+n+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",n,(function(){return Object(a.a)(t,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:this.ce=null,this.oe=!0,n.label=1;case 1:return n.trys.push([1,3,,7]),[4,e.collectGarbage(this.garbageCollector)];case 2:return n.sent(),[3,7];case 3:return sr(t=n.sent())?(f("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",t),[3,6]):[3,4];case 4:return[4,Qr(t)];case 5:n.sent(),n.label=6;case 6:return[3,7];case 7:return[4,this.ue(e)];case 8:return n.sent(),[2]}}))}))}))},e}(),Zr=function(){function e(e,t){this.ae=e,this.params=t}return e.prototype.calculateTargetCount=function(e,t){return this.ae.he(e).next((function(e){return Math.floor(t/100*e)}))},e.prototype.nthSequenceNumber=function(e,t){var n=this;if(0===t)return nr.resolve(s.o);var r=new Jr(t);return this.ae.forEachTarget(e,(function(e){return r.re(e.sequenceNumber)})).next((function(){return n.ae.le(e,(function(e){return r.re(e)}))})).next((function(){return r.maxValue}))},e.prototype.removeTargets=function(e,t,n){return this.ae.removeTargets(e,t,n)},e.prototype.removeOrphanedDocuments=function(e,t){return this.ae.removeOrphanedDocuments(e,t)},e.prototype.collect=function(e,t){var n=this;return-1===this.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; disabled"),nr.resolve(Lr)):this.getCacheSize(e).next((function(r){return r<n.params.cacheSizeCollectionThreshold?(f("LruGarbageCollector","Garbage collection skipped; Cache size "+r+" is lower than threshold "+n.params.cacheSizeCollectionThreshold),Lr):n.fe(e,t)}))},e.prototype.getCacheSize=function(e){return this.ae.getCacheSize(e)},e.prototype.fe=function(e,t){var n,r,o,a,s,c,u,l=this,h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((function(t){return t>l.params.maximumSequenceNumbersToCollect?(f("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+l.params.maximumSequenceNumbersToCollect+" from "+t),r=l.params.maximumSequenceNumbersToCollect):r=t,a=Date.now(),l.nthSequenceNumber(e,r)})).next((function(r){return n=r,s=Date.now(),l.removeTargets(e,n,t)})).next((function(t){return o=t,c=Date.now(),l.removeOrphanedDocuments(e,n)})).next((function(e){return u=Date.now(),d()<=i.a.DEBUG&&f("LruGarbageCollector","LRU Garbage Collection\n\tCounted targets in "+(a-h)+"ms\n\tDetermined least recently used "+r+" in "+(s-a)+"ms\n\tRemoved "+o+" targets in "+(c-s)+"ms\n\tRemoved "+e+" documents in "+(u-c)+"ms\nTotal Duration: "+(u-h)+"ms"),nr.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:o,documentsRemoved:e})}))},e}(),ei=function(){function e(e,t){this.db=e,this.garbageCollector=function(e,t){return new Zr(e,t)}(this,t)}return e.prototype.he=function(e){var t=this.de(e);return this.db.getTargetCache().getTargetCount(e).next((function(e){return t.next((function(t){return e+t}))}))},e.prototype.de=function(e){var t=0;return this.le(e,(function(e){t++})).next((function(){return t}))},e.prototype.forEachTarget=function(e,t){return this.db.getTargetCache().forEachTarget(e,t)},e.prototype.le=function(e,t){return this.we(e,(function(e,n){return t(n)}))},e.prototype.addReference=function(e,t,n){return ti(e,n)},e.prototype.removeReference=function(e,t,n){return ti(e,n)},e.prototype.removeTargets=function(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)},e.prototype.markPotentiallyOrphaned=function(e,t){return ti(e,t)},e.prototype._e=function(e,t){return function(e,t){var n=!1;return Gr(e).$t((function(r){return Vr(e,r,t).next((function(e){return e&&(n=!0),nr.resolve(!e)}))})).next((function(){return n}))}(e,t)},e.prototype.removeOrphanedDocuments=function(e,t){var n=this,r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[],o=0;return this.we(e,(function(a,s){if(s<=t){var c=n._e(e,a).next((function(t){if(!t)return o++,r.getEntry(e,a).next((function(){return r.removeEntry(a),Yr(e).delete([0,Pn(a.path)])}))}));i.push(c)}})).next((function(){return nr.waitFor(i)})).next((function(){return r.apply(e)})).next((function(){return o}))},e.prototype.removeTarget=function(e,t){var n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)},e.prototype.updateLimboDocument=function(e,t){return ti(e,t)},e.prototype.we=function(e,t){var n,r=Yr(e),i=s.o;return r.Ot({index:Hn.documentTargetsIndex},(function(e,r){var o=e[0],a=(e[1],r.path),c=r.sequenceNumber;0===o?(i!==s.o&&t(new K(Ln(n)),i),i=c,n=a):i=s.o})).next((function(){i!==s.o&&t(new K(Ln(n)),i)}))},e.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},e}();function ti(e,t){return Yr(e).put(function(e,t){return new Hn(0,Pn(e.path),t)}(t,e.currentSequenceNumber))}var ni=function(){function e(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={}}return e.prototype.get=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(this.equalsFn(a,e))return s}},e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.set=function(e,t){var n=this.mapKeyFn(e),r=this.inner[n];if(void 0!==r){for(var i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t])}else this.inner[n]=[[e,t]]},e.prototype.delete=function(e){var t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),!0;return!1},e.prototype.forEach=function(e){A(this.inner,(function(t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];e(a,s)}}))},e.prototype.isEmpty=function(){return C(this.inner)},e}(),ri=function(){function e(){this.changes=new ni((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),this.changesApplied=!1}return e.prototype.getReadTime=function(e){var t=this.changes.get(e);return t?t.readTime:I.min()},e.prototype.addEntry=function(e,t){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:t})},e.prototype.removeEntry=function(e,t){void 0===t&&(t=null),this.assertNotApplied(),this.changes.set(e,{document:se.newInvalidDocument(e),readTime:t})},e.prototype.getEntry=function(e,t){this.assertNotApplied();var n=this.changes.get(t);return void 0!==n?nr.resolve(n.document):this.getFromCache(e,t)},e.prototype.getEntries=function(e,t){return this.getAllFromCache(e,t)},e.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},e.prototype.assertNotApplied=function(){},e}(),ii=function(){function e(e,t){this.R=e,this.Ut=t}return e.prototype.addEntry=function(e,t,n){return si(e).put(ci(t),n)},e.prototype.removeEntry=function(e,t){var n=si(e),r=ci(t);return n.delete(r)},e.prototype.updateMetadata=function(e,t){var n=this;return this.getMetadata(e).next((function(r){return r.byteSize+=t,n.me(e,r)}))},e.prototype.getEntry=function(e,t){var n=this;return si(e).get(ci(t)).next((function(e){return n.ye(t,e)}))},e.prototype.ge=function(e,t){var n=this;return si(e).get(ci(t)).next((function(e){return{document:n.ye(t,e),size:jr(e)}}))},e.prototype.getEntries=function(e,t){var n=this,r=xt();return this.pe(e,t,(function(e,t){var i=n.ye(e,t);r=r.insert(e,i)})).next((function(){return r}))},e.prototype.Ee=function(e,t){var n=this,r=xt(),i=new Ct(K.comparator);return this.pe(e,t,(function(e,t){var o=n.ye(e,t);r=r.insert(e,o),i=i.insert(e,jr(t))})).next((function(){return{documents:r,Te:i}}))},e.prototype.pe=function(e,t,n){if(t.isEmpty())return nr.resolve();var r=IDBKeyRange.bound(t.first().path.toArray(),t.last().path.toArray()),i=t.getIterator(),o=i.getNext();return si(e).Ot({range:r},(function(e,t,r){for(var a=K.fromSegments(e);o&&K.comparator(o,a)<0;)n(o,null),o=i.getNext();o&&o.isEqual(a)&&(n(o,t),o=i.hasNext()?i.getNext():null),o?r.Ct(o.path.toArray()):r.done()})).next((function(){for(;o;)n(o,null),o=i.hasNext()?i.getNext():null}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){var r=this,i=xt(),o=t.path.length+1,a={};if(n.isEqual(I.min())){var s=t.path.toArray();a.range=IDBKeyRange.lowerBound(s)}else{var c=t.path.toArray(),u=br(n);a.range=IDBKeyRange.lowerBound([c,u],!0),a.index=Gn.collectionReadTimeIndex}return si(e).Ot(a,(function(e,n,a){if(e.length===o){var s=yr(r.R,n);t.path.isPrefixOf(s.key.path)?We(t,s)&&(i=i.insert(s.key,s)):a.done()}})).next((function(){return i}))},e.prototype.newChangeBuffer=function(e){return new oi(this,!!e&&e.trackRemovals)},e.prototype.getSize=function(e){return this.getMetadata(e).next((function(e){return e.byteSize}))},e.prototype.getMetadata=function(e){return ai(e).get(qn.key).next((function(e){return g(!!e),e}))},e.prototype.me=function(e,t){return ai(e).put(qn.key,t)},e.prototype.ye=function(e,t){if(t){var n=yr(this.R,t);if(!n.isNoDocument()||!n.version.isEqual(I.min()))return n}return se.newInvalidDocument(e)},e}(),oi=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Ie=t,r.trackRemovals=n,r.Ae=new ni((function(e){return e.toString()}),(function(e,t){return e.isEqual(t)})),r}return Object(a.b)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[],r=0,i=new Nt((function(e,t){return E(e.canonicalString(),t.canonicalString())}));return this.changes.forEach((function(o,a){var s=t.Ae.get(o);if(a.document.isValidDocument()){var c=_r(t.Ie.R,a.document,t.getReadTime(o));i=i.add(o.path.popLast());var u=jr(c);r+=u-s,n.push(t.Ie.addEntry(e,o,c))}else if(r-=s,t.trackRemovals){var l=_r(t.Ie.R,se.newNoDocument(o,I.min()),t.getReadTime(o));n.push(t.Ie.addEntry(e,o,l))}else n.push(t.Ie.removeEntry(e,o))})),i.forEach((function(r){n.push(t.Ie.Ut.addToCollectionParentIndex(e,r))})),n.push(this.Ie.updateMetadata(e,r)),nr.waitFor(n)},t.prototype.getFromCache=function(e,t){var n=this;return this.Ie.ge(e,t).next((function(e){return n.Ae.set(t,e.size),e.document}))},t.prototype.getAllFromCache=function(e,t){var n=this;return this.Ie.Ee(e,t).next((function(e){var t=e.documents;return e.Te.forEach((function(e,t){n.Ae.set(e,t)})),t}))},t}(ri);function ai(e){return hr(e,qn.store)}function si(e){return hr(e,Gn.store)}function ci(e){return e.path.toArray()}var ui=function(){function e(e){this.R=e}return e.prototype.Rt=function(e,t,n,r){var i=this;g(n<r&&n>=0&&r<=11);var o=new rr("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore(Un.store)}(e),function(e){e.createObjectStore(jn.store,{keyPath:jn.keyPath}),e.createObjectStore(Fn.store,{keyPath:Fn.keyPath,autoIncrement:!0}).createIndex(Fn.userMutationsIndex,Fn.userMutationsKeyPath,{unique:!0}),e.createObjectStore(Vn.store)}(e),li(e),function(e){e.createObjectStore(Gn.store)}(e));var a=nr.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore(Hn.store),e.deleteObjectStore(Kn.store),e.deleteObjectStore(zn.store)}(e),li(e)),a=a.next((function(){return function(e){var t=e.store(zn.store),n=new zn(0,0,I.min().toTimestamp(),0);return t.put(zn.key,n)}(o)}))),n<4&&r>=4&&(0!==n&&(a=a.next((function(){return function(e,t){return t.store(Fn.store).Nt().next((function(n){e.deleteObjectStore(Fn.store),e.createObjectStore(Fn.store,{keyPath:Fn.keyPath,autoIncrement:!0}).createIndex(Fn.userMutationsIndex,Fn.userMutationsKeyPath,{unique:!0});var r=t.store(Fn.store),i=n.map((function(e){return r.put(e)}));return nr.waitFor(i)}))}(e,o)}))),a=a.next((function(){!function(e){e.createObjectStore(Qn.store,{keyPath:Qn.keyPath})}(e)}))),n<5&&r>=5&&(a=a.next((function(){return i.Re(o)}))),n<6&&r>=6&&(a=a.next((function(){return function(e){e.createObjectStore(qn.store)}(e),i.be(o)}))),n<7&&r>=7&&(a=a.next((function(){return i.ve(o)}))),n<8&&r>=8&&(a=a.next((function(){return i.Pe(e,o)}))),n<9&&r>=9&&(a=a.next((function(){!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e),function(e){var t=e.objectStore(Gn.store);t.createIndex(Gn.readTimeIndex,Gn.readTimeIndexPath,{unique:!1}),t.createIndex(Gn.collectionReadTimeIndex,Gn.collectionReadTimeIndexPath,{unique:!1})}(t)}))),n<10&&r>=10&&(a=a.next((function(){return i.Ve(o)}))),n<11&&r>=11&&(a=a.next((function(){!function(e){e.createObjectStore(Xn.store,{keyPath:Xn.keyPath})}(e),function(e){e.createObjectStore(Jn.store,{keyPath:Jn.keyPath})}(e)}))),a},e.prototype.be=function(e){var t=0;return e.store(Gn.store).Ot((function(e,n){t+=jr(n)})).next((function(){var n=new qn(t);return e.store(qn.store).put(qn.key,n)}))},e.prototype.Re=function(e){var t=this,n=e.store(jn.store),r=e.store(Fn.store);return n.Nt().next((function(n){return nr.forEach(n,(function(n){var i=IDBKeyRange.bound([n.userId,-1],[n.userId,n.lastAcknowledgedBatchId]);return r.Nt(Fn.userMutationsIndex,i).next((function(r){return nr.forEach(r,(function(r){g(r.userId===n.userId);var i=Sr(t.R,r);return Ur(e,n.userId,i).next((function(){}))}))}))}))}))},e.prototype.ve=function(e){var t=e.store(Hn.store),n=e.store(Gn.store);return e.store(zn.store).get(zn.key).next((function(e){var r=[];return n.Ot((function(n,i){var o=new O(n),a=function(e){return[0,Pn(e)]}(o);r.push(t.get(a).next((function(n){return n?nr.resolve():function(n){return t.put(new Hn(0,Pn(n),e.highestListenSequenceNumber))}(o)})))})).next((function(){return nr.waitFor(r)}))}))},e.prototype.Pe=function(e,t){e.createObjectStore(Yn.store,{keyPath:Yn.keyPath});var n=t.store(Yn.store),r=new Pr,i=function(e){if(r.add(e)){var t=e.lastSegment(),i=e.popLast();return n.put({collectionId:t,parent:Pn(i)})}};return t.store(Gn.store).Ot({kt:!0},(function(e,t){var n=new O(e);return i(n.popLast())})).next((function(){return t.store(Vn.store).Ot({kt:!0},(function(e,t){e[0];var n=e[1],r=(e[2],Ln(n));return i(r.popLast())}))}))},e.prototype.Ve=function(e){var t=this,n=e.store(Kn.store);return n.Ot((function(e,r){var i=Ir(r),o=Rr(t.R,i);return n.put(o)}))},e}();function li(e){e.createObjectStore(Hn.store,{keyPath:Hn.keyPath}).createIndex(Hn.documentTargetsIndex,Hn.documentTargetsKeyPath,{unique:!0}),e.createObjectStore(Kn.store,{keyPath:Kn.keyPath}).createIndex(Kn.queryTargetsIndexName,Kn.queryTargetsKeyPath,{unique:!0}),e.createObjectStore(zn.store)}var di="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",fi=function(){function e(t,n,r,i,o,a,s,l,d,f){if(this.allowTabSynchronization=t,this.persistenceKey=n,this.clientId=r,this.Se=o,this.window=a,this.document=s,this.De=d,this.Ce=f,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Fe=null,this.inForeground=!1,this.ke=null,this.Oe=null,this.$e=Number.NEGATIVE_INFINITY,this.Me=function(e){return Promise.resolve()},!e.yt())throw new u(c.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new ei(this,i),this.Le=n+"main",this.R=new gr(l),this.Be=new ir(this.Le,11,new ui(this.R)),this.qe=new Kr(this.referenceDelegate,this.R),this.Ut=new Dr,this.Ue=function(e,t){return new ii(e,t)}(this.R,this.Ut),this.Qe=new Cr,this.window&&this.window.localStorage?this.Ke=this.window.localStorage:(this.Ke=null,!1===f&&h("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return e.prototype.start=function(){var e=this;return this.je().then((function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new u(c.FAILED_PRECONDITION,di);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",(function(t){return e.qe.getHighestSequenceNumber(t)}))})).then((function(t){e.Ne=new s(t,e.De)})).then((function(){e.xe=!0})).catch((function(t){return e.Be&&e.Be.close(),Promise.reject(t)}))},e.prototype.He=function(e){var t=this;return this.Me=function(n){return Object(a.a)(t,void 0,void 0,(function(){return Object(a.c)(this,(function(t){return this.started?[2,e(n)]:[2]}))}))},e(this.isPrimary)},e.prototype.setDatabaseDeletedListener=function(e){var t=this;this.Be.vt((function(n){return Object(a.a)(t,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return null===n.newVersion?[4,e()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))}))}))},e.prototype.setNetworkEnabled=function(e){var t=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget((function(){return Object(a.a)(t,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})))},e.prototype.je=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(function(t){return pi(t).put(new Qn(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next((function(){if(e.isPrimary)return e.Je(t).next((function(t){t||(e.isPrimary=!1,e.Se.enqueueRetryable((function(){return e.Me(!1)})))}))})).next((function(){return e.Ye(t)})).next((function(n){return e.isPrimary&&!n?e.Xe(t).next((function(){return!1})):!!n&&e.Ze(t).next((function(){return!0}))}))})).catch((function(t){if(sr(t))return f("IndexedDbPersistence","Failed to extend owner lease: ",t),e.isPrimary;if(!e.allowTabSynchronization)throw t;return f("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1})).then((function(t){e.isPrimary!==t&&e.Se.enqueueRetryable((function(){return e.Me(t)})),e.isPrimary=t}))},e.prototype.Je=function(e){var t=this;return hi(e).get(Un.key).next((function(e){return nr.resolve(t.tn(e))}))},e.prototype.en=function(e){return pi(e).delete(this.clientId)},e.prototype.nn=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t,n,r,i=this;return Object(a.c)(this,(function(o){switch(o.label){case 0:return!this.isPrimary||this.sn(this.$e,18e5)?[3,2]:(this.$e=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(function(e){var t=hr(e,Qn.store);return t.Nt().next((function(e){var n=i.rn(e,18e5),r=e.filter((function(e){return-1===n.indexOf(e)}));return nr.forEach(r,(function(e){return t.delete(e.clientId)})).next((function(){return r}))}))})).catch((function(){return[]}))]);case 1:if(e=o.sent(),this.Ke)for(t=0,n=e;t<n.length;t++)r=n[t],this.Ke.removeItem(this.on(r.clientId));o.label=2;case 2:return[2]}}))}))},e.prototype.ze=function(){var e=this;this.Oe=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,(function(){return e.je().then((function(){return e.nn()})).then((function(){return e.ze()}))}))},e.prototype.tn=function(e){return!!e&&e.ownerId===this.clientId},e.prototype.Ye=function(e){var t=this;return this.Ce?nr.resolve(!0):hi(e).get(Un.key).next((function(n){if(null!==n&&t.sn(n.leaseTimestampMs,5e3)&&!t.cn(n.ownerId)){if(t.tn(n)&&t.networkEnabled)return!0;if(!t.tn(n)){if(!n.allowTabSynchronization)throw new u(c.FAILED_PRECONDITION,di);return!1}}return!(!t.networkEnabled||!t.inForeground)||pi(e).Nt().next((function(e){return void 0===t.rn(e,5e3).find((function(e){if(t.clientId!==e.clientId){var n=!t.networkEnabled&&e.networkEnabled,r=!t.inForeground&&e.inForeground,i=t.networkEnabled===e.networkEnabled;if(n||r&&i)return!0}return!1}))}))})).next((function(e){return t.isPrimary!==e&&f("IndexedDbPersistence","Client "+(e?"is":"is not")+" eligible for a primary lease."),e}))},e.prototype.shutdown=function(){return Object(a.a)(this,void 0,void 0,(function(){var e=this;return Object(a.c)(this,(function(t){switch(t.label){case 0:return this.xe=!1,this.un(),this.Oe&&(this.Oe.cancel(),this.Oe=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Un.store,Qn.store],(function(t){var n=new fr(t,s.o);return e.Xe(n).next((function(){return e.en(n)}))}))];case 1:return t.sent(),this.Be.close(),this.ln(),[2]}}))}))},e.prototype.rn=function(e,t){var n=this;return e.filter((function(e){return n.sn(e.updateTimeMs,t)&&!n.cn(e.clientId)}))},e.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",(function(t){return pi(t).Nt().next((function(t){return e.rn(t,18e5).map((function(e){return e.clientId}))}))}))},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.getMutationQueue=function(e){return Fr.Kt(e,this.R,this.Ut,this.referenceDelegate)},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getBundleCache=function(){return this.Qe},e.prototype.runTransaction=function(e,t,n){var r=this;f("IndexedDbPersistence","Starting transaction:",e);var i,o="readonly"===t?"readonly":"readwrite";return this.Be.runTransaction(e,o,$n,(function(o){return i=new fr(o,r.Ne?r.Ne.next():s.o),"readwrite-primary"===t?r.Je(i).next((function(e){return!!e||r.Ye(i)})).next((function(t){if(!t)throw h("Failed to obtain primary lease for action '"+e+"'."),r.isPrimary=!1,r.Se.enqueueRetryable((function(){return r.Me(!1)})),new u(c.FAILED_PRECONDITION,Zn);return n(i)})).next((function(e){return r.Ze(i).next((function(){return e}))})):r.dn(i).next((function(){return n(i)}))})).then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.dn=function(e){var t=this;return hi(e).get(Un.key).next((function(e){if(null!==e&&t.sn(e.leaseTimestampMs,5e3)&&!t.cn(e.ownerId)&&!t.tn(e)&&!(t.Ce||t.allowTabSynchronization&&e.allowTabSynchronization))throw new u(c.FAILED_PRECONDITION,di)}))},e.prototype.Ze=function(e){var t=new Un(this.clientId,this.allowTabSynchronization,Date.now());return hi(e).put(Un.key,t)},e.yt=function(){return ir.yt()},e.prototype.Xe=function(e){var t=this,n=hi(e);return n.get(Un.key).next((function(e){return t.tn(e)?(f("IndexedDbPersistence","Releasing primary lease."),n.delete(Un.key)):nr.resolve()}))},e.prototype.sn=function(e,t){var n=Date.now();return!(e<n-t||e>n&&(h("Detected an update time that is in the future: "+e+" > "+n),1))},e.prototype.We=function(){var e=this;null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ke=function(){e.Se.enqueueAndForget((function(){return e.inForeground="visible"===e.document.visibilityState,e.je()}))},this.document.addEventListener("visibilitychange",this.ke),this.inForeground="visible"===this.document.visibilityState)},e.prototype.an=function(){this.ke&&(this.document.removeEventListener("visibilitychange",this.ke),this.ke=null)},e.prototype.Ge=function(){var e,t=this;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Fe=function(){t.un(),t.Se.enqueueAndForget((function(){return t.shutdown()}))},this.window.addEventListener("unload",this.Fe))},e.prototype.hn=function(){this.Fe&&(this.window.removeEventListener("unload",this.Fe),this.Fe=null)},e.prototype.cn=function(e){var t;try{var n=null!==(null===(t=this.Ke)||void 0===t?void 0:t.getItem(this.on(e)));return f("IndexedDbPersistence","Client '"+e+"' "+(n?"is":"is not")+" zombied in LocalStorage"),n}catch(e){return h("IndexedDbPersistence","Failed to get zombied client id.",e),!1}},e.prototype.un=function(){if(this.Ke)try{this.Ke.setItem(this.on(this.clientId),String(Date.now()))}catch(e){h("Failed to set zombie client id.",e)}},e.prototype.ln=function(){if(this.Ke)try{this.Ke.removeItem(this.on(this.clientId))}catch(e){}},e.prototype.on=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},e}();function hi(e){return hr(e,Un.store)}function pi(e){return hr(e,Qn.store)}function vi(e,t){var n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}var mi=function(e,t){this.progress=e,this.wn=t},gi=function(){function e(e,t,n){this.Ue=e,this._n=t,this.Ut=n}return e.prototype.mn=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,t).next((function(r){return n.yn(e,t,r)}))},e.prototype.yn=function(e,t,n){return this.Ue.getEntry(e,t).next((function(e){for(var t=0,r=n;t<r.length;t++)r[t].applyToLocalView(e);return e}))},e.prototype.gn=function(e,t){e.forEach((function(e,n){for(var r=0,i=t;r<i.length;r++)i[r].applyToLocalView(n)}))},e.prototype.pn=function(e,t){var n=this;return this.Ue.getEntries(e,t).next((function(t){return n.En(e,t).next((function(){return t}))}))},e.prototype.En=function(e,t){var n=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(e,t).next((function(e){return n.gn(t,e)}))},e.prototype.getDocumentsMatchingQuery=function(e,t,n){return function(e){return K.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.Tn(e,t.path):Le(t)?this.In(e,t,n):this.An(e,t,n)},e.prototype.Tn=function(e,t){return this.mn(e,new K(t)).next((function(e){var t=Mt();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))},e.prototype.In=function(e,t,n){var r=this,i=t.collectionGroup,o=Mt();return this.Ut.getCollectionParents(e,i).next((function(a){return nr.forEach(a,(function(a){var s=function(e,t){return new Ce(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,a.child(i));return r.An(e,s,n).next((function(e){e.forEach((function(e,t){o=o.insert(e,t)}))}))})).next((function(){return o}))}))},e.prototype.An=function(e,t,n){var r,i,o=this;return this.Ue.getDocumentsMatchingQuery(e,t,n).next((function(n){return r=n,o._n.getAllMutationBatchesAffectingQuery(e,t)})).next((function(t){return i=t,o.Rn(e,i,r).next((function(e){r=e;for(var t=0,n=i;t<n.length;t++)for(var o=n[t],a=0,s=o.mutations;a<s.length;a++){var c=s[a],u=c.key,l=r.get(u);null==l&&(l=se.newInvalidDocument(u),r=r.insert(u,l)),ft(c,l,o.localWriteTime),l.isFoundDocument()||(r=r.remove(u))}}))})).next((function(){return r.forEach((function(e,n){We(t,n)||(r=r.remove(e))})),r}))},e.prototype.Rn=function(e,t,n){for(var r=Vt(),i=0,o=t;i<o.length;i++)for(var a=0,s=o[i].mutations;a<s.length;a++){var c=s[a];c instanceof gt&&null===n.get(c.key)&&(r=r.add(c.key))}var u=n;return this.Ue.getEntries(e,r).next((function(e){return e.forEach((function(e,t){t.isFoundDocument()&&(u=u.insert(e,t))})),u}))},e}(),yi=function(){function e(e,t,n,r){this.targetId=e,this.fromCache=t,this.bn=n,this.vn=r}return e.Pn=function(t,n){for(var r=Vt(),i=Vt(),o=0,a=n.docChanges;o<a.length;o++){var s=a[o];switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}}return new e(t,n.fromCache,r,i)},e}(),_i=function(){function e(){}return e.prototype.Vn=function(e){this.Sn=e},e.prototype.getDocumentsMatchingQuery=function(e,t,n,r){var o=this;return function(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}(t)||n.isEqual(I.min())?this.Dn(e,t):this.Sn.pn(e,r).next((function(a){var s=o.Cn(t,a);return(Ne(t)||Pe(t))&&o.Nn(t.limitType,s,r,n)?o.Dn(e,t):(d()<=i.a.DEBUG&&f("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),Be(t)),o.Sn.getDocumentsMatchingQuery(e,t,n).next((function(e){return s.forEach((function(t){e=e.insert(t.key,t)})),e})))}))},e.prototype.Cn=function(e,t){var n=new Nt(Ge(e));return t.forEach((function(t,r){We(e,r)&&(n=n.add(r))})),n},e.prototype.Nn=function(e,t,n,r){if(n.size!==t.size)return!0;var i="F"===e?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)},e.prototype.Dn=function(e,t){return d()<=i.a.DEBUG&&f("QueryEngine","Using full collection scan to execute query:",Be(t)),this.Sn.getDocumentsMatchingQuery(e,t,I.min())},e}(),bi=function(){function e(e,t,n,r){this.persistence=e,this.xn=t,this.R=r,this.Fn=new Ct(E),this.kn=new ni((function(e){return le(e)}),de),this.On=I.min(),this._n=e.getMutationQueue(n),this.$n=e.getRemoteDocumentCache(),this.qe=e.getTargetCache(),this.Mn=new gi(this.$n,this._n,this.persistence.getIndexManager()),this.Qe=e.getBundleCache(),this.xn.Vn(this.Mn)}return e.prototype.collectGarbage=function(e){var t=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",(function(n){return e.collect(n,t.Fn)}))},e}();function Ei(e,t,n,r){return new bi(e,t,n,r)}function wi(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o;return Object(a.c)(this,(function(a){switch(a.label){case 0:return n=y(e),r=n._n,i=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",(function(e){var o;return n._n.getAllMutationBatches(e).next((function(a){return o=a,r=n.persistence.getMutationQueue(t),i=new gi(n.$n,r,n.persistence.getIndexManager()),r.getAllMutationBatches(e)})).next((function(t){for(var n=[],r=[],a=Vt(),s=0,c=o;s<c.length;s++){var u=c[s];n.push(u.batchId);for(var l=0,d=u.mutations;l<d.length;l++){var f=d[l];a=a.add(f.key)}}for(var h=0,p=t;h<p.length;h++){var v=p[h];r.push(v.batchId);for(var m=0,g=v.mutations;m<g.length;m++){var y=g[m];a=a.add(y.key)}}return i.pn(e,a).next((function(e){return{Ln:e,removedBatchIds:n,addedBatchIds:r}}))}))}))];case 1:return o=a.sent(),[2,(n._n=r,n.Mn=i,n.xn.Vn(n.Mn),o)]}}))}))}function Ti(e,t){var n=y(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(function(e){var r=t.batch.keys(),i=n.$n.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){var i=n.batch,o=i.keys(),a=nr.resolve();return o.forEach((function(e){a=a.next((function(){return r.getEntry(t,e)})).next((function(t){var o=n.docVersions.get(e);g(null!==o),t.version.compareTo(o)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&r.addEntry(t,n.commitVersion))}))})),a.next((function(){return e._n.removeMutationBatch(t,i)}))}(n,e,t,i).next((function(){return i.apply(e)})).next((function(){return n._n.performConsistencyCheck(e)})).next((function(){return n.Mn.pn(e,r)}))}))}function Si(e){var t=y(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(function(e){return t.qe.getLastRemoteSnapshotVersion(e)}))}function Ii(e,t){var n=y(e),r=t.snapshotVersion,i=n.Fn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(function(e){var o=n.$n.newChangeBuffer({trackRemovals:!0});i=n.Fn;var a=[];t.targetChanges.forEach((function(t,o){var s=i.get(o);if(s){a.push(n.qe.removeMatchingKeys(e,t.removedDocuments,o).next((function(){return n.qe.addMatchingKeys(e,t.addedDocuments,o)})));var c=t.resumeToken;if(c.approximateByteSize()>0){var u=s.withResumeToken(c,r).withSequenceNumber(e.currentSequenceNumber);i=i.insert(o,u),function(e,t,n){return g(t.resumeToken.approximateByteSize()>0),0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(s,u,t)&&a.push(n.qe.updateTargetData(e,u))}}}));var s=xt();if(t.documentUpdates.forEach((function(r,i){t.resolvedLimboDocuments.has(r)&&a.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),a.push(Ri(e,o,t.documentUpdates,r,void 0).next((function(e){s=e}))),!r.isEqual(I.min())){var c=n.qe.getLastRemoteSnapshotVersion(e).next((function(t){return n.qe.setTargetsMetadata(e,e.currentSequenceNumber,r)}));a.push(c)}return nr.waitFor(a).next((function(){return o.apply(e)})).next((function(){return n.Mn.En(e,s)})).next((function(){return s}))})).then((function(e){return n.Fn=i,e}))}function Ri(e,t,n,r,i){var o=Vt();return n.forEach((function(e){return o=o.add(e)})),t.getEntries(e,o).next((function(e){var o=xt();return n.forEach((function(n,a){var s=e.get(n),c=(null==i?void 0:i.get(n))||r;a.isNoDocument()&&a.version.isEqual(I.min())?(t.removeEntry(n,c),o=o.insert(n,a)):!s.isValidDocument()||a.version.compareTo(s.version)>0||0===a.version.compareTo(s.version)&&s.hasPendingWrites?(t.addEntry(a,c),o=o.insert(n,a)):f("LocalStore","Ignoring outdated watch update for ",n,". Current version:",s.version," Watch version:",a.version)})),o}))}function Ai(e,t){var n=y(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(function(e){return void 0===t&&(t=-1),n._n.getNextMutationBatchAfterBatchId(e,t)}))}function Ci(e,t){var n=y(e);return n.persistence.runTransaction("Allocate target","readwrite",(function(e){var r;return n.qe.getTargetData(e,t).next((function(i){return i?(r=i,nr.resolve(r)):n.qe.allocateTargetId(e).next((function(i){return r=new mr(t,i,0,e.currentSequenceNumber),n.qe.addTargetData(e,r).next((function(){return r}))}))}))})).then((function(e){var r=n.Fn.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Fn=n.Fn.insert(e.targetId,e),n.kn.set(t,e.targetId)),e}))}function ki(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s;return Object(a.c)(this,(function(a){switch(a.label){case 0:r=y(e),i=r.Fn.get(t),o=n?"readwrite":"readwrite-primary",a.label=1;case 1:return a.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",o,(function(e){return r.persistence.referenceDelegate.removeTarget(e,i)}))];case 2:a.sent(),a.label=3;case 3:return[3,5];case 4:if(!sr(s=a.sent()))throw s;return f("LocalStore","Failed to update sequence numbers for target "+t+": "+s),[3,5];case 5:return r.Fn=r.Fn.remove(t),r.kn.delete(i.target),[2]}}))}))}function Oi(e,t,n){var r=y(e),i=I.min(),o=Vt();return r.persistence.runTransaction("Execute query","readonly",(function(e){return function(e,t,n){var r=y(e),i=r.kn.get(n);return void 0!==i?nr.resolve(r.Fn.get(i)):r.qe.getTargetData(t,n)}(r,e,Ue(t)).next((function(t){if(t)return i=t.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(e,t.targetId).next((function(e){o=e}))})).next((function(){return r.xn.getDocumentsMatchingQuery(e,t,n?i:I.min(),n?o:Vt())})).next((function(e){return{documents:e,Bn:o}}))}))}function Ni(e,t){var n=y(e),r=y(n.qe),i=n.Fn.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(function(e){return r.lt(e,t).next((function(e){return e?e.target:null}))}))}function Pi(e){var t=y(e);return t.persistence.runTransaction("Get new document changes","readonly",(function(e){return function(e,t,n){var r=y(e),i=xt(),o=br(n),a=si(t),s=IDBKeyRange.lowerBound(o,!0);return a.Ot({index:Gn.readTimeIndex,range:s},(function(e,t){var n=yr(r.R,t);i=i.insert(n.key,n),o=t.readTime})).next((function(){return{wn:i,readTime:Er(o)}}))}(t.$n,e,t.On)})).then((function(e){var n=e.wn,r=e.readTime;return t.On=r,n}))}function Di(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){return[2,(t=y(e)).persistence.runTransaction("Synchronize last document change read time","readonly",(function(e){return function(e){var t=si(e),n=I.min();return t.Ot({index:Gn.readTimeIndex,reverse:!0},(function(e,t,r){t.readTime&&(n=Er(t.readTime)),r.done()})).next((function(){return n}))}(e)})).then((function(e){t.On=e}))]}))}))}function xi(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o,s,c,u,l,d,f,h,p;return Object(a.c)(this,(function(a){switch(a.label){case 0:for(i=y(e),o=Vt(),s=xt(),c=jt(),u=0,l=n;u<l.length;u++)d=l[u],f=t.qn(d.metadata.name),d.document&&(o=o.add(f)),s=s.insert(f,t.Un(d)),c=c.insert(f,t.Qn(d.metadata.readTime));return h=i.$n.newChangeBuffer({trackRemovals:!0}),[4,Ci(i,function(e){return Ue(Oe(O.fromString("__bundle__/docs/"+e)))}(r))];case 1:return p=a.sent(),[2,i.persistence.runTransaction("Apply bundle documents","readwrite",(function(e){return Ri(e,h,s,I.min(),c).next((function(t){return h.apply(e),t})).next((function(t){return i.qe.removeMatchingKeysForTargetId(e,p.targetId).next((function(){return i.qe.addMatchingKeys(e,o,p.targetId)})).next((function(){return i.Mn.En(e,t)})).next((function(){return t}))}))}))]}}))}))}function Li(e,t,n){return void 0===n&&(n=Vt()),Object(a.a)(this,void 0,void 0,(function(){var r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return[4,Ci(e,Ue(Ar(t.bundledQuery)))];case 1:return r=o.sent(),[2,(i=y(e)).persistence.runTransaction("Save named query","readwrite",(function(e){var o=on(t.readTime);if(r.snapshotVersion.compareTo(o)>=0)return i.Qe.saveNamedQuery(e,t);var a=r.withResumeToken(x.EMPTY_BYTE_STRING,o);return i.Fn=i.Fn.insert(a.targetId,a),i.qe.updateTargetData(e,a).next((function(){return i.qe.removeMatchingKeysForTargetId(e,r.targetId)})).next((function(){return i.qe.addMatchingKeys(e,n,r.targetId)})).next((function(){return i.Qe.saveNamedQuery(e,t)}))}))]}}))}))}var Mi=function(){function e(e){this.R=e,this.Kn=new Map,this.jn=new Map}return e.prototype.getBundleMetadata=function(e,t){return nr.resolve(this.Kn.get(t))},e.prototype.saveBundleMetadata=function(e,t){var n;return this.Kn.set(t.id,{id:(n=t).id,version:n.version,createTime:on(n.createTime)}),nr.resolve()},e.prototype.getNamedQuery=function(e,t){return nr.resolve(this.jn.get(t))},e.prototype.saveNamedQuery=function(e,t){return this.jn.set(t.name,function(e){return{name:e.name,query:Ar(e.bundledQuery),readTime:on(e.readTime)}}(t)),nr.resolve()},e}(),Ui=function(){function e(){this.Wn=new Nt(ji.Gn),this.zn=new Nt(ji.Hn)}return e.prototype.isEmpty=function(){return this.Wn.isEmpty()},e.prototype.addReference=function(e,t){var n=new ji(e,t);this.Wn=this.Wn.add(n),this.zn=this.zn.add(n)},e.prototype.Jn=function(e,t){var n=this;e.forEach((function(e){return n.addReference(e,t)}))},e.prototype.removeReference=function(e,t){this.Yn(new ji(e,t))},e.prototype.Xn=function(e,t){var n=this;e.forEach((function(e){return n.removeReference(e,t)}))},e.prototype.Zn=function(e){var t=this,n=new K(new O([])),r=new ji(n,e),i=new ji(n,e+1),o=[];return this.zn.forEachInRange([r,i],(function(e){t.Yn(e),o.push(e.key)})),o},e.prototype.ts=function(){var e=this;this.Wn.forEach((function(t){return e.Yn(t)}))},e.prototype.Yn=function(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)},e.prototype.es=function(e){var t=new K(new O([])),n=new ji(t,e),r=new ji(t,e+1),i=Vt();return this.zn.forEachInRange([n,r],(function(e){i=i.add(e.key)})),i},e.prototype.containsKey=function(e){var t=new ji(e,0),n=this.Wn.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)},e}(),ji=function(){function e(e,t){this.key=e,this.ns=t}return e.Gn=function(e,t){return K.comparator(e.key,t.key)||E(e.ns,t.ns)},e.Hn=function(e,t){return E(e.ns,t.ns)||K.comparator(e.key,t.key)},e}(),Fi=function(){function e(e,t){this.Ut=e,this.referenceDelegate=t,this._n=[],this.ss=1,this.rs=new Nt(ji.Gn)}return e.prototype.checkEmpty=function(e){return nr.resolve(0===this._n.length)},e.prototype.addMutationBatch=function(e,t,n,r){var i=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var o=new pr(i,t,n,r);this._n.push(o);for(var a=0,s=r;a<s.length;a++){var c=s[a];this.rs=this.rs.add(new ji(c.key,i)),this.Ut.addToCollectionParentIndex(e,c.key.path.popLast())}return nr.resolve(o)},e.prototype.lookupMutationBatch=function(e,t){return nr.resolve(this.os(t))},e.prototype.getNextMutationBatchAfterBatchId=function(e,t){var n=t+1,r=this.cs(n),i=r<0?0:r;return nr.resolve(this._n.length>i?this._n[i]:null)},e.prototype.getHighestUnacknowledgedBatchId=function(){return nr.resolve(0===this._n.length?-1:this.ss-1)},e.prototype.getAllMutationBatches=function(e){return nr.resolve(this._n.slice())},e.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,t){var n=this,r=new ji(t,0),i=new ji(t,Number.POSITIVE_INFINITY),o=[];return this.rs.forEachInRange([r,i],(function(e){var t=n.os(e.ns);o.push(t)})),nr.resolve(o)},e.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,t){var n=this,r=new Nt(E);return t.forEach((function(e){var t=new ji(e,0),i=new ji(e,Number.POSITIVE_INFINITY);n.rs.forEachInRange([t,i],(function(e){r=r.add(e.ns)}))})),nr.resolve(this.us(r))},e.prototype.getAllMutationBatchesAffectingQuery=function(e,t){var n=t.path,r=n.length+1,i=n;K.isDocumentKey(i)||(i=i.child(""));var o=new ji(new K(i),0),a=new Nt(E);return this.rs.forEachWhile((function(e){var t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(a=a.add(e.ns)),!0)}),o),nr.resolve(this.us(a))},e.prototype.us=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.os(e);null!==r&&n.push(r)})),n},e.prototype.removeMutationBatch=function(e,t){var n=this;g(0===this.hs(t.batchId,"removed")),this._n.shift();var r=this.rs;return nr.forEach(t.mutations,(function(i){var o=new ji(i.key,t.batchId);return r=r.delete(o),n.referenceDelegate.markPotentiallyOrphaned(e,i.key)})).next((function(){n.rs=r}))},e.prototype.Gt=function(e){},e.prototype.containsKey=function(e,t){var n=new ji(t,0),r=this.rs.firstAfterOrEqual(n);return nr.resolve(t.isEqual(r&&r.key))},e.prototype.performConsistencyCheck=function(e){return this._n.length,nr.resolve()},e.prototype.hs=function(e,t){return this.cs(e)},e.prototype.cs=function(e){return 0===this._n.length?0:e-this._n[0].batchId},e.prototype.os=function(e){var t=this.cs(e);return t<0||t>=this._n.length?null:this._n[t]},e}(),Vi=function(){function e(e,t){this.Ut=e,this.ls=t,this.docs=new Ct(K.comparator),this.size=0}return e.prototype.addEntry=function(e,t,n){var r=t.key,i=this.docs.get(r),o=i?i.size:0,a=this.ls(t);return this.docs=this.docs.insert(r,{document:t.clone(),size:a,readTime:n}),this.size+=a-o,this.Ut.addToCollectionParentIndex(e,r.path.popLast())},e.prototype.removeEntry=function(e){var t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)},e.prototype.getEntry=function(e,t){var n=this.docs.get(t);return nr.resolve(n?n.document.clone():se.newInvalidDocument(t))},e.prototype.getEntries=function(e,t){var n=this,r=xt();return t.forEach((function(e){var t=n.docs.get(e);r=r.insert(e,t?t.document.clone():se.newInvalidDocument(e))})),nr.resolve(r)},e.prototype.getDocumentsMatchingQuery=function(e,t,n){for(var r=xt(),i=new K(t.path.child("")),o=this.docs.getIteratorFrom(i);o.hasNext();){var a=o.getNext(),s=a.key,c=a.value,u=c.document,l=c.readTime;if(!t.path.isPrefixOf(s.path))break;l.compareTo(n)<=0||We(t,u)&&(r=r.insert(u.key,u.clone()))}return nr.resolve(r)},e.prototype.fs=function(e,t){return nr.forEach(this.docs,(function(e){return t(e)}))},e.prototype.newChangeBuffer=function(e){return new Bi(this)},e.prototype.getSize=function(e){return nr.resolve(this.size)},e}(),Bi=function(e){function t(t){var n=this;return(n=e.call(this)||this).Ie=t,n}return Object(a.b)(t,e),t.prototype.applyChanges=function(e){var t=this,n=[];return this.changes.forEach((function(r,i){i.document.isValidDocument()?n.push(t.Ie.addEntry(e,i.document,t.getReadTime(r))):t.Ie.removeEntry(r)})),nr.waitFor(n)},t.prototype.getFromCache=function(e,t){return this.Ie.getEntry(e,t)},t.prototype.getAllFromCache=function(e,t){return this.Ie.getEntries(e,t)},t}(ri),Wi=function(){function e(e){this.persistence=e,this.ds=new ni((function(e){return le(e)}),de),this.lastRemoteSnapshotVersion=I.min(),this.highestTargetId=0,this.ws=0,this._s=new Ui,this.targetCount=0,this.ys=qr.Jt()}return e.prototype.forEachTarget=function(e,t){return this.ds.forEach((function(e,n){return t(n)})),nr.resolve()},e.prototype.getLastRemoteSnapshotVersion=function(e){return nr.resolve(this.lastRemoteSnapshotVersion)},e.prototype.getHighestSequenceNumber=function(e){return nr.resolve(this.ws)},e.prototype.allocateTargetId=function(e){return this.highestTargetId=this.ys.next(),nr.resolve(this.highestTargetId)},e.prototype.setTargetsMetadata=function(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.ws&&(this.ws=t),nr.resolve()},e.prototype.te=function(e){this.ds.set(e.target,e);var t=e.targetId;t>this.highestTargetId&&(this.ys=new qr(t),this.highestTargetId=t),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)},e.prototype.addTargetData=function(e,t){return this.te(t),this.targetCount+=1,nr.resolve()},e.prototype.updateTargetData=function(e,t){return this.te(t),nr.resolve()},e.prototype.removeTargetData=function(e,t){return this.ds.delete(t.target),this._s.Zn(t.targetId),this.targetCount-=1,nr.resolve()},e.prototype.removeTargets=function(e,t,n){var r=this,i=0,o=[];return this.ds.forEach((function(a,s){s.sequenceNumber<=t&&null===n.get(s.targetId)&&(r.ds.delete(a),o.push(r.removeMatchingKeysForTargetId(e,s.targetId)),i++)})),nr.waitFor(o).next((function(){return i}))},e.prototype.getTargetCount=function(e){return nr.resolve(this.targetCount)},e.prototype.getTargetData=function(e,t){var n=this.ds.get(t)||null;return nr.resolve(n)},e.prototype.addMatchingKeys=function(e,t,n){return this._s.Jn(t,n),nr.resolve()},e.prototype.removeMatchingKeys=function(e,t,n){this._s.Xn(t,n);var r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((function(t){i.push(r.markPotentiallyOrphaned(e,t))})),nr.waitFor(i)},e.prototype.removeMatchingKeysForTargetId=function(e,t){return this._s.Zn(t),nr.resolve()},e.prototype.getMatchingKeysForTargetId=function(e,t){var n=this._s.es(t);return nr.resolve(n)},e.prototype.containsKey=function(e,t){return nr.resolve(this._s.containsKey(t))},e}(),Gi=function(){function e(e,t){var n=this;this.gs={},this.Ne=new s(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.qe=new Wi(this),this.Ut=new Nr,this.Ue=function(e,t){return new Vi(e,(function(e){return n.referenceDelegate.ps(e)}))}(this.Ut),this.R=new gr(t),this.Qe=new Mi(this.R)}return e.prototype.start=function(){return Promise.resolve()},e.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(e.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),e.prototype.setDatabaseDeletedListener=function(){},e.prototype.setNetworkEnabled=function(){},e.prototype.getIndexManager=function(){return this.Ut},e.prototype.getMutationQueue=function(e){var t=this.gs[e.toKey()];return t||(t=new Fi(this.Ut,this.referenceDelegate),this.gs[e.toKey()]=t),t},e.prototype.getTargetCache=function(){return this.qe},e.prototype.getRemoteDocumentCache=function(){return this.Ue},e.prototype.getBundleCache=function(){return this.Qe},e.prototype.runTransaction=function(e,t,n){var r=this;f("MemoryPersistence","Starting transaction:",e);var i=new qi(this.Ne.next());return this.referenceDelegate.Es(),n(i).next((function(e){return r.referenceDelegate.Ts(i).next((function(){return e}))})).toPromise().then((function(e){return i.raiseOnCommittedEvent(),e}))},e.prototype.Is=function(e,t){return nr.or(Object.values(this.gs).map((function(n){return function(){return n.containsKey(e,t)}})))},e}(),qi=function(e){function t(t){var n=this;return(n=e.call(this)||this).currentSequenceNumber=t,n}return Object(a.b)(t,e),t}(er),Ki=function(){function e(e){this.persistence=e,this.As=new Ui,this.Rs=null}return e.bs=function(t){return new e(t)},Object.defineProperty(e.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw m()},enumerable:!1,configurable:!0}),e.prototype.addReference=function(e,t,n){return this.As.addReference(n,t),this.vs.delete(n.toString()),nr.resolve()},e.prototype.removeReference=function(e,t,n){return this.As.removeReference(n,t),this.vs.add(n.toString()),nr.resolve()},e.prototype.markPotentiallyOrphaned=function(e,t){return this.vs.add(t.toString()),nr.resolve()},e.prototype.removeTarget=function(e,t){var n=this;this.As.Zn(t.targetId).forEach((function(e){return n.vs.add(e.toString())}));var r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((function(e){e.forEach((function(e){return n.vs.add(e.toString())}))})).next((function(){return r.removeTargetData(e,t)}))},e.prototype.Es=function(){this.Rs=new Set},e.prototype.Ts=function(e){var t=this,n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return nr.forEach(this.vs,(function(r){var i=K.fromPath(r);return t.Ps(e,i).next((function(e){e||n.removeEntry(i)}))})).next((function(){return t.Rs=null,n.apply(e)}))},e.prototype.updateLimboDocument=function(e,t){var n=this;return this.Ps(e,t).next((function(e){e?n.vs.delete(t.toString()):n.vs.add(t.toString())}))},e.prototype.ps=function(e){return 0},e.prototype.Ps=function(e,t){var n=this;return nr.or([function(){return nr.resolve(n.As.containsKey(t))},function(){return n.persistence.getTargetCache().containsKey(e,t)},function(){return n.persistence.Is(e,t)}])},e}(),Hi=function(){function e(e){this.uid=e}return e.prototype.isAuthenticated=function(){return null!=this.uid},e.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},e.prototype.isEqual=function(e){return e.uid===this.uid},e}();function zi(e,t){return"firestore_clients_"+e+"_"+t}function Yi(e,t,n){var r="firestore_mutations_"+e+"_"+n;return t.isAuthenticated()&&(r+="_"+t.uid),r}function Qi(e,t){return"firestore_targets_"+e+"_"+t}Hi.UNAUTHENTICATED=new Hi(null),Hi.GOOGLE_CREDENTIALS=new Hi("google-credentials-uid"),Hi.FIRST_PARTY=new Hi("first-party-uid");var Xi=function(){function e(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}return e.Vs=function(t,n,r){var i,o=JSON.parse(r),a="object"==typeof o&&-1!==["pending","acknowledged","rejected"].indexOf(o.state)&&(void 0===o.error||"object"==typeof o.error);return a&&o.error&&(a="string"==typeof o.error.message&&"string"==typeof o.error.code)&&(i=new u(o.error.code,o.error.message)),a?new e(t,n,o.state,i):(h("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),Ji=function(){function e(e,t,n){this.targetId=e,this.state=t,this.error=n}return e.Vs=function(t,n){var r,i=JSON.parse(n),o="object"==typeof i&&-1!==["not-current","current","rejected"].indexOf(i.state)&&(void 0===i.error||"object"==typeof i.error);return o&&i.error&&(o="string"==typeof i.error.message&&"string"==typeof i.error.code)&&(r=new u(i.error.code,i.error.message)),o?new e(t,i.state,r):(h("SharedClientState","Failed to parse target state for ID '"+t+"': "+n),null)},e.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},e}(),$i=function(){function e(e,t){this.clientId=e,this.activeTargetIds=t}return e.Vs=function(t,n){for(var r=JSON.parse(n),i="object"==typeof r&&r.activeTargetIds instanceof Array,o=Wt(),a=0;i&&a<r.activeTargetIds.length;++a)i=q(r.activeTargetIds[a]),o=o.add(r.activeTargetIds[a]);return i?new e(t,o):(h("SharedClientState","Failed to parse client data for instance '"+t+"': "+n),null)},e}(),Zi=function(){function e(e,t){this.clientId=e,this.onlineState=t}return e.Vs=function(t){var n=JSON.parse(t);return"object"==typeof n&&-1!==["Unknown","Online","Offline"].indexOf(n.onlineState)&&"string"==typeof n.clientId?new e(n.clientId,n.onlineState):(h("SharedClientState","Failed to parse online state: "+t),null)},e}(),eo=function(){function e(){this.activeTargetIds=Wt()}return e.prototype.Ds=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},e.prototype.Cs=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},e.prototype.Ss=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},e}(),to=function(){function e(e,t,n,r,i){this.window=e,this.Se=t,this.persistenceKey=n,this.Ns=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.Fs.bind(this),this.ks=new Ct(E),this.started=!1,this.Os=[];var o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.$s=zi(this.persistenceKey,this.Ns),this.Ms=function(e){return"firestore_sequence_number_"+e}(this.persistenceKey),this.ks=this.ks.insert(this.Ns,new eo),this.Ls=new RegExp("^firestore_clients_"+o+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+o+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+o+"_(\\d+)$"),this.Us=function(e){return"firestore_online_state_"+e}(this.persistenceKey),this.Qs=function(e){return"firestore_bundle_loaded_"+e}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return e.yt=function(e){return!(!e||!e.localStorage)},e.prototype.start=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t,n,r,i,o,s,c,u,l,d,f=this;return Object(a.c)(this,(function(a){switch(a.label){case 0:return[4,this.syncEngine.fn()];case 1:for(e=a.sent(),t=0,n=e;t<n.length;t++)(r=n[t])!==this.Ns&&(i=this.getItem(zi(this.persistenceKey,r)))&&(o=$i.Vs(r,i))&&(this.ks=this.ks.insert(o.clientId,o));for(this.Ks(),(s=this.storage.getItem(this.Us))&&(c=this.js(s))&&this.Ws(c),u=0,l=this.Os;u<l.length;u++)d=l[u],this.Fs(d);return this.Os=[],this.window.addEventListener("unload",(function(){return f.shutdown()})),this.started=!0,[2]}}))}))},e.prototype.writeSequenceNumber=function(e){this.setItem(this.Ms,JSON.stringify(e))},e.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.ks)},e.prototype.isActiveQueryTarget=function(e){var t=!1;return this.ks.forEach((function(n,r){r.activeTargetIds.has(e)&&(t=!0)})),t},e.prototype.addPendingMutation=function(e){this.zs(e,"pending")},e.prototype.updateMutationState=function(e,t,n){this.zs(e,t,n),this.Hs(e)},e.prototype.addLocalQueryTarget=function(e){var t="not-current";if(this.isActiveQueryTarget(e)){var n=this.storage.getItem(Qi(this.persistenceKey,e));if(n){var r=Ji.Vs(e,n);r&&(t=r.state)}}return this.Js.Ds(e),this.Ks(),t},e.prototype.removeLocalQueryTarget=function(e){this.Js.Cs(e),this.Ks()},e.prototype.isLocalQueryTarget=function(e){return this.Js.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){this.removeItem(Qi(this.persistenceKey,e))},e.prototype.updateQueryState=function(e,t,n){this.Ys(e,t,n)},e.prototype.handleUserChange=function(e,t,n){var r=this;t.forEach((function(e){r.Hs(e)})),this.currentUser=e,n.forEach((function(e){r.addPendingMutation(e)}))},e.prototype.setOnlineState=function(e){this.Xs(e)},e.prototype.notifyBundleLoaded=function(){this.Zs()},e.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.$s),this.started=!1)},e.prototype.getItem=function(e){var t=this.storage.getItem(e);return f("SharedClientState","READ",e,t),t},e.prototype.setItem=function(e,t){f("SharedClientState","SET",e,t),this.storage.setItem(e,t)},e.prototype.removeItem=function(e){f("SharedClientState","REMOVE",e),this.storage.removeItem(e)},e.prototype.Fs=function(e){var t=this,n=e;if(n.storageArea===this.storage){if(f("SharedClientState","EVENT",n.key,n.newValue),n.key===this.$s)return void h("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable((function(){return Object(a.a)(t,void 0,void 0,(function(){var e,t,r,i,o,c;return Object(a.c)(this,(function(a){if(this.started){if(null!==n.key)if(this.Ls.test(n.key)){if(null==n.newValue)return e=this.ti(n.key),[2,this.ei(e,null)];if(t=this.ni(n.key,n.newValue))return[2,this.ei(t.clientId,t)]}else if(this.Bs.test(n.key)){if(null!==n.newValue&&(r=this.si(n.key,n.newValue)))return[2,this.ii(r)]}else if(this.qs.test(n.key)){if(null!==n.newValue&&(i=this.ri(n.key,n.newValue)))return[2,this.oi(i)]}else if(n.key===this.Us){if(null!==n.newValue&&(o=this.js(n.newValue)))return[2,this.Ws(o)]}else if(n.key===this.Ms)(c=function(e){var t=s.o;if(null!=e)try{var n=JSON.parse(e);g("number"==typeof n),t=n}catch(e){h("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(n.newValue))!==s.o&&this.sequenceNumberHandler(c);else if(n.key===this.Qs)return[2,this.syncEngine.ci()]}else this.Os.push(n);return[2]}))}))}))}},Object.defineProperty(e.prototype,"Js",{get:function(){return this.ks.get(this.Ns)},enumerable:!1,configurable:!0}),e.prototype.Ks=function(){this.setItem(this.$s,this.Js.Ss())},e.prototype.zs=function(e,t,n){var r=new Xi(this.currentUser,e,t,n),i=Yi(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Ss())},e.prototype.Hs=function(e){var t=Yi(this.persistenceKey,this.currentUser,e);this.removeItem(t)},e.prototype.Xs=function(e){var t={clientId:this.Ns,onlineState:e};this.storage.setItem(this.Us,JSON.stringify(t))},e.prototype.Ys=function(e,t,n){var r=Qi(this.persistenceKey,e),i=new Ji(e,t,n);this.setItem(r,i.Ss())},e.prototype.Zs=function(){this.setItem(this.Qs,"value-not-used")},e.prototype.ti=function(e){var t=this.Ls.exec(e);return t?t[1]:null},e.prototype.ni=function(e,t){var n=this.ti(e);return $i.Vs(n,t)},e.prototype.si=function(e,t){var n=this.Bs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Xi.Vs(new Hi(i),r,t)},e.prototype.ri=function(e,t){var n=this.qs.exec(e),r=Number(n[1]);return Ji.Vs(r,t)},e.prototype.js=function(e){return Zi.Vs(e)},e.prototype.ii=function(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(f("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])}))}))},e.prototype.oi=function(e){return this.syncEngine.ai(e.targetId,e.state,e.error)},e.prototype.ei=function(e,t){var n=this,r=t?this.ks.insert(e,t):this.ks.remove(e),i=this.Gs(this.ks),o=this.Gs(r),a=[],s=[];return o.forEach((function(e){i.has(e)||a.push(e)})),i.forEach((function(e){o.has(e)||s.push(e)})),this.syncEngine.hi(a,s).then((function(){n.ks=r}))},e.prototype.Ws=function(e){this.ks.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},e.prototype.Gs=function(e){var t=Wt();return e.forEach((function(e,n){t=t.unionWith(n.activeTargetIds)})),t},e}(),no=function(){function e(){this.li=new eo,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return e.prototype.addPendingMutation=function(e){},e.prototype.updateMutationState=function(e,t,n){},e.prototype.addLocalQueryTarget=function(e){return this.li.Ds(e),this.fi[e]||"not-current"},e.prototype.updateQueryState=function(e,t,n){this.fi[e]=t},e.prototype.removeLocalQueryTarget=function(e){this.li.Cs(e)},e.prototype.isLocalQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.clearQueryState=function(e){delete this.fi[e]},e.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},e.prototype.isActiveQueryTarget=function(e){return this.li.activeTargetIds.has(e)},e.prototype.start=function(){return this.li=new eo,Promise.resolve()},e.prototype.handleUserChange=function(e,t,n){},e.prototype.setOnlineState=function(e){},e.prototype.shutdown=function(){},e.prototype.writeSequenceNumber=function(e){},e.prototype.notifyBundleLoaded=function(){},e}(),ro=function(){function e(){}return e.prototype.di=function(e){},e.prototype.shutdown=function(){},e}(),io=function(){function e(){var e=this;this.wi=function(){return e._i()},this.mi=function(){return e.yi()},this.gi=[],this.pi()}return e.prototype.di=function(e){this.gi.push(e)},e.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},e.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},e.prototype._i=function(){f("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(0)},e.prototype.yi=function(){f("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,t=this.gi;e<t.length;e++)(0,t[e])(1)},e.yt=function(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener},e}(),oo={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},ao=function(){function e(e){this.Ei=e.Ei,this.Ti=e.Ti}return e.prototype.Ii=function(e){this.Ai=e},e.prototype.Ri=function(e){this.bi=e},e.prototype.onMessage=function(e){this.vi=e},e.prototype.close=function(){this.Ti()},e.prototype.send=function(e){this.Ei(e)},e.prototype.Pi=function(){this.Ai()},e.prototype.Vi=function(e){this.bi(e)},e.prototype.Si=function(e){this.vi(e)},e}(),so=function(e){function t(t){var n=this;return(n=e.call(this,t)||this).forceLongPolling=t.forceLongPolling,n.autoDetectLongPolling=t.autoDetectLongPolling,n}return Object(a.b)(t,e),t.prototype.ki=function(e,t,n,r){return new Promise((function(i,a){var s=new o.f;s.listenOnce(o.c.COMPLETE,(function(){try{switch(s.getLastErrorCode()){case o.a.NO_ERROR:var t=s.getResponseJson();f("Connection","XHR received:",JSON.stringify(t)),i(t);break;case o.a.TIMEOUT:f("Connection",'RPC "'+e+'" timed out'),a(new u(c.DEADLINE_EXCEEDED,"Request time out"));break;case o.a.HTTP_ERROR:var n=s.getStatus();if(f("Connection",'RPC "'+e+'" failed with status:',n,"response text:",s.getResponseText()),n>0){var r=s.getResponseJson().error;if(r&&r.status&&r.message){var l=function(e){var t=e.toLowerCase().replace(/_/g,"-");return Object.values(c).indexOf(t)>=0?t:c.UNKNOWN}(r.status);a(new u(l,r.message))}else a(new u(c.UNKNOWN,"Server responded with status "+s.getStatus()))}else a(new u(c.UNAVAILABLE,"Connection failed."));break;default:m()}}finally{f("Connection",'RPC "'+e+'" completed.')}}));var l=JSON.stringify(r);s.send(t,"POST",l,n,15)}))},t.prototype.$i=function(e,t){var n=[this.Di,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=Object(o.g)(),a=Object(o.h)(),s={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.Fi(s.initMessageHeaders,t),Object(r.y)()||Object(r.B)()||Object(r.u)()||Object(r.w)()||Object(r.C)()||Object(r.t)()||(s.httpHeadersOverwriteParam="$httpHeaders");var l=n.join("");f("Connection","Creating WebChannel: "+l,s);var d=i.createWebChannel(l,s),h=!1,v=!1,m=new ao({Ei:function(e){v?f("Connection","Not sending because WebChannel is closed:",e):(h||(f("Connection","Opening WebChannel transport."),d.open(),h=!0),f("Connection","WebChannel sending:",e),d.send(e))},Ti:function(){return d.close()}}),y=function(e,t,n){e.listen(t,(function(e){try{n(e)}catch(e){setTimeout((function(){throw e}),0)}}))};return y(d,o.e.EventType.OPEN,(function(){v||f("Connection","WebChannel transport opened.")})),y(d,o.e.EventType.CLOSE,(function(){v||(v=!0,f("Connection","WebChannel transport closed"),m.Vi())})),y(d,o.e.EventType.ERROR,(function(e){v||(v=!0,p("Connection","WebChannel transport errored:",e),m.Vi(new u(c.UNAVAILABLE,"The operation could not be completed")))})),y(d,o.e.EventType.MESSAGE,(function(e){var t;if(!v){var n=e.data[0];g(!!n);var r=n,i=r.error||(null===(t=r[0])||void 0===t?void 0:t.error);if(i){f("Connection","WebChannel received error:",i);var o=i.status,a=function(e){var t=Et[e];if(void 0!==t)return At(t)}(o),s=i.message;void 0===a&&(a=c.INTERNAL,s="Unknown error status: "+o+" with message "+i.message),v=!0,m.Vi(new u(a,s)),d.close()}else f("Connection","WebChannel received:",n),m.Si(n)}})),y(a,o.b.STAT_EVENT,(function(e){e.stat===o.d.PROXY?f("Connection","Detected buffering proxy"):e.stat===o.d.NOPROXY&&f("Connection","Detected no buffering proxy")})),setTimeout((function(){m.Pi()}),0),m},t}(function(){function e(e){this.databaseInfo=e,this.databaseId=e.databaseId;var t=e.ssl?"https":"http";this.Di=t+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return e.prototype.Ni=function(e,t,n,r){var i=this.xi(e,t);f("RestConnection","Sending: ",i,n);var o={};return this.Fi(o,r),this.ki(e,i,o,n).then((function(e){return f("RestConnection","Received: ",e),e}),(function(t){throw p("RestConnection",e+" failed with error: ",t,"url: ",i,"request:",n),t}))},e.prototype.Oi=function(e,t,n,r){return this.Ni(e,t,n,r)},e.prototype.Fi=function(e,t){if(e["X-Goog-Api-Client"]="gl-js/ fire/8.4.0",e["X-Firebase-GMPID"]=this.databaseInfo.appId,e["Content-Type"]="text/plain",t)for(var n in t.authHeaders)t.authHeaders.hasOwnProperty(n)&&(e[n]=t.authHeaders[n])},e.prototype.xi=function(e,t){var n=oo[e];return this.Di+"/v1/"+t+":"+n},e}());function co(){return"undefined"!=typeof window?window:null}function uo(){return"undefined"!=typeof document?document:null}function lo(e){return new en(e,!0)}var fo=function(){function e(e,t,n,r,i){void 0===n&&(n=1e3),void 0===r&&(r=1.5),void 0===i&&(i=6e4),this.Se=e,this.timerId=t,this.Mi=n,this.Li=r,this.Bi=i,this.qi=0,this.Ui=null,this.Qi=Date.now(),this.reset()}return e.prototype.reset=function(){this.qi=0},e.prototype.Ki=function(){this.qi=this.Bi},e.prototype.ji=function(e){var t=this;this.cancel();var n=Math.floor(this.qi+this.Wi()),r=Math.max(0,Date.now()-this.Qi),i=Math.max(0,n-r);i>0&&f("ExponentialBackoff","Backing off for "+i+" ms (base delay: "+this.qi+" ms, delay with jitter: "+n+" ms, last attempt: "+r+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,i,(function(){return t.Qi=Date.now(),e()})),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},e.prototype.Gi=function(){null!==this.Ui&&(this.Ui.skipDelay(),this.Ui=null)},e.prototype.cancel=function(){null!==this.Ui&&(this.Ui.cancel(),this.Ui=null)},e.prototype.Wi=function(){return(Math.random()-.5)*this.qi},e}(),ho=function(){function e(e,t,n,r,i,o){this.Se=e,this.zi=n,this.Hi=r,this.Ji=i,this.listener=o,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new fo(e,t)}return e.prototype.tr=function(){return 1===this.state||2===this.state||4===this.state},e.prototype.er=function(){return 2===this.state},e.prototype.start=function(){3!==this.state?this.auth():this.nr()},e.prototype.stop=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))},e.prototype.sr=function(){this.state=0,this.Zi.reset()},e.prototype.ir=function(){var e=this;this.er()&&null===this.Xi&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,(function(){return e.rr()})))},e.prototype.cr=function(e){this.ur(),this.stream.send(e)},e.prototype.rr=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){return this.er()?[2,this.close(0)]:[2]}))}))},e.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},e.prototype.close=function(e,t){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(n){switch(n.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,3!==e?this.Zi.reset():t&&t.code===c.RESOURCE_EXHAUSTED?(h(t.toString()),h("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Ki()):t&&t.code===c.UNAUTHENTICATED&&this.Ji.invalidateToken(),null!==this.stream&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.ar=function(){},e.prototype.auth=function(){var e=this;this.state=1;var t=this.hr(this.Yi),n=this.Yi;this.Ji.getToken().then((function(t){e.Yi===n&&e.lr(t)}),(function(n){t((function(){var t=new u(c.UNKNOWN,"Fetching auth token failed: "+n.message);return e.dr(t)}))}))},e.prototype.lr=function(e){var t=this,n=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii((function(){n((function(){return t.state=2,t.listener.Ii()}))})),this.stream.Ri((function(e){n((function(){return t.dr(e)}))})),this.stream.onMessage((function(e){n((function(){return t.onMessage(e)}))}))},e.prototype.nr=function(){var e=this;this.state=4,this.Zi.ji((function(){return Object(a.a)(e,void 0,void 0,(function(){return Object(a.c)(this,(function(e){return this.state=0,this.start(),[2]}))}))}))},e.prototype.dr=function(e){return f("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},e.prototype.hr=function(e){var t=this;return function(n){t.Se.enqueueAndForget((function(){return t.Yi===e?n():(f("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())}))}},e}(),po=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"listen_stream_connection_backoff","listen_stream_idle",n,r,o)||this).R=i,a}return Object(a.b)(t,e),t.prototype.wr=function(e){return this.Hi.$i("Listen",e)},t.prototype.onMessage=function(e){this.Zi.reset();var t=function(e,t){var n;if("targetChange"in t){t.targetChange;var r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:m()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=function(e,t){return e.I?(g(void 0===t||"string"==typeof t),x.fromBase64String(t||"")):(g(void 0===t||t instanceof Uint8Array),x.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=(s=t.targetChange.cause)&&function(e){var t=void 0===e.code?c.UNKNOWN:At(e.code);return new u(t,e.message||"")}(s);n=new zt(r,i,o,a||null)}else if("documentChange"in t){t.documentChange,(r=t.documentChange).document,r.document.name,r.document.updateTime,i=un(e,r.document.name),o=on(r.document.updateTime);var s=new oe({mapValue:{fields:r.document.fields}}),l=(a=se.newFoundDocument(i,o,s),r.targetIds||[]),d=r.removedTargetIds||[];n=new Kt(l,d,a.key,a)}else if("documentDelete"in t)t.documentDelete,(r=t.documentDelete).document,i=un(e,r.document),o=r.readTime?on(r.readTime):I.min(),s=se.newNoDocument(i,o),a=r.removedTargetIds||[],n=new Kt([],a,s.key,s);else if("documentRemove"in t)t.documentRemove,(r=t.documentRemove).document,i=un(e,r.document),o=r.removedTargetIds||[],n=new Kt([],o,i,null);else{if(!("filter"in t))return m();t.filter;var f=t.filter;f.targetId,r=f.count||0,i=new It(r),o=f.targetId,n=new Ht(o,i)}return n}(this.R,e),n=function(e){if(!("targetChange"in e))return I.min();var t=e.targetChange;return t.targetIds&&t.targetIds.length?I.min():t.readTime?on(t.readTime):I.min()}(e);return this.listener._r(t,n)},t.prototype.mr=function(e){var t={};t.database=fn(this.R),t.addTarget=function(e,t){var n,r=t.target;return(n=fe(r)?{documents:yn(e,r)}:{query:_n(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0?n.resumeToken=nn(e,t.resumeToken):t.snapshotVersion.compareTo(I.min())>0&&(n.readTime=tn(e,t.snapshotVersion.toTimestamp())),n}(this.R,e);var n=function(e,t){var n=function(e,t){switch(t){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return m()}}(0,t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.R,e);n&&(t.labels=n),this.cr(t)},t.prototype.yr=function(e){var t={};t.database=fn(this.R),t.removeTarget=e,this.cr(t)},t}(ho),vo=function(e){function t(t,n,r,i,o){var a=this;return(a=e.call(this,t,"write_stream_connection_backoff","write_stream_idle",n,r,o)||this).R=i,a.gr=!1,a}return Object(a.b)(t,e),Object.defineProperty(t.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),t.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,e.prototype.start.call(this)},t.prototype.ar=function(){this.gr&&this.Er([])},t.prototype.wr=function(e){return this.Hi.$i("Write",e)},t.prototype.onMessage=function(e){if(g(!!e.streamToken),this.lastStreamToken=e.streamToken,this.gr){this.Zi.reset();var t=function(e,t){return e&&e.length>0?(g(void 0!==t),e.map((function(e){return function(e,t){var n=e.updateTime?on(e.updateTime):on(t);return n.isEqual(I.min())&&(n=on(t)),new st(n,e.transformResults||[])}(e,t)}))):[]}(e.writeResults,e.commitTime),n=on(e.commitTime);return this.listener.Tr(n,t)}return g(!e.writeResults||0===e.writeResults.length),this.gr=!0,this.listener.Ir()},t.prototype.Ar=function(){var e={};e.database=fn(this.R),this.cr(e)},t.prototype.Er=function(e){var t=this,n={streamToken:this.lastStreamToken,writes:e.map((function(e){return mn(t.R,e)}))};this.cr(n)},t}(ho),mo=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).credentials=t,i.Hi=n,i.R=r,i.Rr=!1,i}return Object(a.b)(t,e),t.prototype.br=function(){if(this.Rr)throw new u(c.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.Ni=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Ni(e,t,n,i)})).catch((function(e){throw e.code===c.UNAUTHENTICATED&&r.credentials.invalidateToken(),e}))},t.prototype.Oi=function(e,t,n){var r=this;return this.br(),this.credentials.getToken().then((function(i){return r.Hi.Oi(e,t,n,i)})).catch((function(e){throw e.code===c.UNAUTHENTICATED&&r.credentials.invalidateToken(),e}))},t.prototype.terminate=function(){this.Rr=!1},t}((function(){})),go=function(){function e(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return e.prototype.Sr=function(){var e=this;0===this.vr&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(function(){return e.Pr=null,e.Cr("Backend didn't respond within 10 seconds."),e.Dr("Offline"),Promise.resolve()})))},e.prototype.Nr=function(e){"Online"===this.state?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.Fr(),this.Cr("Connection failed 1 times. Most recent error: "+e.toString()),this.Dr("Offline")))},e.prototype.set=function(e){this.Fr(),this.vr=0,"Online"===e&&(this.Vr=!1),this.Dr(e)},e.prototype.Dr=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},e.prototype.Cr=function(e){var t="Could not reach Cloud Firestore backend. "+e+"\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.";this.Vr?(h(t),this.Vr=!1):f("OnlineStateTracker",t)},e.prototype.Fr=function(){null!==this.Pr&&(this.Pr.cancel(),this.Pr=null)},e}(),yo=function(e,t,n,r,i){var o=this;this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.kr=[],this.Or=new Map,this.$r=new Set,this.Mr=[],this.Lr=i,this.Lr.di((function(e){n.enqueueAndForget((function(){return Object(a.a)(o,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return Ao(this)?(f("RemoteStore","Restarting streams for network reachability change."),[4,function(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return(t=y(e)).$r.add(4),[4,bo(t)];case 1:return n.sent(),t.Br.set("Unknown"),t.$r.delete(4),[4,_o(t)];case 2:return n.sent(),[2]}}))}))}(this)]):[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))}))})),this.Br=new go(n,r)};function _o(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:if(!Ao(e))return[3,4];t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function bo(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:t=0,n=e.Mr,r.label=1;case 1:return t<n.length?[4,(0,n[t])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return t++,[3,1];case 4:return[2]}}))}))}function Eo(e,t){var n=y(e);n.Or.has(t.targetId)||(n.Or.set(t.targetId,t),Ro(n)?Io(n):Wo(n).er()&&To(n,t))}function wo(e,t){var n=y(e),r=Wo(n);n.Or.delete(t),r.er()&&So(n,t),0===n.Or.size&&(r.er()?r.ir():Ao(n)&&n.Br.set("Unknown"))}function To(e,t){e.qr.U(t.targetId),Wo(e).mr(t)}function So(e,t){e.qr.U(t),Wo(e).yr(t)}function Io(e){e.qr=new Qt({getRemoteKeysForTarget:function(t){return e.remoteSyncer.getRemoteKeysForTarget(t)},lt:function(t){return e.Or.get(t)||null}}),Wo(e).start(),e.Br.Sr()}function Ro(e){return Ao(e)&&!Wo(e).tr()&&e.Or.size>0}function Ao(e){return 0===y(e).$r.size}function Co(e){e.qr=void 0}function ko(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){return e.Or.forEach((function(t,n){To(e,t)})),[2]}))}))}function Oo(e,t){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(n){return Co(e),Ro(e)?(e.Br.Nr(t),Io(e)):e.Br.set("Unknown"),[2]}))}))}function No(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o;return Object(a.c)(this,(function(s){switch(s.label){case 0:if(e.Br.set("Online"),!(t instanceof zt&&2===t.state&&t.cause))return[3,6];s.label=1;case 1:return s.trys.push([1,3,,5]),[4,function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o;return Object(a.c)(this,(function(a){switch(a.label){case 0:n=t.cause,r=0,i=t.targetIds,a.label=1;case 1:return r<i.length?(o=i[r],e.Or.has(o)?[4,e.remoteSyncer.rejectListen(o,n)]:[3,3]):[3,5];case 2:a.sent(),e.Or.delete(o),e.qr.removeTarget(o),a.label=3;case 3:a.label=4;case 4:return r++,[3,1];case 5:return[2]}}))}))}(e,t)];case 2:return s.sent(),[3,5];case 3:return r=s.sent(),f("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),r),[4,Po(e,r)];case 4:return s.sent(),[3,5];case 5:return[3,13];case 6:if(t instanceof Kt?e.qr.X(t):t instanceof Ht?e.qr.rt(t):e.qr.et(t),n.isEqual(I.min()))return[3,13];s.label=7;case 7:return s.trys.push([7,11,,13]),[4,Si(e.localStore)];case 8:return i=s.sent(),n.compareTo(i)>=0?[4,function(e,t){var n=e.qr.ut(t);return n.targetChanges.forEach((function(n,r){if(n.resumeToken.approximateByteSize()>0){var i=e.Or.get(r);i&&e.Or.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach((function(t){var n=e.Or.get(t);if(n){e.Or.set(t,n.withResumeToken(x.EMPTY_BYTE_STRING,n.snapshotVersion)),So(e,t);var r=new mr(n.target,t,1,n.sequenceNumber);To(e,r)}})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)]:[3,10];case 9:s.sent(),s.label=10;case 10:return[3,13];case 11:return f("RemoteStore","Failed to raise snapshot:",o=s.sent()),[4,Po(e,o)];case 12:return s.sent(),[3,13];case 13:return[2]}}))}))}function Po(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r=this;return Object(a.c)(this,(function(i){switch(i.label){case 0:if(!sr(t))throw t;return e.$r.add(1),[4,bo(e)];case 1:return i.sent(),e.Br.set("Offline"),n||(n=function(){return Si(e.localStore)}),e.asyncQueue.enqueueRetryable((function(){return Object(a.a)(r,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return f("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return t.sent(),e.$r.delete(1),[4,_o(e)];case 2:return t.sent(),[2]}}))}))})),[2]}}))}))}function Do(e,t){return t().catch((function(n){return Po(e,n,t)}))}function xo(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n,r,i,o;return Object(a.c)(this,(function(a){switch(a.label){case 0:t=y(e),n=Go(t),r=t.kr.length>0?t.kr[t.kr.length-1].batchId:-1,a.label=1;case 1:if(!function(e){return Ao(e)&&e.kr.length<10}(t))return[3,7];a.label=2;case 2:return a.trys.push([2,4,,6]),[4,Ai(t.localStore,r)];case 3:return null===(i=a.sent())?(0===t.kr.length&&n.ir(),[3,7]):(r=i.batchId,function(e,t){e.kr.push(t);var n=Go(e);n.er()&&n.pr&&n.Er(t.mutations)}(t,i),[3,6]);case 4:return o=a.sent(),[4,Po(t,o)];case 5:return a.sent(),[3,6];case 6:return[3,1];case 7:return Lo(t)&&Mo(t),[2]}}))}))}function Lo(e){return Ao(e)&&!Go(e).tr()&&e.kr.length>0}function Mo(e){Go(e).start()}function Uo(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){return Go(e).Ar(),[2]}))}))}function jo(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n,r,i;return Object(a.c)(this,(function(o){for(t=Go(e),n=0,r=e.kr;n<r.length;n++)i=r[n],t.Er(i.mutations);return[2]}))}))}function Fo(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return r=e.kr.shift(),i=vr.from(r,t,n),[4,Do(e,(function(){return e.remoteSyncer.applySuccessfulWrite(i)}))];case 1:return o.sent(),[4,xo(e)];case 2:return o.sent(),[2]}}))}))}function Vo(e,t){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(n){switch(n.label){case 0:return t&&Go(e).pr?[4,function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:return Rt(r=t.code)&&r!==c.ABORTED?(n=e.kr.shift(),Go(e).sr(),[4,Do(e,(function(){return e.remoteSyncer.rejectFailedWrite(n.batchId,t)}))]):[3,3];case 1:return i.sent(),[4,xo(e)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}(e,t)]:[3,2];case 1:n.sent(),n.label=2;case 2:return Lo(e)&&Mo(e),[2]}}))}))}function Bo(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return n=y(e),t?(n.$r.delete(2),[4,_o(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return t?[3,4]:(n.$r.add(2),[4,bo(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}}))}))}function Wo(e){var t=this;return e.Ur||(e.Ur=function(e,t,n){var r=y(e);return r.br(),new po(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:ko.bind(null,e),Ri:Oo.bind(null,e),_r:No.bind(null,e)}),e.Mr.push((function(n){return Object(a.a)(t,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return n?(e.Ur.sr(),Ro(e)?Io(e):e.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,e.Ur.stop()];case 2:t.sent(),Co(e),t.label=3;case 3:return[2]}}))}))}))),e.Ur}function Go(e){var t=this;return e.Qr||(e.Qr=function(e,t,n){var r=y(e);return r.br(),new vo(t,r.Hi,r.credentials,r.R,n)}(e.datastore,e.asyncQueue,{Ii:Uo.bind(null,e),Ri:Vo.bind(null,e),Ir:jo.bind(null,e),Tr:Fo.bind(null,e)}),e.Mr.push((function(n){return Object(a.a)(t,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return n?(e.Qr.sr(),[4,xo(e)]):[3,2];case 1:return t.sent(),[3,4];case 2:return[4,e.Qr.stop()];case 3:t.sent(),e.kr.length>0&&(f("RemoteStore","Stopping write stream with "+e.kr.length+" pending writes"),e.kr=[]),t.label=4;case 4:return[2]}}))}))}))),e.Qr}var qo=function(){function e(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new tr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((function(e){}))}return e.createAndSchedule=function(t,n,r,i,o){var a=new e(t,n,Date.now()+r,i,o);return a.start(r),a},e.prototype.start=function(e){var t=this;this.timerHandle=setTimeout((function(){return t.handleDelayElapsed()}),e)},e.prototype.skipDelay=function(){return this.handleDelayElapsed()},e.prototype.cancel=function(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new u(c.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},e.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget((function(){return null!==e.timerHandle?(e.clearTimeout(),e.op().then((function(t){return e.deferred.resolve(t)}))):Promise.resolve()}))},e.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},e}();function Ko(e,t){if(h("AsyncQueue",t+": "+e),sr(e))return new u(c.UNAVAILABLE,t+": "+e);throw e}var Ho=function(){function e(e){this.comparator=e?function(t,n){return e(t,n)||K.comparator(t.key,n.key)}:function(e,t){return K.comparator(e.key,t.key)},this.keyedMap=Mt(),this.sortedSet=new Ct(this.comparator)}return e.emptySet=function(t){return new e(t.comparator)},e.prototype.has=function(e){return null!=this.keyedMap.get(e)},e.prototype.get=function(e){return this.keyedMap.get(e)},e.prototype.first=function(){return this.sortedSet.minKey()},e.prototype.last=function(){return this.sortedSet.maxKey()},e.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},e.prototype.indexOf=function(e){var t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1},Object.defineProperty(e.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e){this.sortedSet.inorderTraversal((function(t,n){return e(t),!1}))},e.prototype.add=function(e){var t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))},e.prototype.delete=function(e){var t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this},e.prototype.isEqual=function(t){if(!(t instanceof e))return!1;if(this.size!==t.size)return!1;for(var n=this.sortedSet.getIterator(),r=t.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},e.prototype.toString=function(){var e=[];return this.forEach((function(t){e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"},e.prototype.copy=function(t,n){var r=new e;return r.comparator=this.comparator,r.keyedMap=t,r.sortedSet=n,r},e}(),zo=function(){function e(){this.Kr=new Ct(K.comparator)}return e.prototype.track=function(e){var t=e.doc.key,n=this.Kr.get(t);n?0!==e.type&&3===n.type?this.Kr=this.Kr.insert(t,e):3===e.type&&1!==n.type?this.Kr=this.Kr.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Kr=this.Kr.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Kr=this.Kr.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Kr=this.Kr.remove(t):1===e.type&&2===n.type?this.Kr=this.Kr.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Kr=this.Kr.insert(t,{type:2,doc:e.doc}):m():this.Kr=this.Kr.insert(t,e)},e.prototype.jr=function(){var e=[];return this.Kr.inorderTraversal((function(t,n){e.push(n)})),e},e}(),Yo=function(){function e(e,t,n,r,i,o,a,s){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=s}return e.fromInitialDocuments=function(t,n,r,i){var o=[];return n.forEach((function(e){o.push({type:0,doc:e})})),new e(t,n,Ho.emptySet(n),o,r,i,!0,!1)},Object.defineProperty(e.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Fe(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0},e}(),Qo=function(){this.Wr=void 0,this.listeners=[]},Xo=function(){this.queries=new ni((function(e){return Ve(e)}),Fe),this.onlineState="Unknown",this.Gr=new Set};function Jo(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c,u;return Object(a.c)(this,(function(a){switch(a.label){case 0:if(n=y(e),r=t.query,i=!1,(o=n.queries.get(r))||(i=!0,o=new Qo),!i)return[3,4];a.label=1;case 1:return a.trys.push([1,3,,4]),s=o,[4,n.onListen(r)];case 2:return s.Wr=a.sent(),[3,4];case 3:return c=a.sent(),u=Ko(c,"Initialization of query '"+Be(t.query)+"' failed"),[2,void t.onError(u)];case 4:return n.queries.set(r,o),o.listeners.push(t),t.zr(n.onlineState),o.Wr&&t.Hr(o.Wr)&&ta(n),[2]}}))}))}function $o(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(a.c)(this,(function(a){return n=y(e),r=t.query,i=!1,(o=n.queries.get(r))&&(s=o.listeners.indexOf(t))>=0&&(o.listeners.splice(s,1),i=0===o.listeners.length),i?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]}))}))}function Zo(e,t){for(var n=y(e),r=!1,i=0,o=t;i<o.length;i++){var a=o[i],s=a.query,c=n.queries.get(s);if(c){for(var u=0,l=c.listeners;u<l.length;u++)l[u].Hr(a)&&(r=!0);c.Wr=a}}r&&ta(n)}function ea(e,t,n){var r=y(e),i=r.queries.get(t);if(i)for(var o=0,a=i.listeners;o<a.length;o++)a[o].onError(n);r.queries.delete(t)}function ta(e){e.Gr.forEach((function(e){e.next()}))}var na=function(){function e(e,t,n){this.query=e,this.Jr=t,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=n||{}}return e.prototype.Hr=function(e){if(!this.options.includeMetadataChanges){for(var t=[],n=0,r=e.docChanges;n<r.length;n++){var i=r[n];3!==i.type&&t.push(i)}e=new Yo(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var o=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),o=!0):this.eo(e,this.onlineState)&&(this.no(e),o=!0),this.Xr=e,o},e.prototype.onError=function(e){this.Jr.error(e)},e.prototype.zr=function(e){this.onlineState=e;var t=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),t=!0),t},e.prototype.eo=function(e,t){if(!e.fromCache)return!0;var n="Offline"!==t;return!(this.options.so&&n||e.docs.isEmpty()&&"Offline"!==t)},e.prototype.Zr=function(e){if(e.docChanges.length>0)return!0;var t=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges},e.prototype.no=function(e){e=Yo.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)},e}(),ra=function(){function e(e,t){this.payload=e,this.byteLength=t}return e.prototype.io=function(){return"metadata"in this.payload},e}(),ia=function(){function e(e){this.R=e}return e.prototype.qn=function(e){return un(this.R,e)},e.prototype.Un=function(e){return e.metadata.exists?vn(this.R,e.document,!1):se.newNoDocument(this.qn(e.metadata.name),this.Qn(e.metadata.readTime))},e.prototype.Qn=function(e){return on(e)},e}(),oa=function(){function e(e,t,n){this.ro=e,this.localStore=t,this.R=n,this.queries=[],this.documents=[],this.progress=aa(e)}return e.prototype.oo=function(e){this.progress.bytesLoaded+=e.byteLength;var t=this.progress.documentsLoaded;return e.payload.namedQuery?this.queries.push(e.payload.namedQuery):e.payload.documentMetadata?(this.documents.push({metadata:e.payload.documentMetadata}),e.payload.documentMetadata.exists||++t):e.payload.document&&(this.documents[this.documents.length-1].document=e.payload.document,++t),t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null},e.prototype.co=function(e){for(var t=new Map,n=new ia(this.R),r=0,i=e;r<i.length;r++){var o=i[r];if(o.metadata.queries)for(var a=n.qn(o.metadata.name),s=0,c=o.metadata.queries;s<c.length;s++){var u=c[s],l=(t.get(u)||Vt()).add(a);t.set(u,l)}}return t},e.prototype.complete=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t,n,r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return[4,xi(this.localStore,new ia(this.R),this.documents,this.ro.id)];case 1:e=o.sent(),t=this.co(this.documents),n=0,r=this.queries,o.label=2;case 2:return n<r.length?(i=r[n],[4,Li(this.localStore,i,t.get(i.name))]):[3,5];case 3:o.sent(),o.label=4;case 4:return n++,[3,2];case 5:return[2,(this.progress.taskState="Success",new mi(Object.assign({},this.progress),e))]}}))}))},e}();function aa(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}var sa=function(e){this.key=e},ca=function(e){this.key=e},ua=function(){function e(e,t){this.query=e,this.uo=t,this.ao=null,this.current=!1,this.ho=Vt(),this.mutatedKeys=Vt(),this.lo=Ge(e),this.fo=new Ho(this.lo)}return Object.defineProperty(e.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),e.prototype._o=function(e,t){var n=this,r=t?t.mo:new zo,i=t?t.fo:this.fo,o=t?t.mutatedKeys:this.mutatedKeys,a=i,s=!1,c=Ne(this.query)&&i.size===this.query.limit?i.last():null,u=Pe(this.query)&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((function(e,t){var l=i.get(e),d=We(n.query,t)?t:null,f=!!l&&n.mutatedKeys.has(l.key),h=!!d&&(d.hasLocalMutations||n.mutatedKeys.has(d.key)&&d.hasCommittedMutations),p=!1;l&&d?l.data.isEqual(d.data)?f!==h&&(r.track({type:3,doc:d}),p=!0):n.yo(l,d)||(r.track({type:2,doc:d}),p=!0,(c&&n.lo(d,c)>0||u&&n.lo(d,u)<0)&&(s=!0)):!l&&d?(r.track({type:0,doc:d}),p=!0):l&&!d&&(r.track({type:1,doc:l}),p=!0,(c||u)&&(s=!0)),p&&(d?(a=a.add(d),o=h?o.add(e):o.delete(e)):(a=a.delete(e),o=o.delete(e)))})),Ne(this.query)||Pe(this.query))for(;a.size>this.query.limit;){var l=Ne(this.query)?a.last():a.first();a=a.delete(l.key),o=o.delete(l.key),r.track({type:1,doc:l})}return{fo:a,mo:r,Nn:s,mutatedKeys:o}},e.prototype.yo=function(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations},e.prototype.applyChanges=function(e,t,n){var r=this,i=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;var o=e.mo.jr();o.sort((function(e,t){return function(e,t){var n=function(e){switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return m()}};return n(e)-n(t)}(e.type,t.type)||r.lo(e.doc,t.doc)})),this.po(n);var a=t?this.Eo():[],s=0===this.ho.size&&this.current?1:0,c=s!==this.ao;return this.ao=s,0!==o.length||c?{snapshot:new Yo(this.query,e.fo,i,o,e.mutatedKeys,0===s,c,!1),To:a}:{To:a}},e.prototype.zr=function(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({fo:this.fo,mo:new zo,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},e.prototype.Io=function(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations},e.prototype.po=function(e){var t=this;e&&(e.addedDocuments.forEach((function(e){return t.uo=t.uo.add(e)})),e.modifiedDocuments.forEach((function(e){})),e.removedDocuments.forEach((function(e){return t.uo=t.uo.delete(e)})),this.current=e.current)},e.prototype.Eo=function(){var e=this;if(!this.current)return[];var t=this.ho;this.ho=Vt(),this.fo.forEach((function(t){e.Io(t.key)&&(e.ho=e.ho.add(t.key))}));var n=[];return t.forEach((function(t){e.ho.has(t)||n.push(new ca(t))})),this.ho.forEach((function(e){t.has(e)||n.push(new sa(e))})),n},e.prototype.Ao=function(e){this.uo=e.Bn,this.ho=Vt();var t=this._o(e.documents);return this.applyChanges(t,!0)},e.prototype.Ro=function(){return Yo.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,0===this.ao)},e}(),la=function(e,t,n){this.query=e,this.targetId=t,this.view=n},da=function(e){this.key=e,this.bo=!1},fa=function(){function e(e,t,n,r,i,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.vo={},this.Po=new ni((function(e){return Ve(e)}),Fe),this.Vo=new Map,this.So=new Set,this.Do=new Ct(K.comparator),this.Co=new Map,this.No=new Ui,this.xo={},this.Fo=new Map,this.ko=qr.Yt(),this.onlineState="Unknown",this.Oo=void 0}return Object.defineProperty(e.prototype,"isPrimaryClient",{get:function(){return!0===this.Oo},enumerable:!1,configurable:!0}),e}();function ha(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c;return Object(a.c)(this,(function(a){switch(a.label){case 0:return n=Wa(e),(o=n.Po.get(t))?(r=o.targetId,n.sharedClientState.addLocalQueryTarget(r),i=o.view.Ro(),[3,4]):[3,1];case 1:return[4,Ci(n.localStore,Ue(t))];case 2:return s=a.sent(),c=n.sharedClientState.addLocalQueryTarget(s.targetId),r=s.targetId,[4,pa(n,t,r,"current"===c)];case 3:i=a.sent(),n.isPrimaryClient&&Eo(n.remoteStore,s),a.label=4;case 4:return[2,i]}}))}))}function pa(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o,s,c,u,l;return Object(a.c)(this,(function(d){switch(d.label){case 0:return e.$o=function(t,n,r){return function(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o,s;return Object(a.c)(this,(function(a){switch(a.label){case 0:return(i=t.view._o(n)).Nn?[4,Oi(e.localStore,t.query,!1).then((function(e){var n=e.documents;return t.view._o(n,i)}))]:[3,2];case 1:i=a.sent(),a.label=2;case 2:return o=r&&r.targetChanges.get(t.targetId),s=t.view.applyChanges(i,e.isPrimaryClient,o),[2,(Aa(e,t.targetId,s.To),s.snapshot)]}}))}))}(e,t,n,r)},[4,Oi(e.localStore,t,!0)];case 1:return i=d.sent(),o=new ua(t,i.Bn),s=o._o(i.documents),c=qt.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState),u=o.applyChanges(s,e.isPrimaryClient,c),Aa(e,n,u.To),l=new la(t,n,o),[2,(e.Po.set(t,l),e.Vo.has(n)?e.Vo.get(n).push(t):e.Vo.set(n,[t]),u.snapshot)]}}))}))}function va(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return n=y(e),r=n.Po.get(t),(i=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,i.filter((function(e){return!Fe(e,t)}))),void n.Po.delete(t))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,ki(n.localStore,r.targetId,!1).then((function(){n.sharedClientState.clearQueryState(r.targetId),wo(n.remoteStore,r.targetId),Ia(n,r.targetId)})).catch(Qr)]):[3,3];case 1:o.sent(),o.label=2;case 2:return[3,5];case 3:return Ia(n,r.targetId),[4,ki(n.localStore,r.targetId,!0)];case 4:o.sent(),o.label=5;case 5:return[2]}}))}))}function ma(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s;return Object(a.c)(this,(function(a){switch(a.label){case 0:r=Ga(e),a.label=1;case 1:return a.trys.push([1,5,,6]),[4,function(e,t){var n,r=y(e),i=S.now(),o=t.reduce((function(e,t){return e.add(t.key)}),Vt());return r.persistence.runTransaction("Locally write mutations","readwrite",(function(e){return r.Mn.pn(e,o).next((function(o){n=o;for(var a=[],s=0,c=t;s<c.length;s++){var u=c[s],l=ht(u,n.get(u.key));null!=l&&a.push(new gt(u.key,l,ae(l.toProto().mapValue),ct.exists(!0)))}return r._n.addMutationBatch(e,i,a,t)}))})).then((function(e){return e.applyToLocalDocumentSet(n),{batchId:e.batchId,changes:n}}))}(r.localStore,t)];case 2:return i=a.sent(),r.sharedClientState.addPendingMutation(i.batchId),function(e,t,n){var r=e.xo[e.currentUser.toKey()];r||(r=new Ct(E)),r=r.insert(t,n),e.xo[e.currentUser.toKey()]=r}(r,i.batchId,n),[4,Oa(r,i.changes)];case 3:return a.sent(),[4,xo(r.remoteStore)];case 4:return a.sent(),[3,6];case 5:return o=a.sent(),s=Ko(o,"Failed to persist write"),n.reject(s),[3,6];case 6:return[2]}}))}))}function ga(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:n=y(e),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,Ii(n.localStore,t)];case 2:return r=i.sent(),t.targetChanges.forEach((function(e,t){var r=n.Co.get(t);r&&(g(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.bo=!0:e.modifiedDocuments.size>0?g(r.bo):e.removedDocuments.size>0&&(g(r.bo),r.bo=!1))})),[4,Oa(n,r,t)];case 3:return i.sent(),[3,6];case 4:return[4,Qr(i.sent())];case 5:return i.sent(),[3,6];case 6:return[2]}}))}))}function ya(e,t,n){var r=y(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){var i=[];r.Po.forEach((function(e,n){var r=n.view.zr(t);r.snapshot&&i.push(r.snapshot)})),function(e,t){var n=y(e);n.onlineState=t;var r=!1;n.queries.forEach((function(e,n){for(var i=0,o=n.listeners;i<o.length;i++)o[i].zr(t)&&(r=!0)})),r&&ta(n)}(r.eventManager,t),i.length&&r.vo._r(i),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}function _a(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s,c,u;return Object(a.c)(this,(function(a){switch(a.label){case 0:return(r=y(e)).sharedClientState.updateQueryState(t,"rejected",n),i=r.Co.get(t),(o=i&&i.key)?(s=(s=new Ct(K.comparator)).insert(o,se.newNoDocument(o,I.min())),c=Vt().add(o),u=new Gt(I.min(),new Map,new Nt(E),s,c),[4,ga(r,u)]):[3,2];case 1:return a.sent(),r.Do=r.Do.remove(o),r.Co.delete(t),ka(r),[3,4];case 2:return[4,ki(r.localStore,t,!1).then((function(){return Ia(r,t,n)})).catch(Qr)];case 3:a.sent(),a.label=4;case 4:return[2]}}))}))}function ba(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:n=y(e),r=t.batch.batchId,o.label=1;case 1:return o.trys.push([1,4,,6]),[4,Ti(n.localStore,t)];case 2:return i=o.sent(),Sa(n,r,null),Ta(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Oa(n,i)];case 3:return o.sent(),[3,6];case 4:return[4,Qr(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function Ea(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:r=y(e),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,function(e,t){var n=y(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(function(e){var r;return n._n.lookupMutationBatch(e,t).next((function(t){return g(null!==t),r=t.keys(),n._n.removeMutationBatch(e,t)})).next((function(){return n._n.performConsistencyCheck(e)})).next((function(){return n.Mn.pn(e,r)}))}))}(r.localStore,t)];case 2:return i=o.sent(),Sa(r,t,n),Ta(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),[4,Oa(r,i)];case 3:return o.sent(),[3,6];case 4:return[4,Qr(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}}))}))}function wa(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s;return Object(a.c)(this,(function(a){switch(a.label){case 0:Ao((n=y(e)).remoteStore)||f("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,function(e){var t=y(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(function(e){return t._n.getHighestUnacknowledgedBatchId(e)}))}(n.localStore)];case 2:return-1===(r=a.sent())?[2,void t.resolve()]:((i=n.Fo.get(r)||[]).push(t),n.Fo.set(r,i),[3,4]);case 3:return o=a.sent(),s=Ko(o,"Initialization of waitForPendingWrites() operation failed"),t.reject(s),[3,4];case 4:return[2]}}))}))}function Ta(e,t){(e.Fo.get(t)||[]).forEach((function(e){e.resolve()})),e.Fo.delete(t)}function Sa(e,t,n){var r=y(e),i=r.xo[r.currentUser.toKey()];if(i){var o=i.get(t);o&&(n?o.reject(n):o.resolve(),i=i.remove(t)),r.xo[r.currentUser.toKey()]=i}}function Ia(e,t,n){void 0===n&&(n=null),e.sharedClientState.removeLocalQueryTarget(t);for(var r=0,i=e.Vo.get(t);r<i.length;r++){var o=i[r];e.Po.delete(o),n&&e.vo.Mo(o,n)}e.Vo.delete(t),e.isPrimaryClient&&e.No.Zn(t).forEach((function(t){e.No.containsKey(t)||Ra(e,t)}))}function Ra(e,t){e.So.delete(t.path.canonicalString());var n=e.Do.get(t);null!==n&&(wo(e.remoteStore,n),e.Do=e.Do.remove(t),e.Co.delete(n),ka(e))}function Aa(e,t,n){for(var r=0,i=n;r<i.length;r++){var o=i[r];o instanceof sa?(e.No.addReference(o.key,t),Ca(e,o)):o instanceof ca?(f("SyncEngine","Document no longer in limbo: "+o.key),e.No.removeReference(o.key,t),e.No.containsKey(o.key)||Ra(e,o.key)):m()}}function Ca(e,t){var n=t.key,r=n.path.canonicalString();e.Do.get(n)||e.So.has(r)||(f("SyncEngine","New document in limbo: "+n),e.So.add(r),ka(e))}function ka(e){for(;e.So.size>0&&e.Do.size<e.maxConcurrentLimboResolutions;){var t=e.So.values().next().value;e.So.delete(t);var n=new K(O.fromString(t)),r=e.ko.next();e.Co.set(r,new da(n)),e.Do=e.Do.insert(n,r),Eo(e.remoteStore,new mr(Ue(Oe(n.path)),r,2,s.o))}}function Oa(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s;return Object(a.c)(this,(function(c){switch(c.label){case 0:return r=y(e),i=[],o=[],s=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach((function(e,a){s.push(r.$o(a,t,n).then((function(e){if(e){r.isPrimaryClient&&r.sharedClientState.updateQueryState(a.targetId,e.fromCache?"not-current":"current"),i.push(e);var t=yi.Pn(a.targetId,e);o.push(t)}})))})),[4,Promise.all(s)]);case 1:return c.sent(),r.vo._r(i),[4,function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c,u,l,d;return Object(a.c)(this,(function(a){switch(a.label){case 0:n=y(e),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(function(e){return nr.forEach(t,(function(t){return nr.forEach(t.bn,(function(r){return n.persistence.referenceDelegate.addReference(e,t.targetId,r)})).next((function(){return nr.forEach(t.vn,(function(r){return n.persistence.referenceDelegate.removeReference(e,t.targetId,r)}))}))}))}))];case 2:return a.sent(),[3,4];case 3:if(!sr(r=a.sent()))throw r;return f("LocalStore","Failed to update sequence numbers: "+r),[3,4];case 4:for(i=0,o=t;i<o.length;i++)s=o[i],c=s.targetId,s.fromCache||(u=n.Fn.get(c),l=u.snapshotVersion,d=u.withLastLimboFreeSnapshotVersion(l),n.Fn=n.Fn.insert(c,d));return[2]}}))}))}(r.localStore,o)];case 2:c.sent(),c.label=3;case 3:return[2]}}))}))}function Na(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:return(n=y(e)).currentUser.isEqual(t)?[3,3]:(f("SyncEngine","User change. New user:",t.toKey()),[4,wi(n.localStore,t)]);case 1:return r=i.sent(),n.currentUser=t,function(e,t){e.Fo.forEach((function(e){e.forEach((function(e){e.reject(new u(c.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))}))})),e.Fo.clear()}(n),n.sharedClientState.handleUserChange(t,r.removedBatchIds,r.addedBatchIds),[4,Oa(n,r.Ln)];case 2:i.sent(),i.label=3;case 3:return[2]}}))}))}function Pa(e,t){var n=y(e),r=n.Co.get(t);if(r&&r.bo)return Vt().add(r.key);var i=Vt(),o=n.Vo.get(t);if(!o)return i;for(var a=0,s=o;a<s.length;a++){var c=s[a],u=n.Po.get(c);i=i.unionWith(u.view.wo)}return i}function Da(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return[4,Oi((n=y(e)).localStore,t.query,!0)];case 1:return r=o.sent(),i=t.view.Ao(r),[2,(n.isPrimaryClient&&Aa(n,t.targetId,i.To),i)]}}))}))}function xa(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){return[2,Pi((t=y(e)).localStore).then((function(e){return Oa(t,e)}))]}))}))}function La(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o;return Object(a.c)(this,(function(a){switch(a.label){case 0:return[4,function(e,t){var n=y(e),r=y(n._n);return n.persistence.runTransaction("Lookup mutation documents","readonly",(function(e){return r.jt(e,t).next((function(t){return t?n.Mn.pn(e,t):nr.resolve(null)}))}))}((i=y(e)).localStore,t)];case 1:return null===(o=a.sent())?[3,6]:"pending"!==n?[3,3]:[4,xo(i.remoteStore)];case 2:return a.sent(),[3,4];case 3:"acknowledged"===n||"rejected"===n?(Sa(i,t,r||null),Ta(i,t),function(e,t){y(y(e)._n).Gt(t)}(i.localStore,t)):m(),a.label=4;case 4:return[4,Oa(i,o)];case 5:return a.sent(),[3,7];case 6:f("SyncEngine","Cannot apply mutation batch with id: "+t),a.label=7;case 7:return[2]}}))}))}function Ma(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c,u,l;return Object(a.c)(this,(function(a){switch(a.label){case 0:return Wa(n=y(e)),Ga(n),!0!==t||!0===n.Oo?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,Ua(n,r.toArray())]);case 1:return i=a.sent(),n.Oo=!0,[4,Bo(n.remoteStore,!0)];case 2:for(a.sent(),o=0,s=i;o<s.length;o++)c=s[o],Eo(n.remoteStore,c);return[3,7];case 3:return!1!==t||!1===n.Oo?[3,7]:(u=[],l=Promise.resolve(),n.Vo.forEach((function(e,t){n.sharedClientState.isLocalQueryTarget(t)?u.push(t):l=l.then((function(){return Ia(n,t),ki(n.localStore,t,!0)})),wo(n.remoteStore,t)})),[4,l]);case 4:return a.sent(),[4,Ua(n,u)];case 5:return a.sent(),function(e){var t=y(e);t.Co.forEach((function(e,n){wo(t.remoteStore,n)})),t.No.ts(),t.Co=new Map,t.Do=new Ct(K.comparator)}(n),n.Oo=!1,[4,Bo(n.remoteStore,!1)];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))}function Ua(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c,u,l,d,f,h,p,v,m;return Object(a.c)(this,(function(a){switch(a.label){case 0:n=y(e),r=[],i=[],o=0,s=t,a.label=1;case 1:return o<s.length?(c=s[o],u=void 0,(l=n.Vo.get(c))&&0!==l.length?[4,Ci(n.localStore,Ue(l[0]))]:[3,7]):[3,13];case 2:u=a.sent(),d=0,f=l,a.label=3;case 3:return d<f.length?(h=f[d],p=n.Po.get(h),[4,Da(n,p)]):[3,6];case 4:(v=a.sent()).snapshot&&i.push(v.snapshot),a.label=5;case 5:return d++,[3,3];case 6:return[3,11];case 7:return[4,Ni(n.localStore,c)];case 8:return m=a.sent(),[4,Ci(n.localStore,m)];case 9:return u=a.sent(),[4,pa(n,ja(m),c,!1)];case 10:a.sent(),a.label=11;case 11:r.push(u),a.label=12;case 12:return o++,[3,1];case 13:return[2,(n.vo._r(i),r)]}}))}))}function ja(e){return ke(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Fa(e){var t=y(e);return y(y(t.localStore).persistence).fn()}function Va(e,t,n,r){return Object(a.a)(this,void 0,void 0,(function(){var i,o,s;return Object(a.c)(this,(function(a){switch(a.label){case 0:return(i=y(e)).Oo?(f("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!i.Vo.has(t))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,Pi(i.localStore)];case 3:return o=a.sent(),s=Gt.createSynthesizedRemoteEventForCurrentChange(t,"current"===n),[4,Oa(i,o,s)];case 4:return a.sent(),[3,8];case 5:return[4,ki(i.localStore,t,!0)];case 6:return a.sent(),Ia(i,t,r),[3,8];case 7:m(),a.label=8;case 8:return[2]}}))}))}function Ba(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s,c,u,l,d,h,p;return Object(a.c)(this,(function(v){switch(v.label){case 0:if(!(r=Wa(e)).Oo)return[3,10];i=0,o=t,v.label=1;case 1:return i<o.length?(s=o[i],r.Vo.has(s)?(f("SyncEngine","Adding an already active target "+s),[3,5]):[4,Ni(r.localStore,s)]):[3,6];case 2:return c=v.sent(),[4,Ci(r.localStore,c)];case 3:return u=v.sent(),[4,pa(r,ja(c),u.targetId,!1)];case 4:v.sent(),Eo(r.remoteStore,u),v.label=5;case 5:return i++,[3,1];case 6:l=function(e){return Object(a.c)(this,(function(t){switch(t.label){case 0:return r.Vo.has(e)?[4,ki(r.localStore,e,!1).then((function(){wo(r.remoteStore,e),Ia(r,e)})).catch(Qr)]:[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}}))},d=0,h=n,v.label=7;case 7:return d<h.length?(p=h[d],[5,l(p)]):[3,10];case 8:v.sent(),v.label=9;case 9:return d++,[3,7];case 10:return[2]}}))}))}function Wa(e){var t=y(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ga.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Pa.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=_a.bind(null,t),t.vo._r=Zo.bind(null,t.eventManager),t.vo.Mo=ea.bind(null,t.eventManager),t}function Ga(e){var t=y(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=ba.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=Ea.bind(null,t),t}function qa(e,t,n){var r=y(e);(function(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s,c,u;return Object(a.c)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,14,,15]),[4,t.getMetadata()];case 1:return r=a.sent(),[4,function(e,t){var n=y(e),r=on(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(function(e){return n.Qe.getBundleMetadata(e,t.id)})).then((function(e){return!!e&&e.createTime.compareTo(r)>=0}))}(e.localStore,r)];case 2:return a.sent()?[4,t.close()]:[3,4];case 3:return[2,(a.sent(),void n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)))];case 4:return n._updateProgress(aa(r)),i=new oa(r,e.localStore,t.R),[4,t.Lo()];case 5:o=a.sent(),a.label=6;case 6:return o?[4,i.oo(o)]:[3,10];case 7:return(s=a.sent())&&n._updateProgress(s),[4,t.Lo()];case 8:o=a.sent(),a.label=9;case 9:return[3,6];case 10:return[4,i.complete()];case 11:return c=a.sent(),[4,Oa(e,c.wn,void 0)];case 12:return a.sent(),[4,function(e,t){var n=y(e);return n.persistence.runTransaction("Save bundle","readwrite",(function(e){return n.Qe.saveBundleMetadata(e,t)}))}(e.localStore,r)];case 13:return a.sent(),n._completeWith(c.progress),[3,15];case 14:return p("SyncEngine","Loading bundle failed with "+(u=a.sent())),n._failWith(u),[3,15];case 15:return[2]}}))}))})(r,t,n).then((function(){r.sharedClientState.notifyBundleLoaded()}))}var Ka=function(){function e(){this.synchronizeTabs=!1}return e.prototype.initialize=function(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return this.R=lo(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return t.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Qo(e),[2]}}))}))},e.prototype.Uo=function(e){return null},e.prototype.Qo=function(e){return Ei(this.persistence,new _i,e.initialUser,this.R)},e.prototype.qo=function(e){return new Gi(Ki.bs,this.R)},e.prototype.Bo=function(e){return new no},e.prototype.terminate=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}}))}))},e}(),Ha=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Ko=t,i.cacheSizeBytes=n,i.forceOwnership=r,i.synchronizeTabs=!1,i}return Object(a.b)(t,e),t.prototype.initialize=function(t){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(n){switch(n.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return n.sent(),[4,Di(this.localStore)];case 2:return n.sent(),[4,this.Ko.initialize(this,t)];case 3:return n.sent(),[4,Ga(this.Ko.syncEngine)];case 4:return n.sent(),[4,xo(this.Ko.remoteStore)];case 5:return n.sent(),[2]}}))}))},t.prototype.Qo=function(e){return Ei(this.persistence,new _i,e.initialUser,this.R)},t.prototype.Uo=function(e){var t=this.persistence.referenceDelegate.garbageCollector;return new $r(t,e.asyncQueue)},t.prototype.qo=function(e){var t=vi(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?Mr.withCacheSize(this.cacheSizeBytes):Mr.DEFAULT;return new fi(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,co(),uo(),this.R,this.sharedClientState,!!this.forceOwnership)},t.prototype.Bo=function(e){return new no},t}(Ka),za=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n,!1)||this).Ko=t,r.cacheSizeBytes=n,r.synchronizeTabs=!0,r}return Object(a.b)(t,e),t.prototype.initialize=function(t){return Object(a.a)(this,void 0,void 0,(function(){var n,r=this;return Object(a.c)(this,(function(i){switch(i.label){case 0:return[4,e.prototype.initialize.call(this,t)];case 1:return i.sent(),n=this.Ko.syncEngine,this.sharedClientState instanceof to?(this.sharedClientState.syncEngine={ui:La.bind(null,n),ai:Va.bind(null,n),hi:Ba.bind(null,n),fn:Fa.bind(null,n),ci:xa.bind(null,n)},[4,this.sharedClientState.start()]):[3,3];case 2:i.sent(),i.label=3;case 3:return[4,this.persistence.He((function(e){return Object(a.a)(r,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return[4,Ma(this.Ko.syncEngine,e)];case 1:return t.sent(),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):e||this.gcScheduler.stop()),[2]}}))}))}))];case 4:return i.sent(),[2]}}))}))},t.prototype.Bo=function(e){var t=co();if(!to.yt(t))throw new u(c.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var n=vi(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new to(t,e.asyncQueue,n,e.clientId,e.initialUser)},t}(Ha),Ya=function(){function e(){}return e.prototype.initialize=function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n=this;return Object(a.c)(this,(function(r){switch(r.label){case 0:return this.localStore?[3,2]:(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(e){return ya(n.syncEngine,e,1)},this.remoteStore.remoteSyncer.handleCredentialChange=Na.bind(null,this.syncEngine),[4,Bo(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.createEventManager=function(e){return new Xo},e.prototype.createDatastore=function(e){var t,n=lo(e.databaseInfo.databaseId),r=(t=e.databaseInfo,new so(t));return function(e,t,n){return new mo(e,t,n)}(e.credentials,r,n)},e.prototype.createRemoteStore=function(e){var t,n,r,i,o,a=this;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=function(e){return ya(a.syncEngine,e,0)},o=io.yt()?new io:new ro,new yo(t,n,r,i,o)},e.prototype.createSyncEngine=function(e,t){return function(e,t,n,r,i,o,a){var s=new fa(e,t,n,r,i,o);return a&&(s.Oo=!0),s}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)},e.prototype.terminate=function(){return function(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=y(e),f("RemoteStore","RemoteStore shutting down."),t.$r.add(5),[4,bo(t)];case 1:return n.sent(),t.Lr.shutdown(),t.Br.set("Unknown"),[2]}}))}))}(this.remoteStore)},e}();function Qa(e,t){void 0===t&&(t=10240);var n=0;return{read:function(){return Object(a.a)(this,void 0,void 0,(function(){var r;return Object(a.c)(this,(function(i){return n<e.byteLength?(r={value:e.slice(n,n+t),done:!1},[2,(n+=t,r)]):[2,{done:!0}]}))}))},cancel:function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){return[2]}))}))},releaseLock:function(){},closed:Promise.reject("unimplemented")}}var Xa=function(){function e(e){this.observer=e,this.muted=!1}return e.prototype.next=function(e){this.observer.next&&this.jo(this.observer.next,e)},e.prototype.error=function(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},e.prototype.Wo=function(){this.muted=!0},e.prototype.jo=function(e,t){var n=this;this.muted||setTimeout((function(){n.muted||e(t)}),0)},e}(),Ja=function(){function e(e,t){var n=this;this.Go=e,this.R=t,this.metadata=new tr,this.buffer=new Uint8Array,this.zo=new TextDecoder("utf-8"),this.Ho().then((function(e){e&&e.io()?n.metadata.resolve(e.payload.metadata):n.metadata.reject(new Error("The first element of the bundle is not a metadata, it is\n             "+JSON.stringify(null==e?void 0:e.payload)))}),(function(e){return n.metadata.reject(e)}))}return e.prototype.close=function(){return this.Go.cancel()},e.prototype.getMetadata=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){return[2,this.metadata.promise]}))}))},e.prototype.Lo=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return[4,this.getMetadata()];case 1:return[2,(e.sent(),this.Ho())]}}))}))},e.prototype.Ho=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t,n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:return[4,this.Jo()];case 1:return null===(e=i.sent())?[2,null]:(t=this.zo.decode(e),n=Number(t),isNaN(n)&&this.Yo("length string ("+t+") is not valid number"),[4,this.Xo(n)]);case 2:return r=i.sent(),[2,new ra(JSON.parse(r),e.length+n)]}}))}))},e.prototype.Zo=function(){return this.buffer.findIndex((function(e){return e==="{".charCodeAt(0)}))},e.prototype.Jo=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return this.Zo()<0?[4,this.tc()]:[3,3];case 1:if(n.sent())return[3,3];n.label=2;case 2:return[3,0];case 3:return 0===this.buffer.length?[2,null]:((e=this.Zo())<0&&this.Yo("Reached the end of bundle when a length string is expected."),t=this.buffer.slice(0,e),[2,(this.buffer=this.buffer.slice(e),t)])}}))}))},e.prototype.Xo=function(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return this.buffer.length<e?[4,this.tc()]:[3,3];case 1:n.sent()&&this.Yo("Reached the end of bundle when more is expected."),n.label=2;case 2:return[3,0];case 3:return t=this.zo.decode(this.buffer.slice(0,e)),[2,(this.buffer=this.buffer.slice(e),t)]}}))}))},e.prototype.Yo=function(e){throw this.Go.cancel(),new Error("Invalid bundle format: "+e)},e.prototype.tc=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return[4,this.Go.read()];case 1:return(e=n.sent()).done||((t=new Uint8Array(this.buffer.length+e.value.length)).set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t),[2,e.done]}}))}))},e}(),$a=function(){function e(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return e.prototype.lookup=function(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n=this;return Object(a.c)(this,(function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new u(c.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i,o,s,c;return Object(a.c)(this,(function(a){switch(a.label){case 0:return n=y(e),r=fn(n.R)+"/documents",i={documents:t.map((function(e){return cn(n.R,e)}))},[4,n.Oi("BatchGetDocuments",r,i)];case 1:return o=a.sent(),s=new Map,o.forEach((function(e){var t=function(e,t){return"found"in t?function(e,t){g(!!t.found),t.found.name,t.found.updateTime;var n=un(e,t.found.name),r=on(t.found.updateTime),i=new oe({mapValue:{fields:t.found.fields}});return se.newFoundDocument(n,r,i)}(e,t):"missing"in t?function(e,t){g(!!t.missing),g(!!t.readTime);var n=un(e,t.missing),r=on(t.readTime);return se.newNoDocument(n,r)}(e,t):m()}(n.R,e);s.set(t.key.toString(),t)})),c=[],[2,(t.forEach((function(e){var t=s.get(e.toString());g(!!t),c.push(t)})),c)]}}))}))}(this.datastore,e)];case 1:return[2,((t=r.sent()).forEach((function(e){return n.recordVersion(e)})),t)]}}))}))},e.prototype.set=function(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.update=function(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())},e.prototype.delete=function(e){this.write(new Tt(e,this.precondition(e))),this.writtenDocs.add(e.toString())},e.prototype.commit=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t=this;return Object(a.c)(this,(function(n){switch(n.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach((function(t){e.delete(t.key.toString())})),e.forEach((function(e,n){var r=K.fromPath(n);t.mutations.push(new St(r,t.precondition(r)))})),[4,function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return n=y(e),r=fn(n.R)+"/documents",i={writes:t.map((function(e){return mn(n.R,e)}))},[4,n.Ni("Commit",r,i)];case 1:return o.sent(),[2]}}))}))}(this.datastore,this.mutations)];case 1:return n.sent(),this.committed=!0,[2]}}))}))},e.prototype.recordVersion=function(e){var t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw m();t=I.min()}var n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new u(c.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)},e.prototype.precondition=function(e){var t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?ct.updateTime(t):ct.none()},e.prototype.preconditionForUpdate=function(e){var t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(I.min()))throw new u(c.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return ct.updateTime(t)}return ct.exists(!0)},e.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations.push(e)},e.prototype.ensureCommitNotCalled=function(){},e}(),Za=function(){function e(e,t,n,r){this.asyncQueue=e,this.datastore=t,this.updateFunction=n,this.deferred=r,this.ec=5,this.Zi=new fo(this.asyncQueue,"transaction_retry")}return e.prototype.run=function(){this.nc()},e.prototype.nc=function(){var e=this;this.Zi.ji((function(){return Object(a.a)(e,void 0,void 0,(function(){var e,t,n=this;return Object(a.c)(this,(function(r){return e=new $a(this.datastore),(t=this.sc(e))&&t.then((function(t){n.asyncQueue.enqueueAndForget((function(){return e.commit().then((function(){n.deferred.resolve(t)})).catch((function(e){n.ic(e)}))}))})).catch((function(e){n.ic(e)})),[2]}))}))}))},e.prototype.sc=function(e){try{var t=this.updateFunction(e);return!W(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}},e.prototype.ic=function(e){var t=this;this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget((function(){return t.nc(),Promise.resolve()}))):this.deferred.reject(e)},e.prototype.rc=function(e){if("FirebaseError"===e.name){var t=e.code;return"aborted"===t||"failed-precondition"===t||!Rt(t)}return!1},e}(),es=function(){function e(e,t,n){var r=this;this.credentials=e,this.asyncQueue=t,this.databaseInfo=n,this.user=Hi.UNAUTHENTICATED,this.clientId=b.u(),this.credentialListener=function(){},this.receivedInitialUser=new tr,this.credentials.setChangeListener((function(e){f("FirestoreClient","Received user=",e.uid),r.user=e,r.credentialListener(e),r.receivedInitialUser.resolve()}))}return e.prototype.getConfiguration=function(){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return[4,this.receivedInitialUser.promise];case 1:return[2,(e.sent(),{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100})]}}))}))},e.prototype.setCredentialChangeListener=function(e){var t=this;this.credentialListener=e,this.receivedInitialUser.promise.then((function(){return t.credentialListener(t.user)}))},e.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new u(c.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var t=new tr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((function(){return Object(a.a)(e,void 0,void 0,(function(){var e,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:r.sent(),r.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:r.sent(),r.label=4;case 4:return this.credentials.removeChangeListener(),t.resolve(),[3,6];case 5:return e=r.sent(),n=Ko(e,"Failed to shutdown persistence"),t.reject(n),[3,6];case 6:return[2]}}))}))})),t.promise},e}();function ts(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r,i=this;return Object(a.c)(this,(function(o){switch(o.label){case 0:return e.asyncQueue.verifyOperationInProgress(),f("FirestoreClient","Initializing OfflineComponentProvider"),[4,e.getConfiguration()];case 1:return n=o.sent(),[4,t.initialize(n)];case 2:return o.sent(),r=n.initialUser,e.setCredentialChangeListener((function(n){r.isEqual(n)||(r=n,e.asyncQueue.enqueueRetryable((function(){return Object(a.a)(i,void 0,void 0,(function(){return Object(a.c)(this,(function(e){switch(e.label){case 0:return[4,wi(t.localStore,n)];case 1:return e.sent(),[2]}}))}))})))})),t.persistence.setDatabaseDeletedListener((function(){return e.terminate()})),e.offlineComponents=t,[2]}}))}))}function ns(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:return e.asyncQueue.verifyOperationInProgress(),[4,rs(e)];case 1:return n=i.sent(),f("FirestoreClient","Initializing OnlineComponentProvider"),[4,e.getConfiguration()];case 2:return r=i.sent(),[4,t.initialize(n,r)];case 3:return i.sent(),e.setCredentialChangeListener((function(n){return e.asyncQueue.enqueueRetryable((function(){return function(e,t){return Object(a.a)(this,void 0,void 0,(function(){var n,r;return Object(a.c)(this,(function(i){switch(i.label){case 0:return(n=y(e)).asyncQueue.verifyOperationInProgress(),f("RemoteStore","RemoteStore received new credentials"),r=Ao(n),n.$r.add(3),[4,bo(n)];case 1:return i.sent(),r&&n.Br.set("Unknown"),[4,n.remoteSyncer.handleCredentialChange(t)];case 2:return i.sent(),n.$r.delete(3),[4,_o(n)];case 3:return i.sent(),[2]}}))}))}(t.remoteStore,n)}))})),e.onlineComponents=t,[2]}}))}))}function rs(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return e.offlineComponents?[3,2]:(f("FirestoreClient","Using default OfflineComponentProvider"),[4,ts(e,new Ka)]);case 1:t.sent(),t.label=2;case 2:return[2,e.offlineComponents]}}))}))}function is(e){return Object(a.a)(this,void 0,void 0,(function(){return Object(a.c)(this,(function(t){switch(t.label){case 0:return e.onlineComponents?[3,2]:(f("FirestoreClient","Using default OnlineComponentProvider"),[4,ns(e,new Ya)]);case 1:t.sent(),t.label=2;case 2:return[2,e.onlineComponents]}}))}))}function os(e){return rs(e).then((function(e){return e.persistence}))}function as(e){return rs(e).then((function(e){return e.localStore}))}function ss(e){return is(e).then((function(e){return e.remoteStore}))}function cs(e){return is(e).then((function(e){return e.syncEngine}))}function us(e){return Object(a.a)(this,void 0,void 0,(function(){var t,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return[4,is(e)];case 1:return t=r.sent(),[2,((n=t.eventManager).onListen=ha.bind(null,t.syncEngine),n.onUnlisten=va.bind(null,t.syncEngine),n)]}}))}))}function ls(e,t,n){var r=this;void 0===n&&(n={});var i=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(r,void 0,void 0,(function(){var r;return Object(a.c)(this,(function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new Xa({next:function(o){t.enqueueAndForget((function(){return $o(e,a)}));var s=o.docs.has(n);!s&&o.fromCache?i.reject(new u(c.UNAVAILABLE,"Failed to get document because the client is offline.")):s&&o.fromCache&&r&&"server"===r.source?i.reject(new u(c.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(o)},error:function(e){return i.reject(e)}}),a=new na(Oe(n.path),o,{includeMetadataChanges:!0,so:!0});return Jo(e,a)},[4,us(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}}))}))})),i.promise}function ds(e,t,n){var r=this;void 0===n&&(n={});var i=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(r,void 0,void 0,(function(){var r;return Object(a.c)(this,(function(o){switch(o.label){case 0:return r=function(e,t,n,r,i){var o=new Xa({next:function(n){t.enqueueAndForget((function(){return $o(e,a)})),n.fromCache&&"server"===r.source?i.reject(new u(c.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:function(e){return i.reject(e)}}),a=new na(n,o,{includeMetadataChanges:!0,so:!0});return Jo(e,a)},[4,us(e)];case 1:return[2,r.apply(void 0,[o.sent(),e.asyncQueue,t,n,i])]}}))}))})),i.promise}var fs=function(e,t,n,r,i,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=a},hs=function(){function e(e,t){this.projectId=e,this.database=t||"(default)"}return Object.defineProperty(e.prototype,"isDefaultDatabase",{get:function(){return"(default)"===this.database},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){return t instanceof e&&t.projectId===this.projectId&&t.database===this.database},e}(),ps=new Map,vs=function(e,t){this.user=t,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+e},ms=function(){function e(){this.changeListener=null}return e.prototype.getToken=function(){return Promise.resolve(null)},e.prototype.invalidateToken=function(){},e.prototype.setChangeListener=function(e){this.changeListener=e,e(Hi.UNAUTHENTICATED)},e.prototype.removeChangeListener=function(){this.changeListener=null},e}(),gs=function(){function e(e){var t=this;this.oc=null,this.currentUser=Hi.UNAUTHENTICATED,this.receivedInitialUser=!1,this.cc=0,this.changeListener=null,this.forceRefresh=!1,this.oc=function(){t.cc++,t.currentUser=t.uc(),t.receivedInitialUser=!0,t.changeListener&&t.changeListener(t.currentUser)},this.cc=0,this.auth=e.getImmediate({optional:!0}),this.auth?this.auth.addAuthTokenListener(this.oc):(this.oc(null),e.get().then((function(e){t.auth=e,t.oc&&t.auth.addAuthTokenListener(t.oc)}),(function(){})))}return e.prototype.getToken=function(){var e=this,t=this.cc,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then((function(n){return e.cc!==t?(f("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):n?(g("string"==typeof n.accessToken),new vs(n.accessToken,e.currentUser)):null})):Promise.resolve(null)},e.prototype.invalidateToken=function(){this.forceRefresh=!0},e.prototype.setChangeListener=function(e){this.changeListener=e,this.receivedInitialUser&&e(this.currentUser)},e.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.oc),this.oc=null,this.changeListener=null},e.prototype.uc=function(){var e=this.auth&&this.auth.getUid();return g(null===e||"string"==typeof e),new Hi(e)},e}(),ys=function(){function e(e,t,n){this.ac=e,this.hc=t,this.lc=n,this.type="FirstParty",this.user=Hi.FIRST_PARTY}return Object.defineProperty(e.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.hc},t=this.ac.auth.getAuthHeaderValueForFirstParty([]);return t&&(e.Authorization=t),this.lc&&(e["X-Goog-Iam-Authorization-Token"]=this.lc),e},enumerable:!1,configurable:!0}),e}(),_s=function(){function e(e,t,n){this.ac=e,this.hc=t,this.lc=n}return e.prototype.getToken=function(){return Promise.resolve(new ys(this.ac,this.hc,this.lc))},e.prototype.setChangeListener=function(e){e(Hi.FIRST_PARTY)},e.prototype.removeChangeListener=function(){},e.prototype.invalidateToken=function(){},e}();function bs(e,t,n){if(!n)throw new u(c.INVALID_ARGUMENT,"Function "+e+"() cannot be called with an empty "+t+".")}function Es(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new u(c.INVALID_ARGUMENT,"Invalid options passed to function "+e+'(): You cannot specify both "merge" and "mergeFields".');return t}function ws(e,t,n,r){if(!0===t&&!0===r)throw new u(c.INVALID_ARGUMENT,e+" and "+n+" cannot be used together.")}function Ts(e){if(!K.isDocumentKey(e))throw new u(c.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e+" has "+e.length+".")}function Ss(e){if(K.isDocumentKey(e))throw new u(c.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e+" has "+e.length+".")}function Is(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=e.substring(0,20)+"..."),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";var t=function(e){if(e.constructor){var t=/function\s+([^\s(]+)\s*\(/.exec(e.constructor.toString());if(t&&t.length>1)return t[1]}return null}(e);return t?"a custom "+t+" object":"an object"}return"function"==typeof e?"a function":m()}function Rs(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new u(c.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Is(e);throw new u(c.INVALID_ARGUMENT,"Expected type '"+t.name+"', but it was: "+n)}return e}function As(e,t){if(t<=0)throw new u(c.INVALID_ARGUMENT,"Function "+e+"() requires a positive number, but it was: "+t+".")}var Cs=function(){function e(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new u(c.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new u(c.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,ws("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return e.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties},e}(),ks=function(){function e(e,t){this._persistenceKey="(lite)",this._settings=new Cs({}),this._settingsFrozen=!1,e instanceof hs?(this._databaseId=e,this._credentials=new ms):(this._app=e,this._databaseId=function(e){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new u(c.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new hs(e.options.projectId)}(e),this._credentials=new gs(t))}return Object.defineProperty(e.prototype,"app",{get:function(){if(!this._app)throw new u(c.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_terminated",{get:function(){return void 0!==this._terminateTask},enumerable:!1,configurable:!0}),e.prototype._setSettings=function(e){if(this._settingsFrozen)throw new u(c.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Cs(e),void 0!==e.credentials&&(this._credentials=function(e){if(!e)return new ms;switch(e.type){case"gapi":var t=e.client;return g(!("object"!=typeof t||null===t||!t.auth||!t.auth.getAuthHeaderValueForFirstParty)),new _s(t,e.sessionIndex||"0",e.iamToken||null);case"provider":return e.client;default:throw new u(c.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},e.prototype._getSettings=function(){return this._settings},e.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},e.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},e.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},e.prototype._terminate=function(){return this,(e=ps.get(this))&&(f("ComponentProvider","Removing Datastore"),ps.delete(this),e.terminate()),Promise.resolve();var e},e}(),Os=function(){function e(e,t,n){this._converter=t,this._key=n,this.type="document",this.firestore=e}return Object.defineProperty(e.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new Ps(this.firestore,this._converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(t){return new e(this.firestore,t,this._key)},e}(),Ns=function(){function e(e,t,n){this._converter=t,this._query=n,this.type="query",this.firestore=e}return e.prototype.withConverter=function(t){return new e(this.firestore,t,this._query)},e}(),Ps=function(e){function t(t,n,r){var i=this;return(i=e.call(this,t,n,Oe(r))||this)._path=r,i.type="collection",i}return Object(a.b)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._path.popLast();return e.isEmpty()?null:new Os(this.firestore,null,new K(e))},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._path)},t}(Ns);function Ds(e,t){for(var n,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(e=Object(r.p)(e),bs("collection","path",t),e instanceof ks)return Ss(n=O.fromString.apply(O,Object(a.d)([t],i))),new Ps(e,null,n);if(!(e instanceof Os||e instanceof Ps))throw new u(c.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ss(n=O.fromString.apply(O,Object(a.d)([e.path],i)).child(O.fromString(t))),new Ps(e.firestore,null,n)}function xs(e,t){for(var n,i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];if(e=Object(r.p)(e),1===arguments.length&&(t=b.u()),bs("doc","path",t),e instanceof ks)return Ts(n=O.fromString.apply(O,Object(a.d)([t],i))),new Os(e,null,new K(n));if(!(e instanceof Os||e instanceof Ps))throw new u(c.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return Ts(n=e._path.child(O.fromString.apply(O,Object(a.d)([t],i)))),new Os(e.firestore,e instanceof Ps?e._converter:null,new K(n))}function Ls(e,t){return e=Object(r.p)(e),t=Object(r.p)(t),(e instanceof Os||e instanceof Ps)&&(t instanceof Os||t instanceof Ps)&&e.firestore===t.firestore&&e.path===t.path&&e._converter===t._converter}function Ms(e,t){return e=Object(r.p)(e),t=Object(r.p)(t),e instanceof Ns&&t instanceof Ns&&e.firestore===t.firestore&&Fe(e._query,t._query)&&e._converter===t._converter}var Us=function(){function e(){var e=this;this.fc=Promise.resolve(),this.dc=[],this.wc=!1,this._c=[],this.mc=null,this.yc=!1,this.gc=[],this.Zi=new fo(this,"async_queue_retry"),this.Ec=function(){var t=uo();t&&f("AsyncQueue","Visibility state changed to "+t.visibilityState),e.Zi.Gi()};var t=uo();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Ec)}return Object.defineProperty(e.prototype,"isShuttingDown",{get:function(){return this.wc},enumerable:!1,configurable:!0}),e.prototype.enqueueAndForget=function(e){this.enqueue(e)},e.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.Tc(),this.Ic(e)},e.prototype.enterRestrictedMode=function(){if(!this.wc){this.wc=!0;var e=uo();e&&"function"==typeof e.removeEventListener&&e.removeEventListener("visibilitychange",this.Ec)}},e.prototype.enqueue=function(e){return this.Tc(),this.wc?new Promise((function(e){})):this.Ic(e)},e.prototype.enqueueRetryable=function(e){var t=this;this.enqueueAndForget((function(){return t.dc.push(e),t.Ac()}))},e.prototype.Ac=function(){return Object(a.a)(this,void 0,void 0,(function(){var e,t=this;return Object(a.c)(this,(function(n){switch(n.label){case 0:if(0===this.dc.length)return[3,5];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,this.dc[0]()];case 2:return n.sent(),this.dc.shift(),this.Zi.reset(),[3,4];case 3:if(!sr(e=n.sent()))throw e;return f("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.dc.length>0&&this.Zi.ji((function(){return t.Ac()})),n.label=5;case 5:return[2]}}))}))},e.prototype.Ic=function(e){var t=this,n=this.fc.then((function(){return t.yc=!0,e().catch((function(e){throw t.mc=e,t.yc=!1,h("INTERNAL UNHANDLED ERROR: ",function(e){var t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e)),e})).then((function(e){return t.yc=!1,e}))}));return this.fc=n,n},e.prototype.enqueueAfterDelay=function(e,t,n){var r=this;this.Tc(),this.gc.indexOf(e)>-1&&(t=0);var i=qo.createAndSchedule(this,e,t,n,(function(e){return r.Rc(e)}));return this._c.push(i),i},e.prototype.Tc=function(){this.mc&&m()},e.prototype.verifyOperationInProgress=function(){},e.prototype.bc=function(){return Object(a.a)(this,void 0,void 0,(function(){var e;return Object(a.c)(this,(function(t){switch(t.label){case 0:return[4,e=this.fc];case 1:t.sent(),t.label=2;case 2:if(e!==this.fc)return[3,0];t.label=3;case 3:return[2]}}))}))},e.prototype.vc=function(e){for(var t=0,n=this._c;t<n.length;t++)if(n[t].timerId===e)return!0;return!1},e.prototype.Pc=function(e){var t=this;return this.bc().then((function(){t._c.sort((function(e,t){return e.targetTimeMs-t.targetTimeMs}));for(var n=0,r=t._c;n<r.length;n++){var i=r[n];if(i.skipDelay(),"all"!==e&&i.timerId===e)break}return t.bc()}))},e.prototype.Vc=function(e){this.gc.push(e)},e.prototype.Rc=function(e){var t=this._c.indexOf(e);this._c.splice(t,1)},e}();function js(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(var n=e,r=0,i=["next","error","complete"];r<i.length;r++){var o=i[r];if(o in n&&"function"==typeof n[o])return!0}return!1}(e)}var Fs=function(){function e(){this._progressObserver={},this._taskCompletionResolver=new tr,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}return e.prototype.onProgress=function(e,t,n){this._progressObserver={next:e,error:t,complete:n}},e.prototype.catch=function(e){return this._taskCompletionResolver.promise.catch(e)},e.prototype.then=function(e,t){return this._taskCompletionResolver.promise.then(e,t)},e.prototype._completeWith=function(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)},e.prototype._failWith=function(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)},e.prototype._updateProgress=function(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)},e}(),Vs=-1,Bs=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this)._queue=new Us,r._persistenceKey="name"in t?t.name:"[DEFAULT]",r}return Object(a.b)(t,e),t.prototype._terminate=function(){return this._firestoreClient||Gs(this),this._firestoreClient.terminate()},t}(ks);function Ws(e){return e._firestoreClient||Gs(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function Gs(e){var t,n=e._freezeSettings(),r=function(e,t,n,r){return new fs(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,n);e._firestoreClient=new es(e._credentials,e._queue,r)}function qs(e,t,n){var r=this,i=new tr;return e.asyncQueue.enqueue((function(){return Object(a.a)(r,void 0,void 0,(function(){var r;return Object(a.c)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,4]),[4,ts(e,n)];case 1:return o.sent(),[4,ns(e,t)];case 2:return o.sent(),i.resolve(),[3,4];case 3:if(!function(e){return"FirebaseError"===e.name?e.code===c.FAILED_PRECONDITION||e.code===c.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(r=o.sent()))throw r;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+r),i.reject(r),[3,4];case 4:return[2]}}))}))})).then((function(){return i.promise}))}function Ks(e){if(e._initialized||e._terminated)throw new u(c.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Hs=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0;n<e.length;++n)if(0===e[n].length)throw new u(c.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new P(e)}return e.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},e}(),zs=function(){function e(e){this._byteString=e}return e.fromBase64String=function(t){try{return new e(x.fromBase64String(t))}catch(t){throw new u(c.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}},e.fromUint8Array=function(t){return new e(x.fromUint8Array(t))},e.prototype.toBase64=function(){return this._byteString.toBase64()},e.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},e.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},e.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},e}(),Ys=function(e){this._methodName=e},Qs=function(){function e(e,t){if(!isFinite(e)||e<-90||e>90)throw new u(c.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new u(c.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}return Object.defineProperty(e.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},e.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},e.prototype._compareTo=function(e){return E(this._lat,e._lat)||E(this._long,e._long)},e}(),Xs=/^__.*__$/,Js=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return null!==this.fieldMask?new gt(e,this.data,this.fieldMask,t,this.fieldTransforms):new mt(e,this.data,t,this.fieldTransforms)},e}(),$s=function(){function e(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}return e.prototype.toMutation=function(e,t){return new gt(e,this.data,this.fieldMask,t,this.fieldTransforms)},e}();function Zs(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw m()}}var ec=function(){function e(e,t,n,r,i,o){this.settings=e,this.databaseId=t,this.R=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Sc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}return Object.defineProperty(e.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"Dc",{get:function(){return this.settings.Dc},enumerable:!1,configurable:!0}),e.prototype.Cc=function(t){return new e(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},e.prototype.Nc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Cc({path:n,xc:!1});return r.Fc(e),r},e.prototype.kc=function(e){var t,n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Cc({path:n,xc:!1});return r.Sc(),r},e.prototype.Oc=function(e){return this.Cc({path:void 0,xc:!0})},e.prototype.$c=function(e){return bc(e,this.settings.methodName,this.settings.Mc||!1,this.path,this.settings.Lc)},e.prototype.contains=function(e){return void 0!==this.fieldMask.find((function(t){return e.isPrefixOf(t)}))||void 0!==this.fieldTransforms.find((function(t){return e.isPrefixOf(t.field)}))},e.prototype.Sc=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.Fc(this.path.get(e))},e.prototype.Fc=function(e){if(0===e.length)throw this.$c("Document fields must not be empty");if(Zs(this.Dc)&&Xs.test(e))throw this.$c('Document fields cannot begin and end with "__"')},e}(),tc=function(){function e(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.R=n||lo(e)}return e.prototype.Bc=function(e,t,n,r){return void 0===r&&(r=!1),new ec({Dc:e,methodName:t,Lc:n,path:P.emptyPath(),xc:!1,Mc:r},this.databaseId,this.R,this.ignoreUndefinedProperties)},e}();function nc(e){var t=e._freezeSettings(),n=lo(e._databaseId);return new tc(e._databaseId,!!t.ignoreUndefinedProperties,n)}function rc(e,t,n,r,i,o){void 0===o&&(o={});var a=e.Bc(o.merge||o.mergeFields?2:0,t,n,i);mc("Data must be an object, but it was:",a,r);var s,l,d=pc(r,a);if(o.merge)s=new D(a.fieldMask),l=a.fieldTransforms;else if(o.mergeFields){for(var f=[],h=0,p=o.mergeFields;h<p.length;h++){var v=gc(t,p[h],n);if(!a.contains(v))throw new u(c.INVALID_ARGUMENT,"Field '"+v+"' is specified in your field mask but missing from your input data.");Ec(f,v)||f.push(v)}s=new D(f),l=a.fieldTransforms.filter((function(e){return s.covers(e.field)}))}else s=null,l=a.fieldTransforms;return new Js(new oe(d),s,l)}var ic=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype._toFieldTransform=function(e){if(2!==e.Dc)throw 1===e.Dc?e.$c(this._methodName+"() can only appear at the top level of your update data"):e.$c(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return e.fieldMask.push(e.path),null},t.prototype.isEqual=function(e){return e instanceof t},t}(Ys);function oc(e,t,n){return new ec({Dc:3,Lc:t.settings.Lc,methodName:e._methodName,xc:n},t.databaseId,t.R,t.ignoreUndefinedProperties)}var ac=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype._toFieldTransform=function(e){return new at(e.path,new $e)},t.prototype.isEqual=function(e){return e instanceof t},t}(Ys),sc=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).qc=n,r}return Object(a.b)(t,e),t.prototype._toFieldTransform=function(e){var t=oc(this,e,!0),n=this.qc.map((function(e){return hc(e,t)})),r=new Ze(n);return new at(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Ys),cc=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).qc=n,r}return Object(a.b)(t,e),t.prototype._toFieldTransform=function(e){var t=oc(this,e,!0),n=this.qc.map((function(e){return hc(e,t)})),r=new tt(n);return new at(e.path,r)},t.prototype.isEqual=function(e){return this===e},t}(Ys),uc=function(e){function t(t,n){var r=this;return(r=e.call(this,t)||this).Uc=n,r}return Object(a.b)(t,e),t.prototype._toFieldTransform=function(e){var t=new rt(e.R,ze(e.R,this.Uc));return new at(e.path,t)},t.prototype.isEqual=function(e){return this===e},t}(Ys);function lc(e,t,n,i){var o=e.Bc(1,t,n);mc("Data must be an object, but it was:",o,i);var a=[],s=oe.empty();A(i,(function(e,i){var c=_c(t,e,n);i=Object(r.p)(i);var u=o.kc(c);if(i instanceof ic)a.push(c);else{var l=hc(i,u);null!=l&&(a.push(c),s.set(c,l))}}));var c=new D(a);return new $s(s,c,o.fieldTransforms)}function dc(e,t,n,i,o,a){var s=e.Bc(1,t,n),l=[gc(t,i,n)],d=[o];if(a.length%2!=0)throw new u(c.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var f=0;f<a.length;f+=2)l.push(gc(t,a[f])),d.push(a[f+1]);for(var h=[],p=oe.empty(),v=l.length-1;v>=0;--v)if(!Ec(h,l[v])){var m=l[v],g=d[v];g=Object(r.p)(g);var y=s.kc(m);if(g instanceof ic)h.push(m);else{var _=hc(g,y);null!=_&&(h.push(m),p.set(m,_))}}var b=new D(h);return new $s(p,b,s.fieldTransforms)}function fc(e,t,n,r){return void 0===r&&(r=!1),hc(n,e.Bc(r?4:3,t))}function hc(e,t){if(vc(e=Object(r.p)(e)))return mc("Unsupported field value:",t,e),pc(e,t);if(e instanceof Ys)return function(e,t){if(!Zs(t.Dc))throw t.$c(e._methodName+"() can only be used with update() and set()");if(!t.path)throw t.$c(e._methodName+"() is not currently supported inside arrays");var n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xc&&4!==t.Dc)throw t.$c("Nested arrays are not supported");return function(e,t){for(var n=[],r=0,i=0,o=e;i<o.length;i++){var a=hc(o[i],t.Oc(r));null==a&&(a={nullValue:"NULL_VALUE"}),n.push(a),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Object(r.p)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return ze(t.R,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){var n=S.fromDate(e);return{timestampValue:tn(t.R,n)}}if(e instanceof S)return n=new S(e.seconds,1e3*Math.floor(e.nanoseconds/1e3)),{timestampValue:tn(t.R,n)};if(e instanceof Qs)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof zs)return{bytesValue:nn(t.R,e._byteString)};if(e instanceof Os){n=t.databaseId;var i=e.firestore._databaseId;if(!i.isEqual(n))throw t.$c("Document reference is for database "+i.projectId+"/"+i.database+" but should be for database "+n.projectId+"/"+n.database);return{referenceValue:an(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t.$c("Unsupported field value: "+Is(e))}(e,t)}function pc(e,t){var n={};return C(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):A(e,(function(e,r){var i=hc(r,t.Nc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function vc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof S||e instanceof Qs||e instanceof zs||e instanceof Os||e instanceof Ys)}function mc(e,t,n){if(!vc(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){var r=Is(n);throw"an object"===r?t.$c(e+" a custom object"):t.$c(e+" "+r)}}function gc(e,t,n){if((t=Object(r.p)(t))instanceof Hs)return t._internalPath;if("string"==typeof t)return _c(e,t);throw bc("Field path arguments must be of type string or FieldPath.",e,!1,void 0,n)}var yc=new RegExp("[~\\*/\\[\\]]");function _c(e,t,n){if(t.search(yc)>=0)throw bc("Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'",e,!1,void 0,n);try{return(new(Hs.bind.apply(Hs,Object(a.d)([void 0],t.split(".")))))._internalPath}catch(r){throw bc("Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",e,!1,void 0,n)}}function bc(e,t,n,r,i){var o=r&&!r.isEmpty(),a=void 0!==i,s="Function "+t+"() called with invalid data";n&&(s+=" (via `toFirestore()`)");var l="";return(o||a)&&(l+=" (found",o&&(l+=" in field "+r),a&&(l+=" in document "+i),l+=")"),new u(c.INVALID_ARGUMENT,(s+=". ")+e+l)}function Ec(e,t){return e.some((function(e){return e.isEqual(t)}))}var wc=function(){function e(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}return Object.defineProperty(e.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new Os(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),e.prototype.exists=function(){return null!==this._document},e.prototype.data=function(){if(this._document){if(this._converter){var e=new Tc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.toProto())}},e.prototype.get=function(e){if(this._document){var t=this._document.data.field(Sc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}},e}(),Tc=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.data=function(){return e.prototype.data.call(this)},t}(wc);function Sc(e,t){return"string"==typeof t?_c(e,t):t instanceof Hs?t._internalPath:t._delegate._internalPath}var Ic=function(){function e(e,t){this.hasPendingWrites=e,this.fromCache=t}return e.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},e}(),Rc=function(e){function t(t,n,r,i,o,a){var s=this;return(s=e.call(this,t,n,r,i,a)||this)._firestore=t,s._firestoreImpl=t,s.metadata=o,s}return Object(a.b)(t,e),t.prototype.exists=function(){return e.prototype.exists.call(this)},t.prototype.data=function(e){if(void 0===e&&(e={}),this._document){if(this._converter){var t=new Ac(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.toProto(),e.serverTimestamps)}},t.prototype.get=function(e,t){if(void 0===t&&(t={}),this._document){var n=this._document.data.field(Sc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}},t}(wc),Ac=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.data=function(t){return void 0===t&&(t={}),e.prototype.data.call(this,t)},t}(Rc),Cc=function(){function e(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Ic(r.hasPendingWrites,r.fromCache),this.query=n}return Object.defineProperty(e.prototype,"docs",{get:function(){var e=[];return this.forEach((function(t){return e.push(t)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.size},enumerable:!1,configurable:!0}),e.prototype.forEach=function(e,t){var n=this;this._snapshot.docs.forEach((function(r){e.call(t,new Ac(n._firestore,n._userDataWriter,r.key,r,new Ic(n._snapshot.mutatedKeys.has(r.key),n._snapshot.fromCache),n.query._converter))}))},e.prototype.docChanges=function(e){void 0===e&&(e={});var t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new u(c.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){var n=0;return e._snapshot.docChanges.map((function(t){var r=new Ac(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ic(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query._converter);return t.doc,{type:"added",doc:r,oldIndex:-1,newIndex:n++}}))}var r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((function(e){return t||3!==e.type})).map((function(t){var n=new Ac(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Ic(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query._converter),i=-1,o=-1;return 0!==t.type&&(i=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(o=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:kc(t.type),doc:n,oldIndex:i,newIndex:o}}))}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges},e}();function kc(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return m()}}function Oc(e,t){return e instanceof Rc&&t instanceof Rc?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Cc&&t instanceof Cc&&e._firestore===t._firestore&&Ms(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}function Nc(e){if(Pe(e)&&0===e.explicitOrderBy.length)throw new u(c.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Pc=function(){};function Dc(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r];e=o._apply(e)}return e}var xc=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).Qc=t,i.Kc=n,i.jc=r,i.type="where",i}return Object(a.b)(t,e),t.prototype._apply=function(e){var t=nc(e.firestore),n=function(e,t,n,r,i,o,a){var s;if(i.isKeyField()){if("array-contains"===o||"array-contains-any"===o)throw new u(c.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+o+"' queries on FieldPath.documentId().");if("in"===o||"not-in"===o){Bc(a,o);for(var l=[],d=0,f=a;d<f.length;d++){var h=f[d];l.push(Vc(r,e,h))}s={arrayValue:{values:l}}}else s=Vc(r,e,a)}else"in"!==o&&"not-in"!==o&&"array-contains-any"!==o||Bc(a,o),s=fc(n,"where",a,"in"===o||"not-in"===o);var p=he.create(i,o,s);return function(e,t){if(t.g()){var n=xe(e);if(null!==n&&!n.isEqual(t.field))throw new u(c.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+n.toString()+"' and '"+t.field.toString()+"'");var r=De(e);null!==r&&Wc(e,t.field,r)}var i=function(e,t){for(var n=0,r=e.filters;n<r.length;n++){var i=r[n];if(t.indexOf(i.op)>=0)return i.op}return null}(e,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==i)throw i===t.op?new u(c.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+t.op.toString()+"' filter."):new u(c.INVALID_ARGUMENT,"Invalid query. You cannot use '"+t.op.toString()+"' filters with '"+i.toString()+"' filters.")}(e,p),p}(e._query,0,t,e.firestore._databaseId,this.Qc,this.Kc,this.jc);return new Ns(e.firestore,e._converter,function(e,t){var n=e.filters.concat([t]);return new Ce(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}(e._query,n))},t}(Pc),Lc=function(e){function t(t,n){var r=this;return(r=e.call(this)||this).Qc=t,r.Wc=n,r.type="orderBy",r}return Object(a.b)(t,e),t.prototype._apply=function(e){var t=function(e,t,n){if(null!==e.startAt)throw new u(c.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new u(c.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var r=new Se(t,n);return function(e,t){if(null===De(e)){var n=xe(e);null!==n&&Wc(e,n,t.field)}}(e,r),r}(e._query,this.Qc,this.Wc);return new Ns(e.firestore,e._converter,function(e,t){var n=e.explicitOrderBy.concat([t]);return new Ce(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))},t}(Pc),Mc=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Gc=n,i.zc=r,i}return Object(a.b)(t,e),t.prototype._apply=function(e){return new Ns(e.firestore,e._converter,je(e._query,this.Gc,this.zc))},t}(Pc),Uc=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Hc=n,i.Jc=r,i}return Object(a.b)(t,e),t.prototype._apply=function(e){var t=Fc(e,this.type,this.Hc,this.Jc);return new Ns(e.firestore,e._converter,function(e,t){return new Ce(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))},t}(Pc),jc=function(e){function t(t,n,r){var i=this;return(i=e.call(this)||this).type=t,i.Hc=n,i.Jc=r,i}return Object(a.b)(t,e),t.prototype._apply=function(e){var t=Fc(e,this.type,this.Hc,this.Jc);return new Ns(e.firestore,e._converter,function(e,t){return new Ce(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))},t}(Pc);function Fc(e,t,n,i){if(n[0]=Object(r.p)(n[0]),n[0]instanceof wc)return function(e,t,n,r,i){if(!r)throw new u(c.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+n+"().");for(var o=[],a=0,s=Me(e);a<s.length;a++){var l=s[a];if(l.field.isKeyField())o.push(Z(t,r.key));else{var d=r.data.field(l.field);if(F(d))throw new u(c.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+l.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===d){var f=l.field.canonicalString();throw new u(c.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+f+"' (used as the orderBy) does not exist.")}o.push(d)}}return new we(o,i)}(e._query,e.firestore._databaseId,t,n[0]._document,i);var o=nc(e.firestore);return function(e,t,n,r,i,o){var a=e.explicitOrderBy;if(i.length>a.length)throw new u(c.INVALID_ARGUMENT,"Too many arguments provided to "+r+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var s=[],l=0;l<i.length;l++){var d=i[l];if(a[l].field.isKeyField()){if("string"!=typeof d)throw new u(c.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+r+"(), but got a "+typeof d);if(!Le(e)&&-1!==d.indexOf("/"))throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+r+"() must be a plain document ID, but '"+d+"' contains a slash.");var f=e.path.child(O.fromString(d));if(!K.isDocumentKey(f))throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+r+"() must result in a valid document path, but '"+f+"' is not because it contains an odd number of segments.");var h=new K(f);s.push(Z(t,h))}else{var p=fc(n,r,d);s.push(p)}}return new we(s,o)}(e._query,e.firestore._databaseId,o,t,n,i)}function Vc(e,t,n){if("string"==typeof(n=Object(r.p)(n))){if(""===n)throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!Le(t)&&-1!==n.indexOf("/"))throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var i=t.path.child(O.fromString(n));if(!K.isDocumentKey(i))throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+i+"' is not because it has an odd number of segments ("+i.length+").");return Z(e,new K(i))}if(n instanceof Os)return Z(e,n._key);throw new u(c.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Is(n)+".")}function Bc(e,t){if(!Array.isArray(e)||0===e.length)throw new u(c.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+t.toString()+"' filters.");if(e.length>10)throw new u(c.INVALID_ARGUMENT,"Invalid Query. '"+t.toString()+"' filters support a maximum of 10 elements in the value array.")}function Wc(e,t,n){if(!n.isEqual(t))throw new u(c.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}var Gc=function(){function e(){}return e.prototype.convertValue=function(e,t){switch(void 0===t&&(t="none"),H(e)){case 0:return null;case 1:return e.booleanValue;case 2:return U(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(j(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw m()}},e.prototype.convertObject=function(e,t){var n=this,r={};return A(e.fields||{},(function(e,i){r[e]=n.convertValue(i,t)})),r},e.prototype.convertGeoPoint=function(e){return new Qs(U(e.latitude),U(e.longitude))},e.prototype.convertArray=function(e,t){var n=this;return(e.values||[]).map((function(e){return n.convertValue(e,t)}))},e.prototype.convertServerTimestamp=function(e,t){switch(t){case"previous":var n=V(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(B(e));default:return null}},e.prototype.convertTimestamp=function(e){var t=M(e);return new S(t.seconds,t.nanos)},e.prototype.convertDocumentKey=function(e,t){var n=O.fromString(e);g(Nn(n));var r=new hs(n.get(1),n.get(3)),i=new K(n.popFirst(5));return r.isEqual(t)||h("Document "+i+" contains a document reference within a different database ("+r.projectId+"/"+r.database+") which is not supported. It will be treated as a reference in the current database ("+t.projectId+"/"+t.database+") instead."),i},e}();function qc(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}var Kc=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(a.b)(t,e),t.prototype.convertBytes=function(e){return new zs(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Os(this.firestore,null,t)},t}(Gc),Hc=function(){function e(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=nc(e)}return e.prototype.set=function(e,t,n){this._verifyNotCommitted();var r=zc(e,this._firestore),i=qc(r._converter,t,n),o=rc(this._dataReader,"WriteBatch.set",r._key,i,null!==r._converter,n);return this._mutations.push(o.toMutation(r._key,ct.none())),this},e.prototype.update=function(e,t,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];this._verifyNotCommitted();var a,s=zc(e,this._firestore);return a="string"==typeof(t=Object(r.p)(t))||t instanceof Hs?dc(this._dataReader,"WriteBatch.update",s._key,t,n,i):lc(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(a.toMutation(s._key,ct.exists(!0))),this},e.prototype.delete=function(e){this._verifyNotCommitted();var t=zc(e,this._firestore);return this._mutations=this._mutations.concat(new Tt(t._key,ct.none())),this},e.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},e.prototype._verifyNotCommitted=function(){if(this._committed)throw new u(c.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},e}();function zc(e,t){if((e=Object(r.p)(e)).firestore!==t)throw new u(c.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}var Yc=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(a.b)(t,e),t.prototype.convertBytes=function(e){return new zs(e)},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return new Os(this.firestore,null,t)},t}(Gc);function Qc(e,t,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];e=Rs(e,Os);var a=Rs(e.firestore,Bs),s=nc(a);return Jc(a,[("string"==typeof(t=Object(r.p)(t))||t instanceof Hs?dc(s,"updateDoc",e._key,t,n,i):lc(s,"updateDoc",e._key,t)).toMutation(e._key,ct.exists(!0))])}function Xc(e){for(var t,n,i,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];e=Object(r.p)(e);var c={includeMetadataChanges:!1},u=0;"object"!=typeof o[u]||js(o[u])||(c=o[u],u++);var l,d,f,h={includeMetadataChanges:c.includeMetadataChanges};if(js(o[u])){var p=o[u];o[u]=null===(t=p.next)||void 0===t?void 0:t.bind(p),o[u+1]=null===(n=p.error)||void 0===n?void 0:n.bind(p),o[u+2]=null===(i=p.complete)||void 0===i?void 0:i.bind(p)}if(e instanceof Os)d=Rs(e.firestore,Bs),f=Oe(e._key.path),l={next:function(t){o[u]&&o[u]($c(d,e,t))},error:o[u+1],complete:o[u+2]};else{var v=Rs(e,Ns);d=Rs(v.firestore,Bs),f=v._query;var m=new Yc(d);l={next:function(e){o[u]&&o[u](new Cc(d,m,v,e))},error:o[u+1],complete:o[u+2]},Nc(e._query)}return function(e,t,n,r){var i=this,o=new Xa(r),s=new na(t,o,n);return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(i,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=Jo,[4,us(e)];case 1:return[2,t.apply(void 0,[n.sent(),s])]}}))}))})),function(){o.Wo(),e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(i,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=$o,[4,us(e)];case 1:return[2,t.apply(void 0,[n.sent(),s])]}}))}))}))}}(Ws(d),f,h,l)}function Jc(e,t){return function(e,t){var n=this,r=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(i){switch(i.label){case 0:return n=ma,[4,cs(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(Ws(e),t)}function $c(e,t,n){var r=n.docs.get(t._key),i=new Yc(e);return new Rc(e,i,t._key,r,new Ic(n.hasPendingWrites,n.fromCache),t._converter)}var Zc=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this)._firestore=t,r}return Object(a.b)(t,e),t.prototype.get=function(t){var n=this,r=zc(t,this._firestore),i=new Yc(this._firestore);return e.prototype.get.call(this,t).then((function(e){return new Rc(n._firestore,i,r._key,e._document,new Ic(!1,!1),r._converter)}))},t}(function(){function e(e,t){this._firestore=e,this._transaction=t,this._dataReader=nc(e)}return e.prototype.get=function(e){var t=this,n=zc(e,this._firestore),r=new Kc(this._firestore);return this._transaction.lookup([n._key]).then((function(e){if(!e||1!==e.length)return m();var i=e[0];if(i.isFoundDocument())return new wc(t._firestore,r,i.key,i,n._converter);if(i.isNoDocument())return new wc(t._firestore,r,n._key,null,n._converter);throw m()}))},e.prototype.set=function(e,t,n){var r=zc(e,this._firestore),i=qc(r._converter,t,n),o=rc(this._dataReader,"Transaction.set",r._key,i,null!==r._converter,n);return this._transaction.set(r._key,o),this},e.prototype.update=function(e,t,n){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a,s=zc(e,this._firestore);return a="string"==typeof(t=Object(r.p)(t))||t instanceof Hs?dc(this._dataReader,"Transaction.update",s._key,t,n,i):lc(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,a),this},e.prototype.delete=function(e){var t=zc(e,this._firestore);return this._transaction.delete(t._key),this},e}());function eu(){if("undefined"==typeof Uint8Array)throw new u(c.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function tu(){if("undefined"==typeof atob)throw new u(c.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var nu=function(){function e(e){this._delegate=e}return e.fromBase64String=function(t){return tu(),new e(zs.fromBase64String(t))},e.fromUint8Array=function(t){return eu(),new e(zs.fromUint8Array(t))},e.prototype.toBase64=function(){return tu(),this._delegate.toBase64()},e.prototype.toUint8Array=function(){return eu(),this._delegate.toUint8Array()},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},e}(),ru=function(){function e(){}return e.prototype.enableIndexedDbPersistence=function(e,t){return function(e,t){Ks(e=Rs(e,Bs));var n=Ws(e),r=e._freezeSettings(),i=new Ya;return qs(n,i,new Ha(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})},e.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(e){Ks(e=Rs(e,Bs));var t=Ws(e),n=e._freezeSettings(),r=new Ya;return qs(t,r,new za(r,n.cacheSizeBytes))}(e._delegate)},e.prototype.clearIndexedDbPersistence=function(e){return function(e){var t=this;if(e._initialized&&!e._terminated)throw new u(c.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var n=new tr;return e._queue.enqueueAndForgetEvenWhileRestricted((function(){return Object(a.a)(t,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,function(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return ir.yt()?(t=e+"main",[4,ir.delete(t)]):[2,Promise.resolve()];case 1:return n.sent(),[2]}}))}))}(vi(e._databaseId,e._persistenceKey))];case 1:return r.sent(),n.resolve(),[3,3];case 2:return t=r.sent(),n.reject(t),[3,3];case 3:return[2]}}))}))})),n.promise}(e._delegate)},e}(),iu=function(){function e(e,t,n){var r=this;this._delegate=t,this.Yc=n,this.INTERNAL={delete:function(){return r.terminate()}},e instanceof hs||(this.Xc=e)}return Object.defineProperty(e.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),e.prototype.settings=function(e){e.merge&&delete(e=Object.assign(Object.assign({},this._delegate._getSettings()),e)).merge,this._delegate._setSettings(e)},e.prototype.useEmulator=function(e,t){!function(e,t,n){var r=(e=Rs(e,ks))._getSettings();"firestore.googleapis.com"!==r.host&&r.host!==t&&p("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},r),{host:t+":"+n,ssl:!1}))}(this._delegate,e,t)},e.prototype.enableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue((function(){return Object(a.a)(t,void 0,void 0,(function(){var t,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return[4,os(e)];case 1:return t=r.sent(),[4,ss(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!0),function(e){var t=y(e);return t.$r.delete(0),_o(t)}(n))]}}))}))}))}(Ws(Rs(this._delegate,Bs)))},e.prototype.disableNetwork=function(){return function(e){var t=this;return e.asyncQueue.enqueue((function(){return Object(a.a)(t,void 0,void 0,(function(){var t,n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return[4,os(e)];case 1:return t=r.sent(),[4,ss(e)];case 2:return n=r.sent(),[2,(t.setNetworkEnabled(!1),function(e){return Object(a.a)(this,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return(t=y(e)).$r.add(0),[4,bo(t)];case 1:return n.sent(),t.Br.set("Offline"),[2]}}))}))}(n))]}}))}))}))}(Ws(Rs(this._delegate,Bs)))},e.prototype.enablePersistence=function(e){var t=!1,n=!1;return e&&ws("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this.Yc.enableMultiTabIndexedDbPersistence(this):this.Yc.enableIndexedDbPersistence(this,n)},e.prototype.clearPersistence=function(){return this.Yc.clearIndexedDbPersistence(this)},e.prototype.terminate=function(){return this.Xc&&(this.Xc._removeServiceInstance("firestore"),this.Xc._removeServiceInstance("firestore-exp")),this._delegate._delete()},e.prototype.waitForPendingWrites=function(){return function(e){var t=this,n=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(t,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(r){switch(r.label){case 0:return t=wa,[4,cs(e)];case 1:return[2,t.apply(void 0,[r.sent(),n])]}}))}))})),n.promise}(Ws(Rs(this._delegate,Bs)))},e.prototype.onSnapshotsInSync=function(e){return function(e,t){return function(e,t){var n=this,r=new Xa(t);return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=function(e,t){y(e).Gr.add(t),t.next()},[4,us(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}}))}))})),function(){r.Wo(),e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=function(e,t){y(e).Gr.delete(t)},[4,us(e)];case 1:return[2,t.apply(void 0,[n.sent(),r])]}}))}))}))}}(Ws(e=Rs(e,Bs)),js(t)?t:{next:t})}(this._delegate,e)},Object.defineProperty(e.prototype,"app",{get:function(){if(!this.Xc)throw new u(c.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.Xc},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new _u(this,Ds(this._delegate,e))}catch(e){throw du(e,"collection()","Firestore.collection()")}},e.prototype.doc=function(e){try{return new lu(this,xs(this._delegate,e))}catch(e){throw du(e,"doc()","Firestore.doc()")}},e.prototype.collectionGroup=function(e){try{return new mu(this,function(e,t){if(e=Rs(e,ks),bs("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new u(c.INVALID_ARGUMENT,"Invalid collection ID '"+t+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new Ns(e,null,function(e){return new Ce(O.emptyPath(),e)}(t))}(this._delegate,e))}catch(e){throw du(e,"collectionGroup()","Firestore.collectionGroup()")}},e.prototype.runTransaction=function(e){var t=this;return function(e,t){return function(e,t){var n=this,r=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(i){switch(i.label){case 0:return[4,function(e){return is(e).then((function(e){return e.datastore}))}(e)];case 1:return n=i.sent(),new Za(e.asyncQueue,n,t,r).run(),[2]}}))}))})),r.promise}(Ws(e),(function(n){return t(new Zc(e,n))}))}(this._delegate,(function(n){return e(new su(t,n))}))},e.prototype.batch=function(){var e=this;return Ws(this._delegate),new cu(new Hc(this._delegate,(function(t){return Jc(e._delegate,t)})))},e.prototype.loadBundle=function(e){throw new u(c.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},e.prototype.namedQuery=function(e){throw new u(c.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},e}(),ou=function(e){function t(t){var n=this;return(n=e.call(this)||this).firestore=t,n}return Object(a.b)(t,e),t.prototype.convertBytes=function(e){return new nu(new zs(e))},t.prototype.convertReference=function(e){var t=this.convertDocumentKey(e,this.firestore._databaseId);return lu.Zc(t,this.firestore,null)},t}(Gc);function au(e){var t;t=e,l.setLogLevel(t)}var su=function(){function e(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new ou(e)}return e.prototype.get=function(e){var t=this,n=bu(e);return this._delegate.get(n).then((function(e){return new pu(t._firestore,new Rc(t._firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,n._converter))}))},e.prototype.set=function(e,t,n){var r=bu(e);return n?(Es("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=bu(e);return 2===arguments.length?this._delegate.update(s,t):(r=this._delegate).update.apply(r,Object(a.d)([s,t,n],i)),this},e.prototype.delete=function(e){var t=bu(e);return this._delegate.delete(t),this},e}(),cu=function(){function e(e){this._delegate=e}return e.prototype.set=function(e,t,n){var r=bu(e);return n?(Es("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this},e.prototype.update=function(e,t,n){for(var r,i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var s=bu(e);return 2===arguments.length?this._delegate.update(s,t):(r=this._delegate).update.apply(r,Object(a.d)([s,t,n],i)),this},e.prototype.delete=function(e){var t=bu(e);return this._delegate.delete(t),this},e.prototype.commit=function(){return this._delegate.commit()},e}(),uu=function(){function e(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}return e.prototype.fromFirestore=function(e,t){var n=new Ac(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vu(this._firestore,n),null!=t?t:{})},e.prototype.toFirestore=function(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)},e.tu=function(t,n){var r=e.eu,i=r.get(t);i||(i=new WeakMap,r.set(t,i));var o=i.get(n);return o||(o=new e(t,new ou(t),n),i.set(n,o)),o},e}();uu.eu=new WeakMap;var lu=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ou(e)}return e.nu=function(t,n,r){if(t.length%2!=0)throw new u(c.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t.canonicalString()+" has "+t.length);return new e(n,new Os(n._delegate,r,new K(t)))},e.Zc=function(t,n,r){return new e(n,new Os(n._delegate,r,t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return new _u(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),e.prototype.collection=function(e){try{return new _u(this.firestore,Ds(this._delegate,e))}catch(e){throw du(e,"collection()","DocumentReference.collection()")}},e.prototype.isEqual=function(e){return(e=Object(r.p)(e))instanceof Os&&Ls(this._delegate,e)},e.prototype.set=function(e,t){t=Es("DocumentReference.set",t);try{return function(e,t,n){e=Rs(e,Os);var r=Rs(e.firestore,Bs),i=qc(e._converter,t,n);return Jc(r,[rc(nc(r),"setDoc",e._key,i,null!==e._converter,n).toMutation(e._key,ct.none())])}(this._delegate,e,t)}catch(e){throw du(e,"setDoc()","DocumentReference.set()")}},e.prototype.update=function(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];try{return 1===arguments.length?Qc(this._delegate,e):Qc.apply(void 0,Object(a.d)([this._delegate,e,t],n))}catch(e){throw du(e,"updateDoc()","DocumentReference.update()")}},e.prototype.delete=function(){return Jc(Rs((e=this._delegate).firestore,Bs),[new Tt(e._key,ct.none())]);var e},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=fu(t),i=hu(t,(function(t){return new pu(e.firestore,new Rc(e.firestore._delegate,e._userDataWriter,t._key,t._document,t.metadata,e._delegate._converter))}));return Xc(this._delegate,r,i)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=Rs(e,Os);var t=Rs(e.firestore,Bs),n=Ws(t),r=new Yc(t);return function(e,t){var n=this,r=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i;return Object(a.c)(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,function(e,t){var n=y(e);return n.persistence.runTransaction("read document","readonly",(function(e){return n.Mn.mn(e,t)}))}(e,t)];case 1:return(i=o.sent()).isFoundDocument()?n.resolve(i):i.isNoDocument()?n.resolve(null):n.reject(new u(c.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return r=o.sent(),i=Ko(r,"Failed to get document '"+t+" from cache"),n.reject(i),[3,3];case 3:return[2]}}))}))},[4,as(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(n,e._key).then((function(n){return new Rc(t,r,e._key,n,new Ic(null!==n&&n.hasLocalMutations,!0),e._converter)}))}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Rs(e,Os);var t=Rs(e.firestore,Bs);return ls(Ws(t),e._key,{source:"server"}).then((function(n){return $c(t,e,n)}))}(this._delegate):function(e){e=Rs(e,Os);var t=Rs(e.firestore,Bs);return ls(Ws(t),e._key).then((function(n){return $c(t,e,n)}))}(this._delegate)).then((function(e){return new pu(t.firestore,new Rc(t.firestore._delegate,t._userDataWriter,e._key,e._document,e.metadata,t._delegate._converter))}))},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(uu.tu(this.firestore,t)):this._delegate.withConverter(null))},e}();function du(e,t,n){return e.message=e.message.replace(t,n),e}function fu(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];if("object"==typeof r&&!js(r))return r}return{}}function hu(e,t){var n,r,i;return{next:function(e){i.next&&i.next(t(e))},error:null===(n=(i=js(e[0])?e[0]:js(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}var pu=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"ref",{get:function(){return new lu(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),e.prototype.data=function(e){return this._delegate.data(e)},e.prototype.get=function(e,t){return this._delegate.get(e,t)},e.prototype.isEqual=function(e){return Oc(this._delegate,e._delegate)},e}(),vu=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.data=function(e){return this._delegate.data(e)},t}(pu),mu=function(){function e(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new ou(e)}return e.prototype.where=function(t,n,r){try{return new e(this.firestore,Dc(this._delegate,function(e,t,n){var r=t,i=Sc("where",e);return new xc(i,r,n)}(t,n,r)))}catch(t){throw du(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.orderBy=function(t,n){try{return new e(this.firestore,Dc(this._delegate,function(e,t){void 0===t&&(t="asc");var n=t,r=Sc("orderBy",e);return new Lc(r,n)}(t,n)))}catch(t){throw du(t,/(orderBy|where)\(\)/,"Query.$1()")}},e.prototype.limit=function(t){try{return new e(this.firestore,Dc(this._delegate,function(e){return As("limit",e),new Mc("limit",e,"F")}(t)))}catch(t){throw du(t,"limit()","Query.limit()")}},e.prototype.limitToLast=function(t){try{return new e(this.firestore,Dc(this._delegate,function(e){return As("limitToLast",e),new Mc("limitToLast",e,"L")}(t)))}catch(t){throw du(t,"limitToLast()","Query.limitToLast()")}},e.prototype.startAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Dc(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Uc("startAt",e,!0)}.apply(void 0,t)))}catch(t){throw du(t,"startAt()","Query.startAt()")}},e.prototype.startAfter=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Dc(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new Uc("startAfter",e,!1)}.apply(void 0,t)))}catch(t){throw du(t,"startAfter()","Query.startAfter()")}},e.prototype.endBefore=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Dc(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new jc("endBefore",e,!0)}.apply(void 0,t)))}catch(t){throw du(t,"endBefore()","Query.endBefore()")}},e.prototype.endAt=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return new e(this.firestore,Dc(this._delegate,function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new jc("endAt",e,!1)}.apply(void 0,t)))}catch(t){throw du(t,"endAt()","Query.endAt()")}},e.prototype.isEqual=function(e){return Ms(this._delegate,e._delegate)},e.prototype.get=function(e){var t=this;return("cache"===(null==e?void 0:e.source)?function(e){e=Rs(e,Ns);var t=Rs(e.firestore,Bs),n=Ws(t),r=new Yc(t);return function(e,t){var n=this,r=new tr;return e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(n,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(i){switch(i.label){case 0:return n=function(e,t,n){return Object(a.a)(this,void 0,void 0,(function(){var r,i,o,s,c;return Object(a.c)(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,Oi(e,t,!0)];case 1:return c=a.sent(),r=new ua(t,c.Bn),i=r._o(c.documents),o=r.applyChanges(i,!1),n.resolve(o.snapshot),[3,3];case 2:return s=a.sent(),c=Ko(s,"Failed to execute query '"+t+" against cache"),n.reject(c),[3,3];case 3:return[2]}}))}))},[4,as(e)];case 1:return[2,n.apply(void 0,[i.sent(),t,r])]}}))}))})),r.promise}(n,e._query).then((function(n){return new Cc(t,r,e,n)}))}(this._delegate):"server"===(null==e?void 0:e.source)?function(e){e=Rs(e,Ns);var t=Rs(e.firestore,Bs),n=Ws(t),r=new Yc(t);return ds(n,e._query,{source:"server"}).then((function(n){return new Cc(t,r,e,n)}))}(this._delegate):function(e){e=Rs(e,Ns);var t=Rs(e.firestore,Bs),n=Ws(t),r=new Yc(t);return Nc(e._query),ds(n,e._query).then((function(n){return new Cc(t,r,e,n)}))}(this._delegate)).then((function(e){return new yu(t.firestore,new Cc(t.firestore._delegate,t._userDataWriter,t._delegate,e._snapshot))}))},e.prototype.onSnapshot=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=fu(t),i=hu(t,(function(t){return new yu(e.firestore,new Cc(e.firestore._delegate,e._userDataWriter,e._delegate,t._snapshot))}));return Xc(this._delegate,r,i)},e.prototype.withConverter=function(t){return new e(this.firestore,t?this._delegate.withConverter(uu.tu(this.firestore,t)):this._delegate.withConverter(null))},e}(),gu=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"doc",{get:function(){return new vu(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),e}(),yu=function(){function e(e,t){this._firestore=e,this._delegate=t}return Object.defineProperty(e.prototype,"query",{get:function(){return new mu(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map((function(t){return new vu(e._firestore,t)}))},enumerable:!1,configurable:!0}),e.prototype.docChanges=function(e){var t=this;return this._delegate.docChanges(e).map((function(e){return new gu(t._firestore,e)}))},e.prototype.forEach=function(e,t){var n=this;this._delegate.forEach((function(r){e.call(t,new vu(n._firestore,r))}))},e.prototype.isEqual=function(e){return Oc(this._delegate,e._delegate)},e}(),_u=function(e){function t(t,n){var r=this;return(r=e.call(this,t,n)||this).firestore=t,r._delegate=n,r}return Object(a.b)(t,e),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return e?new lu(this.firestore,e):null},enumerable:!1,configurable:!0}),t.prototype.doc=function(e){try{return new lu(this.firestore,void 0===e?xs(this._delegate):xs(this._delegate,e))}catch(e){throw du(e,"doc()","CollectionReference.doc()")}},t.prototype.add=function(e){var t=this;return function(e,t){var n=Rs(e.firestore,Bs),r=xs(e),i=qc(e._converter,t);return Jc(n,[rc(nc(e.firestore),"addDoc",r._key,i,null!==e._converter,{}).toMutation(r._key,ct.exists(!1))]).then((function(){return r}))}(this._delegate,e).then((function(e){return new lu(t.firestore,e)}))},t.prototype.isEqual=function(e){return Ls(this._delegate,e._delegate)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(uu.tu(this.firestore,e)):this._delegate.withConverter(null))},t}(mu);function bu(e){return Rs(e,Os)}var Eu=function(){function e(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this._delegate=new(Hs.bind.apply(Hs,Object(a.d)([void 0],e)))}return e.documentId=function(){return new e(P.keyField().canonicalString())},e.prototype.isEqual=function(e){return(e=Object(r.p)(e))instanceof Hs&&this._delegate._internalPath.isEqual(e._internalPath)},e}(),wu=function(){function e(e){this._delegate=e}return e.serverTimestamp=function(){var t=new ac("serverTimestamp");return t._methodName="FieldValue.serverTimestamp",new e(t)},e.delete=function(){var t=new ic("deleteField");return t._methodName="FieldValue.delete",new e(t)},e.arrayUnion=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new sc("arrayUnion",e)}.apply(void 0,t);return r._methodName="FieldValue.arrayUnion",new e(r)},e.arrayRemove=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new cc("arrayRemove",e)}.apply(void 0,t);return r._methodName="FieldValue.arrayRemove",new e(r)},e.increment=function(t){var n=function(e){return new uc("increment",e)}(t);return n._methodName="FieldValue.increment",new e(n)},e.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},e}();function Tu(e){return function(e,t){var n=Ws(e=Rs(e,Bs)),r=new Fs;return function(e,t,n,r){var i=this,o=function(e,t){return function(e,t){return new Ja(e,t)}(function(e,t){if(e instanceof Uint8Array)return Qa(e,t);if(e instanceof ArrayBuffer)return Qa(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof e?(new TextEncoder).encode(e):e),t)}(n,lo(t));e.asyncQueue.enqueueAndForget((function(){return Object(a.a)(i,void 0,void 0,(function(){var t;return Object(a.c)(this,(function(n){switch(n.label){case 0:return t=qa,[4,cs(e)];case 1:return t.apply(void 0,[n.sent(),o,r]),[2]}}))}))}))}(n,e._databaseId,t,r),r}(this._delegate,e)}function Su(e){var t,n,r=this;return(t=this._delegate,n=e,function(e,t){var n=this;return e.asyncQueue.enqueue((function(){return Object(a.a)(n,void 0,void 0,(function(){var n;return Object(a.c)(this,(function(r){switch(r.label){case 0:return n=function(e,t){var n=y(e);return n.persistence.runTransaction("Get named query","readonly",(function(e){return n.Qe.getNamedQuery(e,t)}))},[4,as(e)];case 1:return[2,n.apply(void 0,[r.sent(),t])]}}))}))}))}(Ws(t=Rs(t,Bs)),n).then((function(e){return e?new Ns(t,null,e.query):null}))).then((function(e){return e?new mu(r,e):null}))}}).call(this,n(38))},function(e,t,n){"use strict";n.d(t,"a",(function(){return _})),n.d(t,"b",(function(){return v})),n.d(t,"c",(function(){return p})),n.d(t,"d",(function(){return y})),n.d(t,"e",(function(){return R}));var r=n(24),i=n(2),o=n.n(i),a=(n(34),n(25)),s=n(47),c=n(23),u=n(12),l=n(48),d=n.n(l),f=(n(32),n(22)),h=(n(29),function(e){var t=Object(s.a)();return t.displayName=e,t}("Router-History")),p=function(e){var t=Object(s.a)();return t.displayName=e,t}("Router"),v=function(e){function t(t){var n;return(n=e.call(this,t)||this).state={location:t.history.location},n._isMounted=!1,n._pendingLocation=null,t.staticContext||(n.unlisten=t.history.listen((function(e){n._isMounted?n.setState({location:e}):n._pendingLocation=e}))),n}Object(r.a)(t,e),t.computeRootMatch=function(e){return{path:"/",url:"/",params:{},isExact:"/"===e}};var n=t.prototype;return n.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&this.unlisten()},n.render=function(){return o.a.createElement(p.Provider,{value:{history:this.props.history,location:this.state.location,match:t.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},o.a.createElement(h.Provider,{children:this.props.children||null,value:this.props.history}))},t}(o.a.Component);o.a.Component;o.a.Component;var m={},g=0;function y(e,t){void 0===t&&(t={}),("string"===typeof t||Array.isArray(t))&&(t={path:t});var n=t,r=n.path,i=n.exact,o=void 0!==i&&i,a=n.strict,s=void 0!==a&&a,c=n.sensitive,u=void 0!==c&&c;return[].concat(r).reduce((function(t,n){if(!n&&""!==n)return null;if(t)return t;var r=function(e,t){var n=""+t.end+t.strict+t.sensitive,r=m[n]||(m[n]={});if(r[e])return r[e];var i=[],o={regexp:d()(e,i,t),keys:i};return g<1e4&&(r[e]=o,g++),o}(n,{end:o,strict:s,sensitive:u}),i=r.regexp,a=r.keys,c=i.exec(e);if(!c)return null;var l=c[0],f=c.slice(1),h=e===l;return o&&!h?null:{path:n,url:"/"===n&&""===l?"/":l,isExact:h,params:a.reduce((function(e,t,n){return e[t.name]=f[n],e}),{})}}),null)}var _=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.render=function(){var e=this;return o.a.createElement(p.Consumer,null,(function(t){t||Object(c.a)(!1);var n=e.props.location||t.location,r=e.props.computedMatch?e.props.computedMatch:e.props.path?y(n.pathname,e.props):t.match,i=Object(u.a)({},t,{location:n,match:r}),a=e.props,s=a.children,l=a.component,d=a.render;return Array.isArray(s)&&0===s.length&&(s=null),o.a.createElement(p.Provider,{value:i},i.match?s?"function"===typeof s?s(i):s:l?o.a.createElement(l,i):d?d(i):null:"function"===typeof s?s(i):null)}))},t}(o.a.Component);function b(e){return"/"===e.charAt(0)?e:"/"+e}function E(e,t){if(!e)return t;var n=b(e);return 0!==t.pathname.indexOf(n)?t:Object(u.a)({},t,{pathname:t.pathname.substr(n.length)})}function w(e){return"string"===typeof e?e:Object(a.e)(e)}function T(e){return function(){Object(c.a)(!1)}}function S(){}o.a.Component;o.a.Component;var I=o.a.useContext;function R(){return I(h)}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return ir})),n.d(t,"b",(function(){return ar})),n.d(t,"c",(function(){return or})),n.d(t,"d",(function(){return sr})),n.d(t,"e",(function(){return cr})),n.d(t,"f",(function(){return ur})),n.d(t,"g",(function(){return nr})),n.d(t,"h",(function(){return rr}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}var o,a="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:"undefined"!==typeof self?self:{},s=s||{},c=a||self;function u(){}function l(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function d(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}var f="closure_uid_"+(1e9*Math.random()>>>0),h=0;function p(e,t,n){return e.call.apply(e.bind,arguments)}function v(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function m(e,t,n){return(m=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?p:v).apply(null,arguments)}function g(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function y(){return Date.now()}function _(e,t){function n(){}n.prototype=t.prototype,e.X=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Kb=function(e,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return t.prototype[n].apply(e,i)}}function b(){this.j=this.j,this.i=this.i}b.prototype.j=!1,b.prototype.ja=function(){if(!this.j&&(this.j=!0,this.G(),0))(function(e){Object.prototype.hasOwnProperty.call(e,f)&&e[f]||(e[f]=++h)})(this)},b.prototype.G=function(){if(this.i)for(;this.i.length;)this.i.shift()()};var E=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},w=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"===typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};function T(e){return Array.prototype.concat.apply([],arguments)}function S(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}function I(e){return/^[\s\xa0]*$/.test(e)}var R,A=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function C(e,t){return-1!=e.indexOf(t)}function k(e,t){return e<t?-1:e>t?1:0}e:{var O=c.navigator;if(O){var N=O.userAgent;if(N){R=N;break e}}R=""}function P(e,t,n){for(var r in e)t.call(n,e[r],r,e)}function D(e){var t={};for(var n in e)t[n]=e[n];return t}var x="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function L(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<x.length;o++)n=x[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function M(e){return M[" "](e),e}M[" "]=u;var U,j=C(R,"Opera"),F=C(R,"Trident")||C(R,"MSIE"),V=C(R,"Edge"),B=V||F,W=C(R,"Gecko")&&!(C(R.toLowerCase(),"webkit")&&!C(R,"Edge"))&&!(C(R,"Trident")||C(R,"MSIE"))&&!C(R,"Edge"),G=C(R.toLowerCase(),"webkit")&&!C(R,"Edge");function q(){var e=c.document;return e?e.documentMode:void 0}e:{var K="",H=function(){var e=R;return W?/rv:([^\);]+)(\)|;)/.exec(e):V?/Edge\/([\d\.]+)/.exec(e):F?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):G?/WebKit\/(\S+)/.exec(e):j?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(H&&(K=H?H[1]:""),F){var z=q();if(null!=z&&z>parseFloat(K)){U=String(z);break e}}U=K}var Y,Q={};function X(e){return function(e,t){var n=Q;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=A(String(U)).split("."),r=A(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=k(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||k(0==a[2].length,0==s[2].length)||k(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}if(c.document&&F){var J=q();Y=J||(parseInt(U,10)||void 0)}else Y=void 0;var $=Y,Z=!F||9<=Number($),ee=F&&!X("9"),te=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{c.addEventListener("test",u,t),c.removeEventListener("test",u,t)}catch(n){}return e}();function ne(e,t){this.type=e,this.a=this.target=t,this.defaultPrevented=!1}function re(e,t){if(ne.call(this,e?e.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.a=t,t=e.relatedTarget){if(W){e:{try{M(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:ie[e.pointerType]||"",this.c=e,e.defaultPrevented&&this.b()}}ne.prototype.b=function(){this.defaultPrevented=!0},_(re,ne);var ie={2:"touch",3:"pen",4:"mouse"};re.prototype.b=function(){re.X.b.call(this);var e=this.c;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,ee)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}};var oe="closure_listenable_"+(1e6*Math.random()|0),ae=0;function se(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ca=i,this.key=++ae,this.Y=this.Z=!1}function ce(e){e.Y=!0,e.listener=null,e.proxy=null,e.src=null,e.ca=null}function ue(e){this.src=e,this.a={},this.b=0}function le(e,t){var n=t.type;if(n in e.a){var r,i=e.a[n],o=E(i,t);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(ce(t),0==e.a[n].length&&(delete e.a[n],e.b--))}}function de(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.Y&&o.listener==t&&o.capture==!!n&&o.ca==r)return i}return-1}ue.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=de(e,t,r,i);return-1<a?(t=e[a],n||(t.Z=!1)):((t=new se(t,this.src,o,!!r,i)).Z=n,e.push(t)),t};var fe="closure_lm_"+(1e6*Math.random()|0),he={};function pe(e,t,n,r,i){if(r&&r.once)return me(e,t,n,r,i);if(Array.isArray(t)){for(var o=0;o<t.length;o++)pe(e,t[o],n,r,i);return null}return n=Se(n),e&&e[oe]?e.va(t,n,d(r)?!!r.capture:!!r,i):ve(e,t,n,!1,r,i)}function ve(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=d(i)?!!i.capture:!!i;if(a&&!Z)return null;var s=we(e);if(s||(e[fe]=s=new ue(e)),(n=s.add(t,n,r,a,o)).proxy)return n;if(r=function(){var e=Ee,t=Z?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)te||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(_e(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function me(e,t,n,r,i){if(Array.isArray(t)){for(var o=0;o<t.length;o++)me(e,t[o],n,r,i);return null}return n=Se(n),e&&e[oe]?e.wa(t,n,d(r)?!!r.capture:!!r,i):ve(e,t,n,!0,r,i)}function ge(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)ge(e,t[o],n,r,i);else r=d(r)?!!r.capture:!!r,n=Se(n),e&&e[oe]?(e=e.c,(t=String(t).toString())in e.a&&(-1<(n=de(o=e.a[t],n,r,i))&&(ce(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=we(e))&&(t=e.a[t.toString()],e=-1,t&&(e=de(t,n,r,i)),(n=-1<e?t[e]:null)&&ye(n))}function ye(e){if("number"!==typeof e&&e&&!e.Y){var t=e.src;if(t&&t[oe])le(t.c,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(_e(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=we(t))?(le(n,e),0==n.b&&(n.src=null,t[fe]=null)):ce(e)}}}function _e(e){return e in he?he[e]:he[e]="on"+e}function be(e,t){var n=e.listener,r=e.ca||e.src;return e.Z&&ye(e),n.call(r,t)}function Ee(e,t){if(e.Y)return!0;if(!Z){if(!t)e:{t=["window","event"];for(var n=c,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}return be(e,t=new re(t,this))}return be(e,new re(t,this))}function we(e){return(e=e[fe])instanceof ue?e:null}var Te="__closure_events_fn_"+(1e9*Math.random()>>>0);function Se(e){return"function"===typeof e?e:(e[Te]||(e[Te]=function(t){return e.handleEvent(t)}),e[Te])}function Ie(){b.call(this),this.c=new ue(this),this.J=this,this.C=null}function Re(e,t){var n,r=e.C;if(r)for(n=[];r;r=r.C)n.push(r);if(e=e.J,r=t.type||t,"string"===typeof t)t=new ne(t,e);else if(t instanceof ne)t.target=t.target||e;else{var i=t;L(t=new ne(r,e),i)}if(i=!0,n)for(var o=n.length-1;0<=o;o--){var a=t.a=n[o];i=Ae(a,r,!0,t)&&i}if(i=Ae(a=t.a=e,r,!0,t)&&i,i=Ae(a,r,!1,t)&&i,n)for(o=0;o<n.length;o++)i=Ae(a=t.a=n[o],r,!1,t)&&i}function Ae(e,t,n,r){if(!(t=e.c.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.Y&&a.capture==n){var s=a.listener,c=a.ca||a.src;a.Z&&le(e.c,a),i=!1!==s.call(c,r)&&i}}return i&&!r.defaultPrevented}_(Ie,b),Ie.prototype[oe]=!0,(o=Ie.prototype).addEventListener=function(e,t,n,r){pe(this,e,t,n,r)},o.removeEventListener=function(e,t,n,r){ge(this,e,t,n,r)},o.G=function(){if(Ie.X.G.call(this),this.c){var e,t=this.c;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)ce(n[r]);delete t.a[e],t.b--}}this.C=null},o.va=function(e,t,n,r){return this.c.add(String(e),t,!1,n,r)},o.wa=function(e,t,n,r){return this.c.add(String(e),t,!0,n,r)};var Ce=c.JSON.stringify;function ke(){this.b=this.a=null}var Oe,Ne=new(function(){function e(e,t){this.c=e,this.f=t,this.b=0,this.a=null}return e.prototype.get=function(){var e;return 0<this.b?(this.b--,e=this.a,this.a=e.next,e.next=null):e=this.c(),e},e}())((function(){return new De}),(function(e){e.reset()}));function Pe(){var e=Ue,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function De(){this.next=this.b=this.a=null}function xe(e){c.setTimeout((function(){throw e}),0)}function Le(e,t){Oe||function(){var e=c.Promise.resolve(void 0);Oe=function(){e.then(je)}}(),Me||(Oe(),Me=!0),Ue.add(e,t)}ke.prototype.add=function(e,t){var n=Ne.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},De.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},De.prototype.reset=function(){this.next=this.b=this.a=null};var Me=!1,Ue=new ke;function je(){for(var e;e=Pe();){try{e.a.call(e.b)}catch(n){xe(n)}var t=Ne;t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}Me=!1}function Fe(e,t){Ie.call(this),this.b=e||1,this.a=t||c,this.f=m(this.Za,this),this.g=y()}function Ve(e){e.aa=!1,e.M&&(e.a.clearTimeout(e.M),e.M=null)}function Be(e,t,n){if("function"===typeof e)n&&(e=m(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=m(e.handleEvent,e)}return 2147483647<Number(t)?-1:c.setTimeout(e,t||0)}function We(e){e.a=Be((function(){e.a=null,e.c&&(e.c=!1,We(e))}),e.h);var t=e.b;e.b=null,e.g.apply(null,t)}_(Fe,Ie),(o=Fe.prototype).aa=!1,o.M=null,o.Za=function(){if(this.aa){var e=y()-this.g;0<e&&e<.8*this.b?this.M=this.a.setTimeout(this.f,this.b-e):(this.M&&(this.a.clearTimeout(this.M),this.M=null),Re(this,"tick"),this.aa&&(Ve(this),this.start()))}},o.start=function(){this.aa=!0,this.M||(this.M=this.a.setTimeout(this.f,this.b),this.g=y())},o.G=function(){Fe.X.G.call(this),Ve(this),delete this.a};var Ge=function(e){function t(t,n){var r=e.call(this)||this;return r.g=t,r.h=n,r.b=null,r.c=!1,r.a=null,r}return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype.f=function(e){this.b=arguments,this.a?this.c=!0:We(this)},t.prototype.G=function(){e.prototype.G.call(this),this.a&&(c.clearTimeout(this.a),this.a=null,this.c=!1,this.b=null)},t}(b);function qe(e){b.call(this),this.b=e,this.a={}}_(qe,b);var Ke=[];function He(e,t,n,r){Array.isArray(n)||(n&&(Ke[0]=n.toString()),n=Ke);for(var i=0;i<n.length;i++){var o=pe(t,n[i],r||e.handleEvent,!1,e.b||e);if(!o)break;e.a[o.key]=o}}function ze(e){P(e.a,(function(e,t){this.a.hasOwnProperty(t)&&ye(e)}),e),e.a={}}function Ye(){this.a=!0}function Qe(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.a)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var o=i[0];if("noop"!=o&&"stop"!=o&&"close"!=o)for(var a=1;a<i.length;a++)i[a]=""}}}return Ce(n)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}qe.prototype.G=function(){qe.X.G.call(this),ze(this)},qe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},Ye.prototype.info=function(){};var Xe={},Je=null;function $e(){return Je=Je||new Ie}function Ze(e){ne.call(this,Xe.Fa,e)}function et(e){var t=$e();Re(t,new Ze(t,e))}function tt(e,t){ne.call(this,Xe.STAT_EVENT,e),this.stat=t}function nt(e){var t=$e();Re(t,new tt(t,e))}function rt(e){ne.call(this,Xe.Ga,e)}function it(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return c.setTimeout((function(){e()}),t)}Xe.Fa="serverreachability",_(Ze,ne),Xe.STAT_EVENT="statevent",_(tt,ne),Xe.Ga="timingevent",_(rt,ne);var ot={NO_ERROR:0,$a:1,nb:2,mb:3,hb:4,lb:5,ob:6,Da:7,TIMEOUT:8,rb:9},at={fb:"complete",Bb:"success",Ea:"error",Da:"abort",tb:"ready",ub:"readystatechange",TIMEOUT:"timeout",pb:"incrementaldata",sb:"progress",ib:"downloadprogress",Jb:"uploadprogress"};function st(){}function ct(e){var t;return(t=e.a)||(t=e.a={}),t}function ut(){}st.prototype.a=null;var lt,dt={OPEN:"a",eb:"b",Ea:"c",qb:"d"};function ft(){ne.call(this,"d")}function ht(){ne.call(this,"c")}function pt(){}function vt(e,t,n,r){this.g=e,this.c=t,this.f=n,this.S=r||1,this.J=new qe(this),this.P=mt,e=B?125:void 0,this.R=new Fe(e),this.B=null,this.b=!1,this.j=this.l=this.i=this.H=this.u=this.T=this.o=null,this.s=[],this.a=null,this.D=0,this.h=this.m=null,this.N=-1,this.A=!1,this.O=0,this.F=null,this.V=this.C=this.U=this.I=!1}_(ft,ne),_(ht,ne),_(pt,st),lt=new pt;var mt=45e3,gt={},yt={};function _t(e,t,n){e.H=1,e.i=Bt(Lt(t)),e.j=n,e.I=!0,bt(e,null)}function bt(e,t){e.u=y(),Tt(e),e.l=Lt(e.i);var n=e.l,r=e.S;Array.isArray(r)||(r=[String(r)]),en(n.b,"t",r),e.D=0,e.a=Qn(e.g,e.g.C?t:null),0<e.O&&(e.F=new Ge(m(e.Ca,e,e.a),e.O)),He(e.J,e.a,"readystatechange",e.Xa),t=e.B?D(e.B):{},e.j?(e.m||(e.m="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.a.ba(e.l,e.m,e.j,t)):(e.m="GET",e.a.ba(e.l,e.m,null,t)),et(1),function(e,t,n,r,i,o){e.info((function(){if(e.a)if(o)for(var a="",s=o.split("&"),c=0;c<s.length;c++){var u=s[c].split("=");if(1<u.length){var l=u[0];u=u[1];var d=l.split("_");a=2<=d.length&&"type"==d[1]?a+(l+"=")+u+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+a}))}(e.c,e.m,e.l,e.f,e.S,e.j)}function Et(e,t,n){for(var r=!0;!e.A&&e.D<n.length;){var i=wt(e,n);if(i==yt){4==t&&(e.h=4,nt(14),r=!1),Qe(e.c,e.f,null,"[Incomplete Response]");break}if(i==gt){e.h=4,nt(15),Qe(e.c,e.f,n,"[Invalid Chunk]"),r=!1;break}Qe(e.c,e.f,i,null),Ct(e,i)}4==t&&0==n.length&&(e.h=1,nt(16),r=!1),e.b=e.b&&r,r?0<n.length&&!e.V&&(e.V=!0,(t=e.g).a==e&&t.U&&!t.F&&(t.c.info("Great, no buffering proxy detected. Bytes received: "+n.length),Bn(t),t.F=!0,nt(11))):(Qe(e.c,e.f,n,"[Invalid Chunked Response]"),At(e),Rt(e))}function wt(e,t){var n=e.D,r=t.indexOf("\n",n);return-1==r?yt:(n=Number(t.substring(n,r)),isNaN(n)?gt:(r+=1)+n>t.length?yt:(t=t.substr(r,n),e.D=r+n,t))}function Tt(e){e.T=y()+e.P,St(e,e.P)}function St(e,t){if(null!=e.o)throw Error("WatchDog timer not null");e.o=it(m(e.Va,e),t)}function It(e){e.o&&(c.clearTimeout(e.o),e.o=null)}function Rt(e){0==e.g.v||e.A||qn(e.g,e)}function At(e){It(e);var t=e.F;t&&"function"==typeof t.ja&&t.ja(),e.F=null,Ve(e.R),ze(e.J),e.a&&(t=e.a,e.a=null,t.abort(),t.ja())}function Ct(e,t){try{var n=e.g;if(0!=n.v&&(n.a==e||cn(n.b,e)))if(n.I=e.N,!e.C&&cn(n.b,e)&&3==n.v){try{var r=n.ka.a.parse(t)}catch(g){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.j){if(n.a){if(!(n.a.u+3e3<e.u))break e;Gn(n),Pn(n)}Vn(n),nt(18)}}else n.oa=i[1],0<n.oa-n.P&&37500>i[2]&&n.H&&0==n.o&&!n.m&&(n.m=it(m(n.Sa,n),6e3));if(1>=sn(n.b)&&n.ea){try{n.ea()}catch(g){}n.ea=void 0}}else Hn(n,11)}else if((e.C||n.a==e)&&Gn(n),!I(t))for(t=r=n.ka.a.parse(t),r=0;r<t.length;r++)if(i=t[r],n.P=i[0],i=i[1],2==n.v)if("c"==i[0]){n.J=i[1],n.ga=i[2];var o=i[3];null!=o&&(n.ha=o,n.c.info("VER="+n.ha));var a=i[4];null!=a&&(n.pa=a,n.c.info("SVER="+n.pa));var s=i[5];if(null!=s&&"number"===typeof s&&0<s){var c=1.5*s;n.D=c,n.c.info("backChannelRequestTimeoutMs_="+c)}c=n;var u=e.a;if(u){var l=u.a?u.a.getResponseHeader("X-Client-Wire-Protocol"):null;if(l){var d=c.b;!d.a&&(C(l,"spdy")||C(l,"quic")||C(l,"h2"))&&(d.f=d.g,d.a=new Set,d.b&&(un(d,d.b),d.b=null))}if(c.A){var f=u.a?u.a.getResponseHeader("X-HTTP-Session-Id"):null;f&&(c.na=f,Vt(c.B,c.A,f))}}n.v=3,n.f&&n.f.ta(),n.U&&(n.N=y()-e.u,n.c.info("Handshake RTT: "+n.N+"ms"));var h=e;if((c=n).la=Yn(c,c.C?c.ga:null,c.fa),h.C){ln(c.b,h);var p=h,v=c.D;v&&p.setTimeout(v),p.o&&(It(p),Tt(p)),c.a=h}else Fn(c);0<n.g.length&&Ln(n)}else"stop"!=i[0]&&"close"!=i[0]||Hn(n,7);else 3==n.v&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?Hn(n,7):Nn(n):"noop"!=i[0]&&n.f&&n.f.sa(i),n.o=0);et(4)}catch(g){}}function kt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(l(e)||"string"===typeof e)w(e,t,void 0);else{if(e.L&&"function"==typeof e.L)var n=e.L();else if(e.K&&"function"==typeof e.K)n=void 0;else if(l(e)||"string"===typeof e){n=[];for(var r=e.length,i=0;i<r;i++)n.push(i)}else for(i in n=[],r=0,e)n[r++]=i;i=(r=function(e){if(e.K&&"function"==typeof e.K)return e.K();if("string"===typeof e)return e.split("");if(l(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e)).length;for(var o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}}function Ot(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Ot)for(n=e.L(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Nt(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Pt(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Pt(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Pt(e,t){return Object.prototype.hasOwnProperty.call(e,t)}(o=vt.prototype).setTimeout=function(e){this.P=e},o.Xa=function(e){e=e.target;var t=this.F;t&&3==An(e)?t.f():this.Ca(e)},o.Ca=function(e){try{if(e==this.a)e:{var t=An(this.a),n=this.a.ua(),r=this.a.W();if(!(3>t||3==t&&!B&&!this.a.$())){this.A||4!=t||7==n||et(8==n||0>=r?3:2),It(this);var i=this.a.W();this.N=i;var o=this.a.$();if(this.b=200==i,function(e,t,n,r,i,o,a){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+o+" "+a}))}(this.c,this.m,this.l,this.f,this.S,t,i),this.b){if(this.U&&!this.C){t:{if(this.a){var a,s=this.a;if((a=s.a?s.a.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(a)){var c=a;break t}}c=null}if(!c){this.b=!1,this.h=3,nt(12),At(this),Rt(this);break e}Qe(this.c,this.f,c,"Initial handshake response via X-HTTP-Initial-Response"),this.C=!0,Ct(this,c)}this.I?(Et(this,t,o),B&&this.b&&3==t&&(He(this.J,this.R,"tick",this.Wa),this.R.start())):(Qe(this.c,this.f,o,null),Ct(this,o)),4==t&&At(this),this.b&&!this.A&&(4==t?qn(this.g,this):(this.b=!1,Tt(this)))}else 400==i&&0<o.indexOf("Unknown SID")?(this.h=3,nt(12)):(this.h=0,nt(13)),At(this),Rt(this)}}}catch(u){}},o.Wa=function(){if(this.a){var e=An(this.a),t=this.a.$();this.D<t.length&&(It(this),Et(this,e,t),this.b&&4!=e&&Tt(this))}},o.cancel=function(){this.A=!0,At(this)},o.Va=function(){this.o=null;var e=y();0<=e-this.T?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.c,this.l),2!=this.H&&(et(3),nt(17)),At(this),this.h=2,Rt(this)):St(this,this.T-e)},(o=Ot.prototype).K=function(){Nt(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},o.L=function(){return Nt(this),this.a.concat()},o.get=function(e,t){return Pt(this.b,e)?this.b[e]:t},o.set=function(e,t){Pt(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},o.forEach=function(e,t){for(var n=this.L(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var Dt=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function xt(e,t){if(this.c=this.j=this.f="",this.h=null,this.i=this.g="",this.a=!1,e instanceof xt){this.a=void 0!==t?t:e.a,Mt(this,e.f),this.j=e.j,Ut(this,e.c),jt(this,e.h),this.g=e.g,t=e.b;var n=new Xt;n.c=t.c,t.a&&(n.a=new Ot(t.a),n.b=t.b),Ft(this,n),this.i=e.i}else e&&(n=String(e).match(Dt))?(this.a=!!t,Mt(this,n[1]||"",!0),this.j=Wt(n[2]||""),Ut(this,n[3]||"",!0),jt(this,n[4]),this.g=Wt(n[5]||"",!0),Ft(this,n[6]||"",!0),this.i=Wt(n[7]||"")):(this.a=!!t,this.b=new Xt(null,this.a))}function Lt(e){return new xt(e)}function Mt(e,t,n){e.f=n?Wt(t,!0):t,e.f&&(e.f=e.f.replace(/:$/,""))}function Ut(e,t,n){e.c=n?Wt(t,!0):t}function jt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.h=t}else e.h=null}function Ft(e,t,n){t instanceof Xt?(e.b=t,function(e,t){t&&!e.f&&(Jt(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&($t(this,t),en(this,n,e))}),e)),e.f=t}(e.b,e.a)):(n||(t=Gt(t,Yt)),e.b=new Xt(t,e.a))}function Vt(e,t,n){e.b.set(t,n)}function Bt(e){return Vt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^y()).toString(36)),e}function Wt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function Gt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,qt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function qt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}xt.prototype.toString=function(){var e=[],t=this.f;t&&e.push(Gt(t,Kt,!0),":");var n=this.c;return(n||"file"==t)&&(e.push("//"),(t=this.j)&&e.push(Gt(t,Kt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.h)&&e.push(":",String(n))),(n=this.g)&&(this.c&&"/"!=n.charAt(0)&&e.push("/"),e.push(Gt(n,"/"==n.charAt(0)?zt:Ht,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.i)&&e.push("#",Gt(n,Qt)),e.join("")};var Kt=/[#\/\?@]/g,Ht=/[#\?:]/g,zt=/[#\?]/g,Yt=/[#\?@]/g,Qt=/#/g;function Xt(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function Jt(e){e.a||(e.a=new Ot,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function $t(e,t){Jt(e),t=tn(e,t),Pt(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Pt((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Nt(e)))}function Zt(e,t){return Jt(e),t=tn(e,t),Pt(e.a.b,t)}function en(e,t,n){$t(e,t),0<n.length&&(e.c=null,e.a.set(tn(e,t),S(n)),e.b+=n.length)}function tn(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}(o=Xt.prototype).add=function(e,t){Jt(this),this.c=null,e=tn(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},o.forEach=function(e,t){Jt(this),this.a.forEach((function(n,r){w(n,(function(n){e.call(t,n,r,this)}),this)}),this)},o.L=function(){Jt(this);for(var e=this.a.K(),t=this.a.L(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},o.K=function(e){Jt(this);var t=[];if("string"===typeof e)Zt(this,e)&&(t=T(t,this.a.get(tn(this,e))));else{e=this.a.K();for(var n=0;n<e.length;n++)t=T(t,e[n])}return t},o.set=function(e,t){return Jt(this),this.c=null,Zt(this,e=tn(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},o.get=function(e,t){return e&&0<(e=this.K(e)).length?String(e[0]):t},o.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.L(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.K(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var nn=function(e,t){this.b=e,this.a=t};function rn(e){this.g=e||on,c.PerformanceNavigationTiming?e=0<(e=c.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(c.ia&&c.ia.ya&&c.ia.ya()&&c.ia.ya().Lb),this.f=e?this.g:1,this.a=null,1<this.f&&(this.a=new Set),this.b=null,this.c=[]}var on=10;function an(e){return!!e.b||!!e.a&&e.a.size>=e.f}function sn(e){return e.b?1:e.a?e.a.size:0}function cn(e,t){return e.b?e.b==t:!!e.a&&e.a.has(t)}function un(e,t){e.a?e.a.add(t):e.b=t}function ln(e,t){e.b&&e.b==t?e.b=null:e.a&&e.a.has(t)&&e.a.delete(t)}function dn(e){var t,n;if(null!=e.b)return e.c.concat(e.b.s);if(null!=e.a&&0!==e.a.size){var r=e.c;try{for(var o=i(e.a.values()),a=o.next();!a.done;a=o.next()){var s=a.value;r=r.concat(s.s)}}catch(c){t={error:c}}finally{try{a&&!a.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r}return S(e.c)}function fn(){}function hn(){this.a=new fn}function pn(e,t,n){var r=n||"";try{kt(e,(function(e,n){var i=e;d(e)&&(i=Ce(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function vn(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(o){}}rn.prototype.cancel=function(){var e,t;if(this.c=dn(this),this.b)this.b.cancel(),this.b=null;else if(this.a&&0!==this.a.size){try{for(var n=i(this.a.values()),r=n.next();!r.done;r=n.next()){r.value.cancel()}}catch(o){e={error:o}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}this.a.clear()}},fn.prototype.stringify=function(e){return c.JSON.stringify(e,void 0)},fn.prototype.parse=function(e){return c.JSON.parse(e,void 0)};var mn=c.JSON.parse;function gn(e){Ie.call(this),this.headers=new Ot,this.H=e||null,this.b=!1,this.s=this.a=null,this.B="",this.h=0,this.f="",this.g=this.A=this.l=this.u=!1,this.o=0,this.m=null,this.I=yn,this.D=this.F=!1}_(gn,Ie);var yn="",_n=/^https?$/i,bn=["POST","PUT"];function En(e){return"content-type"==e.toLowerCase()}function wn(e,t){e.b=!1,e.a&&(e.g=!0,e.a.abort(),e.g=!1),e.f=t,e.h=5,Tn(e),In(e)}function Tn(e){e.u||(e.u=!0,Re(e,"complete"),Re(e,"error"))}function Sn(e){if(e.b&&"undefined"!=typeof s&&(!e.s[1]||4!=An(e)||2!=e.W()))if(e.l&&4==An(e))Be(e.za,0,e);else if(Re(e,"readystatechange"),4==An(e)){e.b=!1;try{var t,n=e.W();e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.B).match(Dt)[1]||null;if(!o&&c.self&&c.self.location){var a=c.self.location.protocol;o=a.substr(0,a.length-1)}i=!_n.test(o?o.toLowerCase():"")}t=i}if(t)Re(e,"complete"),Re(e,"success");else{e.h=6;try{var u=2<An(e)?e.a.statusText:""}catch(n){u=""}e.f=u+" ["+e.W()+"]",Tn(e)}}finally{In(e)}}}function In(e,t){if(e.a){Rn(e);var n=e.a,r=e.s[0]?u:null;e.a=null,e.s=null,t||Re(e,"ready");try{n.onreadystatechange=r}catch(i){}}}function Rn(e){e.a&&e.D&&(e.a.ontimeout=null),e.m&&(c.clearTimeout(e.m),e.m=null)}function An(e){return e.a?e.a.readyState:0}function Cn(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=function(e){var t="";return P(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):Vt(e,t,n))}function kn(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function On(e){this.pa=0,this.g=[],this.c=new Ye,this.ga=this.la=this.B=this.fa=this.a=this.na=this.A=this.V=this.i=this.O=this.l=null,this.Oa=this.R=0,this.La=kn("failFast",!1,e),this.H=this.m=this.j=this.h=this.f=null,this.S=!0,this.I=this.oa=this.P=-1,this.T=this.o=this.u=0,this.Ha=kn("baseRetryDelayMs",5e3,e),this.Ra=kn("retryDelaySeedMs",1e4,e),this.Ma=kn("forwardChannelMaxRetries",2,e),this.ma=kn("forwardChannelRequestTimeoutMs",2e4,e),this.Na=e&&e.g||void 0,this.D=void 0,this.C=e&&e.supportsCrossDomainXhr||!1,this.J="",this.b=new rn(e&&e.concurrentRequestLimit),this.ka=new hn,this.da=e&&e.fastHandshake||!1,this.Ia=e&&e.b||!1,e&&e.f&&(this.c.a=!1),e&&e.forceLongPolling&&(this.S=!1),this.U=!this.da&&this.S&&e&&e.detectBufferingProxy||!1,this.ea=void 0,this.N=0,this.F=!1,this.s=null,(this.Ka=e&&e.c||!1)&&this.c.info("Opt-in to enable Chrome Origin Trials.")}function Nn(e){if(Dn(e),3==e.v){var t=e.R++,n=Lt(e.B);Vt(n,"SID",e.J),Vt(n,"RID",t),Vt(n,"TYPE","terminate"),Un(e,n),(t=new vt(e,e.c,t,void 0)).H=2,t.i=Bt(Lt(n)),n=!1,c.navigator&&c.navigator.sendBeacon&&(n=c.navigator.sendBeacon(t.i.toString(),"")),!n&&c.Image&&((new Image).src=t.i,n=!0),n||(t.a=Qn(t.g,null),t.a.ba(t.i)),t.u=y(),Tt(t)}zn(e)}function Pn(e){e.a&&(Bn(e),e.a.cancel(),e.a=null)}function Dn(e){Pn(e),e.j&&(c.clearTimeout(e.j),e.j=null),Gn(e),e.b.cancel(),e.h&&("number"===typeof e.h&&c.clearTimeout(e.h),e.h=null)}function xn(e,t){e.g.push(new nn(e.Oa++,t)),3==e.v&&Ln(e)}function Ln(e){an(e.b)||e.h||(e.h=!0,Le(e.Ba,e),e.u=0)}function Mn(e,t){var n;n=t?t.f:e.R++;var r=Lt(e.B);Vt(r,"SID",e.J),Vt(r,"RID",n),Vt(r,"AID",e.P),Un(e,r),e.i&&e.l&&Cn(r,e.i,e.l),n=new vt(e,e.c,n,e.u+1),null===e.i&&(n.B=e.l),t&&(e.g=t.s.concat(e.g)),t=jn(e,n,1e3),n.setTimeout(Math.round(.5*e.ma)+Math.round(.5*e.ma*Math.random())),un(e.b,n),_t(n,r,t)}function Un(e,t){e.f&&kt({},(function(e,n){Vt(t,n,e)}))}function jn(e,t,n){n=Math.min(e.g.length,n);var r=e.f?m(e.f.Ja,e.f,e):null;e:for(var i=e.g,o=-1;;){var a=["count="+n];-1==o?0<n?(o=i[0].b,a.push("ofs="+o)):o=0:a.push("ofs="+o);for(var s=!0,c=0;c<n;c++){var u=i[c].b,l=i[c].a;if(0>(u-=o))o=Math.max(0,i[c].b-100),s=!1;else try{pn(l,a,"req"+u+"_")}catch(d){r&&r(l)}}if(s){r=a.join("&");break e}}return e=e.g.splice(0,n),t.s=e,r}function Fn(e){e.a||e.j||(e.T=1,Le(e.Aa,e),e.o=0)}function Vn(e){return!(e.a||e.j||3<=e.o)&&(e.T++,e.j=it(m(e.Aa,e),Kn(e,e.o)),e.o++,!0)}function Bn(e){null!=e.s&&(c.clearTimeout(e.s),e.s=null)}function Wn(e){e.a=new vt(e,e.c,"rpc",e.T),null===e.i&&(e.a.B=e.l),e.a.O=0;var t=Lt(e.la);Vt(t,"RID","rpc"),Vt(t,"SID",e.J),Vt(t,"CI",e.H?"0":"1"),Vt(t,"AID",e.P),Un(e,t),Vt(t,"TYPE","xmlhttp"),e.i&&e.l&&Cn(t,e.i,e.l),e.D&&e.a.setTimeout(e.D);var n=e.a;e=e.ga,n.H=1,n.i=Bt(Lt(t)),n.j=null,n.I=!0,bt(n,e)}function Gn(e){null!=e.m&&(c.clearTimeout(e.m),e.m=null)}function qn(e,t){var n=null;if(e.a==t){Gn(e),Bn(e),e.a=null;var r=2}else{if(!cn(e.b,t))return;n=t.s,ln(e.b,t),r=1}if(e.I=t.N,0!=e.v)if(t.b)if(1==r){n=t.j?t.j.length:0,t=y()-t.u;var i=e.u;Re(r=$e(),new rt(r,n,t,i)),Ln(e)}else Fn(e);else if(3==(i=t.h)||0==i&&0<e.I||!(1==r&&function(e,t){return!(sn(e.b)>=e.b.f-(e.h?1:0))&&(e.h?(e.g=t.s.concat(e.g),!0):!(1==e.v||2==e.v||e.u>=(e.La?0:e.Ma))&&(e.h=it(m(e.Ba,e,t),Kn(e,e.u)),e.u++,!0))}(e,t)||2==r&&Vn(e)))switch(n&&0<n.length&&(t=e.b,t.c=t.c.concat(n)),i){case 1:Hn(e,5);break;case 4:Hn(e,10);break;case 3:Hn(e,6);break;default:Hn(e,2)}}function Kn(e,t){var n=e.Ha+Math.floor(Math.random()*e.Ra);return e.f||(n*=2),n*t}function Hn(e,t){if(e.c.info("Error code "+t),2==t){var n=null;e.f&&(n=null);var r=m(e.Ya,e);n||(n=new xt("//www.google.com/images/cleardot.gif"),c.location&&"http"==c.location.protocol||Mt(n,"https"),Bt(n)),function(e,t){var n=new Ye;if(c.Image){var r=new Image;r.onload=g(vn,n,r,"TestLoadImage: loaded",!0,t),r.onerror=g(vn,n,r,"TestLoadImage: error",!1,t),r.onabort=g(vn,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=g(vn,n,r,"TestLoadImage: timeout",!1,t),c.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(n.toString(),r)}else nt(2);e.v=0,e.f&&e.f.ra(t),zn(e),Dn(e)}function zn(e){e.v=0,e.I=-1,e.f&&(0==dn(e.b).length&&0==e.g.length||(e.b.c.length=0,S(e.g),e.g.length=0),e.f.qa())}function Yn(e,t,n){var r=function(e){return e instanceof xt?Lt(e):new xt(e,void 0)}(n);if(""!=r.c)t&&Ut(r,t+"."+r.c),jt(r,r.h);else{var i=c.location;r=function(e,t,n,r){var i=new xt(null,void 0);return e&&Mt(i,e),t&&Ut(i,t),n&&jt(i,n),r&&(i.g=r),i}(i.protocol,t?t+"."+i.hostname:i.hostname,+i.port,n)}return e.V&&P(e.V,(function(e,t){Vt(r,t,e)})),t=e.A,n=e.na,t&&n&&Vt(r,t,n),Vt(r,"VER",e.ha),Un(e,r),r}function Qn(e,t){if(t&&!e.C)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new gn(e.Na)).F=e.C,t}function Xn(){}function Jn(){if(F&&!(10<=Number($)))throw Error("Environmental error: no available transport.")}function $n(e,t){Ie.call(this),this.a=new On(t),this.o=e,this.b=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.a.l=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.a&&(e?e["X-WebChannel-Client-Profile"]=t.a:e={"X-WebChannel-Client-Profile":t.a}),this.a.O=e,(e=t&&t.httpHeadersOverwriteParam)&&!I(e)&&(this.a.i=e),this.m=t&&t.supportsCrossDomainXhr||!1,this.l=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!I(t)&&(this.a.A=t,null!==(e=this.b)&&t in e&&(t in(e=this.b)&&delete e[t])),this.f=new tr(this)}function Zn(e){ft.call(this);var t=e.__sm__;if(t){e:{for(var n in t){e=n;break e}e=void 0}(this.c=e)?(e=this.c,this.data=null!==t&&e in t?t[e]:void 0):this.data=t}else this.data=e}function er(){ht.call(this),this.status=1}function tr(e){this.a=e}(o=gn.prototype).ba=function(e,t,n,r){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+e);t=t?t.toUpperCase():"GET",this.B=e,this.f="",this.h=0,this.u=!1,this.b=!0,this.a=new XMLHttpRequest,this.s=this.H?ct(this.H):ct(lt),this.a.onreadystatechange=m(this.za,this);try{this.A=!0,this.a.open(t,String(e),!0),this.A=!1}catch(o){return void wn(this,o)}e=n||"";var i=new Ot(this.headers);r&&kt(r,(function(e,t){i.set(t,e)})),r=function(e){e:{for(var t=En,n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(i.L()),n=c.FormData&&e instanceof c.FormData,!(0<=E(bn,t))||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach((function(e,t){this.a.setRequestHeader(t,e)}),this),this.I&&(this.a.responseType=this.I),"withCredentials"in this.a&&this.a.withCredentials!==this.F&&(this.a.withCredentials=this.F);try{Rn(this),0<this.o&&((this.D=function(e){return F&&X(9)&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(this.a))?(this.a.timeout=this.o,this.a.ontimeout=m(this.xa,this)):this.m=Be(this.xa,this.o,this)),this.l=!0,this.a.send(e),this.l=!1}catch(o){wn(this,o)}},o.xa=function(){"undefined"!=typeof s&&this.a&&(this.f="Timed out after "+this.o+"ms, aborting",this.h=8,Re(this,"timeout"),this.abort(8))},o.abort=function(e){this.a&&this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1,this.h=e||7,Re(this,"complete"),Re(this,"abort"),In(this))},o.G=function(){this.a&&(this.b&&(this.b=!1,this.g=!0,this.a.abort(),this.g=!1),In(this,!0)),gn.X.G.call(this)},o.za=function(){this.j||(this.A||this.l||this.g?Sn(this):this.Ua())},o.Ua=function(){Sn(this)},o.W=function(){try{return 2<An(this)?this.a.status:-1}catch(e){return-1}},o.$=function(){try{return this.a?this.a.responseText:""}catch(e){return""}},o.Pa=function(e){if(this.a){var t=this.a.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),mn(t)}},o.ua=function(){return this.h},o.Qa=function(){return"string"===typeof this.f?this.f:String(this.f)},(o=On.prototype).ha=8,o.v=1,o.Ba=function(e){if(this.h)if(this.h=null,1==this.v){if(!e){this.R=Math.floor(1e5*Math.random()),e=this.R++;var t,n=new vt(this,this.c,e,void 0),r=this.l;if(this.O&&(r?L(r=D(r),this.O):r=this.O),null===this.i&&(n.B=r),this.da)e:{for(var i=t=0;i<this.g.length;i++){var o=this.g[i];if(void 0===(o="__data__"in o.a&&"string"===typeof(o=o.a.__data__)?o.length:void 0))break;if(4096<(t+=o)){t=i;break e}if(4096===t||i===this.g.length-1){t=i+1;break e}}t=1e3}else t=1e3;t=jn(this,n,t),Vt(i=Lt(this.B),"RID",e),Vt(i,"CVER",22),this.A&&Vt(i,"X-HTTP-Session-Id",this.A),Un(this,i),this.i&&r&&Cn(i,this.i,r),un(this.b,n),this.Ia&&Vt(i,"TYPE","init"),this.da?(Vt(i,"$req",t),Vt(i,"SID","null"),n.U=!0,_t(n,i,null)):_t(n,i,t),this.v=2}}else 3==this.v&&(e?Mn(this,e):0==this.g.length||an(this.b)||Mn(this))},o.Aa=function(){if(this.j=null,Wn(this),this.U&&!(this.F||null==this.a||0>=this.N)){var e=2*this.N;this.c.info("BP detection timer enabled: "+e),this.s=it(m(this.Ta,this),e)}},o.Ta=function(){this.s&&(this.s=null,this.c.info("BP detection timeout reached."),this.c.info("Buffering proxy detected and switch to long-polling!"),this.H=!1,this.F=!0,nt(10),Pn(this),Wn(this))},o.Sa=function(){null!=this.m&&(this.m=null,Pn(this),Vn(this),nt(19))},o.Ya=function(e){e?(this.c.info("Successfully pinged google.com"),nt(2)):(this.c.info("Failed to ping google.com"),nt(1))},(o=Xn.prototype).ta=function(){},o.sa=function(){},o.ra=function(){},o.qa=function(){},o.Ja=function(){},Jn.prototype.a=function(e,t){return new $n(e,t)},_($n,Ie),$n.prototype.g=function(){this.a.f=this.f,this.m&&(this.a.C=!0);var e=this.a,t=this.o,n=this.b||void 0;nt(0),e.fa=t,e.V=n||{},e.H=e.S,e.B=Yn(e,null,e.fa),Ln(e)},$n.prototype.close=function(){Nn(this.a)},$n.prototype.h=function(e){if("string"===typeof e){var t={};t.__data__=e,xn(this.a,t)}else this.l?((t={}).__data__=Ce(e),xn(this.a,t)):xn(this.a,e)},$n.prototype.G=function(){this.a.f=null,delete this.f,Nn(this.a),delete this.a,$n.X.G.call(this)},_(Zn,ft),_(er,ht),_(tr,Xn),tr.prototype.ta=function(){Re(this.a,"a")},tr.prototype.sa=function(e){Re(this.a,new Zn(e))},tr.prototype.ra=function(e){Re(this.a,new er(e))},tr.prototype.qa=function(){Re(this.a,"b")},Jn.prototype.createWebChannel=Jn.prototype.a,$n.prototype.send=$n.prototype.h,$n.prototype.open=$n.prototype.g,$n.prototype.close=$n.prototype.close,ot.NO_ERROR=0,ot.TIMEOUT=8,ot.HTTP_ERROR=6,at.COMPLETE="complete",ut.EventType=dt,dt.OPEN="a",dt.CLOSE="b",dt.ERROR="c",dt.MESSAGE="d",Ie.prototype.listen=Ie.prototype.va,gn.prototype.listenOnce=gn.prototype.wa,gn.prototype.getLastError=gn.prototype.Qa,gn.prototype.getLastErrorCode=gn.prototype.ua,gn.prototype.getStatus=gn.prototype.W,gn.prototype.getResponseJson=gn.prototype.Pa,gn.prototype.getResponseText=gn.prototype.$,gn.prototype.send=gn.prototype.ba;var nr=function(){return new Jn},rr=function(){return $e()},ir=ot,or=at,ar=Xe,sr={gb:0,jb:1,kb:2,Db:3,Ib:4,Fb:5,Gb:6,Eb:7,Cb:8,Hb:9,PROXY:10,NOPROXY:11,Ab:12,wb:13,xb:14,vb:15,yb:16,zb:17,bb:18,ab:19,cb:20},cr=ut,ur=gn}).call(this,n(33))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i.v})),n.d(t,"b",(function(){return i.l})),n.d(t,"c",(function(){return i.j})),n.d(t,"d",(function(){return i.u})),n.d(t,"e",(function(){return l}));n(11),n(12);var r=n(6),i=n(4),o=(n(40),function(e){return{done:!0,value:e}}),a={};function s(e){return Object(r.b)(e)?"channel":Object(r.l)(e)?String(e):Object(r.d)(e)?e.name:String(e)}function c(e,t,n){var r,s,c,u=t;function l(t,n){if(u===a)return o(t);if(n&&!s)throw u=a,n;r&&r(t);var i=n?e[s](n):e[u]();return u=i.nextState,c=i.effect,r=i.stateUpdater,s=i.errorState,u===a?o(t):c}return Object(i.M)(l,(function(e){return l(null,e)}),n)}function u(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];var a,u,l={done:!1,value:Object(i.i)(e)},d=function(e){return{done:!1,value:i.j.apply(void 0,[t].concat(r,[e]))}},f=function(e){return{done:!1,value:Object(i.k)(e)}},h=function(e){return a=e},p=function(e){return u=e};return c({q1:function(){return{nextState:"q2",effect:l,stateUpdater:p}},q2:function(){return a?{nextState:"q3",effect:f(a)}:{nextState:"q1",effect:d(u),stateUpdater:h}},q3:function(){return{nextState:"q1",effect:d(u),stateUpdater:h}}},"q1","takeLatest("+s(e)+", "+t.name+")")}function l(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return i.j.apply(void 0,[u,e,t].concat(r))}},function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";var r="Invariant failed";t.a=function(e,t){if(!e)throw new Error(r)}},function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,r(e,t)}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return T})),n.d(t,"b",(function(){return k})),n.d(t,"d",(function(){return N})),n.d(t,"c",(function(){return v})),n.d(t,"f",(function(){return m})),n.d(t,"e",(function(){return p}));var r=n(12);function i(e){return"/"===e.charAt(0)}function o(e,t){for(var n=t,r=n+1,i=e.length;r<i;n+=1,r+=1)e[n]=e[r];e.pop()}var a=function(e,t){void 0===t&&(t="");var n,r=e&&e.split("/")||[],a=t&&t.split("/")||[],s=e&&i(e),c=t&&i(t),u=s||c;if(e&&i(e)?a=r:r.length&&(a.pop(),a=a.concat(r)),!a.length)return"/";if(a.length){var l=a[a.length-1];n="."===l||".."===l||""===l}else n=!1;for(var d=0,f=a.length;f>=0;f--){var h=a[f];"."===h?o(a,f):".."===h?(o(a,f),d++):d&&(o(a,f),d--)}if(!u)for(;d--;d)a.unshift("..");!u||""===a[0]||a[0]&&i(a[0])||a.unshift("");var p=a.join("/");return n&&"/"!==p.substr(-1)&&(p+="/"),p};function s(e){return e.valueOf?e.valueOf():Object.prototype.valueOf.call(e)}var c=function e(t,n){if(t===n)return!0;if(null==t||null==n)return!1;if(Array.isArray(t))return Array.isArray(n)&&t.length===n.length&&t.every((function(t,r){return e(t,n[r])}));if("object"===typeof t||"object"===typeof n){var r=s(t),i=s(n);return r!==t||i!==n?e(r,i):Object.keys(Object.assign({},t,n)).every((function(r){return e(t[r],n[r])}))}return!1},u=n(23);function l(e){return"/"===e.charAt(0)?e:"/"+e}function d(e){return"/"===e.charAt(0)?e.substr(1):e}function f(e,t){return function(e,t){return 0===e.toLowerCase().indexOf(t.toLowerCase())&&-1!=="/?#".indexOf(e.charAt(t.length))}(e,t)?e.substr(t.length):e}function h(e){return"/"===e.charAt(e.length-1)?e.slice(0,-1):e}function p(e){var t=e.pathname,n=e.search,r=e.hash,i=t||"/";return n&&"?"!==n&&(i+="?"===n.charAt(0)?n:"?"+n),r&&"#"!==r&&(i+="#"===r.charAt(0)?r:"#"+r),i}function v(e,t,n,i){var o;"string"===typeof e?(o=function(e){var t=e||"/",n="",r="",i=t.indexOf("#");-1!==i&&(r=t.substr(i),t=t.substr(0,i));var o=t.indexOf("?");return-1!==o&&(n=t.substr(o),t=t.substr(0,o)),{pathname:t,search:"?"===n?"":n,hash:"#"===r?"":r}}(e)).state=t:(void 0===(o=Object(r.a)({},e)).pathname&&(o.pathname=""),o.search?"?"!==o.search.charAt(0)&&(o.search="?"+o.search):o.search="",o.hash?"#"!==o.hash.charAt(0)&&(o.hash="#"+o.hash):o.hash="",void 0!==t&&void 0===o.state&&(o.state=t));try{o.pathname=decodeURI(o.pathname)}catch(s){throw s instanceof URIError?new URIError('Pathname "'+o.pathname+'" could not be decoded. This is likely caused by an invalid percent-encoding.'):s}return n&&(o.key=n),i?o.pathname?"/"!==o.pathname.charAt(0)&&(o.pathname=a(o.pathname,i.pathname)):o.pathname=i.pathname:o.pathname||(o.pathname="/"),o}function m(e,t){return e.pathname===t.pathname&&e.search===t.search&&e.hash===t.hash&&e.key===t.key&&c(e.state,t.state)}function g(){var e=null;var t=[];return{setPrompt:function(t){return e=t,function(){e===t&&(e=null)}},confirmTransitionTo:function(t,n,r,i){if(null!=e){var o="function"===typeof e?e(t,n):e;"string"===typeof o?"function"===typeof r?r(o,i):i(!0):i(!1!==o)}else i(!0)},appendListener:function(e){var n=!0;function r(){n&&e.apply(void 0,arguments)}return t.push(r),function(){n=!1,t=t.filter((function(e){return e!==r}))}},notifyListeners:function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.forEach((function(e){return e.apply(void 0,n)}))}}}var y=!("undefined"===typeof window||!window.document||!window.document.createElement);function _(e,t){t(window.confirm(e))}var b="popstate",E="hashchange";function w(){try{return window.history.state||{}}catch(e){return{}}}function T(e){void 0===e&&(e={}),y||Object(u.a)(!1);var t=window.history,n=function(){var e=window.navigator.userAgent;return(-1===e.indexOf("Android 2.")&&-1===e.indexOf("Android 4.0")||-1===e.indexOf("Mobile Safari")||-1!==e.indexOf("Chrome")||-1!==e.indexOf("Windows Phone"))&&window.history&&"pushState"in window.history}(),i=!(-1===window.navigator.userAgent.indexOf("Trident")),o=e,a=o.forceRefresh,s=void 0!==a&&a,c=o.getUserConfirmation,d=void 0===c?_:c,m=o.keyLength,T=void 0===m?6:m,S=e.basename?h(l(e.basename)):"";function I(e){var t=e||{},n=t.key,r=t.state,i=window.location,o=i.pathname+i.search+i.hash;return S&&(o=f(o,S)),v(o,r,n)}function R(){return Math.random().toString(36).substr(2,T)}var A=g();function C(e){Object(r.a)(V,e),V.length=t.length,A.notifyListeners(V.location,V.action)}function k(e){(function(e){return void 0===e.state&&-1===navigator.userAgent.indexOf("CriOS")})(e)||P(I(e.state))}function O(){P(I(w()))}var N=!1;function P(e){if(N)N=!1,C();else{A.confirmTransitionTo(e,"POP",d,(function(t){t?C({action:"POP",location:e}):function(e){var t=V.location,n=x.indexOf(t.key);-1===n&&(n=0);var r=x.indexOf(e.key);-1===r&&(r=0);var i=n-r;i&&(N=!0,M(i))}(e)}))}}var D=I(w()),x=[D.key];function L(e){return S+p(e)}function M(e){t.go(e)}var U=0;function j(e){1===(U+=e)&&1===e?(window.addEventListener(b,k),i&&window.addEventListener(E,O)):0===U&&(window.removeEventListener(b,k),i&&window.removeEventListener(E,O))}var F=!1;var V={length:t.length,action:"POP",location:D,createHref:L,push:function(e,r){var i="PUSH",o=v(e,r,R(),V.location);A.confirmTransitionTo(o,i,d,(function(e){if(e){var r=L(o),a=o.key,c=o.state;if(n)if(t.pushState({key:a,state:c},null,r),s)window.location.href=r;else{var u=x.indexOf(V.location.key),l=x.slice(0,u+1);l.push(o.key),x=l,C({action:i,location:o})}else window.location.href=r}}))},replace:function(e,r){var i="REPLACE",o=v(e,r,R(),V.location);A.confirmTransitionTo(o,i,d,(function(e){if(e){var r=L(o),a=o.key,c=o.state;if(n)if(t.replaceState({key:a,state:c},null,r),s)window.location.replace(r);else{var u=x.indexOf(V.location.key);-1!==u&&(x[u]=o.key),C({action:i,location:o})}else window.location.replace(r)}}))},go:M,goBack:function(){M(-1)},goForward:function(){M(1)},block:function(e){void 0===e&&(e=!1);var t=A.setPrompt(e);return F||(j(1),F=!0),function(){return F&&(F=!1,j(-1)),t()}},listen:function(e){var t=A.appendListener(e);return j(1),function(){j(-1),t()}}};return V}var S="hashchange",I={hashbang:{encodePath:function(e){return"!"===e.charAt(0)?e:"!/"+d(e)},decodePath:function(e){return"!"===e.charAt(0)?e.substr(1):e}},noslash:{encodePath:d,decodePath:l},slash:{encodePath:l,decodePath:l}};function R(e){var t=e.indexOf("#");return-1===t?e:e.slice(0,t)}function A(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.substring(t+1)}function C(e){window.location.replace(R(window.location.href)+"#"+e)}function k(e){void 0===e&&(e={}),y||Object(u.a)(!1);var t=window.history,n=(window.navigator.userAgent.indexOf("Firefox"),e),i=n.getUserConfirmation,o=void 0===i?_:i,a=n.hashType,s=void 0===a?"slash":a,c=e.basename?h(l(e.basename)):"",d=I[s],m=d.encodePath,b=d.decodePath;function E(){var e=b(A());return c&&(e=f(e,c)),v(e)}var w=g();function T(e){Object(r.a)(V,e),V.length=t.length,w.notifyListeners(V.location,V.action)}var k=!1,O=null;function N(){var e,t,n=A(),r=m(n);if(n!==r)C(r);else{var i=E(),a=V.location;if(!k&&(t=i,(e=a).pathname===t.pathname&&e.search===t.search&&e.hash===t.hash))return;if(O===p(i))return;O=null,function(e){if(k)k=!1,T();else{var t="POP";w.confirmTransitionTo(e,t,o,(function(n){n?T({action:t,location:e}):function(e){var t=V.location,n=L.lastIndexOf(p(t));-1===n&&(n=0);var r=L.lastIndexOf(p(e));-1===r&&(r=0);var i=n-r;i&&(k=!0,M(i))}(e)}))}}(i)}}var P=A(),D=m(P);P!==D&&C(D);var x=E(),L=[p(x)];function M(e){t.go(e)}var U=0;function j(e){1===(U+=e)&&1===e?window.addEventListener(S,N):0===U&&window.removeEventListener(S,N)}var F=!1;var V={length:t.length,action:"POP",location:x,createHref:function(e){var t=document.querySelector("base"),n="";return t&&t.getAttribute("href")&&(n=R(window.location.href)),n+"#"+m(c+p(e))},push:function(e,t){var n="PUSH",r=v(e,void 0,void 0,V.location);w.confirmTransitionTo(r,n,o,(function(e){if(e){var t=p(r),i=m(c+t);if(A()!==i){O=t,function(e){window.location.hash=e}(i);var o=L.lastIndexOf(p(V.location)),a=L.slice(0,o+1);a.push(t),L=a,T({action:n,location:r})}else T()}}))},replace:function(e,t){var n="REPLACE",r=v(e,void 0,void 0,V.location);w.confirmTransitionTo(r,n,o,(function(e){if(e){var t=p(r),i=m(c+t);A()!==i&&(O=t,C(i));var o=L.indexOf(p(V.location));-1!==o&&(L[o]=t),T({action:n,location:r})}}))},go:M,goBack:function(){M(-1)},goForward:function(){M(1)},block:function(e){void 0===e&&(e=!1);var t=w.setPrompt(e);return F||(j(1),F=!0),function(){return F&&(F=!1,j(-1)),t()}},listen:function(e){var t=w.appendListener(e);return j(1),function(){j(-1),t()}}};return V}function O(e,t,n){return Math.min(Math.max(e,t),n)}function N(e){void 0===e&&(e={});var t=e,n=t.getUserConfirmation,i=t.initialEntries,o=void 0===i?["/"]:i,a=t.initialIndex,s=void 0===a?0:a,c=t.keyLength,u=void 0===c?6:c,l=g();function d(e){Object(r.a)(b,e),b.length=b.entries.length,l.notifyListeners(b.location,b.action)}function f(){return Math.random().toString(36).substr(2,u)}var h=O(s,0,o.length-1),m=o.map((function(e){return v(e,void 0,"string"===typeof e?f():e.key||f())})),y=p;function _(e){var t=O(b.index+e,0,b.entries.length-1),r=b.entries[t];l.confirmTransitionTo(r,"POP",n,(function(e){e?d({action:"POP",location:r,index:t}):d()}))}var b={length:m.length,action:"POP",location:m[h],index:h,entries:m,createHref:y,push:function(e,t){var r="PUSH",i=v(e,t,f(),b.location);l.confirmTransitionTo(i,r,n,(function(e){if(e){var t=b.index+1,n=b.entries.slice(0);n.length>t?n.splice(t,n.length-t,i):n.push(i),d({action:r,location:i,index:t,entries:n})}}))},replace:function(e,t){var r="REPLACE",i=v(e,t,f(),b.location);l.confirmTransitionTo(i,r,n,(function(e){e&&(b.entries[b.index]=i,d({action:r,location:i}))}))},go:_,goBack:function(){_(-1)},goForward:function(){_(1)},canGo:function(e){var t=b.index+e;return t>=0&&t<b.entries.length},block:function(e){return void 0===e&&(e=!1),l.setPrompt(e)},listen:function(e){return l.appendListener(e)}};return b}},function(e,t,n){"use strict";n.d(t,"a",(function(){return m})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return u})),n.d(t,"d",(function(){return v})),n.d(t,"e",(function(){return s}));var r=n(46),i=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function a(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,n){var i;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(s)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var c=e,u=t,l=[],d=l,f=!1;function h(){d===l&&(d=l.slice())}function p(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function v(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribelistener for more details.");var t=!0;return h(),d.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribelistener for more details.");t=!1,h();var n=d.indexOf(e);d.splice(n,1),l=null}}}function m(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,u=c(u,e)}finally{f=!1}for(var t=l=d,n=0;n<t.length;n++){(0,t[n])()}return e}function g(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,m({type:o.REPLACE})}function y(){var e,t=v;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(p())}return n(),{unsubscribe:t(n)}}})[r.a]=function(){return this},e}return m({type:o.INIT}),(i={dispatch:m,subscribe:v,getState:p,replaceReducer:g})[r.a]=y,i}function c(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e){for(var t=Object.keys(e),n={},r=0;r<t.length;r++){var i=t[r];0,"function"===typeof e[i]&&(n[i]=e[i])}var a,s=Object.keys(n);try{!function(e){Object.keys(e).forEach((function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:o.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof n(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(n)}catch(u){a=u}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var r=!1,i={},o=0;o<s.length;o++){var u=s[o],l=n[u],d=e[u],f=l(d,t);if("undefined"===typeof f){var h=c(u,t);throw new Error(h)}i[u]=f,r=r||f!==d}return(r=r||s.length!==Object.keys(e).length)?i:e}}function l(e,t){return function(){return t(e.apply(this,arguments))}}function d(e,t){if("function"===typeof e)return l(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var n={};for(var r in e){var i=e[r];"function"===typeof i&&(n[r]=l(i,t))}return n}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(n,!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function v(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function m(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(i)}));return p({},n,{dispatch:r=v.apply(void 0,o)(n.dispatch)})}}}},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return g}));var r=n(19),i=n(24),o=n(2),a=n.n(o),s=n(25),c=(n(34),n(12)),u=n(22),l=n(23),d=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return(t=e.call.apply(e,[this].concat(r))||this).history=Object(s.a)(t.props),t}return Object(i.a)(t,e),t.prototype.render=function(){return a.a.createElement(r.b,{history:this.history,children:this.props.children})},t}(a.a.Component);a.a.Component;var f=function(e,t){return"function"===typeof e?e(t):e},h=function(e,t){return"string"===typeof e?Object(s.c)(e,null,null,t):e},p=function(e){return e},v=a.a.forwardRef;"undefined"===typeof v&&(v=p);var m=v((function(e,t){var n=e.innerRef,r=e.navigate,i=e.onClick,o=Object(u.a)(e,["innerRef","navigate","onClick"]),s=o.target,l=Object(c.a)({},o,{onClick:function(e){try{i&&i(e)}catch(t){throw e.preventDefault(),t}e.defaultPrevented||0!==e.button||s&&"_self"!==s||function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)||(e.preventDefault(),r())}});return l.ref=p!==v&&t||n,a.a.createElement("a",l)}));var g=v((function(e,t){var n=e.component,i=void 0===n?m:n,o=e.replace,s=e.to,d=e.innerRef,g=Object(u.a)(e,["component","replace","to","innerRef"]);return a.a.createElement(r.c.Consumer,null,(function(e){e||Object(l.a)(!1);var n=e.history,r=h(f(s,e.location),e.location),u=r?n.createHref(r):"",m=Object(c.a)({},g,{href:u,navigate:function(){var t=f(s,e.location);(o?n.replace:n.push)(t)}});return p!==v?m.ref=t||d:m.innerRef=d,a.a.createElement(i,m)}))})),y=function(e){return e},_=a.a.forwardRef;"undefined"===typeof _&&(_=y);_((function(e,t){var n=e["aria-current"],i=void 0===n?"page":n,o=e.activeClassName,s=void 0===o?"active":o,d=e.activeStyle,p=e.className,v=e.exact,m=e.isActive,b=e.location,E=e.sensitive,w=e.strict,T=e.style,S=e.to,I=e.innerRef,R=Object(u.a)(e,["aria-current","activeClassName","activeStyle","className","exact","isActive","location","sensitive","strict","style","to","innerRef"]);return a.a.createElement(r.c.Consumer,null,(function(e){e||Object(l.a)(!1);var n=b||e.location,o=h(f(S,n),n),u=o.pathname,A=u&&u.replace(/([.+*?=^!:${}()[\]|/\\])/g,"\\$1"),C=A?Object(r.d)(n.pathname,{path:A,exact:v,sensitive:E,strict:w}):null,k=!!(m?m(C,n):C),O=k?function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((function(e){return e})).join(" ")}(p,s):p,N=k?Object(c.a)({},T,{},d):T,P=Object(c.a)({"aria-current":k&&i||null,className:O,style:N,to:o},R);return y!==_?P.ref=t||I:P.innerRef=I,a.a.createElement(g,P)}))}))},function(e,t,n){"use strict";var r=n(32),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function c(e){return r.isMemo(e)?a:s[e.$$typeof]||i}s[r.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},s[r.Memo]=a;var u=Object.defineProperty,l=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,f=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,p=Object.prototype;e.exports=function e(t,n,r){if("string"!==typeof n){if(p){var i=h(n);i&&i!==p&&e(t,i,r)}var a=l(n);d&&(a=a.concat(d(n)));for(var s=c(t),v=c(n),m=0;m<a.length;++m){var g=a[m];if(!o[g]&&(!r||!r[g])&&(!v||!v[g])&&(!s||!s[g])){var y=f(n,g);try{u(t,g,y)}catch(_){}}}}return t}},function(e,t,n){!function(e){"use strict";function t(e){return Array.prototype.slice.call(e)}function n(e){return new Promise((function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function r(e,t,r){var i,o=new Promise((function(o,a){n(i=e[t].apply(e,r)).then(o,a)}));return o.request=i,o}function i(e,t,n){var i=r(e,t,n);return i.then((function(e){if(e)return new l(e,i.request)}))}function o(e,t,n){n.forEach((function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})}))}function a(e,t,n,i){i.forEach((function(i){i in n.prototype&&(e.prototype[i]=function(){return r(this[t],i,arguments)})}))}function s(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})}))}function c(e,t,n,r){r.forEach((function(r){r in n.prototype&&(e.prototype[r]=function(){return i(this[t],r,arguments)})}))}function u(e){this._index=e}function l(e,t){this._cursor=e,this._request=t}function d(e){this._store=e}function f(e){this._tx=e,this.complete=new Promise((function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}}))}function h(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new f(n)}function p(e){this._db=e}function v(e,t,n){var i=r(indexedDB,"open",[e,t]),o=i.request;return o&&(o.onupgradeneeded=function(e){n&&n(new h(o.result,e.oldVersion,o.transaction))}),i.then((function(e){return new p(e)}))}function m(e){return r(indexedDB,"deleteDatabase",[e])}o(u,"_index",["name","keyPath","multiEntry","unique"]),a(u,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),c(u,"_index",IDBIndex,["openCursor","openKeyCursor"]),o(l,"_cursor",["direction","key","primaryKey","value"]),a(l,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach((function(e){e in IDBCursor.prototype&&(l.prototype[e]=function(){var t=this,r=arguments;return Promise.resolve().then((function(){return t._cursor[e].apply(t._cursor,r),n(t._request).then((function(e){if(e)return new l(e,t._request)}))}))})})),d.prototype.createIndex=function(){return new u(this._store.createIndex.apply(this._store,arguments))},d.prototype.index=function(){return new u(this._store.index.apply(this._store,arguments))},o(d,"_store",["name","keyPath","indexNames","autoIncrement"]),a(d,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),c(d,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),s(d,"_store",IDBObjectStore,["deleteIndex"]),f.prototype.objectStore=function(){return new d(this._tx.objectStore.apply(this._tx,arguments))},o(f,"_tx",["objectStoreNames","mode"]),s(f,"_tx",IDBTransaction,["abort"]),h.prototype.createObjectStore=function(){return new d(this._db.createObjectStore.apply(this._db,arguments))},o(h,"_db",["name","version","objectStoreNames"]),s(h,"_db",IDBDatabase,["deleteObjectStore","close"]),p.prototype.transaction=function(){return new f(this._db.transaction.apply(this._db,arguments))},o(p,"_db",["name","version","objectStoreNames"]),s(p,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach((function(e){[d,u].forEach((function(n){e in n.prototype&&(n.prototype[e.replace("open","iterate")]=function(){var n=t(arguments),r=n[n.length-1],i=this._store||this._index,o=i[e].apply(i,n.slice(0,-1));o.onsuccess=function(){r(o.result)}})}))})),[u,d].forEach((function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise((function(i){n.iterateCursor(e,(function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():i(r)):i(r)}))}))})})),e.openDb=v,e.deleteDb=m,Object.defineProperty(e,"__esModule",{value:!0})}(t)},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,c,"next",e)}function c(e){r(a,i,o,s,c,"throw",e)}s(void 0)}))}}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";e.exports=n(65)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){e.exports=n(67)()},function(e,t,n){"use strict";(function(t,r){var i=n(74),o=n(52),a=n(79),s=n(45),c=n(53),u=n(81),l=n(85),d=n(87),f=n(89),h=n(90),p=n(91),v=n(13),m=n(92),g=n(93);e.exports=function(){var e,n,y,_,b;function E(e,t,n){return e(n={path:t,exports:{},require:function(e,t){throw Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}},n.exports),n.exports}function w(e,t,n){return(e=e.match(t))&&e.length>=n&&Ba(e[n],10)}function T(e,t,n){if(e.RTCPeerConnection){var r=(e=e.RTCPeerConnection.prototype).addEventListener;e.addEventListener=function(e,i){if(e!==t)return r.apply(this,arguments);var o=function(e){(e=n(e))&&i(e)};return this._eventMap=this._eventMap||{},this._eventMap[i]=o,r.apply(this,[e,o])};var i=e.removeEventListener;e.removeEventListener=function(e,n){if(e!==t||!this._eventMap||!this._eventMap[n])return i.apply(this,arguments);var r=this._eventMap[n];return delete this._eventMap[n],i.apply(this,[e,r])},Da(e,"on"+t,{get:function(){return this["_on"+t]},set:function(e){this["_on"+t]&&(this.removeEventListener(t,this["_on"+t]),delete this["_on"+t]),e&&this.addEventListener(t,this["_on"+t]=e)},enumerable:!0,configurable:!0})}}function S(e){return"boolean"!=typeof e?Error("Argument type: "+typeof e+". Please use a boolean."):(Wa=e,e?"adapter.js logging disabled":"adapter.js logging enabled")}function I(e){return"boolean"!=typeof e?Error("Argument type: "+typeof e+". Please use a boolean."):(Ga=!e,"adapter.js deprecation warnings "+(e?"disabled":"enabled"))}function R(){"object"!=typeof window||Wa||"undefined"!=typeof console&&"function"==typeof console.log&&console.log.apply(console,arguments)}function A(e,t){Ga&&console.warn(e+" is deprecated, please use "+t+" instead.")}function C(e){var t=e.navigator,n={browser:null,version:null};if(void 0===e||!e.navigator)return n.browser="Not a browser.",n;if(t.mozGetUserMedia)n.browser="firefox",n.version=w(t.userAgent,/Firefox\/(\d+)\./,1);else if(t.webkitGetUserMedia||!1===e.isSecureContext&&e.webkitRTCPeerConnection&&!e.RTCIceGatherer)n.browser="chrome",n.version=w(t.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.mediaDevices&&t.userAgent.match(/Edge\/(\d+).(\d+)$/))n.browser="edge",n.version=w(t.userAgent,/Edge\/(\d+).(\d+)$/,2);else{if(!e.RTCPeerConnection||!t.userAgent.match(/AppleWebKit\/(\d+)\./))return n.browser="Not a supported browser.",n;n.browser="safari",n.version=w(t.userAgent,/AppleWebKit\/(\d+)\./,1),n.supportsUnifiedPlan=e.RTCRtpTransceiver&&"currentDirection"in e.RTCRtpTransceiver.prototype}return n}function k(e){var t;return"[object Object]"===Object.prototype.toString.call(e)?Na(t=Ra(e)).call(t,(function(t,n){var r="[object Object]"===Object.prototype.toString.call(e[n]),i=r?k(e[n]):e[n];return r=r&&!Ra(i).length,void 0===i||r?t:Sa(t,g({},n,i))}),{}):e}function O(e,t,n){var r=n?"outbound-rtp":"inbound-rtp",i=new ra;if(null===t)return i;var o=[];return ba(e).call(e,(function(e){"track"===e.type&&e.trackIdentifier===t.id&&o.push(e)})),ba(o).call(o,(function(t){ba(e).call(e,(function(n){n.type===r&&n.trackId===t.id&&function e(t,n,r){var i;n&&!r.has(n.id)&&(r.set(n.id,n),ba(i=Ra(n)).call(i,(function(i){if(pa(i).call(i,"Id"))e(t,t.get(n[i]),r);else if(pa(i).call(i,"Ids")){var o;ba(o=n[i]).call(o,(function(n){e(t,t.get(n),r)}))}})))}(e,n,i)}))})),i}function N(e){var t=e&&e.navigator;if(t.mediaDevices){var n=C(e),r=function(e){var t;if("object"!=typeof e||e.mandatory||e.optional)return e;var n,r={};return ba(t=Ra(e)).call(t,(function(t){if("require"!==t&&"advanced"!==t&&"mediaSource"!==t){var n="object"==typeof e[t]?e[t]:{ideal:e[t]};void 0!==n.exact&&"number"==typeof n.exact&&(n.min=n.max=n.exact);var i,o=function(e,t){return e?e+t.charAt(0).toUpperCase()+Qc(t).call(t,1):"deviceId"===t?"sourceId":t};if(void 0!==n.ideal){r.optional=r.optional||[];var a={};"number"==typeof n.ideal?(a[o("min",t)]=n.ideal,r.optional.push(a),(a={})[o("max",t)]=n.ideal,r.optional.push(a)):(a[o("",t)]=n.ideal,r.optional.push(a))}void 0!==n.exact&&"number"!=typeof n.exact?(r.mandatory=r.mandatory||{},r.mandatory[o("",t)]=n.exact):ba(i=["min","max"]).call(i,(function(e){void 0!==n[e]&&(r.mandatory=r.mandatory||{},r.mandatory[o(e,t)]=n[e])}))}})),e.advanced&&(r.optional=cs(n=r.optional||[]).call(n,e.advanced)),r},i=function(e,i){if(61<=n.version)return i(e);if((e=JSON.parse(Yr(e)))&&"object"==typeof e.audio){var o=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])};o((e=JSON.parse(Yr(e))).audio,"autoGainControl","googAutoGainControl"),o(e.audio,"noiseSuppression","googNoiseSuppression"),e.audio=r(e.audio)}if(e&&"object"==typeof e.video){var a,s=e.video.facingMode;if(s=s&&("object"==typeof s?s:{ideal:s}),o=66>n.version,!(!s||"user"!==s.exact&&"environment"!==s.exact&&"user"!==s.ideal&&"environment"!==s.ideal||t.mediaDevices.getSupportedConstraints&&t.mediaDevices.getSupportedConstraints().facingMode&&!o)&&(delete e.video.facingMode,"environment"===s.exact||"environment"===s.ideal?a=["back","rear"]:"user"!==s.exact&&"user"!==s.ideal||(a=["front"]),a))return t.mediaDevices.enumerateDevices().then((function(t){t=ds(t).call(t,(function(e){return"videoinput"===e.kind}));var n=Zc(t).call(t,(function(e){return fu(a).call(a,(function(t){var n;return uu(n=e.label.toLowerCase()).call(n,t)}))}));return!n&&t.length&&uu(a).call(a,"back")&&(n=t[t.length-1]),n&&(e.video.deviceId=s.exact?{exact:n.deviceId}:{ideal:n.deviceId}),e.video=r(e.video),hu("chrome: "+Yr(e)),i(e)}));e.video=r(e.video)}return hu("chrome: "+Yr(e)),i(e)},o=function(e){return 64<=n.version?e:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[e.name]||e.name,message:e.message,constraint:e.constraint||e.constraintName,toString:function(){return this.name+(this.message&&": ")+this.message}}};if(e=function(e,n,r){i(e,(function(e){t.webkitGetUserMedia(e,n,(function(e){r&&r(o(e))}))}))},t.getUserMedia=iu(e).call(e,t),t.mediaDevices.getUserMedia){var a,s=iu(a=t.mediaDevices.getUserMedia).call(a,t.mediaDevices);t.mediaDevices.getUserMedia=function(e){return i(e,(function(e){return s(e).then((function(t){var n;if(e.audio&&!t.getAudioTracks().length||e.video&&!t.getVideoTracks().length)throw ba(n=t.getTracks()).call(n,(function(e){e.stop()})),new DOMException("","NotFoundError");return t}),(function(e){return kc.reject(o(e))}))}))}}}}function P(e){e.MediaStream=e.MediaStream||e.webkitMediaStream}function D(e){if("object"!=typeof e||!e.RTCPeerConnection||"ontrack"in e.RTCPeerConnection.prototype)T(e,"track",(function(e){return e.transceiver||Da(e,"transceiver",{value:{receiver:e.receiver}}),e}));else{Da(e.RTCPeerConnection.prototype,"ontrack",{get:function(){return this._ontrack},set:function(e){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=e)},enumerable:!0,configurable:!0});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var n=this;return this._ontrackpoly||(this._ontrackpoly=function(t){var r;t.stream.addEventListener("addtrack",(function(r){var i,o;i=e.RTCPeerConnection.prototype.getReceivers?Zc(o=n.getReceivers()).call(o,(function(e){return e.track&&e.track.id===r.track.id})):{track:r.track},(o=new Event("track")).track=r.track,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)})),ba(r=t.stream.getTracks()).call(r,(function(r){var i,o;i=e.RTCPeerConnection.prototype.getReceivers?Zc(o=n.getReceivers()).call(o,(function(e){return e.track&&e.track.id===r.id})):{track:r},(o=new Event("track")).track=r,o.receiver=i,o.transceiver={receiver:i},o.streams=[t.stream],n.dispatchEvent(o)}))},this.addEventListener("addstream",this._ontrackpoly)),t.apply(this,arguments)}}}function x(e){if("object"==typeof e&&e.RTCPeerConnection&&!("getSenders"in e.RTCPeerConnection.prototype)&&"createDTMFSender"in e.RTCPeerConnection.prototype){var t=function(e,t){return{track:t,get dtmf(){return void 0===this._dtmf&&("audio"===t.kind?this._dtmf=e.createDTMFSender(t):this._dtmf=null),this._dtmf},_pc:e}};if(!e.RTCPeerConnection.prototype.getSenders){e.RTCPeerConnection.prototype.getSenders=function(){var e;return this._senders=this._senders||[],Qc(e=this._senders).call(e)};var n=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,r){var i=n.apply(this,arguments);return i||(i=t(this,e),this._senders.push(i)),i};var r=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t;r.apply(this,arguments);var n,i=Gc(t=this._senders).call(t,e);-1!==i&&Uc(n=this._senders).call(n,i,1)}}var i=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var n,r=this;this._senders=this._senders||[],i.apply(this,[e]),ba(n=e.getTracks()).call(n,(function(e){r._senders.push(t(r,e))}))};var o=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){var t,n=this;this._senders=this._senders||[],o.apply(this,[e]),ba(t=e.getTracks()).call(t,(function(e){var t,r,i,o=Zc(t=n._senders).call(t,(function(t){return t.track===e}));o&&Uc(r=n._senders).call(r,Gc(i=n._senders).call(i,o),1)}))}}else if("object"==typeof e&&e.RTCPeerConnection&&"getSenders"in e.RTCPeerConnection.prototype&&"createDTMFSender"in e.RTCPeerConnection.prototype&&e.RTCRtpSender&&!("dtmf"in e.RTCRtpSender.prototype)){var a=e.RTCPeerConnection.prototype.getSenders;e.RTCPeerConnection.prototype.getSenders=function(){var e=this,t=a.apply(this,[]);return ba(t).call(t,(function(t){return t._pc=e})),t},Da(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function L(e){if(e.RTCPeerConnection){var t=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=this,n=Array.prototype.slice.call(arguments),r=n[0],i=n[1],o=n[2];if(0<arguments.length&&"function"==typeof r)return t.apply(this,arguments);if(0===t.length&&(0===arguments.length||"function"!=typeof r))return t.apply(this,[]);var a=function(e){var t={};return e=e.result(),ba(e).call(e,(function(e){var n,r={id:e.id,timestamp:e.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[e.type]||e.type};ba(n=e.names()).call(n,(function(t){r[t]=e.stat(t)})),t[r.id]=r})),t},s=function(e){var t;return new ra(Pc(t=Ra(e)).call(t,(function(t){return[t,e[t]]})))};return 2<=arguments.length?t.apply(this,[function(e){i(s(a(e)))},r]):new kc((function(n,r){t.apply(e,[function(e){n(s(a(e)))},r])})).then(i,o)}}}function M(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&e.RTCRtpReceiver){if(!("getStats"in e.RTCRtpSender.prototype)){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return ba(n).call(n,(function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return O(t,e.track,!0)}))}}if(!("getStats"in e.RTCRtpReceiver.prototype)){var r=e.RTCPeerConnection.prototype.getReceivers;r&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,t=r.apply(this,[]);return ba(t).call(t,(function(t){return t._pc=e})),t}),T(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){var e=this;return this._pc.getStats().then((function(t){return O(t,e.track,!1)}))}}if("getStats"in e.RTCRtpSender.prototype&&"getStats"in e.RTCRtpReceiver.prototype){var i=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){if(0<arguments.length&&arguments[0]instanceof e.MediaStreamTrack){var t,n,r,o,a,s=arguments[0];return ba(t=this.getSenders()).call(t,(function(e){e.track===s&&(r?a=!0:r=e)})),ba(n=this.getReceivers()).call(n,(function(e){return e.track===s&&(o?a=!0:o=e),e.track===s})),a||r&&o?kc.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():o?o.getStats():kc.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return i.apply(this,arguments)}}}}function U(e){e.RTCPeerConnection.prototype.getLocalStreams=function(){var e,t=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Pc(e=Ra(this._shimmedLocalStreams)).call(e,(function(e){return t._shimmedLocalStreams[e][0]}))};var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addTrack=function(e,n){var r;if(!n)return t.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};var i=t.apply(this,arguments);return this._shimmedLocalStreams[n.id]?-1===Gc(r=this._shimmedLocalStreams[n.id]).call(r,i)&&this._shimmedLocalStreams[n.id].push(i):this._shimmedLocalStreams[n.id]=[n,i],i};var n=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(e){var t,r,i,o=this;this._shimmedLocalStreams=this._shimmedLocalStreams||{},ba(t=e.getTracks()).call(t,(function(e){var t;if(Zc(t=o.getSenders()).call(t,(function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")}));var a=this.getSenders();n.apply(this,arguments),t=ds(r=this.getSenders()).call(r,(function(e){return-1===Gc(a).call(a,e)})),this._shimmedLocalStreams[e.id]=cs(i=[e]).call(i,t)};var r=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[e.id],r.apply(this,arguments)};var i=e.RTCPeerConnection.prototype.removeTrack;e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n=this;return this._shimmedLocalStreams=this._shimmedLocalStreams||{},e&&ba(t=Ra(this._shimmedLocalStreams)).call(t,(function(t){var r,i,o=Gc(r=n._shimmedLocalStreams[t]).call(r,e);-1!==o&&Uc(i=n._shimmedLocalStreams[t]).call(i,o,1),1===n._shimmedLocalStreams[t].length&&delete n._shimmedLocalStreams[t]})),i.apply(this,arguments)}}function j(e){function t(e,t){var n,r=t.sdp;return ba(n=Ra(e._reverseStreams||[])).call(n,(function(t){t=e._reverseStreams[t],r=r.replace(new RegExp(e._streams[t.id].id,"g"),t.id)})),new RTCSessionDescription({type:t.type,sdp:r})}function n(e,t){var n,r=t.sdp;return ba(n=Ra(e._reverseStreams||[])).call(n,(function(t){t=e._reverseStreams[t],r=r.replace(new RegExp(t.id,"g"),e._streams[t.id].id)})),new RTCSessionDescription({type:t.type,sdp:r})}var r;if(e.RTCPeerConnection){var i=C(e);if(e.RTCPeerConnection.prototype.addTrack&&65<=i.version)return U(e);var o=e.RTCPeerConnection.prototype.getLocalStreams;e.RTCPeerConnection.prototype.getLocalStreams=function(){var e=this,t=o.apply(this);return this._reverseStreams=this._reverseStreams||{},Pc(t).call(t,(function(t){return e._reverseStreams[t.id]}))};var a=e.RTCPeerConnection.prototype.addStream;e.RTCPeerConnection.prototype.addStream=function(t){var n,r=this;this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},ba(n=t.getTracks()).call(n,(function(e){var t;if(Zc(t=r.getSenders()).call(t,(function(t){return t.track===e})))throw new DOMException("Track already exists.","InvalidAccessError")})),this._reverseStreams[t.id]||(n=new e.MediaStream(t.getTracks()),this._streams[t.id]=n,this._reverseStreams[n.id]=t,t=n),a.apply(this,[t])};var s=e.RTCPeerConnection.prototype.removeStream;e.RTCPeerConnection.prototype.removeStream=function(e){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},s.apply(this,[this._streams[e.id]||e]),delete this._reverseStreams[this._streams[e.id]?this._streams[e.id].id:e.id],delete this._streams[e.id]},e.RTCPeerConnection.prototype.addTrack=function(t,n){var r,i,o,a=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");var s=Qc([]).call(arguments,1);if(1!==s.length||!Zc(r=s[0].getTracks()).call(r,(function(e){return e===t})))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(Zc(i=this.getSenders()).call(i,(function(e){return e.track===t})))throw new DOMException("Track already exists.","InvalidAccessError");return this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},(r=this._streams[n.id])?(r.addTrack(t),kc.resolve().then((function(){a.dispatchEvent(new Event("negotiationneeded"))}))):(r=new e.MediaStream([t]),this._streams[n.id]=r,this._reverseStreams[r.id]=n,this.addStream(r)),Zc(o=this.getSenders()).call(o,(function(e){return e.track===t}))},ba(r=["createOffer","createAnswer"]).call(r,(function(n){var r=e.RTCPeerConnection.prototype[n];e.RTCPeerConnection.prototype[n]=g({},n,(function(){var e=this,n=arguments;return arguments.length&&"function"==typeof arguments[0]?r.apply(this,[function(r){r=t(e,r),n[0].apply(null,[r])},function(e){n[1]&&n[1].apply(null,e)},arguments[2]]):r.apply(this,arguments).then((function(n){return t(e,n)}))}))[n]}));var c=e.RTCPeerConnection.prototype.setLocalDescription;e.RTCPeerConnection.prototype.setLocalDescription=function(){return arguments.length&&arguments[0].type?(arguments[0]=n(this,arguments[0]),c.apply(this,arguments)):c.apply(this,arguments)};var u=Ya(e.RTCPeerConnection.prototype,"localDescription");Da(e.RTCPeerConnection.prototype,"localDescription",{get:function(){var e=u.get.apply(this);return""===e.type?e:t(this,e)}}),e.RTCPeerConnection.prototype.removeTrack=function(e){var t,n,r=this;if("closed"===this.signalingState)throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!e._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(e._pc!==this)throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{},ba(t=Ra(this._streams)).call(t,(function(t){var i;Zc(i=r._streams[t].getTracks()).call(i,(function(t){return e.track===t}))&&(n=r._streams[t])})),n&&(1===n.getTracks().length?this.removeStream(this._reverseStreams[n.id]):n.removeTrack(e.track),this.dispatchEvent(new Event("negotiationneeded")))}}}function F(e){var t=C(e);if(!e.RTCPeerConnection&&e.webkitRTCPeerConnection&&(e.RTCPeerConnection=e.webkitRTCPeerConnection),e.RTCPeerConnection){var n;53>t.version&&ba(n=["setLocalDescription","setRemoteDescription","addIceCandidate"]).call(n,(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=g({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}))[t]}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?78>t.version&&arguments[0]&&""===arguments[0].candidate?kc.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),kc.resolve())}}}function V(e){T(e,"negotiationneeded",(function(e){if("stable"===e.target.signalingState)return e}))}function B(e,t,n,r,i){return t=Au.writeRtpDescription(e.kind,t),t+=Au.writeIceParameters(e.iceGatherer.getLocalParameters()),t+=Au.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===n?"actpass":i||"active"),t+="a=mid:"+e.mid+"\r\n",e.rtpSender&&e.rtpReceiver?t+="a=sendrecv\r\n":e.rtpSender?t+="a=sendonly\r\n":e.rtpReceiver?t+="a=recvonly\r\n":t+="a=inactive\r\n",e.rtpSender&&(n=e.rtpSender._initialTrackId||e.rtpSender.track.id,e.rtpSender._initialTrackId=n,t=t+"a="+(r="msid:"+(r?r.id:"-")+" "+n+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,t+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),t+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+Au.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(t+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+Au.localCName+"\r\n"),t}function W(e,t){var n={codecs:[],headerExtensions:[],fecMechanisms:[]},r=function(e,t){e=parseInt(e,10);for(var n=0;n<t.length;n++)if(t[n].payloadType===e||t[n].preferredPayloadType===e)return t[n]},i=function(e,t,n,i){return e=r(e.parameters.apt,n),t=r(t.parameters.apt,i),e&&t&&e.name.toLowerCase()===t.name.toLowerCase()};return e.codecs.forEach((function(r){for(var o=0;o<t.codecs.length;o++){var a=t.codecs[o];if(r.name.toLowerCase()===a.name.toLowerCase()&&r.clockRate===a.clockRate&&("rtx"!==r.name.toLowerCase()||!r.parameters||!a.parameters.apt||i(r,a,e.codecs,t.codecs))){(a=JSON.parse(JSON.stringify(a))).numChannels=Math.min(r.numChannels,a.numChannels),n.codecs.push(a),a.rtcpFeedback=a.rtcpFeedback.filter((function(e){for(var t=0;t<r.rtcpFeedback.length;t++)if(r.rtcpFeedback[t].type===e.type&&r.rtcpFeedback[t].parameter===e.parameter)return!0;return!1}));break}}})),e.headerExtensions.forEach((function(e){for(var r=0;r<t.headerExtensions.length;r++){var i=t.headerExtensions[r];if(e.uri===i.uri){n.headerExtensions.push(i);break}}})),n}function G(e,t,n){return-1!=={offer:{setLocalDescription:["stable","have-local-offer"],setRemoteDescription:["stable","have-remote-offer"]},answer:{setLocalDescription:["have-remote-offer","have-local-pranswer"],setRemoteDescription:["have-local-offer","have-remote-pranswer"]}}[t][e].indexOf(n)}function q(e,t){var n=e.getRemoteCandidates().find((function(e){return t.foundation===e.foundation&&t.ip===e.ip&&t.port===e.port&&t.priority===e.priority&&t.protocol===e.protocol&&t.type===e.type}));return n||e.addRemoteCandidate(t),!n}function K(e,t){return(t=Error(t)).name=e,t.code={NotSupportedError:9,InvalidStateError:11,InvalidAccessError:15,TypeError:void 0,OperationError:void 0}[e],t}function H(e){var t;e=e&&e.navigator;var n=iu(t=e.mediaDevices.getUserMedia).call(t,e.mediaDevices);e.mediaDevices.getUserMedia=function(e){return n(e).catch((function(e){return kc.reject(function(e){return{name:{PermissionDeniedError:"NotAllowedError"}[e.name]||e.name,message:e.message,constraint:e.constraint,toString:function(){return this.name}}}(e))}))}}function z(e){var t;"getDisplayMedia"in e.navigator&&e.navigator.mediaDevices&&(e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||(e.navigator.mediaDevices.getDisplayMedia=iu(t=e.navigator.getDisplayMedia).call(t,e.navigator)))}function Y(e){var t=C(e);if(e.RTCIceGatherer&&(e.RTCIceCandidate||(e.RTCIceCandidate=function(e){return e}),e.RTCSessionDescription||(e.RTCSessionDescription=function(e){return e}),15025>t.version)){var n=Ya(e.MediaStreamTrack.prototype,"enabled");Da(e.MediaStreamTrack.prototype,"enabled",{set:function(e){n.set.call(this,e);var t=new Event("enabled");t.enabled=e,this.dispatchEvent(t)}})}!e.RTCRtpSender||"dtmf"in e.RTCRtpSender.prototype||Da(e.RTCRtpSender.prototype,"dtmf",{get:function(){return void 0===this._dtmf&&("audio"===this.track.kind?this._dtmf=new e.RTCDtmfSender(this):"video"===this.track.kind&&(this._dtmf=null)),this._dtmf}}),e.RTCDtmfSender&&!e.RTCDTMFSender&&(e.RTCDTMFSender=e.RTCDtmfSender);var r=Cu(e,t.version);e.RTCPeerConnection=function(e){return e&&e.iceServers&&(e.iceServers=function(e,t){var n=!1;return e=JSON.parse(Yr(e)),ds(e).call(e,(function(e){if(e&&(e.urls||e.url)){var t=e.urls||e.url;e.url&&!e.urls&&A("RTCIceServer.url","RTCIceServer.urls");var r="string"==typeof t;return r&&(t=[t]),t=ds(t).call(t,(function(e){return 0!==Gc(e).call(e,"stun:")&&((e=bu(e).call(e,"turn")&&!bu(e).call(e,"turn:[")&&uu(e).call(e,"transport=udp"))&&!n?(n=!0,!0):e&&!n)})),delete e.url,e.urls=r?t[0]:t,!!t.length}}))}(e.iceServers,t.version),R("ICE servers after filtering:",e.iceServers)),new r(e)},e.RTCPeerConnection.prototype=r.prototype}function Q(e){!e.RTCRtpSender||"replaceTrack"in e.RTCRtpSender.prototype||(e.RTCRtpSender.prototype.replaceTrack=e.RTCRtpSender.prototype.setTrack)}function X(e){var t=C(e),n=e&&e.navigator;if(e=e&&e.MediaStreamTrack,n.getUserMedia=function(e,t,r){A("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(e).then(t,r)},!(55<t.version&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){var r,i=function(e,t,n){t in e&&!(n in e)&&(e[n]=e[t],delete e[t])},o=iu(r=n.mediaDevices.getUserMedia).call(r,n.mediaDevices);if(n.mediaDevices.getUserMedia=function(e){return"object"==typeof e&&"object"==typeof e.audio&&(e=JSON.parse(Yr(e)),i(e.audio,"autoGainControl","mozAutoGainControl"),i(e.audio,"noiseSuppression","mozNoiseSuppression")),o(e)},e&&e.prototype.getSettings){var a=e.prototype.getSettings;e.prototype.getSettings=function(){var e=a.apply(this,arguments);return i(e,"mozAutoGainControl","autoGainControl"),i(e,"mozNoiseSuppression","noiseSuppression"),e}}if(e&&e.prototype.applyConstraints){var s=e.prototype.applyConstraints;e.prototype.applyConstraints=function(e){return"audio"===this.kind&&"object"==typeof e&&(e=JSON.parse(Yr(e)),i(e,"autoGainControl","mozAutoGainControl"),i(e,"noiseSuppression","mozNoiseSuppression")),s.apply(this,[e])}}}}function J(e){"object"==typeof e&&e.RTCTrackEvent&&"receiver"in e.RTCTrackEvent.prototype&&!("transceiver"in e.RTCTrackEvent.prototype)&&Da(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function $(e){var t=C(e);if("object"==typeof e&&(e.RTCPeerConnection||e.mozRTCPeerConnection)){var n;!e.RTCPeerConnection&&e.mozRTCPeerConnection&&(e.RTCPeerConnection=e.mozRTCPeerConnection),53>t.version&&ba(n=["setLocalDescription","setRemoteDescription","addIceCandidate"]).call(n,(function(t){var n=e.RTCPeerConnection.prototype[t];e.RTCPeerConnection.prototype[t]=g({},t,(function(){return arguments[0]=new("addIceCandidate"===t?e.RTCIceCandidate:e.RTCSessionDescription)(arguments[0]),n.apply(this,arguments)}))[t]}));var r=e.RTCPeerConnection.prototype.addIceCandidate;e.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?68>t.version&&arguments[0]&&""===arguments[0].candidate?kc.resolve():r.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),kc.resolve())};var i={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},o=e.RTCPeerConnection.prototype.getStats;e.RTCPeerConnection.prototype.getStats=function(){var e=Array.prototype.slice.call(arguments),n=e[0],r=e[1],a=e[2];return o.apply(this,[n||null]).then((function(e){if(53>t.version&&!r)try{ba(e).call(e,(function(e){e.type=i[e.type]||e.type}))}catch(n){if("TypeError"!==n.name)throw n;ba(e).call(e,(function(t,n){e.set(n,Sa({},t,{type:i[t.type]||t.type}))}))}return e})).then(r,a)}}}function Z(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpSender.prototype))){var t=e.RTCPeerConnection.prototype.getSenders;t&&(e.RTCPeerConnection.prototype.getSenders=function(){var e=this,n=t.apply(this,[]);return ba(n).call(n,(function(t){return t._pc=e})),n});var n=e.RTCPeerConnection.prototype.addTrack;n&&(e.RTCPeerConnection.prototype.addTrack=function(){var e=n.apply(this,arguments);return e._pc=this,e}),e.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):kc.resolve(new ra)}}}function ee(e){if("object"==typeof e&&e.RTCPeerConnection&&e.RTCRtpSender&&(!e.RTCRtpSender||!("getStats"in e.RTCRtpReceiver.prototype))){var t=e.RTCPeerConnection.prototype.getReceivers;t&&(e.RTCPeerConnection.prototype.getReceivers=function(){var e=this,n=t.apply(this,[]);return ba(n).call(n,(function(t){return t._pc=e})),n}),T(e,"track",(function(e){return e.receiver._pc=e.srcElement,e})),e.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}}function te(e){!e.RTCPeerConnection||"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,n=this;A("removeStream","removeTrack"),ba(t=this.getSenders()).call(t,(function(t){var r;t.track&&uu(r=e.getTracks()).call(r,t.track)&&n.removeTrack(t)}))})}function ne(e){e.DataChannel&&!e.RTCDataChannel&&(e.RTCDataChannel=e.DataChannel)}function re(e){if("object"==typeof e&&e.RTCPeerConnection){if("getLocalStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in e.RTCPeerConnection.prototype)){var t=e.RTCPeerConnection.prototype.addTrack;e.RTCPeerConnection.prototype.addStream=function(e){var n,r,i,o=this;this._localStreams||(this._localStreams=[]),uu(n=this._localStreams).call(n,e)||this._localStreams.push(e),ba(r=e.getAudioTracks()).call(r,(function(n){return t.call(o,n,e)})),ba(i=e.getVideoTracks()).call(i,(function(n){return t.call(o,n,e)}))},e.RTCPeerConnection.prototype.addTrack=function(e,n){var r;return n&&(this._localStreams?uu(r=this._localStreams).call(r,n)||this._localStreams.push(n):this._localStreams=[n]),t.call(this,e,n)}}"removeStream"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.removeStream=function(e){var t,n,r,i=this;this._localStreams||(this._localStreams=[]);var o=Gc(t=this._localStreams).call(t,e);if(-1!==o){Uc(n=this._localStreams).call(n,o,1);var a=e.getTracks();ba(r=this.getSenders()).call(r,(function(e){uu(a).call(a,e.track)&&i.removeTrack(e)}))}})}}function ie(e){if("object"==typeof e&&e.RTCPeerConnection&&("getRemoteStreams"in e.RTCPeerConnection.prototype||(e.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in e.RTCPeerConnection.prototype))){Da(e.RTCPeerConnection.prototype,"onaddstream",{get:function(){return this._onaddstream},set:function(e){var t=this;this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=e),this.addEventListener("track",this._onaddstreampoly=function(e){var n;ba(n=e.streams).call(n,(function(e){var n;t._remoteStreams||(t._remoteStreams=[]),uu(n=t._remoteStreams).call(n,e)||(t._remoteStreams.push(e),(n=new Event("addstream")).stream=e,t.dispatchEvent(n))}))})}});var t=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){var e=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(t){var n;ba(n=t.streams).call(n,(function(t){var n;e._remoteStreams||(e._remoteStreams=[]),0<=Gc(n=e._remoteStreams).call(n,t)||(e._remoteStreams.push(t),(n=new Event("addstream")).stream=t,e.dispatchEvent(n))}))}),t.apply(e,arguments)}}}function oe(e){if("object"==typeof e&&e.RTCPeerConnection){var t=(e=e.RTCPeerConnection.prototype).createOffer,n=e.createAnswer,r=e.setLocalDescription,i=e.setRemoteDescription,o=e.addIceCandidate;e.createOffer=function(e,n){var r=t.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return n?(r.then(e,n),kc.resolve()):r},e.createAnswer=function(e,t){var r=n.apply(this,[2<=arguments.length?arguments[2]:arguments[0]]);return t?(r.then(e,t),kc.resolve()):r};var a=function(e,t,n){return e=r.apply(this,[e]),n?(e.then(t,n),kc.resolve()):e};e.setLocalDescription=a,a=function(e,t,n){return e=i.apply(this,[e]),n?(e.then(t,n),kc.resolve()):e},e.setRemoteDescription=a,a=function(e,t,n){return e=o.apply(this,[e]),n?(e.then(t,n),kc.resolve()):e},e.addIceCandidate=a}}function ae(e){var t,n=e&&e.navigator;if(n.mediaDevices&&n.mediaDevices.getUserMedia){var r;e=n.mediaDevices;var i=iu(r=e.getUserMedia).call(r,e);n.mediaDevices.getUserMedia=function(e){return i(se(e))}}!n.getUserMedia&&n.mediaDevices&&n.mediaDevices.getUserMedia&&(n.getUserMedia=iu(t=function(e,t,r){n.mediaDevices.getUserMedia(e).then(t,r)}).call(t,n))}function se(e){return e&&void 0!==e.video?Sa({},e,{video:k(e.video)}):e}function ce(e){var t=e.RTCPeerConnection;e.RTCPeerConnection=function(e,n){if(e&&e.iceServers){for(var r=[],i=0;i<e.iceServers.length;i++){var o=e.iceServers[i];!o.hasOwnProperty("urls")&&o.hasOwnProperty("url")?(A("RTCIceServer.url","RTCIceServer.urls"),(o=JSON.parse(Yr(o))).urls=o.url,delete o.url,r.push(o)):r.push(e.iceServers[i])}e.iceServers=r}return new t(e,n)},e.RTCPeerConnection.prototype=t.prototype,"generateCertificate"in e.RTCPeerConnection&&Da(e.RTCPeerConnection,"generateCertificate",{get:function(){return t.generateCertificate}})}function ue(e){"object"==typeof e&&e.RTCPeerConnection&&"receiver"in e.RTCTrackEvent.prototype&&!e.RTCTransceiver&&Da(e.RTCTrackEvent.prototype,"transceiver",{get:function(){return{receiver:this.receiver}}})}function le(e){var t=e.RTCPeerConnection.prototype.createOffer;e.RTCPeerConnection.prototype.createOffer=function(e){if(e){var n,r;void 0!==e.offerToReceiveAudio&&(e.offerToReceiveAudio=!!e.offerToReceiveAudio);var i=Zc(n=this.getTransceivers()).call(n,(function(e){return"audio"===e.receiver.track.kind}));!1===e.offerToReceiveAudio&&i?"sendrecv"===i.direction?i.setDirection?i.setDirection("sendonly"):i.direction="sendonly":"recvonly"===i.direction&&(i.setDirection?i.setDirection("inactive"):i.direction="inactive"):!0!==e.offerToReceiveAudio||i||this.addTransceiver("audio"),void 0!==e.offerToReceiveVideo&&(e.offerToReceiveVideo=!!e.offerToReceiveVideo),n=Zc(r=this.getTransceivers()).call(r,(function(e){return"video"===e.receiver.track.kind})),!1===e.offerToReceiveVideo&&n?"sendrecv"===n.direction?n.setDirection?n.setDirection("sendonly"):n.direction="sendonly":"recvonly"===n.direction&&(n.setDirection?n.setDirection("inactive"):n.direction="inactive"):!0!==e.offerToReceiveVideo||n||this.addTransceiver("video")}return t.apply(this,arguments)}}function de(e){if(e.RTCIceCandidate&&(!e.RTCIceCandidate||!("foundation"in e.RTCIceCandidate.prototype))){var t=e.RTCIceCandidate;e.RTCIceCandidate=function(e){var n;if("object"==typeof e&&e.candidate&&0===Gc(n=e.candidate).call(n,"a=")&&((e=JSON.parse(Yr(e))).candidate=e.candidate.substr(2)),e.candidate&&e.candidate.length){n=new t(e),e=Au.parseCandidate(e.candidate);var r=Sa(n,e);return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new t(e)},e.RTCIceCandidate.prototype=t.prototype,T(e,"icecandidate",(function(t){return t.candidate&&Da(t,"candidate",{value:new e.RTCIceCandidate(t.candidate),writable:"false"}),t}))}}function fe(e){if(e.RTCPeerConnection){var t=C(e);"sctp"in e.RTCPeerConnection.prototype||Da(e.RTCPeerConnection.prototype,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp}});var n=function(e){return!(!e||!e.sdp)&&((e=Au.splitSections(e.sdp)).shift(),fu(e).call(e,(function(e){var t;return(e=Au.parseMLine(e))&&"application"===e.kind&&-1!==Gc(t=e.protocol).call(t,"SCTP")})))},r=function(e){return null===(e=e.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/))||2>e.length||(e=Ba(e[1],10))!=e?-1:e},i=function(e){var n=65536;return"firefox"===t.browser&&(n=57>t.version?-1===e?16384:2147483637:60>t.version?57===t.version?65535:65536:2147483637),n},o=function(e,n){var r=65536;return"firefox"===t.browser&&57===t.version&&(r=65535),0<(e=Au.matchPrefix(e.sdp,"a=max-message-size:")).length?r=Ba(e[0].substr(19),10):"firefox"===t.browser&&-1!==n&&(r=2147483637),r},a=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,"chrome"===t.browser&&76<=t.version){var e=this.getConfiguration().sdpSemantics;"plan-b"===e&&Da(this,"sctp",{get:function(){return void 0===this._sctp?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){var s,c=r(arguments[0]);e=i(c),c=o(arguments[0],c),s=0===e&&0===c?Number.POSITIVE_INFINITY:0===e||0===c?Math.max(e,c):Math.min(e,c),Da(e={},"maxMessageSize",{get:function(){return s}}),this._sctp=e}return a.apply(this,arguments)}}}function he(e){function t(e,t){var n=e.send;e.send=function(){var r=arguments[0];if(r=r.length||r.size||r.byteLength,"open"===e.readyState&&t.sctp&&r>t.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+t.sctp.maxMessageSize+" bytes)");return n.apply(e,arguments)}}if(e.RTCPeerConnection&&"createDataChannel"in e.RTCPeerConnection.prototype){var n=e.RTCPeerConnection.prototype.createDataChannel;e.RTCPeerConnection.prototype.createDataChannel=function(){var e=n.apply(this,arguments);return t(e,this),e},T(e,"datachannel",(function(e){return t(e.channel,e.target),e}))}}function pe(e){var t;if(e.RTCPeerConnection&&!("connectionState"in e.RTCPeerConnection.prototype)){var n=e.RTCPeerConnection.prototype;Da(n,"connectionState",{get:function(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Da(n,"onconnectionstatechange",{get:function(){return this._onconnectionstatechange||null},set:function(e){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),e&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=e)},enumerable:!0,configurable:!0}),ba(t=["setLocalDescription","setRemoteDescription"]).call(t,(function(e){var t=n[e];n[e]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=function(e){var t=e.target;if(t._lastConnectionState!==t.connectionState){t._lastConnectionState=t.connectionState;var n=new Event("connectionstatechange",e);t.dispatchEvent(n)}return e},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),t.apply(this,arguments)}}))}}function ve(e){if(e.RTCPeerConnection){var t=C(e);if(!("chrome"===t.browser&&71<=t.version)){var n=e.RTCPeerConnection.prototype.setRemoteDescription;e.RTCPeerConnection.prototype.setRemoteDescription=function(e){var t,r;return e&&e.sdp&&-1!==Gc(t=e.sdp).call(t,"\na=extmap-allow-mixed")&&(e.sdp=ds(r=e.sdp.split("\n")).call(r,(function(e){return"a=extmap-allow-mixed"!==Ru(e).call(e)})).join("\n")),n.apply(this,arguments)}}}}function me(e){return"string"==typeof e?Sa({},Uu[e]):e}function ge(e){return"string"==typeof e?Sa({},ju[e]):e}function ye(e){return"string"==typeof e?Sa({},Fu[e]):e}function _e(e){return"string"==typeof e?Sa({},Vu[e]):e}function be(e,t){var n;uu(n=Ra(Bu)).call(n,e)&&(Bu[e]=t)}function Ee(e,t,n){return{sampleRate:e,stereo:t,bitrate:n}}function we(e,t,n,r,i){return{width:e,height:t,frameRate:n,bitrateMin:r,bitrateMax:i}}function Te(e,t,n,r,i){return{width:{max:e},height:{max:t},frameRate:n,bitrateMin:r,bitrateMax:i}}function Se(e,t){return{numSpatialLayers:e,numTemporalLayers:t}}function Ie(e){return"[object Array]"===tl.call(e)}function Re(e){return null!==e&&"object"==typeof e}function Ae(e){return"[object Function]"===tl.call(e)}function Ce(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),Ie(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.call(null,e[n],n,e)}function ke(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Oe(){this.handlers=[]}function Ne(e,t){!nl.isUndefined(e)&&nl.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function Pe(e){this.defaults=e,this.interceptors={request:new il,response:new il}}function De(e){this.message=e}function xe(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function(e){t=e}));var n=this;e((function(e){n.reason||(n.reason=new yl(e),t(n.reason))}))}function Le(e){e=new gl(e);var t=el(gl.prototype.request,e);return nl.extend(t,gl.prototype,e),nl.extend(t,e),t}function Me(){var e=new Date;return e.toTimeString().split(" ")[0]+":"+e.getMilliseconds()}function Ue(e,t){if("boolean"!=typeof e)throw new Al($u.INVALID_PARAMS,"Invalid ".concat(t,": The value is of the boolean type."))}function je(e,t,n){var r;if(!uu(n).call(n,e))throw new Al($u.INVALID_PARAMS,cs(r="".concat(t," can only be set as ")).call(r,Yr(n)))}function Fe(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1e4;if(e<i||e>o||(!(arguments.length>4&&void 0!==arguments[4])||arguments[4])&&("number"!=typeof e||0!=e%1))throw new Al($u.INVALID_PARAMS,cs(n=cs(r="invalid ".concat(t,": the value range is [")).call(r,i,", ")).call(n,o,"]. integer only"))}function Ve(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:255,s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(null==e)throw new Al($u.INVALID_PARAMS,"".concat(t||"param"," cannot be empty"));if(!qe(e,o,a,s))throw new Al($u.INVALID_PARAMS,cs(n=cs(r=cs(i="Invalid ".concat(t||"string param",": Length of the string: [")).call(i,o,",")).call(r,a,"].")).call(n,s?" ASCII characters only.":""))}function Be(e,t){if(!Zu(e))throw new Al($u.INVALID_PARAMS,"".concat(t," should be an array"))}function We(e){if("string"!=typeof e||!/^[a-zA-Z0-9 !#\$%&\(\)\+\-:;<=\.>\?@\[\]\^_\{\}\|~,]{1,64}$/.test(e))throw Rl.error("Invalid Channel Name ".concat(e)),new Al($u.INVALID_PARAMS,"The length must be within 64 bytes. The supported characters: a-z,A-Z,0-9,space,!, #, $, %, &, (, ), +, -, :, ;, <, =, ., >, ?, @, [, ], ^, _,  {, }, |, ~, ,")}function Ge(e){var t;if(!("number"==typeof e&&Math.floor(e)===e&&0<=e&&4294967295>=e||qe(e,1,255)))throw Rl.error(cs(t="Invalid UID ".concat(e," ")).call(t,typeof e)),new Al($u.INVALID_PARAMS,"[String uid] Length of the string: [1,255]. ASCII characters only. [Number uid] The value range is [0,10000]")}function qe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(t="string"==typeof e&&e.length<=n&&e.length>=t){if(!(r=!r))e:if("string"!=typeof e)r=!1;else{for(r=0;r<e.length;r+=1)if(0>(t=e.charCodeAt(r))||255<t){r=!1;break e}r=!0}t=r}return t}function Ke(e){return Ve(e.reportId,"params.reportId",0,100,!1),Ve(e.category,"params.category",0,100,!1),Ve(e.event,"params.event",0,100,!1),Ve(e.label,"params.label",0,100,!1),Fe(e.value,"params.value",-9007199254740991,9007199254740991,!1),!0}function He(e){return Fe(e.timeout,"config.timeout",0,1e5),Fe(e.timeoutFactor,"config.timeoutFactor",0,100,!1),Fe(e.maxRetryCount,"config.maxRetryConfig",0,1/0),Fe(e.maxRetryTimeout,"config.maxRetryTimeout",0,1/0),!0}function ze(e){if(!Zu(e)||1>e.length)return!1;try{ba(e).call(e,(function(e){if(!e.urls)throw Error()}))}catch(t){return!1}return!0}function Ye(e){return Ve(e.turnServerURL,"turnServerURL"),Ve(e.username,"username"),Ve(e.password,"password"),e.udpport&&Fe(e.udpport,"udpport",1,99999,!0),e.forceturn&&Ue(e.forceturn,"forceturn"),e.security&&Ue(e.security,"security"),e.tcpport&&Fe(e.tcpport,"tcpport",1,99999,!0),!0}function Qe(e){return void 0!==e.level&&je(e.level,"level",[1,2]),!0}function Xe(e,t){Ve(e.url,"".concat(t,".url"),1,1e3,!1),null==e.x||Fe(e.x,"".concat(t,".x"),0,1e4),null==e.y||Fe(e.y,"".concat(t,".y"),0,1e4),null==e.width||Fe(e.width,"".concat(t,".width"),0,1e4),null==e.height||Fe(e.height,"".concat(t,".height"),0,1e4),null==e.zOrder||Fe(e.zOrder,"".concat(t,".zOrder"),0,255),null==e.alpha||Fe(e.alpha,"".concat(t,".alpha"),0,1,!1)}function Je(e){if(!e.channelName)throw new Al($u.INVALID_PARAMS,"invalid channelName in info");if(!e.uid||"number"!=typeof e.uid)throw new Al($u.INVALID_PARAMS,"invalid uid in info, uid must be a number");return e.token&&Ve(e.token,"info.token",1,2047),Ge(e.uid),We(e.channelName),!0}function $e(e){return je(e,"mediaSource",["screen","window","application"]),!0}function Ze(e){var t,n,r,i,o=(e=e||navigator.userAgent).match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if("Chrome"===o[1]){var a=e.match(/(OPR(?=\/))\/?(\d+)/i);null!==a&&(o=a)}for(var s in"Safari"===o[1]&&null!==(a=e.match(/version\/(\d+)/i))&&(o[2]=a[1]),-1!==Gc(t=e.toLowerCase()).call(t,"qqbrowser")&&null!==(t=e.match(/(qqbrowser(?=\/))\/?(\d+)/i))&&(o=t),-1!==Gc(n=e.toLowerCase()).call(n,"micromessenger")&&null!==(n=e.match(/(micromessenger(?=\/))\/?(\d+)/i))&&(o=n),-1!==Gc(r=e.toLowerCase()).call(r,"edge")&&null!==(r=e.match(/(edge(?=\/))\/?(\d+)/i))&&(o=r),-1!==Gc(i=e.toLowerCase()).call(i,"trident")&&null!==(i=/\brv[ :]+(\d+)/g.exec(e)||[])&&(o=["","IE",i[1]]),i=null,r=[{s:Eu.WIN_10,r:/(Windows 10.0|Windows NT 10.0)/},{s:Eu.WIN_81,r:/(Windows 8.1|Windows NT 6.3)/},{s:Eu.WIN_8,r:/(Windows 8|Windows NT 6.2)/},{s:Eu.WIN_7,r:/(Windows 7|Windows NT 6.1)/},{s:Eu.WIN_VISTA,r:/Windows NT 6.0/},{s:Eu.WIN_SERVER_2003,r:/Windows NT 5.2/},{s:Eu.WIN_XP,r:/(Windows NT 5.1|Windows XP)/},{s:Eu.WIN_2000,r:/(Windows NT 5.0|Windows 2000)/},{s:Eu.ANDROID,r:/Android/},{s:Eu.OPEN_BSD,r:/OpenBSD/},{s:Eu.SUN_OS,r:/SunOS/},{s:Eu.LINUX,r:/(Linux|X11)/},{s:Eu.IOS,r:/(iPhone|iPad|iPod)/},{s:Eu.MAC_OS_X,r:/Mac OS X/},{s:Eu.MAC_OS,r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:Eu.QNX,r:/QNX/},{s:Eu.UNIX,r:/UNIX/},{s:Eu.BEOS,r:/BeOS/},{s:Eu.OS_2,r:/OS\/2/},{s:Eu.SEARCH_BOT,r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}])if((n=r[s]).r.test(e)){i=n.s;break}return{name:o[1],version:o[2],os:i}}function et(){return Ze().name===wu.CHROME}function tt(){return window.navigator.appVersion&&null!==window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)&&35>=window.navigator.appVersion.match(/Chrome\/([\w\W]*?)\./)[1]}function nt(){var e=Ze();return e.name!==wu.EDGE&&e.name!==wu.SAFARI&&!!navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i)}function rt(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function it(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=rt(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=rt(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function ot(e){if(!e.address||!e.tcp)throw new Al($u.UNEXPECTED_RESPONSE,"Invalid address format ".concat(e));return e.address.match(/^[\.:\d]+$/)?"".concat(e.address.replace(/[^\d]/g,"-"),".edge.agora.io"):(Rl.info("Cannot recognized as IP address ".concat(e.address,". Used As Host instead")),cs(t="".concat(e.address,":")).call(t,e.tcp));var t}function at(e){return"number"==typeof e?e:e.exact||e.ideal||e.max||e.min||0}function st(e,t){var n=e.videoSend[0];return n?(t=t&&t.videoSend[0]?t.videoSend[0].inputFrame:void 0,e={id:vt(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:n.ssrc.toString()},n.inputFrame&&(t&&n.inputFrame.height===t.height||(e.A_fhi=n.inputFrame.height?n.inputFrame.height.toString():"0"),t&&n.inputFrame.width===t.width||(e.A_fwi=n.inputFrame.width?n.inputFrame.width.toString():"0"),t&&n.inputFrame.frameRate===t.frameRate||(e.A_fri=n.inputFrame.frameRate?n.inputFrame.frameRate.toString():"0")),e):null}function ct(e){return 0<=e&&.17>e?1:.17<=e&&.36>e?2:.36<=e&&.59>e?3:.59<=e&&1>=e?4:1<e?5:0}function ut(e,t){var n={};return e.height&&e.width&&(t=t._videoHeight||t.getMediaStreamTrack().getSettings().height,n.scaleResolutionDownBy=t?t/at(e.height):4),n.maxFramerate=e.framerate?at(e.framerate):void 0,n.maxBitrate=e.bitrate?1e3*e.bitrate:void 0,n}function lt(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function dt(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=lt(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=lt(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function ft(e){return window.TextEncoder?(new TextEncoder).encode(e).length:e.length}function ht(e){return new kc((function(t){window.setTimeout(t,e)}))}function pt(e){var t=new Al($u.TIMEOUT,"timeout");return new kc((function(n,r){window.setTimeout((function(){return r(t)}),e)}))}function vt(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:7,r=arguments.length>1?arguments[1]:void 0,i=Math.random().toString(16).substr(2,n).toLowerCase();return i.length===n?cs(e="".concat(r)).call(e,i):cs(t="".concat(r)).call(t,i)+vt(n-i.length,"")}function mt(e){return new kc((function(t,n){var r=document.createElement("video");r.setAttribute("autoplay",""),r.setAttribute("muted",""),r.muted=!0,r.autoplay=!0,r.setAttribute("playsinline",""),r.setAttribute("style","position: absolute; top: 0; left: 0; width: 1px; height: 1px"),document.body.appendChild(r),r.addEventListener("playing",(function(){!r.videoWidth&&Ze().name===wu.FIREFOX||(document.body.removeChild(r),t([r.videoWidth,r.videoHeight]))})),r.srcObject=new MediaStream([e])}))}function gt(e){return kc.all(Pc(e).call(e,(function(e){return e.then((function(e){throw e}),(function(e){return e}))}))).then((function(e){throw e}),(function(e){return e}))}function yt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?kc.reject(new Al($u.UNEXPECTED_ERROR,"can not emit promise")):new kc((function(n,i){e.emit.apply(e,[t].concat(r,[n,i]))}))}function _t(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?kc.resolve():yt.apply(void 0,[e,t].concat(r))}function bt(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return 0===e.getListeners(t).length?null:Et.apply(void 0,[e,t].concat(r))}function Et(e,t){for(var n=null,r=null,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];if(e.emit.apply(e,[t].concat(o,[function(e){n=e},function(e){r=e}])),null!==r)throw r;if(null===n)throw new Al($u.UNEXPECTED_ERROR,"handler is not sync");return n}function wt(e,t){-1!==(t=Gc(e).call(e,t))&&Uc(e).call(e,t,1)}function Tt(e){var t=[];return ba(e).call(e,(function(e){-1===Gc(t).call(t,e)&&t.push(e)})),t}function St(e){kc.resolve().then(e)}function It(e,t){Tf[t]||(Tf[t]=!0,e())}function Rt(e){e=window.atob(e);for(var t=new Uint8Array(new ArrayBuffer(e.length)),n=0;n<e.length;n+=1)t[n]=e.charCodeAt(n);return t}function At(e){for(var t="",n=0;n<e.length;n+=1)t+=String.fromCharCode(e[n]);return window.btoa(t)}function Ct(e,t){return kt.apply(this,arguments)}function kt(){return(kt=m(v.mark((function e(t,n){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxHeight:(r=function(e,t){return e?"number"!=typeof e?e.max||e.exact||e.ideal||e.min||t:e:t})(n.height,1080),maxWidth:r(n.width,1920)}}},n.frameRate&&"number"!=typeof n.frameRate?(t.video.mandatory.maxFrameRate=n.frameRate.max,t.video.mandatory.minFrameRate=n.frameRate.min):"number"==typeof n.frameRate&&(t.video.mandatory.maxFrameRate=n.frameRate),e.next=5,navigator.mediaDevices.getUserMedia(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ot(e){return Nt.apply(this,arguments)}function Nt(){return(Nt=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=function(e){return new kc((function(t,n){var r=document.createElement("div");r.innerText="share screen",r.setAttribute("style","text-align: center; height: 25px; line-height: 25px; border-radius: 4px 4px 0 0; background: #D4D2D4; border-bottom:  solid 1px #B9B8B9;");var i=document.createElement("div");i.setAttribute("style","width: 100%; height: 500px; padding: 15px 25px ; box-sizing: border-box;");var o=document.createElement("div");o.innerText="Agora Web Screensharing wants to share the contents of your screen with webdemo.agorabeckon.com. Choose what you'd like to share.",o.setAttribute("style","height: 12%;");var a=document.createElement("div");a.setAttribute("style","width: 100%; height: 80%; background: #FFF; border:  solid 1px #CBCBCB; display: flex; flex-wrap: wrap; justify-content: space-around; overflow-y: scroll; padding: 0 15px; box-sizing: border-box;");var s=document.createElement("div");s.setAttribute("style","text-align: right; padding: 16px 0;");var c=document.createElement("button");c.innerHTML="cancel",c.setAttribute("style","width: 85px;"),c.onclick=function(){document.body.removeChild(u);var e=Error("NotAllowedError");e.name="NotAllowedError",n(e)},s.appendChild(c),i.appendChild(o),i.appendChild(a),i.appendChild(s);var u=document.createElement("div");u.setAttribute("style","position: fixed; z-index: 99999999; top: 50%; left: 50%; width: 620px; height: 525px; background: #ECECEC; border-radius: 4px; -webkit-transform: translate(-50%,-50%); transform: translate(-50%,-50%);"),u.appendChild(r),u.appendChild(i),document.body.appendChild(u),Pc(e).call(e,(function(e){if(e.id){var n=document.createElement("div");n.setAttribute("style","width: 30%; height: 160px; padding: 20px 0; text-align: center;box-sizing: content-box;"),n.innerHTML='<div style="height: 120px; display: table-cell; vertical-align: middle;"><img style="width: 100%; background: #333333; box-shadow: 1px 1px 1px 1px rgba(0, 0, 0, 0.2);" src='+e.thumbnail.toDataURL()+' /></div><span style="\theight: 40px; line-height: 40px; display: inline-block; width: 70%; word-break: keep-all; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;">'+e.name+"</span>",n.onclick=function(){document.body.removeChild(u),t(e.id)},a.appendChild(n)}}))}))},e.next=3,Pt(t.mediaSource);case 3:return e.t1=e.sent,e.next=6,(0,e.t0)(e.t1);case 6:return n=e.sent,e.next=9,Ct(n,t);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pt(e){return Dt.apply(this,arguments)}function Dt(){return(Dt=m(v.mark((function e(t){var n,r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=["window","screen"],"application"!==t&&"window"!==t||(n=["window"]),"screen"===t&&(n=["screen"]),r=xt()){e.next=6;break}throw new Al($u.ELECTRON_IS_NULL);case 6:t=null;try{t=r.desktopCapturer.getSources({types:n})}catch(i){t=null}return t&&t.then||(t=new kc((function(e,t){r.desktopCapturer.getSources({types:n},(function(n,r){n?t(n):e(r)}))}))),e.prev=9,e.next=12,t;case 12:return e.abrupt("return",e.sent);case 15:throw e.prev=15,e.t0=e.catch(9),new Al($u.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR,e.t0.toString());case 18:case"end":return e.stop()}}),e,null,[[9,15]])})))).apply(this,arguments)}function xt(){if(Af)return Af;try{return Af=window.require("electron")}catch(Tu){return null}}function Lt(e,t){return Mt.apply(this,arguments)}function Mt(){return(Mt=m(v.mark((function e(t,n){var r,i,o,a,s;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=0,i=null;case 1:if(!(2>r)){e.next=24;break}return e.prev=2,e.next=5,Ut(t,n,0<r);case 5:return i=e.sent,e.abrupt("break",24);case 9:if(e.prev=9,e.t0=e.catch(2),!(e.t0 instanceof Al)){e.next=13;break}throw Rl.error(cs(a="[".concat(n,"] ")).call(a,e.t0.toString())),e.t0;case 13:if((s=Ft(e.t0.name||e.t0.code||e.t0,e.t0.message)).code!==$u.MEDIA_OPTION_INVALID){e.next=21;break}return Rl.debug("[".concat(n,"] detect media option invalid, retry")),r+=1,e.next=19,ht(500);case 19:e.next=22;break;case 21:throw Rl.error(cs(o="[".concat(n,"] ")).call(o,s.toString())),s;case 22:e.next=1;break;case 24:if(i){e.next=26;break}throw new Al($u.UNEXPECTED_ERROR,"can not find stream after getUserMedia");case 26:return e.abrupt("return",i);case 27:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function Ut(e,t,n){return jt.apply(this,arguments)}function jt(){return(jt=m(v.mark((function e(t,n,r){var i,o,a,s,c;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(navigator.mediaDevices&&navigator.mediaDevices.getUserMedia){e.next=2;break}throw new Al($u.NOT_SUPPORTED,"can not find getUserMedia");case 2:if(r&&(t.video&&(delete t.video.width,delete t.video.height),t.screen&&(delete t.screen.width,delete t.screen.height)),i=Ed,r=new MediaStream,t.audioSource&&r.addTrack(t.audioSource),t.videoSource&&r.addTrack(t.videoSource),t.audio||t.video||t.screen){e.next=7;break}return e.abrupt("return",(Rl.debug("Using Video Source/ Audio Source"),r));case 7:if(!t.screen){e.next=65;break}if(!xt()){e.next=26;break}if(!t.screen.sourceId){e.next=18;break}return e.t0=Vt,e.t1=r,e.next=14,Ct(t.screen.sourceId,t.screen);case 14:e.t2=e.sent,(0,e.t0)(e.t1,e.t2),e.next=24;break;case 18:return e.t3=Vt,e.t4=r,e.next=22,Ot(t.screen);case 22:e.t5=e.sent,(0,e.t3)(e.t4,e.t5);case 24:e.next=65;break;case 26:if(!(et()&&t.screen.extensionId&&t.screen.mandatory)){e.next=42;break}if(i.getStreamFromExtension){e.next=29;break}throw new Al($u.NOT_SUPPORTED,"This browser does not support screen sharing");case 29:return Rl.debug("[".concat(n,'] Screen access on chrome stable, looking for extension"')),e.next=32,a=t.screen.extensionId,s=n,new kc((function(e,t){try{chrome.runtime.sendMessage(a,{getStream:!0},(function(n){if(!n||!n.streamId)return Rl.error("[".concat(s,"] No response from Chrome Plugin. Plugin not installed properly"),n),void t(new Al($u.CHROME_PLUGIN_NO_RESPONSE,"No response from Chrome Plugin. Plugin not installed properly"));e(n.streamId)}))}catch(r){var n;Rl.error(cs(n="[".concat(s,"] AgoraRTC screensharing plugin is not accessible(")).call(n,a,")"),r.toString()),t(new Al($u.CHROME_PLUGIN_NOT_INSTALL))}}));case 32:return o=e.sent,t.screen.mandatory.chromeMediaSourceId=o,e.t6=Vt,e.t7=r,e.next=38,navigator.mediaDevices.getUserMedia({video:{mandatory:t.screen.mandatory}});case 38:e.t8=e.sent,(0,e.t6)(e.t7,e.t8),e.next=65;break;case 42:if(!i.getDisplayMedia){e.next=54;break}return t.screen.mediaSource&&$e(t.screen.mediaSource),o={width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate,displaySurface:"screen"===t.screen.mediaSource?"monitor":t.screen.mediaSource},Rl.debug("[".concat(n,"] getDisplayMedia:"),Yr({video:o,audio:!!t.screenAudio})),e.t9=Vt,e.t10=r,e.next=50,navigator.mediaDevices.getDisplayMedia({video:o,audio:!!t.screenAudio});case 50:e.t11=e.sent,(0,e.t9)(e.t10,e.t11),e.next=65;break;case 54:if(Ze().name===wu.FIREFOX){e.next=56;break}throw Rl.error("[".concat(n,"] This browser does not support screenSharing")),new Al($u.NOT_SUPPORTED,"This browser does not support screen sharing");case 56:return t.screen.mediaSource&&$e(t.screen.mediaSource),i={video:{mediaSource:t.screen.mediaSource,width:t.screen.width,height:t.screen.height,frameRate:t.screen.frameRate}},Rl.debug(cs(o="[".concat(n,"] getUserMedia: ")).call(o,Yr(i))),e.t12=Vt,e.t13=r,e.next=63,navigator.mediaDevices.getUserMedia(i);case 63:e.t14=e.sent,(0,e.t12)(e.t13,e.t14);case 65:if(t.video||t.audio){e.next=67;break}return e.abrupt("return",r);case 67:if(t={video:t.video,audio:t.audio},Rl.debug("[".concat(n,"] GetUserMedia"),Yr(t)),n=Ze(),o=null,e.t15=n.name!==wu.SAFARI&&n.os!==Eu.IOS,e.t15){e.next=76;break}return e.next=75,Of.lock();case 75:o=e.sent;case 76:return e.prev=76,e.next=79,navigator.mediaDevices.getUserMedia(t);case 79:c=e.sent,e.next=85;break;case 82:throw e.prev=82,e.t16=e.catch(76),o&&o(),e.t16;case 85:return e.abrupt("return",(t.audio&&(Nf=!0),t.video&&(Pf=!0),Vt(r,c),o&&o(),r));case 86:case"end":return e.stop()}}),e,null,[[76,82]])})))).apply(this,arguments)}function Ft(e,t){switch(e){case"Starting video failed":case"OverconstrainedError":case"TrackStartError":var n;return new Al($u.MEDIA_OPTION_INVALID,cs(n="".concat(e,": ")).call(n,t));case"NotFoundError":case"DevicesNotFoundError":var r;return new Al($u.DEVICE_NOT_FOUND,cs(r="".concat(e,": ")).call(r,t));case"NotSupportedError":var i;return new Al($u.NOT_SUPPORTED,cs(i="".concat(e,": ")).call(i,t));case"NotReadableError":var o;return new Al($u.NOT_READABLE,cs(o="".concat(e,": ")).call(o,t));case"InvalidStateError":case"NotAllowedError":case"PERMISSION_DENIED":case"PermissionDeniedError":var a;return new Al($u.PERMISSION_DENIED,cs(a="".concat(e,": ")).call(a,t));case"ConstraintNotSatisfiedError":var s;return new Al($u.CONSTRAINT_NOT_SATISFIED,cs(s="".concat(e,": ")).call(s,t));default:var c;return Rl.error("getUserMedia unexpected error",e),new Al($u.UNEXPECTED_ERROR,cs(c="".concat(e,": ")).call(c,t))}}function Vt(e,t){var n=e.getVideoTracks()[0],r=e.getAudioTracks()[0],i=t.getVideoTracks()[0];(t=t.getAudioTracks()[0])&&(r&&e.removeTrack(r),e.addTrack(t)),i&&(n&&e.removeTrack(n),e.addTrack(i))}function Bt(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Wt(e,t,n){return new kc((function(r,i){t.timeout=t.timeout||Bu.HTTP_CONNECT_TIMEOUT,t.responseType=t.responseType||"json",t.data&&!n?(t.data=Yr(t.data),ft(t.data)):n&&t.data.size,t.headers=t.headers||{},t.headers["Content-Type"]=t.headers["Content-Type"]||"application/json",t.method="POST",t.url=e,Tl.request(t).then((function(e){"string"==typeof e.data?ft(e.data):e.data instanceof ArrayBuffer||e.data instanceof Uint8Array?e.data.byteLength:ft(Yr(e.data)),r(e.data)})).catch((function(e){Tl.isCancel(e)?i(new Al($u.OPERATION_ABORTED,"cancel token canceled")):"ECONNABORTED"===e.code?i(new Al($u.NETWORK_TIMEOUT,e.message)):e.response?i(new Al($u.NETWORK_RESPONSE_ERROR,e.response.status)):i(new Al($u.NETWORK_ERROR,e.message))}))}))}function Gt(e,t){return qt.apply(this,arguments)}function qt(){return(qt=m(v.mark((function e(t,n){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=new Blob([n.data],{type:"buffer"}),e.next=3,Wt(t,function(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Bt(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Bt(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}({},n,{data:r,headers:{"Content-Type":"application/octet-stream"}}),!0);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Kt(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ht(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Kt(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Kt(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function zt(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:Ff};return function(t,n,r){var i=t[n];if("function"==typeof i){var o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;r.value=function(){for(var t,r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];var c=e.report.reportApiInvoke(this._sessionId||null,{name:cs(t="".concat(o,".")).call(t,n),options:a,tag:Pl.TRACER});try{var u=i.apply(this,a);return c.onSuccess(),u}catch(l){throw c.onError(l),l}}}return r}}function Yt(e){var t=Vf[Math.floor(e/1e4)];if(!t)return{desc:"unkonw error",retry:!1};if(!(t=t[e%1e4])){if(Math.floor(e/1e4)===Ll.ACCESS_POINT){if("1"===(e%=1e4).toString()[0])return{desc:e.toString(),retry:!1};if("2"===e.toString()[0])return{desc:e.toString(),retry:!0}}return{desc:"unkonw error",retry:!1}}return t}function Qt(e){return Bf[e]||{desc:"UNKNOW_ERROR_".concat(e),action:"failed"}}function Xt(e,t,n,r){var i=Sa({},Wf,r),o=i.timeout,a=function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(o);case 2:o*=i.timeoutFactor,o=Math.min(i.maxRetryTimeout,o);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=!1;return(r=new kc(function(){var r=m(v.mark((function r(o,c){var u,l;return v.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:t=t||function(){return!1},n=n||function(){return!0},u=0;case 3:if(!(u<i.maxRetryCount)){r.next=25;break}if(!s){r.next=6;break}return r.abrupt("return",c(new Al($u.OPERATION_ABORTED)));case 6:return r.prev=6,r.next=9,e();case 9:if(l=r.sent,t(l,u)&&u+1!==i.maxRetryCount){r.next=12;break}return r.abrupt("return",o(l));case 12:return r.next=14,a();case 14:r.next=22;break;case 16:if(r.prev=16,r.t0=r.catch(6),n(r.t0,u)&&u+1!==i.maxRetryCount){r.next=20;break}return r.abrupt("return",c(r.t0));case 20:return r.next=22,a();case 22:u+=1,r.next=3;break;case 25:case"end":return r.stop()}}),r,null,[[6,16]])})));return function(e,t){return r.apply(this,arguments)}}())).cancel=function(){return s=!0},r}function Jt(){Yf?(Rl.info("create audio context"),(Qf=new Yf).onstatechange=function(){Xf.emit("state-change")},function(e){function t(t){"running"===e.state?(n(!1),_&&e.suspend().then(r,r)):"closed"!==e.state&&(_?n(!1):(n(!0),t&&e.resume().then(r,r)))}function n(e){if(E!==e){E=e;for(var t=0,n=b;t<n.length;t+=1){var r=n[t];e?window.addEventListener(r,i,{capture:!0,passive:!0}):window.removeEventListener(r,i,{capture:!0,passive:!0})}}}function r(){t(!1)}function i(){t(!0)}function o(e){if(!T)if(v.paused)if(_)a(!1);else if(e){a(!1),T=!0,e=void 0;try{(e=v.play())?e.then(s,s):(v.addEventListener("playing",s),v.addEventListener("abort",s),v.addEventListener("error",s))}catch(t){s()}}else a(!0);else a(!1),_&&v.pause()}function a(e){if(w!==e){w=e;for(var t=0,n=b;t<n.length;t++){var r=n[t];e?window.addEventListener(r,c,{capture:!0,passive:!0}):window.removeEventListener(r,c,{capture:!0,passive:!0})}}}function s(){v.removeEventListener("playing",s),v.removeEventListener("abort",s),v.removeEventListener("error",s),T=!1,o(!1)}function c(){o(!0)}function u(){g&&y?m||(m=!0,_=!1,v&&o(!0),t(!0)):m&&(m=!1)}function l(){h&&document[h.hidden]===m&&(g=!document[h.hidden],u())}function d(e){if(!e||e.target===window){if(document.hasFocus()){if(y)return;y=!0}else{if(!y)return;y=!1}u()}}function f(e,t){var n;for(n=t;1<e;e--)n+=t;return n}var h;void 0!==document.hidden?h={hidden:"hidden",visibilitychange:"visibilitychange"}:void 0!==document.webkitHidden?h={hidden:"webkitHidden",visibilitychange:"webkitvisibilitychange"}:void 0!==document.mozHidden?h={hidden:"mozHidden",visibilitychange:"mozvisibilitychange"}:void 0!==document.msHidden&&(h={hidden:"msHidden",visibilitychange:"msvisibilitychange"});var p=navigator.userAgent.toLowerCase();p=0<=Gc(p).call(p,"iphone")&&0>Gc(p).call(p,"like iphone")||0<=Gc(p).call(p,"ipad")&&0>Gc(p).call(p,"like ipad")||0<=Gc(p).call(p,"ipod")&&0>Gc(p).call(p,"like ipod");var v,m=!0,g=!0,y=!0,_=!1,b="click contextmenu auxclick dblclick mousedown mouseup touchend keydown keyup".split(" "),E=!1,w=!1,T=!1;if(p){var S=document.createElement("div");S.innerHTML="<audio x-webkit-airplay='deny'></audio>",(v=S.children.item(0)).controls=!1,v.disableRemotePlayback=!0,v.preload="auto",v.src="data:audio/mpeg;base64,//uQx"+f(23,"A")+"WGluZwAAAA8AAAACAAACcQCA"+f(16,"gICA")+f(66,"/")+"8AAABhTEFNRTMuMTAwA8MAAAAAAAAAABQgJAUHQQAB9AAAAnGMHkkI"+f(320,"A")+"//sQxAADgnABGiAAQBCqgCRMAAgEAH"+f(15,"/")+"7+n/9FTuQsQH//////2NG0jWUGlio5gLQTOtIoeR2WX////X4s9Atb/JRVCbBUpeRUq"+f(18,"/")+"9RUi0f2jn/+xDECgPCjAEQAABN4AAANIAAAAQVTEFNRTMuMTAw"+f(97,"V")+"Q==",v.loop=!0,v.load(),o(!0)}e.onstatechange=function(){t(!0)},t(!1),h&&document.addEventListener(h.visibilitychange,l,!0),p&&(window.addEventListener("focus",d,!0),window.addEventListener("blur",d,!0)),l(),d()}(Qf)):Rl.error("your browser is not support web audio")}function $t(){if(!Qf&&(Jt(),!Qf))throw new Al($u.NOT_SUPPORTED,"can not create audio context");return Qf}function Zt(e){if(!function(){if(null!==Jf)return Jf;var e=$t(),t=e.createBufferSource(),n=e.createGain();e=e.createGain(),t.connect(n),t.connect(e),t.disconnect(n),e=!1;try{t.disconnect(n)}catch(r){e=!0}return t.disconnect(),Jf=e,e}()){Rl.debug("polyfill audio node");var t=e.connect,n=e.disconnect;e.connect=function(n,r,i){var o;return e._inputNodes||(e._inputNodes=[]),uu(o=e._inputNodes).call(o,n)||(n instanceof AudioNode?(e._inputNodes.push(n),t.call(e,n,r,i)):t.call(e,n,r)),e},e.disconnect=function(r,i,o){n.call(e),r?wt(e._inputNodes,r):e._inputNodes=[];var a,s=p(e._inputNodes);try{for(s.s();!(a=s.n()).done;){var c=a.value;t.call(e,c)}}catch(u){s.e(u)}finally{s.f()}}}}function en(e,t){var n=1/t,r=$t(),i=r.createGain();i.gain.value=0,i.connect(r.destination);var o=!1;return function t(){if(o)i=null;else{var a=r.createOscillator();a.onended=t,a.connect(i),a.start(0),a.stop(r.currentTime+n),e(r.currentTime)}}(),function(){o=!0}}function tn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function nn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=tn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=tn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function rn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function on(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=rn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=rn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function an(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function sn(e,t,n,r,i){ch+=1;var o,a,s={sid:n.sid,command:"convergeAllocateEdge",uid:"666",appId:n.appId,ts:Math.floor(gf()/1e3),seq:ch,requestId:ch,version:Du,cname:n.cname},c={service_name:t,json_body:Yr(s)},u=e[0];return Xt(m(v.mark((function e(){var n,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=gf(),e.next=3,Wt(u,{data:c,cancelToken:r,headers:{"X-Packet-Service-Type":"0","X-Packet-URI":"61"}});case 3:if(n=e.sent,a=gf()-o,0===n.code){e.next=7;break}throw i=new Al($u.UNEXPECTED_RESPONSE,"live streaming ap error, code"+n.code,{retry:!0,responseTime:a}),Rl.error(i.toString()),i;case 7:if(200===(n=JSON.parse(n.json_body)).code){e.next=10;break}throw n=new Al($u.UNEXPECTED_RESPONSE,cs(i="live streaming app center error, code: ".concat(n.code,", reason: ")).call(i,n.reason),{code:n.code,responseTime:a}),Rl.error(n.toString()),n;case 10:if(n.servers&&0!==n.servers.length){e.next=12;break}throw i=new Al($u.UNEXPECTED_RESPONSE,"live streaming app center empty server",{code:n.code,responseTime:a}),Rl.error(i.toString()),i;case 12:return i=function(e,t){var n;return{addressList:Pc(n=e.servers).call(n,(function(e){var n,r;return cs(n=cs(r="wss://".concat(e.address.replace(/\./g,"-"),".edge.agora.io:")).call(r,e.wss,"?serviceName=")).call(n,encodeURIComponent(t))})),workerToken:e.workerToken,vid:e.vid}}(n,t),e.abrupt("return",(Bu.LIVE_STREAMING_ADDRESS&&(i.addressList=Bu.LIVE_STREAMING_ADDRESS instanceof Array?Bu.LIVE_STREAMING_ADDRESS:[Bu.LIVE_STREAMING_ADDRESS]),function(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=an(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=an(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}({},i,{responseTime:a})));case 14:case"end":return e.stop()}}),e)}))),(function(r,i){return Ff.apworkerEvent(n.sid,{success:!0,sc:200,serviceName:t,responseDetail:Yr(r.addressList),firstSuccess:0===i,responseTime:a,serverIp:e[i%e.length]}),!1}),(function(r,i){return Ff.apworkerEvent(n.sid,{success:!1,sc:r.data&&r.data.code||200,serviceName:t,responseTime:a,serverIp:e[i%e.length]}),!!(r.code!==$u.OPERATION_ABORTED&&r.code!==$u.UNEXPECTED_RESPONSE||r.data&&r.data.retry)&&(u=e[(i+1)%e.length],!0)}),i)}function cn(e,t,n,r){var i=e.url,o=e.areaCode,a=gf(),s={opid:133,flag:4096,ts:gf(),key:t.token,cname:t.cname,sid:t.sid,detail:{6:t.stringUid,11:o},uid:t.uid||0};return t.multiIP&&t.multiIP.gateway_ip&&(s.detail[5]=Yr({vocs_ip:[t.multiIP.uni_lbs_ip],vos_ip:[t.multiIP.gateway_ip]})),Xt(m(v.mark((function e(){var t,r,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt(i+"".concat(-1===Gc(i).call(i,"?")?"?":"&","action=wrtc_gateway"),{data:s,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}});case 2:if(!(t=e.sent).addresses||0!==t.addresses.length||0!==t.code){e.next=5;break}throw new Al($u.VOID_GATEWAY_ADDRESS,"",{retry:!0});case 5:return Bu.GATEWAY_ADDRESS&&0<Bu.GATEWAY_ADDRESS.length&&(console.log(Bu.GATEWAY_ADDRESS),o=Pc(r=Bu.GATEWAY_ADDRESS).call(r,(function(e,n){return{ip:e.ip,port:e.port,ticket:t.addresses[0]&&t.addresses[0].ticket}})),t.addresses=o),e.abrupt("return",function(e,t){var n,r=[".agora.io",".sd-rtn.com"],i=r[1]&&-1!==Gc(t).call(t,r[1])?1:0;return e.addresses=e.addresses||[],{gatewayAddrs:Pc(n=e.addresses).call(n,(function(e){var t,n,o;return e.ip.match(/^[\.:\d]+$/)?cs(t=cs(n="".concat(e.ip.replace(/[^\d]/g,"-"),".edge")).call(n,r[i++%r.length],":")).call(t,e.port):(Rl.info("Cannot recognized as IP address ".concat(e.ip,". Used As Host instead")),cs(o="".concat(e.ip,":")).call(o,e.port))})),uid:e.uid,cid:e.cid,vid:e.detail&&e.detail[8],uni_lbs_ip:e.detail&&e.detail[1],res:e}}(t,i));case 7:case"end":return e.stop()}}),e)}))),(function(e){if(0===e.res.code)return Ff.joinChooseServer(t.sid,{lts:a,succ:!0,csAddr:i,serverList:e.gatewayAddrs,ec:null,cid:e.res.cid.toString(),uid:e.res.uid.toString()}),!1;throw e=Yt(e.res.code),new Al($u.CAN_NOT_GET_GATEWAY_SERVER,e.desc,{retry:e.retry})}),(function(e){return e.code!==$u.OPERATION_ABORTED&&(e.code===$u.CAN_NOT_GET_GATEWAY_SERVER||e.code===$u.VOID_GATEWAY_ADDRESS?(Ff.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:i,serverList:null,ec:e.message}),Rl.warning(cs(n=cs(r=cs(o="[".concat(t.clientId,"] Choose server ")).call(o,i," failed, message: ")).call(r,e.message,", retry: ")).call(n,e.data.retry)),e.data.retry):(Ff.joinChooseServer(t.sid,{lts:a,succ:!1,csAddr:i,serverList:null,ec:e.code}),Rl.warning("[".concat(t.clientId,"] Choose server network error, retry"),e),!0));var n,r,o}),r)}function un(e,t,n){return ln.apply(this,arguments)}function ln(){return(ln=m(v.mark((function e(t,n,r){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,function(){var e=m(v.mark((function e(t,n,r){var i,o,a,s,c;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pc(i=Qc(o=Bu.WEBCS_DOMAIN).call(o,0,Bu.AJAX_REQUEST_CONCURRENT)).call(i,(function(e){var n;return{url:t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1"):"https://".concat(e,"/api/v1"),areaCode:lh()}})),s=null,i=Pc(a).call(a,(function(e){return Rl.debug("[".concat(t.clientId,"] Connect to choose_server:"),e.url),cn(e,t,n,r)})),o=function(){return new kc(function(){var e=m(v.mark((function e(i,o){var a,c,u,l;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ht(1e3);case 2:if(null!==s){e.next=5;break}u=Pc(a=Qc(c=Bu.WEBCS_DOMAIN_BACKUP_LIST).call(c,0,Bu.AJAX_REQUEST_CONCURRENT)).call(a,(function(e){var n;return{url:t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1"):"https://".concat(e,"/api/v1"),areaCode:lh()}})),gt(l=Pc(u).call(u,(function(e){return Rl.debug("[".concat(t.clientId,"] Connect to backup choose_server:"),e.url),cn(e,t,n,r)}))).then((function(e){ba(l).call(l,(function(e){return e.cancel()})),i(e)})).catch((function(e){return o(e[0])}));case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},e.prev=4,e.next=7,gt(cs(c=[o()]).call(c,i));case 7:s=e.sent,e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(4),e.t0[0];case 13:return e.abrupt("return",(ba(i).call(i,(function(e){return e.cancel()})),s));case 14:case"end":return e.stop()}}),e,null,[[4,10]])})));return function(t,n,r){return e.apply(this,arguments)}}()(t,n,r);case 2:return e.t0=e.sent,e.abrupt("return",{gatewayInfo:e.t0});case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function dn(e,t,n){return fn.apply(this,arguments)}function fn(){return(fn=m(v.mark((function e(t,n,r){var i,o,a,s;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("disabled"===t.cloudProxyServer){e.next=10;break}return e.next=3,function(){var e=m(v.mark((function e(t,n,r){var i,o,a,s,c,u,l;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=gf(),s=Pc(i=Qc(o=Bu.PROXY_CS).call(o,0,Bu.AJAX_REQUEST_CONCURRENT)).call(i,(function(e){var n;return t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1"):"https://".concat(e,"/api/v1")})),"proxy3"!==t.cloudProxyServer&&"proxy4"!==t.cloudProxyServer&&"proxy5"!==t.cloudProxyServer){e.next=20;break}return a=Pc(c=Qc(u=Bu.PROXY_CS).call(u,0,Bu.AJAX_REQUEST_CONCURRENT)).call(c,(function(e){var n;return{url:t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1"):"https://".concat(e,"/api/v1"),areaCode:lh()}})),a=Pc(a).call(a,(function(e){return function(e,t,n,r){var i=e.url,o=e.areaCode,a=gf(),s={opid:133,flag:1048576,ts:+new Date,key:t.token,cname:t.cname,sid:t.sid,detail:{6:t.stringUid,11:o},uid:t.uid||0};return Xt(m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wt(i,{data:s,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":69}});case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))),(function(e){var n;if(0===e.code)return Ff.joinWebProxyAP(t.sid,{lts:a,sucess:1,apServerAddr:i,turnServerAddrList:Pc(n=e.addresses).call(n,(function(e){return e.ip})).join(","),errorCode:null,eventType:t.cloudProxyServer}),!1;throw e=Yt(e.code),new Al($u.CAN_NOT_GET_GATEWAY_SERVER,e.desc,{retry:e.retry})}),(function(e){return e.code!==$u.OPERATION_ABORTED&&(e.code===$u.CAN_NOT_GET_GATEWAY_SERVER||e.code===$u.VOID_GATEWAY_ADDRESS?(Ff.joinWebProxyAP(s.sid,{lts:a,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer}),Rl.warning(cs(n=cs(r=cs(o="[".concat(t.clientId,"] proxy ap server ")).call(o,i," failed, message: ")).call(r,e.message,", retry: ")).call(n,e.data.retry)),e.data.retry):(Ff.joinWebProxyAP(s.sid,{lts:a,sucess:0,apServerAddr:i,turnServerAddrList:null,errorCode:e.code,eventType:t.cloudProxyServer}),!0));var n,r,o}),r)}(e,t,n,r)})),l=null,e.prev=6,e.next=9,gt(a);case 9:l=e.sent,e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(6),Rl.error("[".concat(t.clientId,"] can not get proxy server after trying several times")),new Al($u.CAN_NOT_GET_PROXY_SERVER);case 15:if(ba(a).call(a,(function(e){return e.cancel()})),(a=l.addresses)&&0!==a.length){e.next=19;break}throw Rl.error("[".concat(t.clientId,"] can not get proxy server, empty proxy server list")),new Al($u.CAN_NOT_GET_PROXY_SERVER,"empty proxy server list");case 19:return e.abrupt("return",{addresses:Pc(a).call(a,(function(e){return e.ip})),serverResponse:{tcpport:a[0].port||443,udpport:a[0].port||Mu.udpport,username:Mu.username,password:Mu.password}});case 20:return u=Pc(s).call(s,(function(e){return function(e,t,n,r){var i=gf(),o={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,uid:t.uid,cname:t.cname,ts:Math.floor(gf()/1e3),version:Du,seq:0,requestId:1};return Xt(m(v.mark((function t(){return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Wt(e,{data:{service_name:"webrtc_proxy",json_body:Yr(o)},cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});case 2:return t.t0=t.sent,t.t1=e,t.abrupt("return",{res:t.t0,url:t.t1});case 5:case"end":return t.stop()}}),t)}))),(function(e){if(!e.res.json_body)throw Rl.debug("[".concat(t.clientId,"] Get proxy server failed: no json_body")),new Al($u.UNEXPECTED_RESPONSE,Yr(e.res));var n,r,i=JSON.parse(e.res.json_body);if(200!==i.code)throw Rl.debug(cs(n=cs(r="[".concat(t.clientId,"] Get proxy server failed: response code [")).call(r,i.code,"], reason [")).call(n,i.reason,"]")),new Al($u.UNEXPECTED_RESPONSE,Yr(e.res));return Rl.debug("[".concat(t.clientId,"] App return server length"),i.servers.length),!1}),(function(t){return t.code!==$u.OPERATION_ABORTED&&(Ff.requestProxyAppCenter(o.sid,{lts:i,succ:!1,APAddr:e,workerManagerList:null,ec:t.code,response:t.message}),!0)}),r)}(e,t,n,r)})),c=null,e.prev=22,e.next=25,gt(u);case 25:c=e.sent,e.next=31;break;case 28:throw e.prev=28,e.t1=e.catch(22),Rl.error("[".concat(t.clientId,"] can not get proxy server after trying several times")),new Al($u.CAN_NOT_GET_PROXY_SERVER);case 31:if(ba(u).call(u,(function(e){return e.cancel()})),u=JSON.parse(c.res.json_body),u=Pc(l=u.servers).call(l,ot),"443only"!==t.cloudProxyServer){e.next=36;break}return e.abrupt("return",{addresses:u,serverResponse:{tcpport:443,udpport:Mu.udpport,username:Mu.username,password:Mu.password}});case 36:return Ff.requestProxyAppCenter(t.sid,{lts:a,succ:!0,APAddr:c.url,workerManagerList:Yr(u),ec:null,response:Yr(c.res)}),a=gf(),l=Pc(u).call(u,(function(e){return function(e,t,n,r){var i=gf(),o=e;bu(e).call(e,"http")||(o="https://".concat(e,":4000/v2/machine"));var a={command:"request",gatewayType:"http",appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sdkVersion:"2.3.1",sid:t.sid,seq:1,ts:gf(),requestId:3,clientRequest:{appId:t.appId,cname:t.cname,uid:(t.uid||"").toString(),sid:t.sid}};return Xt(m(v.mark((function t(){return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Wt(o,{data:a,cancelToken:n});case 2:return t.t0=t.sent,t.t1=e,t.abrupt("return",{res:t.t0,url:t.t1});case 5:case"end":return t.stop()}}),t)}))),(function(e){if(!e.res.serverResponse)throw new Al($u.UNEXPECTED_RESPONSE,"requeet worker manager server failed: serverResponse is undefined");return!1}),(function(t){return t.code!==$u.OPERATION_ABORTED&&(Ff.requestProxyWorkerManager(a.sid,{lts:i,succ:!1,workerManagerAddr:e,ec:t.code,response:t.message}),!0)}),r)}(e,t,n,r)})),c=null,e.prev=40,e.next=43,gt(l);case 43:c=e.sent,e.next=49;break;case 46:throw e.prev=46,e.t2=e.catch(40),Rl.error("[".concat(t.clientId,"] can not get worker manager after trying several times")),new Al($u.CAN_NOT_GET_PROXY_SERVER);case 49:return e.abrupt("return",(ba(l).call(l,(function(e){return e.cancel()})),Ff.requestProxyWorkerManager(t.sid,{lts:a,succ:!0,workerManagerAddr:c.url,ec:null,response:Yr(c.res)}),{addresses:[c.url],serverResponse:c.res.serverResponse}));case 50:case"end":return e.stop()}}),e,null,[[6,12],[22,28],[40,46]])})));return function(t,n,r){return e.apply(this,arguments)}}()(t,n,r);case 3:s=e.sent,"443only"===t.cloudProxyServer?t.proxyServer=Bu.PROXY_SERVER_TYPE2:"proxy3"!==t.cloudProxyServer&&"proxy4"!==t.cloudProxyServer&&"proxy5"!==t.cloudProxyServer||(t.proxyServer=Bu.PROXY_SERVER_TYPE3),Ff.setProxyServer(t.proxyServer),Rl.setProxyServer(t.proxyServer),"normal"===t.cloudProxyServer&&(t.proxyServer=s.addresses[0],Ff.setProxyServer(t.proxyServer),Rl.setProxyServer(t.proxyServer)),t.turnServer={mode:"manual",servers:Pc(i=s.addresses).call(i,(function(e){return{turnServerURL:e,tcpport:"proxy3"===t.cloudProxyServer?void 0:s.serverResponse.tcpport?s.serverResponse.tcpport:Mu.tcpport,udpport:"proxy4"===t.cloudProxyServer?void 0:s.serverResponse.udpport?s.serverResponse.udpport:Mu.udpport,username:s.serverResponse.username||Mu.username,password:s.serverResponse.password||Mu.password,forceturn:"proxy4"!==t.cloudProxyServer,security:"proxy5"===t.cloudProxyServer}}))},Rl.debug(cs(o=cs(a="[".concat(t.clientId,"] set proxy server: ")).call(a,t.proxyServer,", mode: ")).call(o,t.cloudProxyServer));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function hn(e,t,n,r){return pn.apply(this,arguments)}function pn(){return(pn=m(v.mark((function e(t,n,r,i){var o,a;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Qc(o=Bu.ACCOUNT_REGISTER).call(o,0,Bu.AJAX_REQUEST_CONCURRENT),o=[],o=n.proxyServer?Pc(a).call(a,(function(e){var t;return cs(t="https://".concat(n.proxyServer,"/ap/?url=")).call(t,e+"/api/v1")})):Pc(a).call(a,(function(e){return"https://".concat(e,"/api/v1")})),e.next=5,function(){var e=m(v.mark((function e(t,n,r,i,o){var a,s,c;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=gf(),s={sid:r.sid,opid:10,appid:r.appId,string_uid:n},c=t[0],e.next=3,Xt((function(){return Wt(c+"".concat(-1===Gc(c).call(c,"?")?"?":"&","action=stringuid"),{data:s,cancelToken:i,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":72}})}),(function(e,r){if(0===e.code){var i;if(0>=e.uid||e.uid>=Math.pow(2,32))throw Rl.error(cs(i="Invalid Uint Uid ".concat(n," => ")).call(i,e.uid),e),Ff.reqUserAccount(s.sid,{lts:a,success:!1,serverAddr:c,stringUid:s.string_uid,uid:e.uid,errorCode:$u.INVALID_UINT_UID_FROM_STRING_UID,extend:s}),new Al($u.INVALID_UINT_UID_FROM_STRING_UID);return Ff.reqUserAccount(s.sid,{lts:a,success:!0,serverAddr:c,stringUid:s.string_uid,uid:e.uid,errorCode:null,extend:s}),!1}return(i=Yt(e.code)).retry&&(c=t[(r+1)%t.length]),Ff.reqUserAccount(s.sid,{lts:a,success:!1,serverAddr:c,stringUid:s.string_uid,uid:e.uid,errorCode:i.desc,extend:s}),i.retry}),(function(e,n){return e.code!==$u.OPERATION_ABORTED&&(Ff.reqUserAccount(s.sid,{lts:a,success:!1,serverAddr:c,stringUid:s.string_uid,uid:null,errorCode:e.code,extend:s}),c=t[(n+1)%t.length],!0)}),o);case 3:if(0===(r=e.sent).code){e.next=6;break}throw r=Yt(r.code),new Al($u.UNEXPECTED_RESPONSE,r.desc);case 6:return e.abrupt("return",r);case 7:case"end":return e.stop()}}),e)})));return function(t,n,r,i,o){return e.apply(this,arguments)}}()(o,t,n,r,i);case 5:return e.abrupt("return",e.sent.uid);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function vn(e,t,n){return mn.apply(this,arguments)}function mn(){return(mn=m(v.mark((function e(t,n,r){var i,o,a,s;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pc(i=Qc(o=Bu.CDS_AP).call(o,0,Bu.AJAX_REQUEST_CONCURRENT)).call(i,(function(e){var n;return t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1"):"https://".concat(e,"/api/v1?action=config")})),i=Pc(a).call(a,(function(e){return function(e,t,n,r){var i=Ze(),o={flag:64,cipher_method:0,features:{device:i.name,system:i.os,vendor:t.appId,version:Du,cname:t.cname,sid:t.sid,session_id:t.sid,detail:"",proxyServer:t.proxyServer}};return Xt((function(){return Wt(e,{data:o,timeout:1e3,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":54}})}),void 0,(function(e){return e.code!==$u.OPERATION_ABORTED}),r)}(e,t,n,r)})),a=o=null,s={},e.prev=4,e.next=7,gt(i);case 7:o=e.sent,e.next=15;break;case 10:if(e.prev=10,e.t0=e.catch(4),e.t0.code!==$u.OPERATION_ABORTED){e.next=14;break}throw e.t0;case 14:a=e.t0;case 15:if(ba(i).call(i,(function(e){return e.cancel()})),Ff.reportApiInvoke(t.sid,{name:Nl.REQUEST_CONFIG_DISTRIBUTE,options:{error:a,res:o}}).onSuccess(),o&&o.test_tags)try{s=function(e){if(!e.test_tags)return{};var t=e.test_tags;e=Ra(t);var n={};return ba(e).call(e,(function(e){var r,i=Ru(r=Qc(e).call(e,4)).call(r);e=JSON.parse(t[e])[1],n[i]=e})),n}(o)}catch(c){}return e.abrupt("return",s);case 18:case"end":return e.stop()}}),e,null,[[4,10]])})))).apply(this,arguments)}function gn(e,t,n,r){return yn.apply(this,arguments)}function yn(){return(yn=m(v.mark((function e(t,n,r,i){var o,a,s;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=Pc(o=Qc(a=Bu.UAP_AP).call(a,0,Bu.AJAX_REQUEST_CONCURRENT)).call(o,(function(e){var t;return n.proxyServer?cs(t="https://".concat(n.proxyServer,"/ap/?url=")).call(t,e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")})),e.next=3,sn(s,t,n,r,i);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _n(e,t,n){return bn.apply(this,arguments)}function bn(){return(bn=m(v.mark((function e(t,n,r){var i,o,a,s;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=Pc(i=Qc(o=Bu.UAP_AP).call(o,0,Bu.AJAX_REQUEST_CONCURRENT)).call(i,(function(e){var n;return t.proxyServer?cs(n="https://".concat(t.proxyServer,"/ap/?url=")).call(n,e+"/api/v1?action=uap"):"https://".concat(e,"/api/v1?action=uap")})),i=Pc(a).call(a,(function(e){return function(e,t,n,r){t={command:"convergeAllocateEdge",sid:t.sid,appId:t.appId,token:t.token,ts:gf(),version:Du,cname:t.cname,uid:t.uid.toString(),requestId:uh,seq:uh},uh+=1;var i={service_name:"tele_channel",json_body:Yr(t)};return Xt(m(v.mark((function t(){var r,o,a;return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Wt(e,{data:i,cancelToken:n,headers:{"X-Packet-Service-Type":0,"X-Packet-URI":61}});case 2:if(0===(r=t.sent).code){t.next=6;break}throw o=new Al($u.UNEXPECTED_RESPONSE,"cross channel ap error, code"+r.code,{retry:!0}),Rl.error(o.toString()),o;case 6:if(200===(r=JSON.parse(r.json_body)).code){t.next=10;break}throw a=new Al($u.UNEXPECTED_RESPONSE,cs(o="cross channel app center error, code: ".concat(r.code,", reason: ")).call(o,r.reason)),Rl.error(a.toString()),a;case 10:if(r.servers&&0!==r.servers.length){t.next=12;break}throw o=new Al($u.UNEXPECTED_RESPONSE,"cross channel app center empty server"),Rl.error(o.toString()),o;case 12:return t.abrupt("return",{vid:r.vid,workerToken:r.workerToken,addressList:Pc(a=r.servers).call(a,(function(e){var t;return cs(t="wss://".concat(e.address.replace(/\./g,"-"),".edge.agora.io:")).call(t,e.wss)}))});case 13:case"end":return t.stop()}}),t)}))),void 0,(function(e){return!!(e.code!==$u.OPERATION_ABORTED&&e.code!==$u.UNEXPECTED_RESPONSE||e.data&&e.data.retry)}),r)}(e,t,n,r)})),e.prev=2,e.next=5,gt(i);case 5:return s=e.sent,e.abrupt("return",(ba(i).call(i,(function(e){return e.cancel()})),s));case 9:throw e.prev=9,e.t0=e.catch(2),e.t0[0];case 12:case"end":return e.stop()}}),e,null,[[2,9]])})))).apply(this,arguments)}function En(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function wn(e){if(Array.isArray(e))return e.map((function(e){return e}));if(!Tn(e))return e;var t,n={};for(t in e)Tn(e[t])||Array.isArray(e[t])?n[t]=wn(e[t]):n[t]=e[t];return n}function Tn(e){return!("object"!=typeof e||Array.isArray(e)||!e)}function Sn(e,t){function n(){this.constructor=e}hh(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function In(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{c(r.next(e))}catch(t){o(t)}}function s(e){try{c(r.throw(e))}catch(t){o(t)}}function c(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}c((r=r.apply(e,t||[])).next())}))}function Rn(e,t){function n(n){return function(a){return function(n){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,i&&(o=2&n[0]?i.return:n[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,n[1])).done)return o;switch(i=0,o&&(n=[2&n[0],o.value]),n[0]){case 0:case 1:o=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(!((o=0<(o=s.trys).length&&o[o.length-1])||6!==n[0]&&2!==n[0])){s=0;continue}if(3===n[0]&&(!o||n[1]>o[0]&&n[1]<o[3]))s.label=n[1];else if(6===n[0]&&s.label<o[1])s.label=o[1],o=n;else{if(!(o&&s.label<o[2])){o[2]&&s.ops.pop(),s.trys.pop();continue}s.label=o[2],s.ops.push(n)}}n=t.call(e,s)}catch(a){n=[6,a],i=0}finally{r=o=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}([n,a])}}var r,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a}function An(e,t,n){return(n=e.createShader(n))?(e.shaderSource(n,t),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)?n:(t=e.getShaderInfoLog(n),e.deleteShader(n),new Al($u.WEBGL_INTERNAL_ERROR,"error compiling shader:"+t).throw())):new Al($u.WEBGL_INTERNAL_ERROR,"can not create shader").throw()}function Cn(e,t,n,r){for(var i=[],o=0;o<t.length;++o)i.push(An(e,t[o],0===o?e.VERTEX_SHADER:e.FRAGMENT_SHADER));return function(e,t,n,r){var i=e.createProgram();if(!i)throw new Al($u.WEBGL_INTERNAL_ERROR,"can not create webgl program");if(ba(t).call(t,(function(t){e.attachShader(i,t)})),n&&ba(n).call(n,(function(t,n){e.bindAttribLocation(i,r?r[n]:n,t)})),e.linkProgram(i),!e.getProgramParameter(i,e.LINK_STATUS))throw t=e.getProgramInfoLog(i),e.deleteProgram(i),new Al($u.WEBGL_INTERNAL_ERROR,"error in program linking:"+t);return i}(e,i,n,r)}function kn(e){for(var t=new Uint8Array([99,114,121,112,116,105,105]),n=t.length,r=e.length,i=new Uint8Array(r),o=new Uint8Array(256),a=0;256>a;a++)o[a]=a;a=0;for(var s=0;256>s;s++){var c;c=[o[a=(a+o[s]+t[s%n])%256],o[s]],o[s]=c[0],o[a]=c[1]}for(a=n=0,s=0;s<0+r;s++){var u;u=[o[a=(a+o[n=(n+1)%256])%256],o[n]],o[n]=u[0],o[a]=u[1],t=o[(o[n]+o[a])%256],0<=s&&(i[s-0]=e[s-0]^t)}return e=String.fromCharCode.apply(null,vf(i)),Function("var winSize = 5; return `"+e+"`")()}function On(e){var t={};return e.facingMode&&(t.facingMode=e.facingMode),e.cameraId&&(t.deviceId={exact:e.cameraId}),e.encoderConfig?(e=me(e.encoderConfig),t.width=e.width,t.height=e.height,!tt()&&e.frameRate&&(t.frameRate=e.frameRate),Ze().name===wu.EDGE&&"object"==typeof t.frameRate&&(t.frameRate.max=60),Ze().name===wu.FIREFOX&&(t.frameRate={ideal:30,max:30}),t):t}function Nn(e){var t={};if(tt()||(void 0!==e.AGC&&(t.autoGainControl=e.AGC,et()&&(t.googAutoGainControl=e.AGC,t.googAutoGainControl2=e.AGC)),void 0!==e.AEC&&(t.echoCancellation=e.AEC),void 0!==e.ANS&&(t.noiseSuppression=e.ANS,et()&&(t.googNoiseSuppression=e.ANS))),e.encoderConfig){var n=_e(e.encoderConfig);t.channelCount=n.stereo?2:1,t.sampleRate=n.sampleRate,t.sampleSize=n.sampleSize}return e.microphoneId&&(t.deviceId={exact:e.microphoneId}),et()&&2===t.channelCount&&(t.googAutoGainControl=!1,t.googAutoGainControl2=!1,t.echoCancellation=!1,t.googNoiseSuppression=!1),t}function Pn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Dn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Pn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Pn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function xn(e,t){var n=e.match(/a=rtpmap:(\d+) opus/);if(!n||!n[0]||!n[1])return e;var r,i=n[1];return(n=e.match("a=fmtp:".concat(i,".*\r\n")))&&n[0]?(i="a=fmtp:".concat(i," minptime=10;useinbandfec=1;"),t.bitrate&&(i+="maxaveragebitrate=".concat(Math.floor(1e3*t.bitrate),";")),t.sampleRate&&(i+=cs(r="maxplaybackrate=".concat(t.sampleRate,";sprop-maxcapturerate=")).call(r,t.sampleRate,";")),t.stereo&&(i+="stereo=1;sprop-stereo-1;"),i+="\r\n",e.replace(n[0],i)):e}function Ln(e){return e.replace("minptime=10","minptime=10;stereo=1; sprop-stereo=1")}function Mn(e,t,n){var r=!1;switch(t){case"h264":case"vp8":return e;case"vp9":case"av1":r=!0}if(r){var i,o,a,s=iu(i=RegExp.prototype.test).call(i,/^([a-z])=(.*)/),c=e.split("m="),u=null,l=null,d=null,f=[],h=[];i=[],r=t=null;for(var p,v=[],m=[],g=0;g<c.length;++g)if(u=c[g].match(/a=msid-semantic:/)){u=c[g];break}for(g=0;g<c.length;++g)if(l=c[g].match(/audio /)){l="m="+c[g];break}for(g=0;g<c.length;++g)if(d=c[g].match(/video /)){d="m="+c[g];break}if(u&&(f=ds(o=u.split(/(\r\n|\r|\n)/)).call(o,s)),0<f.length&&(i=cs(i).call(i,f)),l)for(h=ds(a=l.split(/(\r\n|\r|\n)/)).call(a,s),o=0;o<h.length;++o)if(null===t&&null!==(t=h[o].match(/cname:/))){t="cname:"+h[o].split("cname:")[1];break}if(0<h.length&&(i=cs(i).call(i,h)),!d)return e;for(o=ds(p=d.split(/(\r\n|\r|\n)/)).call(p,s),a=0;a<o.length;++a)if(null===r&&null!==(r=o[a].match(/a=msid:/))&&(r="msid:"+o[a].split(":")[1]),o[a].match(/a=ssrc-group:FID/)){p=o[a].split(" "),v.push(Number(p[1])),p[2]&&m.push(Number(p[2])),o.length=a;break}for(p=1;p<n.numSpatialLayers;++p)v.push(v[0]+p),0<m.length&&m.push(m[0]+p);for(p="a=ssrc-group:SIM ",a=0;a<v.length;++a)p=cs(p).call(p,String(v[a])),a<v.length-1&&(p=cs(p).call(p," "));for(o.push(p),p=0;p<n.numSpatialLayers;++p){var y,_;a=cs(y=cs(_=cs("a=ssrc-group:FID ").call("a=ssrc-group:FID ",String(v[p]))).call(_," ")).call(y,String(m[p])),o.push(a)}for(y=0;y<n.numSpatialLayers;++y){var b,E,w,T;if(null===t||null===r)return e;_=cs(b=cs(E="a=ssrc:".concat(String(v[y]))).call(E," ")).call(b,t),p=cs(w=cs(T="a=ssrc:".concat(String(v[y]))).call(T," ")).call(w,r),o.push(_),o.push(p)}for(b=0;b<n.numSpatialLayers;++b){var S,I,R,A;if(null===t||null===r)return e;E=cs(S=cs(I="a=ssrc:".concat(String(m[b]))).call(I," ")).call(S,t),w=cs(R=cs(A="a=ssrc:".concat(String(m[b]))).call(A," ")).call(R,r),o.push(E),o.push(w)}e=(i=cs(i).call(i,o)).join("\r\n")+"\r\n"}return e}function Un(e,t){var n=document.createElement("video"),r=document.createElement("canvas");n.setAttribute("style","display:none"),r.setAttribute("style","display:none"),n.setAttribute("muted",""),n.muted=!0,n.setAttribute("autoplay",""),n.autoplay=!0,n.setAttribute("playsinline",""),r.width=at(t.width),r.height=at(t.height),t=at(t.framerate||15),document.body.append(n),document.body.append(r);var i=e._mediaStreamTrack;n.srcObject=new MediaStream([i]),n.play();var o=r.getContext("2d");if(!o)throw new Al($u.UNEXPECTED_ERROR,"can not get canvas context");var a=r.captureStream(Ed.supportRequestFrame?0:t).getVideoTracks()[0],s=en((function(){if(n.paused&&n.play(),2<n.videoHeight&&2<n.videoWidth){var t,s,c,u=n.videoHeight/n.videoWidth*r.width;2<=Math.abs(u-r.height)&&(Rl.debug("adjust low stream resolution",cs(t=cs(s=cs(c="".concat(r.width,"x")).call(c,r.height," -> ")).call(s,r.width,"x")).call(t,u)),r.height=u)}o.drawImage(n,0,0,r.width,r.height),a.requestFrame&&a.requestFrame(),i!==e._mediaStreamTrack&&(i=e._mediaStreamTrack,n.srcObject=new MediaStream([i]))}),t),c=a.stop;return a.stop=function(){c.call(a),s(),n.remove(),r.width=0,r.remove(),n=r=null,Rl.debug("clean low stream renderer")},a}function jn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=jn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=jn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function Vn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Vn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Vn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function Wn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Gn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Wn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Wn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function qn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=qn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=qn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function Hn(e){if(!(e instanceof lp))return new Al($u.INVALID_PARAMS,"Config should be instance of [ChannelMediaRelayConfiguration]").throw();var t=e.getSrcChannelMediaInfo();return e=e.getDestChannelMediaInfo(),t?0===e.size?new Al($u.INVALID_PARAMS,"destChannelMediaInfo should not be empty").throw():void 0:new Al($u.INVALID_PARAMS,"srcChannelMediaInfo should not be empty").throw()}function zn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function Yn(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=zn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=zn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function Qn(e,t){return Xn.apply(this,arguments)}function Xn(){return(Xn=m(v.mark((function e(t,n){var r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=null,"string"!=typeof t){e.next=16;break}if(!(i=yp.get(t))){e.next=5;break}return e.abrupt("return",(Rl.debug("use cached audio resource: ",t),i));case 5:return e.prev=5,e.next=8,Xt((function(){return Tl.get(t,{responseType:"arraybuffer"})}),void 0,void 0,{maxRetryCount:3});case 8:r=e.sent.data,e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(5),new Al($u.FETCH_AUDIO_FILE_FAILED,e.t0.toString());case 14:e.next=19;break;case 16:return e.next=18,new kc((function(e,n){var r=new FileReader;r.onload=function(t){t.target?e(t.target.result):n(new Al($u.READ_LOCAL_AUDIO_FILE_ERROR))},r.onerror=function(){n(new Al($u.READ_LOCAL_AUDIO_FILE_ERROR))},r.readAsArrayBuffer(t)}));case 18:r=e.sent;case 19:return e.next=21,function(e){var t=$t();return new kc((function(n,r){t.decodeAudioData(e,(function(e){n(e)}),(function(e){r(new Al($u.DECODE_AUDIO_FILE_FAILED,e.toString()))}))}))}(r);case 21:return r=e.sent,e.abrupt("return",("string"==typeof t&&n&&yp.set(t,r),r));case 23:case"end":return e.stop()}}),e,null,[[5,11]])})))).apply(this,arguments)}function Jn(e,t){var n=Ra(e);if(cf){var r=cf(e);t&&(r=ds(r).call(r,(function(t){return Ya(e,t).enumerable}))),n.push.apply(n,r)}return n}function $n(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=Jn(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=Jn(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}function Zn(e,t,n,r){if(n.optimizationMode)if(r&&r.width&&r.height){var i=function(e,t){var n,r,i,o,a;if("motion"===e)return Rl.debug(cs(o=cs(a="adjust bitrate for motion, (".concat(t.bitrateMax,", ")).call(a,t.bitrateMin,"}) -> (")).call(o,t.bitrateMax,", undefined)")),{max:t.bitrateMax};if(!t.width||!t.height)return{max:t.bitrateMax,min:t.bitrateMin};if(e=at(t.width)*at(t.height),o=Math.max(.25,.1+.03*at(t.frameRate||20)),19200>e)return{};if(76800>e)a=Sf[0];else if(307200>e)a=Sf[1];else if(921600>e)a=Sf[2];else if(2073600>e)a=Sf[3];else{if(!(8294400>e))return{min:t.bitrateMin,max:t.bitrateMax};a=Sf[4]}return e=[Math.round((a[0][0]+a[0][1]*e)*o),Math.round((a[1][0]+a[1][1]*e)*o),Math.round((a[2][0]+a[2][1]*e)*o)],e={min:Math.max(e[2],t.bitrateMin||0),max:Math.max(e[2],t.bitrateMax||e[0])},Rl.debug(cs(n=cs(r=cs(i="adjust bitrate for detail, (".concat(t.bitrateMax,", ")).call(i,t.bitrateMin,"}) -> (")).call(r,e.max,", ")).call(n,e.min,")")),e}(n.optimizationMode,r);n.encoderConfig=$n({},r,{bitrateMin:i.min,bitrateMax:i.max}),("motion"===n.optimizationMode||"detail"===n.optimizationMode&&r.frameRate&&10>at(r.frameRate))&&(t.contentHint=n.optimizationMode,t.contentHint===n.optimizationMode?Rl.debug("[".concat(e,"] set content hint to"),n.optimizationMode):Rl.debug("[".concat(e,"] set content hint failed")))}else Rl.warning("[".concat(e,"] can not apply optimization mode bitrate config, no encoderConfig"))}var er="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof t?t:"undefined"!=typeof self?self:{},tr=function(e){return e&&e.Math==Math&&e},nr=tr("object"==typeof globalThis&&globalThis)||tr("object"==typeof window&&window)||tr("object"==typeof self&&self)||tr("object"==typeof er&&er)||Function("return this")(),rr=function(e){try{return!!e()}catch(t){return!0}},ir=!rr((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})),or={}.propertyIsEnumerable,ar=Object.getOwnPropertyDescriptor,sr=ar&&!or.call({1:2},1)?function(e){return!!(e=ar(this,e))&&e.enumerable}:or,cr=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},ur={}.toString,lr=function(e){return ur.call(e).slice(8,-1)},dr="".split,fr=rr((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==lr(e)?dr.call(e,""):Object(e)}:Object,hr=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e},pr=function(e){return fr(hr(e))},vr=function(e){return"object"==typeof e?null!==e:"function"==typeof e},mr=function(e,t){if(!vr(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!vr(r=n.call(e))||"function"==typeof(n=e.valueOf)&&!vr(r=n.call(e))||!t&&"function"==typeof(n=e.toString)&&!vr(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")},gr={}.hasOwnProperty,yr=function(e,t){return gr.call(e,t)},_r=nr.document,br=vr(_r)&&vr(_r.createElement),Er=!ir&&!rr((function(){return 7!=Object.defineProperty(br?_r.createElement("div"):{},"a",{get:function(){return 7}}).a})),wr=Object.getOwnPropertyDescriptor,Tr=ir?wr:function(e,t){if(e=pr(e),t=mr(t,!0),Er)try{return wr(e,t)}catch(wl){}if(yr(e,t))return cr(!sr.call(e,t),e[t])},Sr=/#|\.prototype\./,Ir=function(e,t){return(e=Ar[Rr(e)])==kr||e!=Cr&&("function"==typeof t?rr(t):!!t)},Rr=Ir.normalize=function(e){return String(e).replace(Sr,".").toLowerCase()},Ar=Ir.data={},Cr=Ir.NATIVE="N",kr=Ir.POLYFILL="P",Or={},Nr=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e},Pr=function(e,t,n){if(Nr(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},Dr=function(e){if(!vr(e))throw TypeError(String(e)+" is not an object");return e},xr=Object.defineProperty,Lr={f:ir?xr:function(e,t,n){if(Dr(e),t=mr(t,!0),Dr(n),Er)try{return xr(e,t,n)}catch(r){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},Mr=ir?function(e,t,n){return Lr.f(e,t,cr(1,n))}:function(e,t,n){return e[t]=n,e},Ur=Tr,jr=function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t},Fr=function(e,t){var n,r,i,o,a,s=e.target,c=e.global,u=e.stat,l=e.proto,d=c?nr:u?nr[s]:(nr[s]||{}).prototype,f=c?Or:Or[s]||(Or[s]={}),h=f.prototype;for(r in t){var p=!Ir(c?r:s+(u?".":"#")+r,e.forced)&&d&&yr(d,r),v=f[r];p&&(i=e.noTargetGet?(a=Ur(d,r))&&a.value:d[r]);var m=p&&i?i:t[r];p&&typeof v==typeof m||(o=e.bind&&p?Pr(m,nr):e.wrap&&p?jr(m):l&&"function"==typeof m?Pr(Function.call,m):m,(e.sham||m&&m.sham||v&&v.sham)&&Mr(o,"sham",!0),f[r]=o,l&&(yr(Or,n=s+"Prototype")||Mr(Or,n,{}),Or[n][r]=m,e.real&&h&&!h[r]&&Mr(h,r,m)))}},Vr=function(e){return"function"==typeof e?e:void 0},Br=function(e,t){return 2>arguments.length?Vr(Or[e])||Vr(nr[e]):Or[e]&&Or[e][t]||nr[e]&&nr[e][t]},Wr=Br("JSON","stringify"),Gr=/[\uD800-\uDFFF]/g,qr=/^[\uD800-\uDBFF]$/,Kr=/^[\uDC00-\uDFFF]$/,Hr=function(e,t,n){var r=n.charAt(t-1);return t=n.charAt(t+1),qr.test(e)&&!Kr.test(t)||Kr.test(e)&&!qr.test(r)?"\\u"+e.charCodeAt(0).toString(16):e},zr=rr((function(){return'"\\udf06\\ud834"'!==Wr("\udf06\ud834")||'"\\udead"'!==Wr("\udead")}));Wr&&Fr({target:"JSON",stat:!0,forced:zr},{stringify:function(e,t,n){var r=Wr.apply(null,arguments);return"string"==typeof r?r.replace(Gr,Hr):r}}),Or.JSON||(Or.JSON={stringify:JSON.stringify});var Yr=function(e,t,n){return Or.JSON.stringify.apply(null,arguments)},Qr={},Xr=0,Jr=Math.random(),$r=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++Xr+Jr).toString(36)},Zr=!rr((function(){return Object.isExtensible(Object.preventExtensions({}))})),ei=E((function(e){var t=Lr.f,n=$r("meta"),r=0,i=Object.isExtensible||function(){return!0},o=function(e){t(e,n,{value:{objectID:"O"+ ++r,weakData:{}}})},a=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!vr(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!yr(e,n)){if(!i(e))return"F";if(!t)return"E";o(e)}return e[n].objectID},getWeakData:function(e,t){if(!yr(e,n)){if(!i(e))return!0;if(!t)return!1;o(e)}return e[n].weakData},onFreeze:function(e){return Zr&&a.REQUIRED&&i(e)&&!yr(e,n)&&o(e),e}};Qr[n]=!0})),ti=nr["__core-js_shared__"]||function(e,t){try{Mr(nr,e,t)}catch(wl){nr[e]=t}return t}("__core-js_shared__",{}),ni=E((function(e){(e.exports=function(e,t){return ti[e]||(ti[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.4.3",mode:"pure",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})})),ri=!!Object.getOwnPropertySymbols&&!rr((function(){return!String(Symbol())})),ii=ri&&!Symbol.sham&&"symbol"==typeof Symbol(),oi=ni("wks"),ai=nr.Symbol,si=ii?ai:$r,ci=function(e){return yr(oi,e)||(ri&&yr(ai,e)?oi[e]=ai[e]:oi[e]=si("Symbol."+e)),oi[e]},ui={},li=ci("iterator"),di=Array.prototype,fi=function(e){return void 0!==e&&(ui.Array===e||di[li]===e)},hi=Math.ceil,pi=Math.floor,vi=function(e){return isNaN(e=+e)?0:(0<e?pi:hi)(e)},mi=Math.min,gi=function(e){return 0<e?mi(vi(e),9007199254740991):0},yi={};yi[ci("toStringTag")]="z";var _i="[object z]"===String(yi),bi=ci("toStringTag"),Ei="Arguments"==lr(function(){return arguments}()),wi=_i?lr:function(e){var t;if(void 0===e)var n="Undefined";else{if(null===e)var r="Null";else{e:{var i=e=Object(e);try{r=i[bi];break e}catch(o){}r=void 0}r="string"==typeof(n=r)?n:Ei?lr(e):"Object"==(t=lr(e))&&"function"==typeof e.callee?"Arguments":t}n=r}return n},Ti=ci("iterator"),Si=function(e){if(null!=e)return e[Ti]||e["@@iterator"]||ui[wi(e)]},Ii=function(e,t,n,r){try{return r?t(Dr(n)[0],n[1]):t(n)}catch(i){throw void 0!==(t=e.return)&&Dr(t.call(e)),i}},Ri=E((function(e){var t=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,n,r,i,o){var a,s;if(n=Pr(n,r,i?2:1),!o){if("function"!=typeof(o=Si(e)))throw TypeError("Target is not iterable");if(fi(o)){for(o=0,r=gi(e.length);r>o;o++)if((a=i?n(Dr(s=e[o])[0],s[1]):n(e[o]))&&a instanceof t)return a;return new t(!1)}e=o.call(e)}for(o=e.next;!(s=o.call(e)).done;)if("object"==typeof(a=Ii(e,n,s.value,i))&&a&&a instanceof t)return a;return new t(!1)}).stop=function(e){return new t(!0,e)}})),Ai=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e},Ci=_i?{}.toString:function(){return"[object "+wi(this)+"]"},ki=Lr.f,Oi=ci("toStringTag"),Ni=function(e,t,n,r){e&&(e=n?e:e.prototype,yr(e,Oi)||ki(e,Oi,{configurable:!0,value:t}),r&&!_i&&Mr(e,"toString",Ci))},Pi=function(e){return Object(hr(e))},Di=Array.isArray||function(e){return"Array"==lr(e)},xi=ci("species"),Li=function(e,t){var n;return Di(e)&&("function"!=typeof(n=e.constructor)||n!==Array&&!Di(n.prototype)?vr(n)&&null===(n=n[xi])&&(n=void 0):n=void 0),new(void 0===n?Array:n)(0===t?0:t)},Mi=[].push,Ui=function(e){var t=1==e,n=2==e,r=3==e,i=4==e,o=6==e,a=5==e||o;return function(s,c,u,l){var d,f,h=Pi(s),p=fr(h);c=Pr(c,u,3),u=gi(p.length);var v=0;for(l=l||Li,s=t?l(s,u):n?l(s,0):void 0;u>v;v++)if((a||v in p)&&(f=c(d=p[v],v,h),e))if(t)s[v]=f;else if(f)switch(e){case 3:return!0;case 5:return d;case 6:return v;case 2:Mi.call(s,d)}else if(i)return!1;return o?-1:r||i?i:s}},ji=Ui(0),Fi=Ui(1),Vi=Ui(2),Bi=Ui(3);Ui(4);var Wi=Ui(5),Gi=Ui(6),qi=ni("native-function-to-string",Function.toString),Ki=nr.WeakMap,Hi="function"==typeof Ki&&/native code/.test(qi.call(Ki)),zi=ni("keys"),Yi=function(e){return zi[e]||(zi[e]=$r(e))},Qi=nr.WeakMap;if(Hi)var Xi=new Qi,Ji=Xi.get,$i=Xi.has,Zi=Xi.set,eo=function(e,t){return Zi.call(Xi,e,t),t},to=function(e){return Ji.call(Xi,e)||{}},no=function(e){return $i.call(Xi,e)};else{var ro=Yi("state");Qr[ro]=!0,eo=function(e,t){return Mr(e,ro,t),t},to=function(e){return yr(e,ro)?e[ro]:{}},no=function(e){return yr(e,ro)}}var io={set:eo,get:to,has:no,enforce:function(e){return no(e)?to(e):eo(e,{})},getterFor:function(e){return function(t){var n;if(!vr(t)||(n=to(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}},oo=Lr.f,ao=io.set,so=io.getterFor,co=Math.max,uo=Math.min,lo=function(e,t){return 0>(e=vi(e))?co(e+t,0):uo(e,t)},fo=function(e){return function(t,n,r){var i;t=pr(t);var o=gi(t.length);if(r=lo(r,o),e&&n!=n){for(;o>r;)if((i=t[r++])!=i)return!0}else for(;o>r;r++)if((e||r in t)&&t[r]===n)return e||r||0;return!e&&-1}},ho=fo(!0),po=fo(!1),vo=function(e,t){var n;e=pr(e);var r=0,i=[];for(n in e)!yr(Qr,n)&&yr(e,n)&&i.push(n);for(;t.length>r;)yr(e,n=t[r++])&&(~po(i,n)||i.push(n));return i},mo="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),go=Object.keys||function(e){return vo(e,mo)},yo=ir?Object.defineProperties:function(e,t){Dr(e);for(var n,r=go(t),i=r.length,o=0;i>o;)Lr.f(e,n=r[o++],t[n]);return e},_o=Br("document","documentElement"),bo=Yi("IE_PROTO"),Eo=function(){},wo=function(){var e=br?_r.createElement("iframe"):{},t=mo.length;for(e.style.display="none",_o.appendChild(e),e.src="javascript:",(e=e.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),wo=e.F;t--;)delete wo.prototype[mo[t]];return wo()},To=Object.create||function(e,t){var n;return null!==e?(Eo.prototype=Dr(e),n=new Eo,Eo.prototype=null,n[bo]=e):n=wo(),void 0===t?n:yo(n,t)};Qr[bo]=!0;var So,Io,Ro,Ao=function(e,t,n,r){r&&r.enumerable?e[t]=n:Mr(e,t,n)},Co=function(e,t,n){for(var r in t)n&&n.unsafe&&e[r]?e[r]=t[r]:Ao(e,r,t[r],n);return e},ko=!rr((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype})),Oo=Yi("IE_PROTO"),No=Object.prototype,Po=ko?Object.getPrototypeOf:function(e){return e=Pi(e),yr(e,Oo)?e[Oo]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?No:null},Do=(ci("iterator"),!1);[].keys&&("next"in(Ro=[].keys())?(Io=Po(Po(Ro)))!==Object.prototype&&(So=Io):Do=!0),null==So&&(So={});var xo=So,Lo=Do,Mo=function(){return this},Uo=(Object.setPrototypeOf||"__proto__"in{}&&function(){var e={};try{Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set.call(e,[])}catch(t){}}(),xo),jo=ci("iterator"),Fo=function(){return this},Vo=function(e,t,n,r,i,o,a){var s,c,u;!function(e,t,n){t+=" Iterator",e.prototype=To(xo,{next:cr(1,n)}),Ni(e,t,!1,!0),ui[t]=Mo}(n,t,r),r=function(e){if(e===i&&p)return p;if(!Lo&&e in f)return f[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}};var l=t+" Iterator",d=!1,f=e.prototype,h=f[jo]||f["@@iterator"]||i&&f[i],p=!Lo&&h||r(i),v="Array"==t&&f.entries||h;if(v&&(s=Po(v.call(new e)),Uo!==Object.prototype&&s.next&&(Ni(s,l,!0,!0),ui[l]=Fo)),"values"==i&&h&&"values"!==h.name&&(d=!0,p=function(){return h.call(this)}),a&&f[jo]!==p&&Mr(f,jo,p),ui[t]=p,i)if(c={values:r("values"),keys:o?p:r("keys"),entries:r("entries")},a)for(u in c)!Lo&&!d&&u in f||Ao(f,u,c[u]);else Fr({target:t,proto:!0,forced:Lo||d},c);return c},Bo=ci("species"),Wo=function(e){e=Br(e);var t=Lr.f;ir&&e&&!e[Bo]&&t(e,Bo,{configurable:!0,get:function(){return this}})},Go=Lr.f,qo=ei.fastKey,Ko=io.set,Ho=io.getterFor,zo=(function(e,t,n){var r=-1!==e.indexOf("Map"),i=-1!==e.indexOf("Weak"),o=r?"set":"add",a=nr[e],s=a&&a.prototype,c={};if(ir&&"function"==typeof a&&(i||s.forEach&&!rr((function(){(new a).entries().next()})))){var u=t((function(t,n){ao(Ai(t,u,e),{type:e,collection:new a}),null!=n&&Ri(n,t[o],t,r)})),l=so(e);ji("add clear delete forEach get has set keys values entries".split(" "),(function(e){var t="add"==e||"set"==e;!(e in s)||i&&"clear"==e||Mr(u.prototype,e,(function(n,r){var o=l(this).collection;return t||!i||vr(n)?(n=o[e](0===n?0:n,r),t?this:n):"get"==e&&void 0}))})),i||oo(u.prototype,"size",{configurable:!0,get:function(){return l(this).collection.size}})}else u=n.getConstructor(t,e,r,o),ei.REQUIRED=!0;Ni(u,e,!1,!0),c[e]=u,Fr({global:!0,forced:!0},c),i||n.setStrong(u,e,r)}("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),{getConstructor:function(e,t,n,r){var i=e((function(e,o){Ai(e,i,t),Ko(e,{type:t,index:To(null),first:void 0,last:void 0,size:0}),ir||(e.size=0),null!=o&&Ri(o,e[r],e,n)})),o=Ho(t),a=function(e,t,n){var r,i,a=o(e),c=s(e,t);return c?c.value=n:(a.last=c={index:i=qo(t,!0),key:t,value:n,previous:r=a.last,next:void 0,removed:!1},a.first||(a.first=c),r&&(r.next=c),ir?a.size++:e.size++,"F"!==i&&(a.index[i]=c)),e},s=function(e,t){e=o(e);var n=qo(t);if("F"!==n)return e.index[n];for(e=e.first;e;e=e.next)if(e.key==t)return e};return Co(i.prototype,{clear:function(){for(var e=o(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,ir?e.size=0:this.size=0},delete:function(e){var t=o(this);if(e=s(this,e)){var n=e.next,r=e.previous;delete t.index[e.index],e.removed=!0,r&&(r.next=n),n&&(n.previous=r),t.first==e&&(t.first=n),t.last==e&&(t.last=r),ir?t.size--:this.size--}return!!e},forEach:function(e){for(var t,n=o(this),r=Pr(e,1<arguments.length?arguments[1]:void 0,3);t=t?t.next:n.first;)for(r(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!s(this,e)}}),Co(i.prototype,n?{get:function(e){return(e=s(this,e))&&e.value},set:function(e,t){return a(this,0===e?0:e,t)}}:{add:function(e){return a(this,e=0===e?0:e,e)}}),ir&&Go(i.prototype,"size",{get:function(){return o(this).size}}),i},setStrong:function(e,t,n){var r=t+" Iterator",i=Ho(t),o=Ho(r);Vo(e,t,(function(e,t){Ko(this,{type:r,target:e,state:i(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),Wo(t)}}),function(e){return function(t,n){var r,i;t=String(hr(t)),n=vi(n);var o=t.length;return 0>n||n>=o?e?"":void 0:55296>(r=t.charCodeAt(n))||56319<r||n+1===o||56320>(i=t.charCodeAt(n+1))||57343<i?e?t.charAt(n):r:e?t.slice(n,n+2):i-56320+(r-55296<<10)+65536}}),Yo=(zo(!1),zo(!0)),Qo=io.set,Xo=io.getterFor("String Iterator");Vo(String,"String",(function(e){Qo(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=Xo(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=Yo(n,r),t.index+=e.length,{value:e,done:!1})}));var Jo=io.set,$o=io.getterFor("Array Iterator");Vo(Array,"Array",(function(e,t){Jo(this,{type:"Array Iterator",target:pr(e),index:0,kind:t})}),(function(){var e=$o(this),t=e.target,n=e.kind,r=e.index++;return!t||r>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:r,done:!1}:"values"==n?{value:t[r],done:!1}:{value:[r,t[r]],done:!1}}),"values"),ui.Arguments=ui.Array;var Zo,ea=ci("toStringTag");for(Zo in{CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}){var ta=nr[Zo],na=ta&&ta.prototype;na&&!na[ea]&&Mr(na,ea,Zo),ui[Zo]=ui.Array}var ra=Or.Map,ia=ci("match"),oa=function(e){var t;if(vr(e)&&(void 0!==(t=e[ia])?t:"RegExp"==lr(e)))throw TypeError("The method doesn't accept regular expressions");return e},aa=ci("match"),sa=function(e){var t=/./;try{"/./"[e](t)}catch(wl){try{return t[aa]=!1,"/./"[e](t)}catch(n){}}return!1},ca="".endsWith,ua=Math.min,la=sa("endsWith");Fr({target:"String",proto:!0,forced:!la},{endsWith:function(e){var t=String(hr(this));oa(e);var n=1<arguments.length?arguments[1]:void 0,r=gi(t.length);return n=void 0===n?r:ua(gi(n),r),r=String(e),ca?ca.call(t,r,n):t.slice(n-r.length,n)===r}});var da=function(e){return Or[e+"Prototype"]},fa=da("String").endsWith,ha=String.prototype,pa=function(e){var t=e.endsWith;return"string"==typeof e||e===ha||e instanceof String&&t===ha.endsWith?fa:t},va=function(e,t){var n=[][e];return!n||!rr((function(){n.call(null,t||function(){throw 1},1)}))},ma=va("forEach")?function(e){return ji(this,e,1<arguments.length?arguments[1]:void 0)}:[].forEach;Fr({target:"Array",proto:!0,forced:[].forEach!=ma},{forEach:ma});var ga=da("Array").forEach,ya=Array.prototype,_a={DOMTokenList:!0,NodeList:!0},ba=function(e){var t=e.forEach;return e===ya||e instanceof Array&&t===ya.forEach||_a.hasOwnProperty(wi(e))?ga:t},Ea={f:Object.getOwnPropertySymbols},wa=Object.assign,Ta=!wa||rr((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=wa({},e)[n]||"abcdefghijklmnopqrst"!=go(wa({},t)).join("")}))?function(e,t){for(var n=Pi(e),r=arguments.length,i=1,o=Ea.f,a=sr;r>i;)for(var s,c=fr(arguments[i++]),u=o?go(c).concat(o(c)):go(c),l=u.length,d=0;l>d;)s=u[d++],ir&&!a.call(c,s)||(n[s]=c[s]);return n}:wa;Fr({target:"Object",stat:!0,forced:Object.assign!==Ta},{assign:Ta});var Sa=Or.Object.assign,Ia=rr((function(){go(1)}));Fr({target:"Object",stat:!0,forced:Ia},{keys:function(e){return go(Pi(e))}});var Ra=Or.Object.keys,Aa=function(e){return function(t,n,r,i){Nr(n),t=Pi(t);var o=fr(t),a=gi(t.length),s=e?a-1:0,c=e?-1:1;if(2>r)for(;;){if(s in o){i=o[s],s+=c;break}if(s+=c,e?0>s:a<=s)throw TypeError("Reduce of empty array with no initial value")}for(;e?0<=s:a>s;s+=c)s in o&&(i=n(i,o[s],s,t));return i}},Ca=[Aa(!1),Aa(!0)][0];Fr({target:"Array",proto:!0,forced:va("reduce")},{reduce:function(e){return Ca(this,e,arguments.length,1<arguments.length?arguments[1]:void 0)}});var ka=da("Array").reduce,Oa=Array.prototype,Na=function(e){var t=e.reduce;return e===Oa||e instanceof Array&&t===Oa.reduce?ka:t};Fr({target:"Object",stat:!0,forced:!ir,sham:!ir},{defineProperty:Lr.f});var Pa=E((function(e){var t=Or.Object;e=e.exports=function(e,n,r){return t.defineProperty(e,n,r)},t.defineProperty.sham&&(e.sham=!0)})),Da=Pa,xa=/^[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*/,La=/[\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff][\t\n\x0B\f\r \u00a0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff]*$/,Ma=function(e){return function(t){return t=String(hr(t)),1&e&&(t=t.replace(xa,"")),2&e&&(t=t.replace(La,"")),t}};Ma(1),Ma(2);var Ua=Ma(3),ja=nr.parseInt,Fa=/^[+-]?0[Xx]/,Va=8!==ja("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff08")||22!==ja("\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff0x16")?function(e,t){return e=Ua(String(e)),ja(e,t>>>0||(Fa.test(e)?16:10))}:ja;Fr({global:!0,forced:parseInt!=Va},{parseInt:Va});var Ba=Or.parseInt,Wa=!0,Ga=!0,qa=Tr,Ka=rr((function(){qa(1)}));Fr({target:"Object",stat:!0,forced:!ir||Ka,sham:!ir},{getOwnPropertyDescriptor:function(e,t){return qa(pr(e),t)}});var Ha,za,Ya=E((function(e){var t=Or.Object;e=e.exports=function(e,n){return t.getOwnPropertyDescriptor(e,n)},t.getOwnPropertyDescriptor.sham&&(e.sham=!0)})),Qa=function(e,t,n){(t=mr(t))in e?Lr.f(e,t,cr(0,n)):e[t]=n},Xa=Br("navigator","userAgent")||"",Ja=nr.process,$a=Ja&&Ja.versions,Za=$a&&$a.v8;Za?za=(Ha=Za.split("."))[0]+Ha[1]:Xa&&(!(Ha=Xa.match(/Edge\/(\d+)/))||74<=Ha[1])&&(Ha=Xa.match(/Chrome\/(\d+)/))&&(za=Ha[1]);var es=za&&+za,ts=ci("species"),ns=function(e){return 51<=es||!rr((function(){var t=[];return(t.constructor={})[ts]=function(){return{foo:1}},1!==t[e](Boolean).foo}))},rs=ci("isConcatSpreadable"),is=51<=es||!rr((function(){var e=[];return e[rs]=!1,e.concat()[0]!==e})),os=ns("concat");Fr({target:"Array",proto:!0,forced:!is||!os},{concat:function(e){var t,n,r=Pi(this),i=Li(r,0),o=0,a=-1;for(t=arguments.length;a<t;a++){var s=n=-1===a?r:arguments[a];if(vr(s)){var c=s[rs];s=void 0!==c?!!c:Di(s)}else s=!1;if(s){if(9007199254740991<o+(c=gi(n.length)))throw TypeError("Maximum allowed index exceeded");for(s=0;s<c;s++,o++)s in n&&Qa(i,o,n[s])}else{if(9007199254740991<=o)throw TypeError("Maximum allowed index exceeded");Qa(i,o++,n)}}return i.length=o,i}});var as=da("Array").concat,ss=Array.prototype,cs=function(e){var t=e.concat;return e===ss||e instanceof Array&&t===ss.concat?as:t};Fr({target:"Array",proto:!0,forced:!ns("filter")},{filter:function(e){return Vi(this,e,1<arguments.length?arguments[1]:void 0)}});var us=da("Array").filter,ls=Array.prototype,ds=function(e){var t=e.filter;return e===ls||e instanceof Array&&t===ls.filter?us:t},fs=nr.Promise,hs=ci("iterator"),ps=!1;try{var vs=0,ms={next:function(){return{done:!!vs++}},return:function(){ps=!0}};ms[hs]=function(){return this},Array.from(ms,(function(){throw 2}))}catch(Tu){}var gs,ys,_s,bs=function(e,t){if(!t&&!ps)return!1;var n=!1;try{(t={})[hs]=function(){return{next:function(){return{done:n=!0}}}},e(t)}catch(r){}return n},Es=ci("species"),ws=function(e,t){var n;return void 0===(e=Dr(e).constructor)||null==(n=Dr(e)[Es])?t:Nr(n)},Ts=/(iphone|ipod|ipad).*applewebkit/i.test(Xa),Ss=nr.location,Is=nr.setImmediate,Rs=nr.clearImmediate,As=nr.process,Cs=nr.MessageChannel,ks=nr.Dispatch,Os=0,Ns={},Ps=function(e){if(Ns.hasOwnProperty(e)){var t=Ns[e];delete Ns[e],t()}},Ds=function(e){return function(){Ps(e)}},xs=function(e){Ps(e.data)},Ls=function(e){nr.postMessage(e+"",Ss.protocol+"//"+Ss.host)};Is&&Rs||(Is=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Ns[++Os]=function(){("function"==typeof e?e:Function(e)).apply(void 0,t)},gs(Os),Os},Rs=function(e){delete Ns[e]},"process"==lr(As)?gs=function(e){As.nextTick(Ds(e))}:ks&&ks.now?gs=function(e){ks.now(Ds(e))}:Cs&&!Ts?(_s=(ys=new Cs).port2,ys.port1.onmessage=xs,gs=Pr(_s.postMessage,_s,1)):!nr.addEventListener||"function"!=typeof postMessage||nr.importScripts||rr(Ls)?gs="onreadystatechange"in(br?_r.createElement("script"):{})?function(e){_o.appendChild(br?_r.createElement("script"):{}).onreadystatechange=function(){_o.removeChild(this),Ps(e)}}:function(e){setTimeout(Ds(e),0)}:(gs=Ls,nr.addEventListener("message",xs,!1)));var Ms,Us,js,Fs,Vs,Bs,Ws,Gs,qs=Is,Ks=Tr,Hs=nr.MutationObserver||nr.WebKitMutationObserver,zs=nr.process,Ys=nr.Promise,Qs="process"==lr(zs),Xs=Ks(nr,"queueMicrotask"),Js=Xs&&Xs.value;Js||(Ms=function(){var e;for(Qs&&(e=zs.domain)&&e.exit();Us;){var t=Us.fn;Us=Us.next;try{t()}catch(wl){throw Us?Fs():js=void 0,wl}}js=void 0,e&&e.enter()},Qs?Fs=function(){zs.nextTick(Ms)}:Hs&&!Ts?(Vs=!0,Bs=document.createTextNode(""),new Hs(Ms).observe(Bs,{characterData:!0}),Fs=function(){Bs.data=Vs=!Vs}):Ys&&Ys.resolve?(Ws=Ys.resolve(void 0),Gs=Ws.then,Fs=function(){Gs.call(Ws,Ms)}):Fs=function(){qs.call(nr,Ms)});var $s,Zs,ec=Js||function(e){e={fn:e,next:void 0},js&&(js.next=e),Us||(Us=e,Fs()),js=e},tc=function(e){var t,n;this.promise=new e((function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r})),this.resolve=Nr(t),this.reject=Nr(n)},nc={f:function(e){return new tc(e)}},rc=function(e,t){return Dr(e),vr(t)&&t.constructor===e?t:((0,(e=nc.f(e)).resolve)(t),e.promise)},ic=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}},oc=ci("species"),ac=io.get,sc=io.set,cc=io.getterFor("Promise"),uc=fs,lc=nr.TypeError,dc=nr.document,fc=nr.process,hc=ni("inspectSource"),pc=(Br("fetch"),nc.f),vc=pc,mc="process"==lr(fc),gc=!!(dc&&dc.createEvent&&nr.dispatchEvent),yc=Ir("Promise",(function(){if(hc(uc)===String(uc)&&(66===es||!mc&&"function"!=typeof PromiseRejectionEvent)||!uc.prototype.finally)return!0;if(51<=es&&/native code/.test(uc))return!1;var e=uc.resolve(1),t=function(e){e((function(){}),(function(){}))};return(e.constructor={})[oc]=t,!(e.then((function(){}))instanceof t)})),_c=yc||!bs((function(e){uc.all(e).catch((function(){}))})),bc=function(e){var t;return!(!vr(e)||"function"!=typeof(t=e.then))&&t},Ec=function(e,t,n){if(!t.notified){t.notified=!0;var r=t.reactions;ec((function(){for(var i=t.value,o=1==t.state,a=0;r.length>a;){var s,c,u,l=r[a++],d=o?l.ok:l.fail,f=l.resolve,h=l.reject,p=l.domain;try{d?(o||(2===t.rejection&&Sc(e,t),t.rejection=1),!0===d?s=i:(p&&p.enter(),s=d(i),p&&(p.exit(),u=!0)),s===l.promise?h(lc("Promise-chain cycle")):(c=bc(s))?c.call(s,f,h):f(s)):h(i)}catch(v){p&&!u&&p.exit(),h(v)}}t.reactions=[],t.notified=!1,n&&!t.rejection&&Tc(e,t)}))}},wc=function(e,t,n){var r,i;gc?((r=dc.createEvent("Event")).promise=t,r.reason=n,r.initEvent(e,!1,!0),nr.dispatchEvent(r)):r={promise:t,reason:n},(i=nr["on"+e])?i(r):"unhandledrejection"===e&&function(e,t){var n=nr.console;n&&n.error&&(1===arguments.length?n.error(e):n.error(e,t))}("Unhandled promise rejection",n)},Tc=function(e,t){qs.call(nr,(function(){var n,r=t.value;if(1!==t.rejection&&!t.parent&&(n=ic((function(){mc?fc.emit("unhandledRejection",r,e):wc("unhandledrejection",e,r)})),t.rejection=mc||1!==t.rejection&&!t.parent?2:1,n.error))throw n.value}))},Sc=function(e,t){qs.call(nr,(function(){mc?fc.emit("rejectionHandled",e):wc("rejectionhandled",e,t.value)}))},Ic=function(e,t,n,r){return function(i){e(t,n,i,r)}},Rc=function(e,t,n,r){t.done||(t.done=!0,r&&(t=r),t.value=n,t.state=2,Ec(e,t,!0))},Ac=function e(t,n,r,i){if(!n.done){n.done=!0,i&&(n=i);try{if(t===r)throw lc("Promise can't be resolved itself");var o=bc(r);o?ec((function(){var i={done:!1};try{o.call(r,Ic(e,t,i,n),Ic(Rc,t,i,n))}catch(a){Rc(t,i,a,n)}})):(n.value=r,n.state=1,Ec(t,n,!1))}catch(a){Rc(t,{done:!1},a,n)}}};yc&&(uc=function(e){Ai(this,uc,"Promise"),Nr(e),$s.call(this);var t=ac(this);try{e(Ic(Ac,this,t),Ic(Rc,this,t))}catch(wl){Rc(this,t,wl)}},($s=function(e){sc(this,{type:"Promise",done:!1,notified:!1,parent:!1,reactions:[],rejection:!1,state:0,value:void 0})}).prototype=Co(uc.prototype,{then:function(e,t){var n=cc(this),r=pc(ws(this,uc));return r.ok="function"!=typeof e||e,r.fail="function"==typeof t&&t,r.domain=mc?fc.domain:void 0,n.parent=!0,n.reactions.push(r),0!=n.state&&Ec(this,n,!1),r.promise},catch:function(e){return this.then(void 0,e)}}),Zs=function(){var e=new $s,t=ac(e);this.promise=e,this.resolve=Ic(Ac,e,t),this.reject=Ic(Rc,e,t)},nc.f=pc=function(e){return e===uc||e===Cc?new Zs(e):vc(e)}),Fr({global:!0,wrap:!0,forced:yc},{Promise:uc}),Ni(uc,"Promise",!1,!0),Wo("Promise");var Cc=Br("Promise");Fr({target:"Promise",stat:!0,forced:yc},{reject:function(e){var t=pc(this);return t.reject.call(void 0,e),t.promise}}),Fr({target:"Promise",stat:!0,forced:!0},{resolve:function(e){return rc(this===Cc?uc:this,e)}}),Fr({target:"Promise",stat:!0,forced:_c},{all:function(e){var t=this,n=pc(t),r=n.resolve,i=n.reject,o=ic((function(){var n=Nr(t.resolve),o=[],a=0,s=1;Ri(e,(function(e){var c=a++,u=!1;o.push(void 0),s++,n.call(t,e).then((function(e){u||(u=!0,o[c]=e,--s||r(o))}),i)})),--s||r(o)}));return o.error&&i(o.value),n.promise},race:function(e){var t=this,n=pc(t),r=n.reject,i=ic((function(){var i=Nr(t.resolve);Ri(e,(function(e){i.call(t,e).then(n.resolve,r)}))}));return i.error&&r(i.value),n.promise}}),Fr({target:"Promise",stat:!0},{allSettled:function(e){var t=this,n=nc.f(t),r=n.resolve,i=n.reject,o=ic((function(){var n=Nr(t.resolve),i=[],o=0,a=1;Ri(e,(function(e){var s=o++,c=!1;i.push(void 0),a++,n.call(t,e).then((function(e){c||(c=!0,i[s]={status:"fulfilled",value:e},--a||r(i))}),(function(e){c||(c=!0,i[s]={status:"rejected",reason:e},--a||r(i))}))})),--a||r(i)}));return o.error&&i(o.value),n.promise}}),Fr({target:"Promise",proto:!0,real:!0},{finally:function(e){var t=ws(this,Br("Promise")),n="function"==typeof e;return this.then(n?function(n){return rc(t,e()).then((function(){return n}))}:e,n?function(n){return rc(t,e()).then((function(){throw n}))}:e)}});var kc=Or.Promise;Fr({target:"Array",proto:!0,forced:!ns("map")},{map:function(e){return Fi(this,e,1<arguments.length?arguments[1]:void 0)}});var Oc=da("Array").map,Nc=Array.prototype,Pc=function(e){var t=e.map;return e===Nc||e instanceof Array&&t===Nc.map?Oc:t},Dc=Math.max,xc=Math.min;Fr({target:"Array",proto:!0,forced:!ns("splice")},{splice:function(e,t){var n,r,i,o,a=Pi(this),s=gi(a.length),c=lo(e,s),u=arguments.length;if(0===u?n=r=0:1===u?(n=0,r=s-c):(n=u-2,r=xc(Dc(vi(t),0),s-c)),9007199254740991<s+n-r)throw TypeError("Maximum allowed length exceeded");for(u=Li(a,r),i=0;i<r;i++)(o=c+i)in a&&Qa(u,i,a[o]);if(u.length=r,n<r){for(i=c;i<s-r;i++){var l=i+n;(o=i+r)in a?a[l]=a[o]:delete a[l]}for(i=s;i>s-r+n;i--)delete a[i-1]}else if(n>r)for(i=s-r;i>c;i--)l=i+n-1,(o=i+r-1)in a?a[l]=a[o]:delete a[l];for(i=0;i<n;i++)a[i+c]=arguments[i+2];return a.length=s-r+n,u}});var Lc=da("Array").splice,Mc=Array.prototype,Uc=function(e){var t=e.splice;return e===Mc||e instanceof Array&&t===Mc.splice?Lc:t},jc=[].indexOf,Fc=!!jc&&0>1/[1].indexOf(1,-0),Vc=va("indexOf");Fr({target:"Array",proto:!0,forced:Fc||Vc},{indexOf:function(e){return Fc?jc.apply(this,arguments)||0:po(this,e,1<arguments.length?arguments[1]:void 0)}});var Bc=da("Array").indexOf,Wc=Array.prototype,Gc=function(e){var t=e.indexOf;return e===Wc||e instanceof Array&&t===Wc.indexOf?Bc:t},qc=ci("species"),Kc=[].slice,Hc=Math.max;Fr({target:"Array",proto:!0,forced:!ns("slice")},{slice:function(e,t){var n,r=pr(this),i=gi(r.length);if(e=lo(e,i),t=lo(void 0===t?i:t,i),Di(r)&&("function"!=typeof(n=r.constructor)||n!==Array&&!Di(n.prototype)?vr(n)&&null===(n=n[qc])&&(n=void 0):n=void 0,n===Array||void 0===n))return Kc.call(r,e,t);for(n=new(void 0===n?Array:n)(Hc(t-e,0)),i=0;e<t;e++,i++)e in r&&Qa(n,i,r[e]);return n.length=i,n}});var zc=da("Array").slice,Yc=Array.prototype,Qc=function(e){var t=e.slice;return e===Yc||e instanceof Array&&t===Yc.slice?zc:t},Xc=!0;"find"in[]&&Array(1).find((function(){Xc=!1})),Fr({target:"Array",proto:!0,forced:Xc},{find:function(e){return Wi(this,e,1<arguments.length?arguments[1]:void 0)}});var Jc=da("Array").find,$c=Array.prototype,Zc=function(e){var t=e.find;return e===$c||e instanceof Array&&t===$c.find?Jc:t},eu=[].slice,tu={};Fr({target:"Function",proto:!0},{bind:Function.bind||function(e){var t=Nr(this),n=eu.call(arguments,1),r=function r(){var i=n.concat(eu.call(arguments));if(this instanceof r){var o=i.length;if(!(o in tu)){for(var a=[],s=0;s<o;s++)a[s]="a["+s+"]";tu[o]=Function("C,a","return new C("+a.join(",")+")")}i=tu[o](t,i)}else i=t.apply(e,i);return i};return vr(t.prototype)&&(r.prototype=t.prototype),r}});var nu=da("Function").bind,ru=Function.prototype,iu=function(e){var t=e.bind;return e===ru||e instanceof Function&&t===ru.bind?nu:t};Fr({target:"Array",proto:!0},{includes:function(e){return ho(this,e,1<arguments.length?arguments[1]:void 0)}});var ou=da("Array").includes;Fr({target:"String",proto:!0,forced:!sa("includes")},{includes:function(e){return!!~String(hr(this)).indexOf(oa(e),1<arguments.length?arguments[1]:void 0)}});var au=da("String").includes,su=Array.prototype,cu=String.prototype,uu=function(e){var t=e.includes;return e===su||e instanceof Array&&t===su.includes?ou:"string"==typeof e||e===cu||e instanceof String&&t===cu.includes?au:t};Fr({target:"Array",proto:!0,forced:va("some")},{some:function(e){return Bi(this,e,1<arguments.length?arguments[1]:void 0)}});var lu=da("Array").some,du=Array.prototype,fu=function(e){var t=e.some;return e===du||e instanceof Array&&t===du.some?lu:t},hu=R,pu=Object.freeze({__proto__:null,shimMediaStream:P,shimOnTrack:D,shimGetSendersWithDtmf:x,shimGetStats:L,shimSenderReceiverGetStats:M,shimAddTrackRemoveTrackWithNative:U,shimAddTrackRemoveTrack:j,shimPeerConnection:F,fixNegotiationNeeded:V,shimGetUserMedia:N,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&("function"==typeof t?e.navigator.mediaDevices.getDisplayMedia=function(n){return t(n).then((function(t){var r=n.video&&n.video.width,i=n.video&&n.video.height;return n.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:t,maxFrameRate:n.video&&n.video.frameRate||3}},r&&(n.video.mandatory.maxWidth=r),i&&(n.video.mandatory.maxHeight=i),e.navigator.mediaDevices.getUserMedia(n)}))}:console.error("shimGetDisplayMedia: getSourceId argument is not a function"))}}),vu="".startsWith,mu=Math.min,gu=sa("startsWith");Fr({target:"String",proto:!0,forced:!gu},{startsWith:function(e){var t=String(hr(this));oa(e);var n=gi(mu(1<arguments.length?arguments[1]:void 0,t.length)),r=String(e);return vu?vu.call(t,r,n):t.slice(n,n+r.length)===r}});var yu=da("String").startsWith,_u=String.prototype,bu=function(e){var t=e.startsWith;return"string"==typeof e||e===_u||e instanceof String&&t===_u.startsWith?yu:t};Fr({target:"String",proto:!0,forced:rr((function(){return"trim"!=="\t\n\v\f\r \xa0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029\ufeff".trim.name}))},{trim:function(){return Ua(this)}});var Eu,wu,Tu,Su=da("String").trim,Iu=String.prototype,Ru=function(e){var t=e.trim;return"string"==typeof e||e===Iu||e instanceof String&&t===Iu.trim?Su:t},Au=E((function(e){var t={generateIdentifier:function(){return Math.random().toString(36).substr(2,10)}};t.localCName=t.generateIdentifier(),t.splitLines=function(e){var t;return Pc(t=Ru(e).call(e).split("\n")).call(t,(function(e){return Ru(e).call(e)}))},t.splitSections=function(e){return e=e.split("\nm="),Pc(e).call(e,(function(e,t){var n;return Ru(n=0<t?"m="+e:e).call(n)+"\r\n"}))},t.getDescription=function(e){return(e=t.splitSections(e))&&e[0]},t.getMediaSections=function(e){return(e=t.splitSections(e)).shift(),e},t.matchPrefix=function(e,n){var r;return ds(r=t.splitLines(e)).call(r,(function(e){return 0===Gc(e).call(e,n)}))},t.parseCandidate=function(e){var t;e={foundation:(t=0===Gc(e).call(e,"a=candidate:")?e.substring(12).split(" "):e.substring(10).split(" "))[0],component:Ba(t[1],10),protocol:t[2].toLowerCase(),priority:Ba(t[3],10),ip:t[4],address:t[4],port:Ba(t[5],10),type:t[7]};for(var n=8;n<t.length;n+=2)switch(t[n]){case"raddr":e.relatedAddress=t[n+1];break;case"rport":e.relatedPort=Ba(t[n+1],10);break;case"tcptype":e.tcpType=t[n+1];break;case"ufrag":e.ufrag=t[n+1],e.usernameFragment=t[n+1];break;default:e[t[n]]=t[n+1]}return e},t.writeCandidate=function(e){var t=[];t.push(e.foundation),t.push(e.component),t.push(e.protocol.toUpperCase()),t.push(e.priority),t.push(e.address||e.ip),t.push(e.port);var n=e.type;return t.push("typ"),t.push(n),"host"!==n&&e.relatedAddress&&e.relatedPort&&(t.push("raddr"),t.push(e.relatedAddress),t.push("rport"),t.push(e.relatedPort)),e.tcpType&&"tcp"===e.protocol.toLowerCase()&&(t.push("tcptype"),t.push(e.tcpType)),(e.usernameFragment||e.ufrag)&&(t.push("ufrag"),t.push(e.usernameFragment||e.ufrag)),"candidate:"+t.join(" ")},t.parseIceOptions=function(e){return e.substr(14).split(" ")},t.parseRtpMap=function(e){e=e.substr(9).split(" ");var t={payloadType:Ba(e.shift(),10)};return e=e[0].split("/"),t.name=e[0],t.clockRate=Ba(e[1],10),t.channels=3===e.length?Ba(e[2],10):1,t.numChannels=t.channels,t},t.writeRtpMap=function(e){var t=e.payloadType;void 0!==e.preferredPayloadType&&(t=e.preferredPayloadType);var n=e.channels||e.numChannels||1;return"a=rtpmap:"+t+" "+e.name+"/"+e.clockRate+(1!==n?"/"+n:"")+"\r\n"},t.parseExtmap=function(e){var t;return e=e.substr(9).split(" "),{id:Ba(e[0],10),direction:0<Gc(t=e[0]).call(t,"/")?e[0].split("/")[1]:"sendrecv",uri:e[1]}},t.writeExtmap=function(e){return"a=extmap:"+(e.id||e.preferredId)+(e.direction&&"sendrecv"!==e.direction?"/"+e.direction:"")+" "+e.uri+"\r\n"},t.parseFmtp=function(e){for(var t={},n=e.substr(Gc(e).call(e," ")+1).split(";"),r=0;r<n.length;r++){var i,o;e=Ru(i=n[r]).call(i).split("="),t[Ru(o=e[0]).call(o)]=e[1]}return t},t.writeFmtp=function(e){var t="",n=e.payloadType;if(void 0!==e.preferredPayloadType&&(n=e.preferredPayloadType),e.parameters&&Ra(e.parameters).length){var r,i=[];ba(r=Ra(e.parameters)).call(r,(function(t){e.parameters[t]?i.push(t+"="+e.parameters[t]):i.push(t)})),t+="a=fmtp:"+n+" "+i.join(";")+"\r\n"}return t},t.parseRtcpFb=function(e){return{type:(e=e.substr(Gc(e).call(e," ")+1).split(" ")).shift(),parameter:e.join(" ")}},t.writeRtcpFb=function(e){var t,n="",r=e.payloadType;return void 0!==e.preferredPayloadType&&(r=e.preferredPayloadType),e.rtcpFeedback&&e.rtcpFeedback.length&&ba(t=e.rtcpFeedback).call(t,(function(e){n+="a=rtcp-fb:"+r+" "+e.type+(e.parameter&&e.parameter.length?" "+e.parameter:"")+"\r\n"})),n},t.parseSsrcMedia=function(e){var t=Gc(e).call(e," "),n={ssrc:Ba(e.substr(7,t-7),10)},r=Gc(e).call(e,":",t);return-1<r?(n.attribute=e.substr(t+1,r-t-1),n.value=e.substr(r+1)):n.attribute=e.substr(t+1),n},t.parseSsrcGroup=function(e){return{semantics:(e=e.substr(13).split(" ")).shift(),ssrcs:Pc(e).call(e,(function(e){return Ba(e,10)}))}},t.getMid=function(e){if(e=t.matchPrefix(e,"a=mid:")[0])return e.substr(6)},t.parseFingerprint=function(e){return{algorithm:(e=e.substr(14).split(" "))[0].toLowerCase(),value:e[1]}},t.getDtlsParameters=function(e,n){return e=t.matchPrefix(e+n,"a=fingerprint:"),{role:"auto",fingerprints:Pc(e).call(e,t.parseFingerprint)}},t.writeDtlsParameters=function(e,t){var n,r="a=setup:"+t+"\r\n";return ba(n=e.fingerprints).call(n,(function(e){r+="a=fingerprint:"+e.algorithm+" "+e.value+"\r\n"})),r},t.getIceParameters=function(e,n){return e=t.splitLines(e),e=cs(e).call(e,t.splitLines(n)),{usernameFragment:ds(e).call(e,(function(e){return 0===Gc(e).call(e,"a=ice-ufrag:")}))[0].substr(12),password:ds(e).call(e,(function(e){return 0===Gc(e).call(e,"a=ice-pwd:")}))[0].substr(10)}},t.writeIceParameters=function(e){return"a=ice-ufrag:"+e.usernameFragment+"\r\na=ice-pwd:"+e.password+"\r\n"},t.parseRtpParameters=function(e){for(var n,r={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},i=t.splitLines(e)[0].split(" "),o=3;o<i.length;o++){var a=i[o],s=t.matchPrefix(e,"a=rtpmap:"+a+" ")[0];if(s){var c;s=t.parseRtpMap(s);var u=t.matchPrefix(e,"a=fmtp:"+a+" ");switch(s.parameters=u.length?t.parseFmtp(u[0]):{},s.rtcpFeedback=Pc(c=t.matchPrefix(e,"a=rtcp-fb:"+a+" ")).call(c,t.parseRtcpFb),r.codecs.push(s),s.name.toUpperCase()){case"RED":case"ULPFEC":r.fecMechanisms.push(s.name.toUpperCase())}}}return ba(n=t.matchPrefix(e,"a=extmap:")).call(n,(function(e){r.headerExtensions.push(t.parseExtmap(e))})),r},t.writeRtpDescription=function(e,n){var r,i,o,a="";a+="m="+e+" ",a+=0<n.codecs.length?"9":"0",a+=" UDP/TLS/RTP/SAVPF ",a+=Pc(r=n.codecs).call(r,(function(e){return void 0!==e.preferredPayloadType?e.preferredPayloadType:e.payloadType})).join(" ")+"\r\n",a+="c=IN IP4 0.0.0.0\r\n",a+="a=rtcp:9 IN IP4 0.0.0.0\r\n",ba(i=n.codecs).call(i,(function(e){a+=t.writeRtpMap(e),a+=t.writeFmtp(e),a+=t.writeRtcpFb(e)}));var s,c=0;return ba(o=n.codecs).call(o,(function(e){e.maxptime>c&&(c=e.maxptime)})),0<c&&(a+="a=maxptime:"+c+"\r\n"),a+="a=rtcp-mux\r\n",n.headerExtensions&&ba(s=n.headerExtensions).call(s,(function(e){a+=t.writeExtmap(e)})),a},t.parseRtpEncodingParameters=function(e){var n,r,i,o,a,s,c,u=[],l=t.parseRtpParameters(e),d=-1!==Gc(n=l.fecMechanisms).call(n,"RED"),f=-1!==Gc(r=l.fecMechanisms).call(r,"ULPFEC"),h=0<(n=ds(i=Pc(o=t.matchPrefix(e,"a=ssrc:")).call(o,(function(e){return t.parseSsrcMedia(e)}))).call(i,(function(e){return"cname"===e.attribute}))).length&&n[0].ssrc;0<(i=Pc(a=t.matchPrefix(e,"a=ssrc-group:FID")).call(a,(function(e){return e=e.substr(17).split(" "),Pc(e).call(e,(function(e){return Ba(e,10)}))}))).length&&1<i[0].length&&i[0][0]===h&&(c=i[0][1]),ba(s=l.codecs).call(s,(function(e){"RTX"===e.name.toUpperCase()&&e.parameters.apt&&(e={ssrc:h,codecPayloadType:Ba(e.parameters.apt,10)},h&&c&&(e.rtx={ssrc:c}),u.push(e),d&&((e=JSON.parse(Yr(e))).fec={ssrc:h,mechanism:f?"red+ulpfec":"red"},u.push(e)))})),0===u.length&&h&&u.push({ssrc:h});var p,v,m=t.matchPrefix(e,"b=");return m.length&&(m=0===Gc(p=m[0]).call(p,"b=TIAS:")?Ba(m[0].substr(7),10):0===Gc(v=m[0]).call(v,"b=AS:")?950*Ba(m[0].substr(5),10)-16e3:void 0,ba(u).call(u,(function(e){e.maxBitrate=m}))),u},t.parseRtcpParameters=function(e){var n,r,i={},o=ds(n=Pc(r=t.matchPrefix(e,"a=ssrc:")).call(r,(function(e){return t.parseSsrcMedia(e)}))).call(n,(function(e){return"cname"===e.attribute}))[0];return o&&(i.cname=o.value,i.ssrc=o.ssrc),n=t.matchPrefix(e,"a=rtcp-rsize"),i.reducedSize=0<n.length,i.compound=0===n.length,e=t.matchPrefix(e,"a=rtcp-mux"),i.mux=0<e.length,i},t.parseMsid=function(e){var n,r,i,o=t.matchPrefix(e,"a=msid:");return 1===o.length?{stream:(i=o[0].substr(7).split(" "))[0],track:i[1]}:0<(e=ds(n=Pc(r=t.matchPrefix(e,"a=ssrc:")).call(r,(function(e){return t.parseSsrcMedia(e)}))).call(n,(function(e){return"msid"===e.attribute}))).length?{stream:(i=e[0].value.split(" "))[0],track:i[1]}:void 0},t.generateSessionId=function(){return Math.random().toString().substr(2,21)},t.writeSessionBoilerplate=function(e,n,r){return n=void 0!==n?n:2,"v=0\r\no="+(r||"thisisadapterortc")+" "+(e||t.generateSessionId())+" "+n+" IN IP4 127.0.0.1\r\ns=-\r\nt=0 0\r\n"},t.writeMediaSection=function(e,n,r,i){return n=t.writeRtpDescription(e.kind,n),n+=t.writeIceParameters(e.iceGatherer.getLocalParameters()),n+=t.writeDtlsParameters(e.dtlsTransport.getLocalParameters(),"offer"===r?"actpass":"active"),n+="a=mid:"+e.mid+"\r\n",e.direction?n+="a="+e.direction+"\r\n":e.rtpSender&&e.rtpReceiver?n+="a=sendrecv\r\n":e.rtpSender?n+="a=sendonly\r\n":e.rtpReceiver?n+="a=recvonly\r\n":n+="a=inactive\r\n",e.rtpSender&&(n=n+"a="+(r="msid:"+i.id+" "+e.rtpSender.track.id+"\r\n")+"a=ssrc:"+e.sendEncodingParameters[0].ssrc+" "+r,e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" "+r,n+="a=ssrc-group:FID "+e.sendEncodingParameters[0].ssrc+" "+e.sendEncodingParameters[0].rtx.ssrc+"\r\n")),n+="a=ssrc:"+e.sendEncodingParameters[0].ssrc+" cname:"+t.localCName+"\r\n",e.rtpSender&&e.sendEncodingParameters[0].rtx&&(n+="a=ssrc:"+e.sendEncodingParameters[0].rtx.ssrc+" cname:"+t.localCName+"\r\n"),n},t.getDirection=function(e,n){e=t.splitLines(e);for(var r=0;r<e.length;r++)switch(e[r]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return e[r].substr(2)}return n?t.getDirection(n):"sendrecv"},t.getKind=function(e){return t.splitLines(e)[0].split(" ")[0].substr(2)},t.isRejected=function(e){return"0"===e.split(" ",2)[1]},t.parseMLine=function(e){return{kind:(e=t.splitLines(e)[0].substr(2).split(" "))[0],port:Ba(e[1],10),protocol:e[2],fmt:Qc(e).call(e,3).join(" ")}},t.parseOLine=function(e){return{username:(e=t.matchPrefix(e,"o=")[0].substr(2).split(" "))[0],sessionId:e[1],sessionVersion:Ba(e[2],10),netType:e[3],addressType:e[4],address:e[5]}},t.isValidSDP=function(e){if("string"!=typeof e||0===e.length)return!1;e=t.splitLines(e);for(var n=0;n<e.length;n++)if(2>e[n].length||"="!==e[n].charAt(1))return!1;return!0},e.exports=t})),Cu=function(e,t){function n(t,n){n.addTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("addtrack",{track:t}))}function r(t,n,r,i){var o=new Event("track");o.track=n,o.receiver=r,o.transceiver={receiver:r},o.streams=i,e.setTimeout((function(){t._dispatchEvent("track",o)}))}var i=function(n){var r=this,i=document.createDocumentFragment();if(["addEventListener","removeEventListener","dispatchEvent"].forEach((function(e){r[e]=i[e].bind(i)})),this.canTrickleIceCandidates=null,this.needNegotiation=!1,this.localStreams=[],this.remoteStreams=[],this._localDescription=null,this._remoteDescription=null,this.signalingState="stable",this.iceConnectionState="new",this.connectionState="new",this.iceGatheringState="new",n=JSON.parse(JSON.stringify(n||{})),this.usingBundle="max-bundle"===n.bundlePolicy,"negotiate"===n.rtcpMuxPolicy)throw K("NotSupportedError","rtcpMuxPolicy 'negotiate' is not supported");switch(n.rtcpMuxPolicy||(n.rtcpMuxPolicy="require"),n.iceTransportPolicy){case"all":case"relay":break;default:n.iceTransportPolicy="all"}switch(n.bundlePolicy){case"balanced":case"max-compat":case"max-bundle":break;default:n.bundlePolicy="balanced"}if(n.iceServers=function(e,t){var n=!1;return(e=JSON.parse(JSON.stringify(e))).filter((function(e){if(e&&(e.urls||e.url)){var r=e.urls||e.url;e.url&&!e.urls&&console.warn("RTCIceServer.url is deprecated! Use urls instead.");var i="string"==typeof r;return i&&(r=[r]),r=r.filter((function(e){return 0!==e.indexOf("turn:")||-1===e.indexOf("transport=udp")||-1!==e.indexOf("turn:[")||n?0===e.indexOf("stun:")&&14393<=t&&-1===e.indexOf("?transport=udp"):(n=!0,!0)})),delete e.url,e.urls=i?r[0]:r,!!r.length}}))}(n.iceServers||[],t),this._iceGatherers=[],n.iceCandidatePoolSize)for(var o=n.iceCandidatePoolSize;0<o;o--)this._iceGatherers.push(new e.RTCIceGatherer({iceServers:n.iceServers,gatherPolicy:n.iceTransportPolicy}));else n.iceCandidatePoolSize=0;this._config=n,this.transceivers=[],this._sdpSessionId=Au.generateSessionId(),this._sdpSessionVersion=0,this._dtlsRole=void 0,this._isClosed=!1};Object.defineProperty(i.prototype,"localDescription",{configurable:!0,get:function(){return this._localDescription}}),Object.defineProperty(i.prototype,"remoteDescription",{configurable:!0,get:function(){return this._remoteDescription}}),i.prototype.onicecandidate=null,i.prototype.onaddstream=null,i.prototype.ontrack=null,i.prototype.onremovestream=null,i.prototype.onsignalingstatechange=null,i.prototype.oniceconnectionstatechange=null,i.prototype.onconnectionstatechange=null,i.prototype.onicegatheringstatechange=null,i.prototype.onnegotiationneeded=null,i.prototype.ondatachannel=null,i.prototype._dispatchEvent=function(e,t){this._isClosed||(this.dispatchEvent(t),"function"==typeof this["on"+e]&&this["on"+e](t))},i.prototype._emitGatheringStateChange=function(){var e=new Event("icegatheringstatechange");this._dispatchEvent("icegatheringstatechange",e)},i.prototype.getConfiguration=function(){return this._config},i.prototype.getLocalStreams=function(){return this.localStreams},i.prototype.getRemoteStreams=function(){return this.remoteStreams},i.prototype._createTransceiver=function(e,t){var n=0<this.transceivers.length;return e={track:null,iceGatherer:null,iceTransport:null,dtlsTransport:null,localCapabilities:null,remoteCapabilities:null,rtpSender:null,rtpReceiver:null,kind:e,mid:null,sendEncodingParameters:null,recvEncodingParameters:null,stream:null,associatedRemoteMediaStreams:[],wantReceive:!0},this.usingBundle&&n?(e.iceTransport=this.transceivers[0].iceTransport,e.dtlsTransport=this.transceivers[0].dtlsTransport):(n=this._createIceAndDtlsTransports(),e.iceTransport=n.iceTransport,e.dtlsTransport=n.dtlsTransport),t||this.transceivers.push(e),e},i.prototype.addTrack=function(t,n){if(this._isClosed)throw K("InvalidStateError","Attempted to call addTrack on a closed peerconnection.");var r;if(this.transceivers.find((function(e){return e.track===t})))throw K("InvalidAccessError","Track already exists.");for(var i=0;i<this.transceivers.length;i++)this.transceivers[i].track||this.transceivers[i].kind!==t.kind||(r=this.transceivers[i]);return r||(r=this._createTransceiver(t.kind)),this._maybeFireNegotiationNeeded(),-1===this.localStreams.indexOf(n)&&this.localStreams.push(n),r.track=t,r.stream=n,r.rtpSender=new e.RTCRtpSender(t,r.dtlsTransport),r.rtpSender},i.prototype.addStream=function(e){var n=this;if(15025<=t)e.getTracks().forEach((function(t){n.addTrack(t,e)}));else{var r=e.clone();e.getTracks().forEach((function(e,t){var n=r.getTracks()[t];e.addEventListener("enabled",(function(e){n.enabled=e.enabled}))})),r.getTracks().forEach((function(e){n.addTrack(e,r)}))}},i.prototype.removeTrack=function(t){if(this._isClosed)throw K("InvalidStateError","Attempted to call removeTrack on a closed peerconnection.");if(!(t instanceof e.RTCRtpSender))throw new TypeError("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.");var n=this.transceivers.find((function(e){return e.rtpSender===t}));if(!n)throw K("InvalidAccessError","Sender was not created by this connection.");var r=n.stream;n.rtpSender.stop(),n.rtpSender=null,n.track=null,n.stream=null,-1===this.transceivers.map((function(e){return e.stream})).indexOf(r)&&-1<this.localStreams.indexOf(r)&&this.localStreams.splice(this.localStreams.indexOf(r),1),this._maybeFireNegotiationNeeded()},i.prototype.removeStream=function(e){var t=this;e.getTracks().forEach((function(e){var n=t.getSenders().find((function(t){return t.track===e}));n&&t.removeTrack(n)}))},i.prototype.getSenders=function(){return this.transceivers.filter((function(e){return!!e.rtpSender})).map((function(e){return e.rtpSender}))},i.prototype.getReceivers=function(){return this.transceivers.filter((function(e){return!!e.rtpReceiver})).map((function(e){return e.rtpReceiver}))},i.prototype._createIceGatherer=function(t,n){var r=this;if(n&&0<t)return this.transceivers[0].iceGatherer;if(this._iceGatherers.length)return this._iceGatherers.shift();var i=new e.RTCIceGatherer({iceServers:this._config.iceServers,gatherPolicy:this._config.iceTransportPolicy});return Object.defineProperty(i,"state",{value:"new",writable:!0}),this.transceivers[t].bufferedCandidateEvents=[],this.transceivers[t].bufferCandidates=function(e){var n=!e.candidate||0===Object.keys(e.candidate).length;i.state=n?"completed":"gathering",null!==r.transceivers[t].bufferedCandidateEvents&&r.transceivers[t].bufferedCandidateEvents.push(e)},i.addEventListener("localcandidate",this.transceivers[t].bufferCandidates),i},i.prototype._gather=function(t,n){var r=this,i=this.transceivers[n].iceGatherer;if(!i.onlocalcandidate){var o=this.transceivers[n].bufferedCandidateEvents;this.transceivers[n].bufferedCandidateEvents=null,i.removeEventListener("localcandidate",this.transceivers[n].bufferCandidates),i.onlocalcandidate=function(e){if(!(r.usingBundle&&0<n)){var o=new Event("icecandidate");o.candidate={sdpMid:t,sdpMLineIndex:n};var a=e.candidate;(e=!a||0===Object.keys(a).length)?"new"!==i.state&&"gathering"!==i.state||(i.state="completed"):("new"===i.state&&(i.state="gathering"),a.component=1,a.ufrag=i.getLocalParameters().usernameFragment,a=Au.writeCandidate(a),o.candidate=Object.assign(o.candidate,Au.parseCandidate(a)),o.candidate.candidate=a,o.candidate.toJSON=function(){return{candidate:o.candidate.candidate,sdpMid:o.candidate.sdpMid,sdpMLineIndex:o.candidate.sdpMLineIndex,usernameFragment:o.candidate.usernameFragment}}),(a=Au.getMediaSections(r._localDescription.sdp))[o.candidate.sdpMLineIndex]+=e?"a=end-of-candidates\r\n":"a="+o.candidate.candidate+"\r\n",r._localDescription.sdp=Au.getDescription(r._localDescription.sdp)+a.join(""),a=r.transceivers.every((function(e){return e.iceGatherer&&"completed"===e.iceGatherer.state})),"gathering"!==r.iceGatheringState&&(r.iceGatheringState="gathering",r._emitGatheringStateChange()),e||r._dispatchEvent("icecandidate",o),a&&(r._dispatchEvent("icecandidate",new Event("icecandidate")),r.iceGatheringState="complete",r._emitGatheringStateChange())}},e.setTimeout((function(){o.forEach((function(e){i.onlocalcandidate(e)}))}),0)}},i.prototype._createIceAndDtlsTransports=function(){var t=this,n=new e.RTCIceTransport(null);n.onicestatechange=function(){t._updateIceConnectionState(),t._updateConnectionState()};var r=new e.RTCDtlsTransport(n);return r.ondtlsstatechange=function(){t._updateConnectionState()},r.onerror=function(){Object.defineProperty(r,"state",{value:"failed",writable:!0}),t._updateConnectionState()},{iceTransport:n,dtlsTransport:r}},i.prototype._disposeIceAndDtlsTransports=function(e){var t=this.transceivers[e].iceGatherer;t&&(delete t.onlocalcandidate,delete this.transceivers[e].iceGatherer),(t=this.transceivers[e].iceTransport)&&(delete t.onicestatechange,delete this.transceivers[e].iceTransport),(t=this.transceivers[e].dtlsTransport)&&(delete t.ondtlsstatechange,delete t.onerror,delete this.transceivers[e].dtlsTransport)},i.prototype._transceive=function(e,n,r){var i=W(e.localCapabilities,e.remoteCapabilities);n&&e.rtpSender&&(i.encodings=e.sendEncodingParameters,i.rtcp={cname:Au.localCName,compound:e.rtcpParameters.compound},e.recvEncodingParameters.length&&(i.rtcp.ssrc=e.recvEncodingParameters[0].ssrc),e.rtpSender.send(i)),r&&e.rtpReceiver&&0<i.codecs.length&&("video"===e.kind&&e.recvEncodingParameters&&15019>t&&e.recvEncodingParameters.forEach((function(e){delete e.rtx})),e.recvEncodingParameters.length?i.encodings=e.recvEncodingParameters:i.encodings=[{}],i.rtcp={compound:e.rtcpParameters.compound},e.rtcpParameters.cname&&(i.rtcp.cname=e.rtcpParameters.cname),e.sendEncodingParameters.length&&(i.rtcp.ssrc=e.sendEncodingParameters[0].ssrc),e.rtpReceiver.receive(i))},i.prototype.setLocalDescription=function(e){var t=this;if(-1===["offer","answer"].indexOf(e.type))return Promise.reject(K("TypeError",'Unsupported type "'+e.type+'"'));if(!G("setLocalDescription",e.type,t.signalingState)||t._isClosed)return Promise.reject(K("InvalidStateError","Can not set local "+e.type+" in state "+t.signalingState));if("offer"===e.type){var n=Au.splitSections(e.sdp),r=n.shift();n.forEach((function(e,n){e=Au.parseRtpParameters(e),t.transceivers[n].localCapabilities=e})),t.transceivers.forEach((function(e,n){t._gather(e.mid,n)}))}else if("answer"===e.type){n=Au.splitSections(t._remoteDescription.sdp),r=n.shift();var i=0<Au.matchPrefix(r,"a=ice-lite").length;n.forEach((function(e,n){var o=t.transceivers[n],a=o.iceGatherer,s=o.iceTransport,c=o.dtlsTransport,u=o.localCapabilities,l=o.remoteCapabilities;if(!(Au.isRejected(e)&&0===Au.matchPrefix(e,"a=bundle-only").length||o.rejected)){var d=Au.getIceParameters(e,r);e=Au.getDtlsParameters(e,r),i&&(e.role="server"),t.usingBundle&&0!==n||(t._gather(o.mid,n),"new"===s.state&&s.start(a,d,i?"controlling":"controlled"),"new"===c.state&&c.start(e)),n=W(u,l),t._transceive(o,0<n.codecs.length,!1)}}))}return t._localDescription={type:e.type,sdp:e.sdp},"offer"===e.type?t._updateSignalingState("have-local-offer"):t._updateSignalingState("stable"),Promise.resolve()},i.prototype.setRemoteDescription=function(i){var o=this;if(-1===["offer","answer"].indexOf(i.type))return Promise.reject(K("TypeError",'Unsupported type "'+i.type+'"'));if(!G("setRemoteDescription",i.type,o.signalingState)||o._isClosed)return Promise.reject(K("InvalidStateError","Can not set remote "+i.type+" in state "+o.signalingState));var a={};o.remoteStreams.forEach((function(e){a[e.id]=e}));var s=[],c=Au.splitSections(i.sdp),u=c.shift(),l=0<Au.matchPrefix(u,"a=ice-lite").length,d=0<Au.matchPrefix(u,"a=group:BUNDLE ").length;o.usingBundle=d;var f=Au.matchPrefix(u,"a=ice-options:")[0];return o.canTrickleIceCandidates=!!f&&0<=f.substr(14).split(" ").indexOf("trickle"),c.forEach((function(r,c){var f=Au.splitLines(r),h=Au.getKind(r),p=Au.isRejected(r)&&0===Au.matchPrefix(r,"a=bundle-only").length,v=f[0].substr(2).split(" ")[2];f=Au.getDirection(r,u);var m=Au.parseMsid(r),g=Au.getMid(r)||Au.generateIdentifier();if(p||"application"===h&&("DTLS/SCTP"===v||"UDP/DTLS/SCTP"===v))o.transceivers[c]={mid:g,kind:h,protocol:v,rejected:!0};else{var y,_;!p&&o.transceivers[c]&&o.transceivers[c].rejected&&(o.transceivers[c]=o._createTransceiver(h,!0));var b,E,w=Au.parseRtpParameters(r);p||(b=Au.getIceParameters(r,u),(E=Au.getDtlsParameters(r,u)).role="client"),v=Au.parseRtpEncodingParameters(r);var T=Au.parseRtcpParameters(r),S=0<Au.matchPrefix(r,"a=end-of-candidates",u).length;if(r=Au.matchPrefix(r,"a=candidate:").map((function(e){return Au.parseCandidate(e)})).filter((function(e){return 1===e.component})),("offer"===i.type||"answer"===i.type)&&!p&&d&&0<c&&o.transceivers[c]&&(o._disposeIceAndDtlsTransports(c),o.transceivers[c].iceGatherer=o.transceivers[0].iceGatherer,o.transceivers[c].iceTransport=o.transceivers[0].iceTransport,o.transceivers[c].dtlsTransport=o.transceivers[0].dtlsTransport,o.transceivers[c].rtpSender&&o.transceivers[c].rtpSender.setTransport(o.transceivers[0].dtlsTransport),o.transceivers[c].rtpReceiver&&o.transceivers[c].rtpReceiver.setTransport(o.transceivers[0].dtlsTransport)),"offer"!==i.type||p){if("answer"===i.type&&!p){h=(y=o.transceivers[c]).iceGatherer;var I=y.iceTransport,R=y.dtlsTransport,A=y.rtpReceiver;p=y.sendEncodingParameters,g=y.localCapabilities,o.transceivers[c].recvEncodingParameters=v,o.transceivers[c].remoteCapabilities=w,o.transceivers[c].rtcpParameters=T,r.length&&"new"===I.state&&(!l&&!S||d&&0!==c?r.forEach((function(e){q(y.iceTransport,e)})):I.setRemoteCandidates(r)),d&&0!==c||("new"===I.state&&I.start(h,b,"controlling"),"new"===R.state&&R.start(E)),!W(y.localCapabilities,y.remoteCapabilities).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&y.sendEncodingParameters[0].rtx&&delete y.sendEncodingParameters[0].rtx,o._transceive(y,"sendrecv"===f||"recvonly"===f,"sendrecv"===f||"sendonly"===f),!A||"sendrecv"!==f&&"sendonly"!==f?delete y.rtpReceiver:(_=A.track,m?(a[m.stream]||(a[m.stream]=new e.MediaStream),n(_,a[m.stream]),s.push([_,A,a[m.stream]])):(a.default||(a.default=new e.MediaStream),n(_,a.default),s.push([_,A,a.default])))}}else(y=o.transceivers[c]||o._createTransceiver(h)).mid=g,y.iceGatherer||(y.iceGatherer=o._createIceGatherer(c,d)),r.length&&"new"===y.iceTransport.state&&(!S||d&&0!==c?r.forEach((function(e){q(y.iceTransport,e)})):y.iceTransport.setRemoteCandidates(r)),g=e.RTCRtpReceiver.getCapabilities(h),15019>t&&(g.codecs=g.codecs.filter((function(e){return"rtx"!==e.name}))),p=y.sendEncodingParameters||[{ssrc:1001*(2*c+2)}],b=!1,"sendrecv"===f||"sendonly"===f?(b=!y.rtpReceiver,A=y.rtpReceiver||new e.RTCRtpReceiver(y.dtlsTransport,h),b&&(_=A.track,m&&"-"===m.stream||(m?(a[m.stream]||(a[m.stream]=new e.MediaStream,Object.defineProperty(a[m.stream],"id",{get:function(){return m.stream}})),Object.defineProperty(_,"id",{get:function(){return m.track}}),I=a[m.stream]):(a.default||(a.default=new e.MediaStream),I=a.default)),I&&(n(_,I),y.associatedRemoteMediaStreams.push(I)),s.push([_,A,I]))):y.rtpReceiver&&y.rtpReceiver.track&&(y.associatedRemoteMediaStreams.forEach((function(t){var n=t.getTracks().find((function(e){return e.id===y.rtpReceiver.track.id}));n&&function(t,n){n.removeTrack(t),n.dispatchEvent(new e.MediaStreamTrackEvent("removetrack",{track:t}))}(n,t)})),y.associatedRemoteMediaStreams=[]),y.localCapabilities=g,y.remoteCapabilities=w,y.rtpReceiver=A,y.rtcpParameters=T,y.sendEncodingParameters=p,y.recvEncodingParameters=v,o._transceive(o.transceivers[c],!1,b)}})),void 0===o._dtlsRole&&(o._dtlsRole="offer"===i.type?"active":"passive"),o._remoteDescription={type:i.type,sdp:i.sdp},"offer"===i.type?o._updateSignalingState("have-remote-offer"):o._updateSignalingState("stable"),Object.keys(a).forEach((function(t){var n=a[t];if(n.getTracks().length){if(-1===o.remoteStreams.indexOf(n)){o.remoteStreams.push(n);var i=new Event("addstream");i.stream=n,e.setTimeout((function(){o._dispatchEvent("addstream",i)}))}s.forEach((function(e){var t=e[0],i=e[1];n.id===e[2].id&&r(o,t,i,[n])}))}})),s.forEach((function(e){e[2]||r(o,e[0],e[1],[])})),e.setTimeout((function(){o&&o.transceivers&&o.transceivers.forEach((function(e){e.iceTransport&&"new"===e.iceTransport.state&&0<e.iceTransport.getRemoteCandidates().length&&(console.warn("Timeout for addRemoteCandidate. Consider sending an end-of-candidates notification"),e.iceTransport.addRemoteCandidate({}))}))}),4e3),Promise.resolve()},i.prototype.close=function(){this.transceivers.forEach((function(e){e.iceTransport&&e.iceTransport.stop(),e.dtlsTransport&&e.dtlsTransport.stop(),e.rtpSender&&e.rtpSender.stop(),e.rtpReceiver&&e.rtpReceiver.stop()})),this._isClosed=!0,this._updateSignalingState("closed")},i.prototype._updateSignalingState=function(e){this.signalingState=e,e=new Event("signalingstatechange"),this._dispatchEvent("signalingstatechange",e)},i.prototype._maybeFireNegotiationNeeded=function(){var t=this;"stable"===this.signalingState&&!0!==this.needNegotiation&&(this.needNegotiation=!0,e.setTimeout((function(){if(t.needNegotiation){t.needNegotiation=!1;var e=new Event("negotiationneeded");t._dispatchEvent("negotiationneeded",e)}}),0))},i.prototype._updateIceConnectionState=function(){var e,t={new:0,closed:0,checking:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach((function(e){e.iceTransport&&!e.rejected&&t[e.iceTransport.state]++})),e="new",0<t.failed?e="failed":0<t.checking?e="checking":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected?e="connected":0<t.completed&&(e="completed"),e!==this.iceConnectionState&&(this.iceConnectionState=e,e=new Event("iceconnectionstatechange"),this._dispatchEvent("iceconnectionstatechange",e))},i.prototype._updateConnectionState=function(){var e,t={new:0,closed:0,connecting:0,connected:0,completed:0,disconnected:0,failed:0};this.transceivers.forEach((function(e){e.iceTransport&&e.dtlsTransport&&!e.rejected&&(t[e.iceTransport.state]++,t[e.dtlsTransport.state]++)})),t.connected+=t.completed,e="new",0<t.failed?e="failed":0<t.connecting?e="connecting":0<t.disconnected?e="disconnected":0<t.new?e="new":0<t.connected&&(e="connected"),e!==this.connectionState&&(this.connectionState=e,e=new Event("connectionstatechange"),this._dispatchEvent("connectionstatechange",e))},i.prototype.createOffer=function(n){var r=this;if(r._isClosed)return Promise.reject(K("InvalidStateError","Can not call createOffer after close"));var i=r.transceivers.filter((function(e){return"audio"===e.kind})).length,o=r.transceivers.filter((function(e){return"video"===e.kind})).length;if(n){if(n.mandatory||n.optional)throw new TypeError("Legacy mandatory/optional constraints not supported.");void 0!==n.offerToReceiveAudio&&(i=!0===n.offerToReceiveAudio?1:!1===n.offerToReceiveAudio?0:n.offerToReceiveAudio),void 0!==n.offerToReceiveVideo&&(o=!0===n.offerToReceiveVideo?1:!1===n.offerToReceiveVideo?0:n.offerToReceiveVideo)}for(r.transceivers.forEach((function(e){"audio"===e.kind?0>--i&&(e.wantReceive=!1):"video"===e.kind&&0>--o&&(e.wantReceive=!1)}));0<i||0<o;)0<i&&(r._createTransceiver("audio"),i--),0<o&&(r._createTransceiver("video"),o--);var a=Au.writeSessionBoilerplate(r._sdpSessionId,r._sdpSessionVersion++);return r.transceivers.forEach((function(n,i){var o=n.track,a=n.kind,s=n.mid||Au.generateIdentifier();n.mid=s,n.iceGatherer||(n.iceGatherer=r._createIceGatherer(i,r.usingBundle)),s=e.RTCRtpSender.getCapabilities(a),15019>t&&(s.codecs=s.codecs.filter((function(e){return"rtx"!==e.name}))),s.codecs.forEach((function(e){"H264"===e.name&&void 0===e.parameters["level-asymmetry-allowed"]&&(e.parameters["level-asymmetry-allowed"]="1"),n.remoteCapabilities&&n.remoteCapabilities.codecs&&n.remoteCapabilities.codecs.forEach((function(t){e.name.toLowerCase()===t.name.toLowerCase()&&e.clockRate===t.clockRate&&(e.preferredPayloadType=t.payloadType)}))})),s.headerExtensions.forEach((function(e){(n.remoteCapabilities&&n.remoteCapabilities.headerExtensions||[]).forEach((function(t){e.uri===t.uri&&(e.id=t.id)}))})),i=n.sendEncodingParameters||[{ssrc:1001*(2*i+1)}],o&&15019<=t&&"video"===a&&!i[0].rtx&&(i[0].rtx={ssrc:i[0].ssrc+1}),n.wantReceive&&(n.rtpReceiver=new e.RTCRtpReceiver(n.dtlsTransport,a)),n.localCapabilities=s,n.sendEncodingParameters=i})),"max-compat"!==r._config.bundlePolicy&&(a+="a=group:BUNDLE "+r.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),a+="a=ice-options:trickle\r\n",r.transceivers.forEach((function(e,t){a+=B(e,e.localCapabilities,"offer",e.stream,r._dtlsRole),a+="a=rtcp-rsize\r\n",!e.iceGatherer||"new"===r.iceGatheringState||0!==t&&r.usingBundle||(e.iceGatherer.getLocalCandidates().forEach((function(e){e.component=1,a+="a="+Au.writeCandidate(e)+"\r\n"})),"completed"===e.iceGatherer.state&&(a+="a=end-of-candidates\r\n"))})),n=new e.RTCSessionDescription({type:"offer",sdp:a}),Promise.resolve(n)},i.prototype.createAnswer=function(){var n=this;if(n._isClosed)return Promise.reject(K("InvalidStateError","Can not call createAnswer after close"));if("have-remote-offer"!==n.signalingState&&"have-local-pranswer"!==n.signalingState)return Promise.reject(K("InvalidStateError","Can not call createAnswer in signalingState "+n.signalingState));var r=Au.writeSessionBoilerplate(n._sdpSessionId,n._sdpSessionVersion++);n.usingBundle&&(r+="a=group:BUNDLE "+n.transceivers.map((function(e){return e.mid})).join(" ")+"\r\n"),r+="a=ice-options:trickle\r\n";var i=Au.getMediaSections(n._remoteDescription.sdp).length;n.transceivers.forEach((function(e,o){if(!(o+1>i)){if(e.rejected)return"application"===e.kind?"DTLS/SCTP"===e.protocol?r+="m=application 0 DTLS/SCTP 5000\r\n":r+="m=application 0 "+e.protocol+" webrtc-datachannel\r\n":"audio"===e.kind?r+="m=audio 0 UDP/TLS/RTP/SAVPF 0\r\na=rtpmap:0 PCMU/8000\r\n":"video"===e.kind&&(r+="m=video 0 UDP/TLS/RTP/SAVPF 120\r\na=rtpmap:120 VP8/90000\r\n"),void(r+="c=IN IP4 0.0.0.0\r\na=inactive\r\na=mid:"+e.mid+"\r\n");var a;e.stream&&("audio"===e.kind?a=e.stream.getAudioTracks()[0]:"video"===e.kind&&(a=e.stream.getVideoTracks()[0]),a&&15019<=t&&"video"===e.kind&&!e.sendEncodingParameters[0].rtx&&(e.sendEncodingParameters[0].rtx={ssrc:e.sendEncodingParameters[0].ssrc+1})),!(o=W(e.localCapabilities,e.remoteCapabilities)).codecs.filter((function(e){return"rtx"===e.name.toLowerCase()})).length&&e.sendEncodingParameters[0].rtx&&delete e.sendEncodingParameters[0].rtx,r+=B(e,o,"answer",e.stream,n._dtlsRole),e.rtcpParameters&&e.rtcpParameters.reducedSize&&(r+="a=rtcp-rsize\r\n")}}));var o=new e.RTCSessionDescription({type:"answer",sdp:r});return Promise.resolve(o)},i.prototype.addIceCandidate=function(e){var t,n=this;return e&&void 0===e.sdpMLineIndex&&!e.sdpMid?Promise.reject(new TypeError("sdpMLineIndex or sdpMid required")):new Promise((function(r,i){if(!n._remoteDescription)return i(K("InvalidStateError","Can not add ICE candidate without a remote description"));if(e&&""!==e.candidate){var o=e.sdpMLineIndex;if(e.sdpMid)for(var a=0;a<n.transceivers.length;a++)if(n.transceivers[a].mid===e.sdpMid){o=a;break}var s=n.transceivers[o];if(!s)return i(K("OperationError","Can not add ICE candidate"));if(s.rejected)return r();if("tcp"===(a=0<Object.keys(e.candidate).length?Au.parseCandidate(e.candidate):{}).protocol&&(0===a.port||9===a.port)||a.component&&1!==a.component)return r();if((0===o||0<o&&s.iceTransport!==n.transceivers[0].iceTransport)&&!q(s.iceTransport,a))return i(K("OperationError","Can not add ICE candidate"));0===(i=e.candidate.trim()).indexOf("a=")&&(i=i.substr(2)),(t=Au.getMediaSections(n._remoteDescription.sdp))[o]+="a="+(a.type?i:"end-of-candidates")+"\r\n",n._remoteDescription.sdp=Au.getDescription(n._remoteDescription.sdp)+t.join("")}else for(o=0;o<n.transceivers.length&&(n.transceivers[o].rejected||(n.transceivers[o].iceTransport.addRemoteCandidate({}),(t=Au.getMediaSections(n._remoteDescription.sdp))[o]+="a=end-of-candidates\r\n",n._remoteDescription.sdp=Au.getDescription(n._remoteDescription.sdp)+t.join(""),!n.usingBundle));o++);r()}))},i.prototype.getStats=function(t){if(t&&t instanceof e.MediaStreamTrack){var n=null;if(this.transceivers.forEach((function(e){e.rtpSender&&e.rtpSender.track===t?n=e.rtpSender:e.rtpReceiver&&e.rtpReceiver.track===t&&(n=e.rtpReceiver)})),!n)throw K("InvalidAccessError","Invalid selector.");return n.getStats()}var r=[];return this.transceivers.forEach((function(e){["rtpSender","rtpReceiver","iceGatherer","iceTransport","dtlsTransport"].forEach((function(t){e[t]&&r.push(e[t].getStats())}))})),Promise.all(r).then((function(e){var t=new Map;return e.forEach((function(e){e.forEach((function(e){t.set(e.id,e)}))})),t}))},["RTCRtpSender","RTCRtpReceiver","RTCIceGatherer","RTCIceTransport","RTCDtlsTransport"].forEach((function(t){if((t=e[t])&&t.prototype&&t.prototype.getStats){var n=t.prototype.getStats;t.prototype.getStats=function(){return n.apply(this).then((function(e){var t=new Map;return Object.keys(e).forEach((function(n){var r;e[n].type={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[(r=e[n]).type]||r.type,t.set(n,e[n])})),t}))}}}));var o=["createOffer","createAnswer"];return o.forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[0]||"function"==typeof e[1]?t.apply(this,[arguments[2]]).then((function(t){"function"==typeof e[0]&&e[0].apply(null,[t])}),(function(t){"function"==typeof e[1]&&e[1].apply(null,[t])})):t.apply(this,arguments)}})),(o=["setLocalDescription","setRemoteDescription","addIceCandidate"]).forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]||"function"==typeof e[2]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)}),(function(t){"function"==typeof e[2]&&e[2].apply(null,[t])})):t.apply(this,arguments)}})),["getStats"].forEach((function(e){var t=i.prototype[e];i.prototype[e]=function(){var e=arguments;return"function"==typeof e[1]?t.apply(this,arguments).then((function(){"function"==typeof e[1]&&e[1].apply(null)})):t.apply(this,arguments)}})),i},ku=Object.freeze({__proto__:null,shimPeerConnection:Y,shimReplaceTrack:Q,shimGetUserMedia:H,shimGetDisplayMedia:z}),Ou=Object.freeze({__proto__:null,shimOnTrack:J,shimPeerConnection:$,shimSenderGetStats:Z,shimReceiverGetStats:ee,shimRemoveStream:te,shimRTCDataChannel:ne,shimGetUserMedia:X,shimGetDisplayMedia:function(e,t){e.navigator.mediaDevices&&"getDisplayMedia"in e.navigator.mediaDevices||e.navigator.mediaDevices&&(e.navigator.mediaDevices.getDisplayMedia=function(n){return n&&n.video?(!0===n.video?n.video={mediaSource:t}:n.video.mediaSource=t,e.navigator.mediaDevices.getUserMedia(n)):((n=new DOMException("getDisplayMedia without video constraints is undefined")).name="NotFoundError",n.code=8,kc.reject(n))})}}),Nu=Object.freeze({__proto__:null,shimLocalStreamsAPI:re,shimRemoteStreamsAPI:ie,shimCallbacksAPI:oe,shimGetUserMedia:ae,shimConstraints:se,shimRTCIceServerUrls:ce,shimTrackEventTransceiver:ue,shimCreateOfferLegacy:le}),Pu=Object.freeze({__proto__:null,shimRTCIceCandidate:de,shimMaxMessageSize:fe,shimSendThrowTypeError:he,shimConnectionState:pe,removeAllowExtmapMixed:ve});!function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).window,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimEdge:!0,shimSafari:!0},n=C(e),r={browserDetails:n,commonShim:Pu,extractVersion:w,disableLog:S,disableWarnings:I};switch(n.browser){case"chrome":if(!pu||!F||!t.shimChrome)return R("Chrome shim is not included in this adapter release."),r;R("adapter.js shimming chrome."),r.browserShim=pu,N(e),P(e),F(e),D(e),j(e),x(e),L(e),M(e),V(e),de(e),pe(e),fe(e),he(e),ve(e);break;case"firefox":if(!Ou||!$||!t.shimFirefox)return R("Firefox shim is not included in this adapter release."),r;R("adapter.js shimming firefox."),r.browserShim=Ou,X(e),$(e),J(e),te(e),Z(e),ee(e),ne(e),de(e),pe(e),fe(e),he(e);break;case"edge":if(!ku||!Y||!t.shimEdge)return R("MS edge shim is not included in this adapter release."),r;R("adapter.js shimming edge."),r.browserShim=ku,H(e),z(e),Y(e),Q(e),fe(e),he(e);break;case"safari":if(!Nu||!t.shimSafari)return R("Safari shim is not included in this adapter release."),r;R("adapter.js shimming safari."),r.browserShim=Nu,ce(e),le(e),oe(e),re(e),ie(e),ue(e),ae(e),de(e),fe(e),he(e),ve(e);break;default:R("Unsupported browser!")}}({window:window}),(Tu=Eu||(Eu={})).WIN_10="Windows 10",Tu.WIN_81="Windows 8.1",Tu.WIN_8="Windows 8",Tu.WIN_7="Windows 7",Tu.WIN_VISTA="Windows Vista",Tu.WIN_SERVER_2003="Windows Server 2003",Tu.WIN_XP="Windows XP",Tu.WIN_2000="Windows 2000",Tu.ANDROID="Android",Tu.OPEN_BSD="Open BSD",Tu.SUN_OS="Sun OS",Tu.LINUX="Linux",Tu.IOS="iOS",Tu.MAC_OS_X="Mac OS X",Tu.MAC_OS="Mac OS",Tu.QNX="QNX",Tu.UNIX="UNIX",Tu.BEOS="BeOS",Tu.OS_2="OS/2",Tu.SEARCH_BOT="Search Bot",function(e){e.CHROME="Chrome",e.SAFARI="Safari",e.EDGE="Edge",e.FIREFOX="Firefox",e.OPERA="OPR",e.QQ="QQBrowser",e.WECHAT="MicroMessenger"}(wu||(wu={}));var Du=function(e){if(e.match(/[0-9]+\.[0-9]+\.[0-9]+$/))return e;var t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-alpha\.([0-9]+)/);if(t&&t[1]&&t[2]){var n,r=t[2];return cs(n="".concat(t[1],".")).call(n,r)}return(t=e.match(/([0-9]+\.[0-9]+\.[0-9]+)\-special\.([0-9]+)/))&&t[1]&&t[2]?(n=t[2],cs(r="".concat(t[1],".")).call(r,100*(Number(n)+1))):"4.0.0.999"}("4.4.0");try{var xu=!0===JSON.parse("true")}catch(Tu){xu=!0}var Lu=xu,Mu={username:"test",password:"111111",turnServerURL:"",tcpport:3433,udpport:3478,forceturn:!1},Uu={"90p":we(160,90),"90p_1":we(160,90),"120p":we(160,120,15,30,65),"120p_1":we(160,120,15,30,65),"120p_3":we(120,120,15,30,50),"120p_4":we(212,120),"180p":we(320,180,15,30,140),"180p_1":we(320,180,15,30,140),"180p_3":we(180,180,15,30,100),"180p_4":we(240,180,15,30,120),"240p":we(320,240,15,40,200),"240p_1":we(320,240,15,40,200),"240p_3":we(240,240,15,40,140),"240p_4":we(424,240,15,40,220),"360p":we(640,360,15,80,400),"360p_1":we(640,360,15,80,400),"360p_3":we(360,360,15,80,260),"360p_4":we(640,360,30,80,600),"360p_6":we(360,360,30,80,400),"360p_7":we(480,360,15,80,320),"360p_8":we(480,360,30,80,490),"360p_9":we(640,360,15,80,800),"360p_10":we(640,360,24,80,800),"360p_11":we(640,360,24,80,1e3),"480p":we(640,480,15,100,500),"480p_1":we(640,480,15,100,500),"480p_2":we(640,480,30,100,1e3),"480p_3":we(480,480,15,100,400),"480p_4":we(640,480,30,100,750),"480p_6":we(480,480,30,100,600),"480p_8":we(848,480,15,100,610),"480p_9":we(848,480,30,100,930),"480p_10":we(640,480,10,100,400),"720p":we(1280,720,15,120,1130),"720p_1":we(1280,720,15,120,1130),"720p_2":we(1280,720,30,120,2e3),"720p_3":we(1280,720,30,120,1710),"720p_5":we(960,720,15,120,910),"720p_6":we(960,720,30,120,1380),"1080p":we(1920,1080,15,120,2080),"1080p_1":we(1920,1080,15,120,2080),"1080p_2":we(1920,1080,30,120,3e3),"1080p_3":we(1920,1080,30,120,3150),"1080p_5":we(1920,1080,60,120,4780),"1440p":we(2560,1440,30,120,4850),"1440p_1":we(2560,1440,30,120,4850),"1440p_2":we(2560,1440,60,120,7350),"4k":we(3840,2160,30,120,8910),"4k_1":we(3840,2160,30,120,8910),"4k_3":we(3840,2160,60,120,13500)},ju={"480p":Te(640,480,5),"480p_1":Te(640,480,5),"480p_2":Te(640,480,30),"480p_3":Te(640,480,15),"720p":Te(1280,720,5),"720p_1":Te(1280,720,5),"720p_2":Te(1280,720,30),"720p_3":Te(1280,720,15),"1080p":Te(1920,1080,5),"1080p_1":Te(1920,1080,5),"1080p_2":Te(1920,1080,30),"1080p_3":Te(1920,1080,15)},Fu={"1SL1TL":Se(1,1),"3SL3TL":Se(3,3),"2SL3TL":Se(2,3)},Vu={speech_low_quality:Ee(16e3,!1),speech_standard:Ee(32e3,!1,18),music_standard:Ee(48e3,!1),standard_stereo:Ee(48e3,!0,56),high_quality:Ee(48e3,!1,128),high_quality_stereo:Ee(48e3,!0,192)},Bu={PROCESS_ID:"",ENCRYPT_AES:!0,AREAS:["CHINA","GLOBAL"],WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io","webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io","webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-web-2.ap.sd-rtn.com","cds-ap-web-3.agora.io","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-web-2.ap.sd-rtn.com","sua-ap-web-3.agora.io","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-ap-web-1.agora.io","uap-web-2.ap.sd-rtn.com","uap-ap-web-3.agora.io","uap-web-4.ap.sd-rtn.com"],LOG_UPLOAD_SERVER:"logservice.agora.io",EVENT_REPORT_DOMAIN:"statscollector-1.agora.io",EVENT_REPORT_BACKUP_DOMAIN:"web-2.statscollector.sd-rtn.com",GATEWAY_ADDRESS:[],GATEWAY_WSS_ADDRESS:"",LIVE_STREAMING_ADDRESS:"",ACCOUNT_REGISTER_RETRY_TIMEOUT:1,ACCOUNT_REGISTER_RETRY_RATIO:2,ACCOUNT_REGISTER_RETRY_TIMEOUT_MAX:6e4,ACCOUNT_REGISTER_RETRY_COUNT_MAX:1e5,AUDIO_CONTEXT:null,WEBCS_BACKUP_CONNECT_TIMEOUT:6e3,HTTP_CONNECT_TIMEOUT:5e3,PLAYER_STATE_DEFER:2e3,SIGNAL_REQUEST_TIMEOUT:1e4,SIGNAL_REQUEST_WATCH_INTERVAL:1e3,REPORT_STATS:!0,UPLOAD_LOG:!1,NOT_REPORT_EVENT:[],FILEPATH_LENMAX:255,SUBSCRIBE_TCC:!0,PING_PONG_TIME_OUT:10,DUALSTREAM_OPERATION_CHECK:!0,WEBSOCKET_TIMEOUT_MIN:1e4,EVENT_REPORT_SEND_INTERVAL:3e3,CONFIG_DISTRIBUTE_INTERVAL:3e5,MEDIA_ELEMENT_EXISTS_DEPTH:3,CANDIDATE_TIMEOUT:5e3,SHIM_CANDIDATE:!1,LEAVE_MSG_TIMEOUT:2e3,SHOW_REPORT_INVOKER_LOG:!1,STATS_FILTER:{transportId:!0,googTrackId:!0},JOIN_EXTEND:"",PUB_EXTEND:"",SUB_EXTEND:"",FORCE_TURN:!1,TURN_ENABLE_TCP:!0,TURN_ENABLE_UDP:!0,MAX_UPLOAD_CACHE:50,UPLOAD_CACHE_INTERVAL:2e3,AJAX_REQUEST_CONCURRENT:3,REPORT_APP_SCENARIO:void 0,CHROME_FORCE_PLAN_B:!1,AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL:400,AUDIO_SOURCE_AVG_VOLUME_DURATION:3e3,AUDIO_VOLUME_INDICATION_INTERVAL:2e3,NORMAL_EVENT_QUEUE_CAPACITY:100,CUSTOM_REPORT:!0,CUSTOM_REPORT_LIMIT:20,PROXY_SERVER_TYPE2:"webnginx-proxy.agora.io",PROXY_SERVER_TYPE3:"webrtc-cloud-proxy.sd-rtn.com",CUSTOM_PUB_ANSWER_MODIFIER:null,CUSTOM_SUB_ANSWER_MODIFIER:null,CUSTOM_PUB_OFFER_MODIFIER:null,CUSTOM_SUB_OFFER_MODIFIER:null,DSCP_TYPE:"high"};Lu||(Bu.WEBCS_DOMAIN=["ap-web-1-oversea.agora.io","ap-web-1-north-america.agora.io"],Bu.WEBCS_DOMAIN_BACKUP_LIST=["ap-web-2-oversea.agora.io","ap-web-2-north-america.agora.io"],Bu.PROXY_CS=["proxy-ap-web-oversea.agora.io","proxy-ap-web-america.agora.io"],Bu.CDS_AP=["cds-ap-web-oversea.agora.io","cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],Bu.ACCOUNT_REGISTER=["sua-ap-web-oversea.agora.io","sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],Bu.UAP_AP=["uap-ap-web-oversea.agora.io","uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],Bu.LOG_UPLOAD_SERVER="logservice-oversea.agora.io",Bu.EVENT_REPORT_DOMAIN="statscollector-1-oversea.agora.io",Bu.EVENT_REPORT_BACKUP_DOMAIN="statscollector-2-oversea.agora.io",Bu.PROXY_SERVER_TYPE3="webrtc-cloud-proxy.agora.io",Bu.AREAS=["NORTH_AMERICA","OVERSEA"]);var Wu=[[0,1,2,3,4,5,5],[0,2,2,3,4,5,5],[0,3,3,3,4,5,5],[0,4,4,4,4,5,5],[0,5,5,5,5,5,5]],Gu=[],qu=[],Ku=qu.sort,Hu=rr((function(){qu.sort(void 0)})),zu=rr((function(){qu.sort(null)})),Yu=va("sort");Fr({target:"Array",proto:!0,forced:Hu||!zu||Yu},{sort:function(e){return void 0===e?Ku.call(Pi(this)):Ku.call(Pi(this),Nr(e))}});var Qu=da("Array").sort,Xu=Array.prototype,Ju=function(e){var t=e.sort;return e===Xu||e instanceof Array&&t===Xu.sort?Qu:t};Fr({target:"Array",stat:!0},{isArray:Di});var $u,Zu=Or.Array.isArray;!function(e){e.UNEXPECTED_ERROR="UNEXPECTED_ERROR",e.UNEXPECTED_RESPONSE="UNEXPECTED_RESPONSE",e.TIMEOUT="TIMEOUT",e.INVALID_PARAMS="INVALID_PARAMS",e.NOT_READABLE="NOT_READABLE",e.NOT_SUPPORTED="NOT_SUPPORTED",e.INVALID_OPERATION="INVALID_OPERATION",e.OPERATION_ABORTED="OPERATION_ABORTED",e.WEB_SECURITY_RESTRICT="WEB_SECURITY_RESTRICT",e.NETWORK_ERROR="NETWORK_ERROR",e.NETWORK_TIMEOUT="NETWORK_TIMEOUT",e.NETWORK_RESPONSE_ERROR="NETWORK_RESPONSE_ERROR",e.API_INVOKE_TIMEOUT="API_INVOKE_TIMEOUT",e.ENUMERATE_DEVICES_FAILED="ENUMERATE_DEVICES_FAILED",e.DEVICE_NOT_FOUND="DEVICE_NOT_FOUND",e.ELECTRON_IS_NULL="ELECTRON_IS_NULL",e.ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR="ELECTRON_DESKTOP_CAPTURER_GET_SOURCES_ERROR",e.CHROME_PLUGIN_NO_RESPONSE="CHROME_PLUGIN_NO_RESPONSE",e.CHROME_PLUGIN_NOT_INSTALL="CHROME_PLUGIN_NOT_INSTALL",e.MEDIA_OPTION_INVALID="MEDIA_OPTION_INVALID",e.PERMISSION_DENIED="PERMISSION_DENIED",e.CONSTRAINT_NOT_SATISFIED="CONSTRAINT_NOT_SATISFIED",e.TRACK_IS_DISABLED="TRACK_IS_DISABLED",e.SHARE_AUDIO_NOT_ALLOWED="SHARE_AUDIO_NOT_ALLOWED",e.LOW_STREAM_ENCODING_ERROR="LOW_STREAM_ENCODING_ERROR",e.SET_ENCODING_PARAMETER_ERROR="SET_ENCODING_PARAMETER_ERROR",e.INVALID_UINT_UID_FROM_STRING_UID="INVALID_UINT_UID_FROM_STRING_UID",e.CAN_NOT_GET_PROXY_SERVER="CAN_NOT_GET_PROXY_SERVER",e.CAN_NOT_GET_GATEWAY_SERVER="CAN_NOT_GET_GATEWAY_SERVER",e.VOID_GATEWAY_ADDRESS="VOID_GATEWAY_ADDRESS",e.UID_CONFLICT="UID_CONFLICT",e.INVALID_LOCAL_TRACK="INVALID_LOCAL_TRACK",e.INVALID_TRACK="INVALID_TRACK",e.SENDER_NOT_FOUND="SENDER_NOT_FOUND",e.CREATE_OFFER_FAILED="CREATE_OFFER_FAILED",e.SET_ANSWER_FAILED="SET_ANSWER_FAILED",e.ICE_FAILED="ICE_FAILED",e.PC_CLOSED="PC_CLOSED",e.SENDER_REPLACE_FAILED="SENDER_REPLACE_FAILED",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NO_ICE_CANDIDATE="NO_ICE_CANDIDATE",e.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS="CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS",e.EXIST_DISABLED_VIDEO_TRACK="EXIST_DISABLED_VIDEO_TRACK",e.INVALID_REMOTE_USER="INVALID_REMOTE_USER",e.REMOTE_USER_IS_NOT_PUBLISHED="REMOTE_USER_IS_NOT_PUBLISHED",e.CUSTOM_REPORT_SEND_FAILED="CUSTOM_REPORT_SEND_FAILED",e.CUSTOM_REPORT_FREQUENCY_TOO_HIGH="CUSTOM_REPORT_FREQUENCY_TOO_HIGH",e.FETCH_AUDIO_FILE_FAILED="FETCH_AUDIO_FILE_FAILED",e.READ_LOCAL_AUDIO_FILE_ERROR="READ_LOCAL_AUDIO_FILE_ERROR",e.DECODE_AUDIO_FILE_FAILED="DECODE_AUDIO_FILE_FAILED",e.WS_ABORT="WS_ABORT",e.WS_DISCONNECT="WS_DISCONNECT",e.WS_ERR="WS_ERR",e.LIVE_STREAMING_TASK_CONFLICT="LIVE_STREAMING_TASK_CONFLICT",e.LIVE_STREAMING_INVALID_ARGUMENT="LIVE_STREAMING_INVALID_ARGUMENT",e.LIVE_STREAMING_INTERNAL_SERVER_ERROR="LIVE_STREAMING_INTERNAL_SERVER_ERROR",e.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED="LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED",e.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED="LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED",e.LIVE_STREAMING_CDN_ERROR="LIVE_STREAMING_CDN_ERROR",e.LIVE_STREAMING_INVALID_RAW_STREAM="LIVE_STREAMING_INVALID_RAW_STREAM",e.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT="LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT",e.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE="LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE",e.LIVE_STREAMING_WARN_FREQUENT_REQUEST="LIVE_STREAMING_WARN_FREQUENT_REQUEST",e.WEBGL_INTERNAL_ERROR="WEBGL_INTERNAL_ERROR",e.BEAUTY_PROCESSOR_INTERNAL_ERROR="BEAUTY_PROCESSOR_INTERNAL_ERROR",e.CROSS_CHANNEL_WAIT_STATUS_ERROR="CROSS_CHANNEL_WAIT_STATUS_ERROR",e.CROSS_CHANNEL_FAILED_JOIN_SRC="CROSS_CHANNEL_FAILED_JOIN_SEC",e.CROSS_CHANNEL_FAILED_JOIN_DEST="CROSS_CHANNEL_FAILED_JOIN_DEST",e.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST="CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST",e.CROSS_CHANNEL_SERVER_ERROR_RESPONSE="CROSS_CHANNEL_SERVER_ERROR_RESPONSE",e.METADATA_OUT_OF_RANGE="METADATA_OUT_OF_RANGE",e.LOCAL_AEC_ERROR="LOCAL_AEC_ERROR"}($u||($u={}));var el=function(e,t){return function(){for(var n=Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}},tl=Object.prototype.toString,nl={isArray:Ie,isArrayBuffer:function(e){return"[object ArrayBuffer]"===tl.call(e)},isBuffer:function(e){return null!=e&&null!=e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:Re,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===tl.call(e)},isFile:function(e){return"[object File]"===tl.call(e)},isBlob:function(e){return"[object Blob]"===tl.call(e)},isFunction:Ae,isStream:function(e){return Re(e)&&Ae(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:Ce,merge:function e(){function t(t,r){"object"==typeof n[r]&&"object"==typeof t?n[r]=e(n[r],t):n[r]=t}for(var n={},r=0,i=arguments.length;r<i;r++)Ce(arguments[r],t);return n},deepMerge:function e(){function t(t,r){"object"==typeof n[r]&&"object"==typeof t?n[r]=e(n[r],t):n[r]="object"==typeof t?e({},t):t}for(var n={},r=0,i=arguments.length;r<i;r++)Ce(arguments[r],t);return n},extend:function(e,t,n){return Ce(t,(function(t,r){e[r]=n&&"function"==typeof t?el(t,n):t})),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}},rl=function(e,t,n){if(!t)return e;if(n)t=n(t);else if(nl.isURLSearchParams(t))t=t.toString();else{var r=[];nl.forEach(t,(function(e,t){null!=e&&(nl.isArray(e)?t+="[]":e=[e],nl.forEach(e,(function(e){nl.isDate(e)?e=e.toISOString():nl.isObject(e)&&(e=JSON.stringify(e)),r.push(ke(t)+"="+ke(e))})))})),t=r.join("&")}return t&&(-1!==(n=e.indexOf("#"))&&(e=e.slice(0,n)),e+=(-1===e.indexOf("?")?"?":"&")+t),e};Oe.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},Oe.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},Oe.prototype.forEach=function(e){nl.forEach(this.handlers,(function(t){null!==t&&e(t)}))};var il=Oe,ol=function(e,t,n){return nl.forEach(n,(function(n){e=n(e,t)})),e},al=function(e){return!(!e||!e.__CANCEL__)},sl=function(e,t){nl.forEach(e,(function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])}))},cl=function(e,t,n,r,i){return function(e,t,n,r,i){return e.config=t,n&&(e.code=n),e.request=r,e.response=i,e.isAxiosError=!0,e.toJSON=function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code}},e}(Error(e),t,n,r,i)},ul="age authorization content-length content-type etag expires from host if-modified-since if-unmodified-since last-modified location max-forwards proxy-authorization referer retry-after user-agent".split(" "),ll=nl.isStandardBrowserEnv()?function(){function e(e){return n&&(r.setAttribute("href",e),e=r.href),r.setAttribute("href",e),{href:r.href,protocol:r.protocol?r.protocol.replace(/:$/,""):"",host:r.host,search:r.search?r.search.replace(/^\?/,""):"",hash:r.hash?r.hash.replace(/^#/,""):"",hostname:r.hostname,port:r.port,pathname:"/"===r.pathname.charAt(0)?r.pathname:"/"+r.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),r=document.createElement("a");return t=e(window.location.href),function(n){return(n=nl.isString(n)?e(n):n).protocol===t.protocol&&n.host===t.host}}():function(){return!0},dl=nl.isStandardBrowserEnv()?{write:function(e,t,n,r,i,o){var a=[];a.push(e+"="+encodeURIComponent(t)),nl.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),nl.isString(r)&&a.push("path="+r),nl.isString(i)&&a.push("domain="+i),!0===o&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){return(e=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)")))?decodeURIComponent(e[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}},fl=function(e){return new Promise((function(t,n){var r=e.data,i=e.headers;nl.isFormData(r)&&delete i["Content-Type"];var o=new XMLHttpRequest;if(e.auth&&(i.Authorization="Basic "+btoa((e.auth.username||"")+":"+(e.auth.password||""))),o.open(e.method.toUpperCase(),rl(e.url,e.params,e.paramsSerializer),!0),o.timeout=e.timeout,o.onreadystatechange=function(){if(o&&4===o.readyState&&(0!==o.status||o.responseURL&&0===o.responseURL.indexOf("file:"))){var r,i,a,s,c,u="getAllResponseHeaders"in o?(r=o.getAllResponseHeaders(),c={},r?(nl.forEach(r.split("\n"),(function(e){s=e.indexOf(":"),i=nl.trim(e.substr(0,s)).toLowerCase(),a=nl.trim(e.substr(s+1)),!i||c[i]&&0<=ul.indexOf(i)||(c[i]="set-cookie"===i?(c[i]?c[i]:[]).concat([a]):c[i]?c[i]+", "+a:a)})),c):c):null;!function(e,t,n){var r=n.config.validateStatus;!r||r(n.status)?e(n):t(cl("Request failed with status code "+n.status,n.config,null,n.request,n))}(t,n,{data:e.responseType&&"text"!==e.responseType?o.response:o.responseText,status:o.status,statusText:o.statusText,headers:u,config:e,request:o}),o=null}},o.onabort=function(){o&&(n(cl("Request aborted",e,"ECONNABORTED",o)),o=null)},o.onerror=function(){n(cl("Network Error",e,null,o)),o=null},o.ontimeout=function(){n(cl("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",o)),o=null},nl.isStandardBrowserEnv()){var a=(e.withCredentials||ll(e.url))&&e.xsrfCookieName?dl.read(e.xsrfCookieName):void 0;a&&(i[e.xsrfHeaderName]=a)}if("setRequestHeader"in o&&nl.forEach(i,(function(e,t){void 0===r&&"content-type"===t.toLowerCase()?delete i[t]:o.setRequestHeader(t,e)})),e.withCredentials&&(o.withCredentials=!0),e.responseType)try{o.responseType=e.responseType}catch(s){if("json"!==e.responseType)throw s}"function"==typeof e.onDownloadProgress&&o.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&o.upload&&o.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then((function(e){o&&(o.abort(),n(e),o=null)})),void 0===r&&(r=null),o.send(r)}))},hl={"Content-Type":"application/x-www-form-urlencoded"},pl={adapter:function(){var e;return("undefined"!=typeof r&&"[object process]"===Object.prototype.toString.call(r)||"undefined"!=typeof XMLHttpRequest)&&(e=fl),e}(),transformRequest:[function(e,t){return sl(t,"Accept"),sl(t,"Content-Type"),nl.isFormData(e)||nl.isArrayBuffer(e)||nl.isBuffer(e)||nl.isStream(e)||nl.isFile(e)||nl.isBlob(e)?e:nl.isArrayBufferView(e)?e.buffer:nl.isURLSearchParams(e)?(Ne(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):nl.isObject(e)?(Ne(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return 200<=e&&300>e},headers:{common:{Accept:"application/json, text/plain, */*"}}};nl.forEach(["delete","get","head"],(function(e){pl.headers[e]={}})),nl.forEach(["post","put","patch"],(function(e){pl.headers[e]=nl.merge(hl)}));var vl=function(e){var t,n,r;return e.cancelToken&&e.cancelToken.throwIfRequested(),e.baseURL&&(r=e.url,!/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(r))&&(e.url=(t=e.baseURL,(n=e.url)?t.replace(/\/+$/,"")+"/"+n.replace(/^\/+/,""):t)),e.headers=e.headers||{},e.data=ol(e.data,e.headers,e.transformRequest),e.headers=nl.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),nl.forEach("delete get head post put patch common".split(" "),(function(t){delete e.headers[t]})),(e.adapter||pl.adapter)(e).then((function(t){return e.cancelToken&&e.cancelToken.throwIfRequested(),t.data=ol(t.data,t.headers,e.transformResponse),t}),(function(t){return al(t)||(e.cancelToken&&e.cancelToken.throwIfRequested(),t&&t.response&&(t.response.data=ol(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))},ml=function(e,t){t=t||{};var n={};return nl.forEach(["url","method","params","data"],(function(e){void 0!==t[e]&&(n[e]=t[e])})),nl.forEach(["headers","auth","proxy"],(function(r){nl.isObject(t[r])?n[r]=nl.deepMerge(e[r],t[r]):void 0!==t[r]?n[r]=t[r]:nl.isObject(e[r])?n[r]=nl.deepMerge(e[r]):void 0!==e[r]&&(n[r]=e[r])})),nl.forEach("baseURL transformRequest transformResponse paramsSerializer timeout withCredentials adapter responseType xsrfCookieName xsrfHeaderName onUploadProgress onDownloadProgress maxContentLength validateStatus maxRedirects httpAgent httpsAgent cancelToken socketPath".split(" "),(function(r){void 0!==t[r]?n[r]=t[r]:void 0!==e[r]&&(n[r]=e[r])})),n};Pe.prototype.request=function(e,t){"string"==typeof e?(e=t||{}).url=e:e=e||{},(e=ml(this.defaults,e)).method=e.method?e.method.toLowerCase():"get";var n=[vl,void 0];for(e=Promise.resolve(e),this.interceptors.request.forEach((function(e){n.unshift(e.fulfilled,e.rejected)})),this.interceptors.response.forEach((function(e){n.push(e.fulfilled,e.rejected)}));n.length;)e=e.then(n.shift(),n.shift());return e},Pe.prototype.getUri=function(e){return e=ml(this.defaults,e),rl(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},nl.forEach(["delete","get","head","options"],(function(e){Pe.prototype[e]=function(t,n){return this.request(nl.merge(n||{},{method:e,url:t}))}})),nl.forEach(["post","put","patch"],(function(e){Pe.prototype[e]=function(t,n,r){return this.request(nl.merge(r||{},{method:e,url:t,data:n}))}}));var gl=Pe;De.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},De.prototype.__CANCEL__=!0;var yl=De;xe.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},xe.source=function(){var e;return{token:new xe((function(t){e=t})),cancel:e}};var _l=Le(pl);_l.Axios=gl,_l.create=function(e){return Le(ml(_l.defaults,e))},_l.Cancel=yl,_l.CancelToken=xe,_l.isCancel=al,_l.all=function(e){return Promise.all(e)},_l.spread=function(e){return function(t){return e.apply(null,t)}};var bl,El,wl,Tl=_l.default=_l,Sl={DEBUG:0,INFO:1,WARNING:2,ERROR:3,NONE:4},Il=function(e){for(var t in Sl)if(Sl[t]===e)return t;return"DEFAULT"},Rl=new(function(){function e(){f(this,e),this.logLevel=Sl.DEBUG,this.uploadLogWaitingList=[],this.uploadLogUploadingList=[],this.currentLogID=this.uploadErrorCount=0}return h(e,[{key:"debug",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;t=cs(r=[Sl.DEBUG]).call(r,t),this.log.apply(this,t)}},{key:"info",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;t=cs(r=[Sl.INFO]).call(r,t),this.log.apply(this,t)}},{key:"warning",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;t=cs(r=[Sl.WARNING]).call(r,t),this.log.apply(this,t)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;t=cs(r=[Sl.ERROR]).call(r,t),this.log.apply(this,t)}},{key:"setLogLevel",value:function(e){this.logLevel=e=Math.min(Math.max(0,e),4)}},{key:"enableLogUpload",value:function(){be("UPLOAD_LOG",!0)}},{key:"disableLogUpload",value:function(){be("UPLOAD_LOG",!1),this.uploadLogUploadingList=[],this.uploadLogWaitingList=[]}},{key:"setProxyServer",value:function(e){this.proxyServerURL=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r,i,o,a,s=Math.max(0,Math.min(4,t[0]));if(t[0]=Me()+" Agora-SDK [".concat(Il(s),"]:"),this.appendLogToWaitingList(s,t),!(s<this.logLevel)){var c=Me()+" %cAgora-SDK [".concat(Il(s),"]:");switch(s){case Sl.DEBUG:t=cs(r=[c,"color: #64B5F6;"]).call(r,Qc(t).call(t,1)),console.log.apply(console,t);break;case Sl.INFO:t=cs(i=[c,"color: #1E88E5; font-weight: bold;"]).call(i,Qc(t).call(t,1)),console.log.apply(console,t);break;case Sl.WARNING:t=cs(o=[c,"color: #FB8C00; font-weight: bold;"]).call(o,Qc(t).call(t,1)),console.warn.apply(console,t);break;case Sl.ERROR:t=cs(a=[c,"color: #B00020; font-weight: bold;"]).call(a,Qc(t).call(t,1)),console.error.apply(console,t)}}}},{key:"appendLogToWaitingList",value:function(e){if(Bu.UPLOAD_LOG){for(var t="",n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];ba(r).call(r,(function(e){"object"==typeof e&&(e=Yr(e)),t+="".concat(e," ")})),this.uploadLogWaitingList.push({payload_str:t,log_level:e,log_item_id:this.currentLogID++}),0===this.uploadLogUploadingList.length&&this.uploadLogInterval()}}},{key:"uploadLogs",value:function(){var e=m(v.mark((function e(){var t,n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n={sdk_version:Du,process_id:Bu.PROCESS_ID,payload:Yr(this.uploadLogUploadingList)},e.next=3,Tl.post(this.url||(this.proxyServerURL?cs(t="https://".concat(this.proxyServerURL,"/ls/?h=")).call(t,Bu.LOG_UPLOAD_SERVER,"&p=443&d=upload/v1"):"https://".concat(Bu.LOG_UPLOAD_SERVER,"/upload/v1")),n,{responseType:"text"});case 3:if("OK"===(n=e.sent).data){e.next=6;break}throw Error("unexpected upload log response: "+n.data);case 6:this.uploadLogUploadingList=[];case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"uploadLogInterval",value:function(){var e,t=this;0===this.uploadLogUploadingList.length&&0===this.uploadLogWaitingList.length||(0===this.uploadLogUploadingList.length&&(this.uploadLogUploadingList=Uc(e=this.uploadLogWaitingList).call(e,0,10)),this.uploadLogs().then((function(){t.uploadErrorCount=0,0<t.uploadLogWaitingList.length&&window.setTimeout((function(){return t.uploadLogInterval()}),3e3)})).catch((function(e){t.uploadErrorCount+=1,2>t.uploadErrorCount?window.setTimeout((function(){return t.uploadLogInterval()}),200):window.setTimeout((function(){return t.uploadLogInterval()}),1e3)})))}}]),e}()),Al=function(){function e(t){var n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=arguments.length>2?arguments[2]:void 0;f(this,e),this.name="AgoraRTCException",this.code=t,this.message=cs(n="AgoraRTCError ".concat(this.code,": ")).call(n,r),this.data=i}return h(e,[{key:"toString",value:function(){var e;return this.data?cs(e="".concat(this.message," data: ")).call(e,Yr(this.data)):this.message}},{key:"print",value:function(){return Rl.error(this.toString()),this}},{key:"throw",value:function(){throw this.print(),this}}]),e}();(wl=bl||(bl={})).FREE="free",wl.UPLOADING="uploading",function(e){e.NONE="none",e.INIT="init",e.CANPLAY="canplay",e.PLAYING="playing",e.PAUSED="paused",e.SUSPEND="suspend",e.STALLED="stalled",e.WAITING="waiting",e.ERROR="error",e.DESTROYED="destroyed",e.ABORT="abort",e.ENDED="ended",e.EMPTIED="emptied"}(El||(El={})),Fr({target:"Number",stat:!0},{MAX_SAFE_INTEGER:9007199254740991}),Fr({target:"Number",stat:!0},{MIN_SAFE_INTEGER:-9007199254740991});var Cl,kl,Ol,Nl,Pl,Dl,xl,Ll,Ml,Ul,jl,Fl,Vl,Bl,Wl,Gl,ql,Kl,Hl,zl,Yl,Ql={sid:"",lts:0,success:null,cname:null,uid:null,peer:null,cid:null,elapse:null,extend:null,vid:0};!function(e){e.PUBLISH="publish",e.SUBSCRIBE="subscribe",e.SESSION_INIT="session_init",e.JOIN_CHOOSE_SERVER="join_choose_server",e.REQ_USER_ACCOUNT="req_user_account",e.JOIN_GATEWAY="join_gateway",e.STREAM_SWITCH="stream_switch",e.REQUEST_PROXY_WORKER_MANAGER="request_proxy_worker_manager",e.REQUEST_PROXY_APPCENTER="request_proxy_appcenter",e.FIRST_VIDEO_RECEIVED="first_video_received",e.FIRST_AUDIO_RECEIVED="first_audio_received",e.FIRST_VIDEO_DECODE="first_video_decode",e.FIRST_AUDIO_DECODE="first_audio_decode",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_UPDATE_STREAM="on_update_stream",e.ON_REMOVE_STREAM="on_remove_stream",e.USER_ANALYTICS="req_user_analytics"}(Cl||(Cl={})),function(e){e.SESSION="io.agora.pb.Wrtc.Session",e.JOIN_CHOOSE_SERVER="io.agora.pb.Wrtc.JoinChooseServer",e.REQ_USER_ACCOUNT="io.agora.pb.Wrtc.ReqUserAccount",e.JOIN_GATEWAT="io.agora.pb.Wrtc.JoinGateway",e.PUBLISH="io.agora.pb.Wrtc.Publish",e.SUBSCRIBE="io.agora.pb.Wrtc.Subscribe",e.STREAM_SWITCH="io.agora.pb.Wrtc.StreamSwitch",e.AUDIO_SENDING_STOPPED="io.agora.pb.Wrtc.AudioSendingStopped",e.VIDEO_SENDING_STOPPED="io.agora.pb.Wrtc.VideoSendingStopped",e.REQUEST_PROXY_APPCENTER="io.agora.pb.Wrtc.RequestProxyAppCenter",e.REQUEST_PROXY_WORKER_MANAGER="io.agora.pb.Wrtc.RequestProxyWorkerManager",e.API_INVOKE="io.agora.pb.Wrtc.ApiInvoke",e.FIRST_VIDEO_RECEIVED="io.agora.pb.Wrtc.FirstVideoReceived",e.FIRST_AUDIO_RECEIVED="io.agora.pb.Wrtc.FirstAudioReceived",e.FIRST_VIDEO_DECODE="io.agora.pb.Wrtc.FirstVideoDecode",e.FIRST_AUDIO_DECODE="io.agora.pb.Wrtc.FirstAudioDecode",e.ON_ADD_AUDIO_STREAM="io.agora.pb.Wrtc.OnAddAudioStream",e.ON_ADD_VIDEO_STREAM="io.agora.pb.Wrtc.OnAddVideoStream",e.ON_UPDATE_STREAM="io.agora.pb.Wrtc.OnUpdateStream",e.ON_REMOVE_STREAM="io.agora.pb.Wrtc.OnRemoveStream",e.JOIN_CHANNEL_TIMEOUT="io.agora.pb.Wrtc.JoinChannelTimeout",e.PEER_PUBLISH_STATUS="io.agora.pb.Wrtc.PeerPublishStatus",e.WORKER_EVENT="io.agora.pb.Wrtc.WorkerEvent",e.AP_WORKER_EVENT="io.agora.pb.Wrtc.APWorkerEvent",e.JOIN_WEB_PROXY_AP="io.agora.pb.Wrtc.JoinWebProxyAP",e.WEBSOCKET_QUIT="io.agora.pb.Wrtc.WebSocketQuit",e.USER_ANALYTICS="io.agora.pb.Wrtc.UserAnalytics"}(kl||(kl={})),function(e){e[e.WORKER_EVENT=156]="WORKER_EVENT",e[e.AP_WORKER_EVENT=160]="AP_WORKER_EVENT"}(Ol||(Ol={})),function(e){e.CREATE_CLIENT="createClient",e.CHECK_SYSTEM_REQUIREMENTS="checkSystemRequirements",e.CHECK_VIDEO_TRACK_IS_ACTIVE="checkVideoTrackIsActive",e.CHECK_AUDIO_TRACK_IS_ACTIVE="checkAudioTrackIsActive",e.CREATE_MIC_AUDIO_TRACK="createMicrophoneAudioTrack",e.CREATE_CUSTOM_AUDIO_TRACK="createCustomAudioTrack",e.CREATE_BUFFER_AUDIO_TRACK="createBufferSourceAudioTrack",e.CREATE_CAM_VIDEO_TRACK="createCameraVideoTrack",e.CREATE_CUSTOM_VIDEO_TRACK="createCustomVideoTrack",e.CREATE_MIC_AND_CAM_TRACKS="createMicrophoneAndCameraTracks",e.CREATE_SCREEN_VIDEO_TRACK="createScreenVideoTrack",e.SET_ENCRYPTION_CONFIG="Client.setEncryptionConfig",e.START_PROXY_SERVER="Client.startProxyServer",e.STOP_PROXY_SERVER="Client.stopProxyServer",e.SET_PROXY_SERVER="Client.setProxyServer",e.SET_TURN_SERVER="Client.setTurnServer",e.SET_CLIENT_ROLE="Client.setClientRole",e.SET_LOW_STREAM_PARAMETER="Client.setLowStreamParameter",e.ENABLE_DUAL_STREAM="Client.enableDualStream",e.DISABLE_DUAL_STREAM="Client.disableDualStream",e.JOIN="Client.join",e.LEAVE="Client.leave",e.PUBLISH="Client.publish",e.UNPUBLISH="Client.unpublish",e.SUBSCRIBE="Client.subscribe",e.UNSUBSCRIBE="Client.unsubscribe",e.RENEW_TOKEN="Client.renewToken",e.SET_REMOTE_VIDEO_STREAM_TYPE="Client.setRemoteVideoStreamType",e.SET_STREAM_FALLBACK_OPTION="Client.setStreamFallbackOption",e.ENABLE_AUDIO_VOLUME_INDICATOR="Client.enableAudioVolumeIndicator",e.SEND_CUSTOM_REPORT_MESSAGE="Client.sendCustomReportMessage",e.ON_LIVE_STREAM_WARNING="Client.onLiveStreamWarning",e.ON_LIVE_STREAM_ERROR="Client.onLiveStreamingError",e.START_LIVE_STREAMING="Client.startLiveStreaming",e.SET_LIVE_TRANSCODING="Client.setLiveTranscoding",e.STOP_LIVE_STREAMING="Client.stopLiveStreaming",e.ADD_INJECT_STREAM_URL="Client.addInjectStreamUrl",e.REMOVE_INJECT_STREAM_URL="Client.removeInjectStreamUrl",e.START_CHANNEL_MEDIA_RELAY="Client.startChannelMediaRelay",e.UPDATE_CHANNEL_MEDIA_RELAY="Client.updateChannelMediaRelay",e.STOP_CHANNEL_MEDIA_RELAY="Client.stopChannelMediaRelay",e.REQUEST_CONFIG_DISTRIBUTE="_config-distribute-request",e.SET_CONFIG_DISTRIBUTE="_configDistribute",e.LOCAL_TRACK_SET_MUTED="LocalTrack.setMute",e.LOCAL_AUDIO_TRACK_PLAY="LocalAudioTrack.play",e.LOCAL_AUDIO_TRACK_PLAY_IN_ELEMENT="LocalAudioTrack.playInElement",e.LOCAL_AUDIO_TRACK_STOP="LocalAudioTrack.stop",e.LOCAL_AUDIO_TRACK_SET_VOLUME="LocalAudioTrack.setVolume",e.MIC_AUDIO_TRACK_SET_DEVICE="MicrophoneAudioTrack.setDevice",e.BUFFER_AUDIO_TRACK_START="BufferSourceAudioTrack.startProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_STOP="BufferSourceAudioTrack.stopProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_PAUSE="BufferSourceAudioTrack.pauseProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_RESUME="BufferSourceAudioTrack.resumeProcessAudioBuffer",e.BUFFER_AUDIO_TRACK_SEEK="BufferSourceAudioTrack.seekAudioBuffer",e.LOCAL_VIDEO_TRACK_PLAY="LocalVideoTrack.play",e.LOCAL_VIDEO_TRACK_STOP="LocalVideoTrack.stop",e.LOCAL_VIDEO_TRACK_BEAUTY="LocalVideoTrack.setBeautyEffect",e.CAM_VIDEO_TRACK_SET_DEVICE="CameraVideoTrack.setDevice",e.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG="CameraVideoTrack.setEncoderConfiguration",e.REMOTE_VIDEO_TRACK_PLAY="RemoteVideoTrack.play",e.REMOTE_VIDEO_TRACK_STOP="RemoteVideoTrack.stop",e.REMOTE_AUDIO_TRACK_PLAY="RemoteAudioTrack.play",e.REMOTE_AUDIO_TRACK_STOP="RemoteAudioTrack.stop",e.REMOTE_AUDIO_SET_VOLUME="RemoteAudioTrack.setVolume",e.REMOTE_AUDIO_SET_OUTPUT_DEVICE="RemoteAudioTrack.setOutputDevice",e.STREAM_TYPE_CHANGE="streamTypeChange"}(Nl||(Nl={})),(Pl||(Pl={})).TRACER="tracer",function(e){e.IDLE="IDLE",e.INITING="INITING",e.INITEND="INITEND"}(Dl||(Dl={})),function(e){e.STATE_CHANGE="state_change",e.RECORDING_DEVICE_CHANGED="recordingDeviceChanged",e.PLAYOUT_DEVICE_CHANGED="playoutDeviceChanged",e.CAMERA_DEVICE_CHANGED="cameraDeviceChanged"}(xl||(xl={})),function(e){e[e.ACCESS_POINT=101]="ACCESS_POINT",e[e.UNILBS=201]="UNILBS",e[e.STRING_UID_ALLOCATOR=901]="STRING_UID_ALLOCATOR"}(Ll||(Ll={})),function(e){e[e.IIIEGAL_APPID=1]="IIIEGAL_APPID",e[e.IIIEGAL_UID=2]="IIIEGAL_UID",e[e.INTERNAL_ERROR=3]="INTERNAL_ERROR"}(Ml||(Ml={})),function(e){e[e.INVALID_VENDOR_KEY=5]="INVALID_VENDOR_KEY",e[e.INVALID_CHANNEL_NAME=7]="INVALID_CHANNEL_NAME",e[e.INTERNAL_ERROR=8]="INTERNAL_ERROR",e[e.NO_AUTHORIZED=9]="NO_AUTHORIZED",e[e.DYNAMIC_KEY_TIMEOUT=10]="DYNAMIC_KEY_TIMEOUT",e[e.NO_ACTIVE_STATUS=11]="NO_ACTIVE_STATUS",e[e.DYNAMIC_KEY_EXPIRED=13]="DYNAMIC_KEY_EXPIRED",e[e.STATIC_USE_DYNAMIC_KEY=14]="STATIC_USE_DYNAMIC_KEY",e[e.DYNAMIC_USE_STATIC_KEY=15]="DYNAMIC_USE_STATIC_KEY",e[e.USER_OVERLOAD=16]="USER_OVERLOAD",e[e.FORBIDDEN_REGION=18]="FORBIDDEN_REGION",e[e.CANNOT_MEET_AREA_DEMAND=19]="CANNOT_MEET_AREA_DEMAND"}(Ul||(Ul={})),function(e){e[e.NO_FLAG_SET=100]="NO_FLAG_SET",e[e.FLAG_SET_BUT_EMPTY=101]="FLAG_SET_BUT_EMPTY",e[e.INVALID_FALG_SET=102]="INVALID_FALG_SET",e[e.NO_SERVICE_AVAILABLE=200]="NO_SERVICE_AVAILABLE",e[e.NO_SERVICE_AVAILABLE_P2P=201]="NO_SERVICE_AVAILABLE_P2P",e[e.NO_SERVICE_AVAILABLE_VOICE=202]="NO_SERVICE_AVAILABLE_VOICE",e[e.NO_SERVICE_AVAILABLE_WEBRTC=203]="NO_SERVICE_AVAILABLE_WEBRTC",e[e.NO_SERVICE_AVAILABLE_CDS=204]="NO_SERVICE_AVAILABLE_CDS",e[e.NO_SERVICE_AVAILABLE_CDN=205]="NO_SERVICE_AVAILABLE_CDN",e[e.NO_SERVICE_AVAILABLE_TDS=206]="NO_SERVICE_AVAILABLE_TDS",e[e.NO_SERVICE_AVAILABLE_REPORT=207]="NO_SERVICE_AVAILABLE_REPORT",e[e.NO_SERVICE_AVAILABLE_APP_CENTER=208]="NO_SERVICE_AVAILABLE_APP_CENTER",e[e.NO_SERVICE_AVAILABLE_ENV0=209]="NO_SERVICE_AVAILABLE_ENV0",e[e.NO_SERVICE_AVAILABLE_VOET=210]="NO_SERVICE_AVAILABLE_VOET",e[e.NO_SERVICE_AVAILABLE_STRING_UID=211]="NO_SERVICE_AVAILABLE_STRING_UID",e[e.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS=212]="NO_SERVICE_AVAILABLE_WEBRTC_UNILBS",e[e.NO_SERVICE_AVAILABLE_UNILBS_FLV=213]="NO_SERVICE_AVAILABLE_UNILBS_FLV"}(jl||(jl={})),function(e){e[e.K_TIMESTAMP_EXPIRED=2]="K_TIMESTAMP_EXPIRED",e[e.K_CHANNEL_PERMISSION_INVALID=3]="K_CHANNEL_PERMISSION_INVALID",e[e.K_CERTIFICATE_INVALID=4]="K_CERTIFICATE_INVALID",e[e.K_CHANNEL_NAME_EMPTY=5]="K_CHANNEL_NAME_EMPTY",e[e.K_CHANNEL_NOT_FOUND=6]="K_CHANNEL_NOT_FOUND",e[e.K_TICKET_INVALID=7]="K_TICKET_INVALID",e[e.K_CHANNEL_CONFLICTED=8]="K_CHANNEL_CONFLICTED",e[e.K_SERVICE_NOT_READY=9]="K_SERVICE_NOT_READY",e[e.K_SERVICE_TOO_HEAVY=10]="K_SERVICE_TOO_HEAVY",e[e.K_UID_BANNED=14]="K_UID_BANNED",e[e.K_IP_BANNED=15]="K_IP_BANNED",e[e.K_CHANNEL_BANNED=16]="K_CHANNEL_BANNED",e[e.WARN_NO_AVAILABLE_CHANNEL=103]="WARN_NO_AVAILABLE_CHANNEL",e[e.WARN_LOOKUP_CHANNEL_TIMEOUT=104]="WARN_LOOKUP_CHANNEL_TIMEOUT",e[e.WARN_LOOKUP_CHANNEL_REJECTED=105]="WARN_LOOKUP_CHANNEL_REJECTED",e[e.WARN_OPEN_CHANNEL_TIMEOUT=106]="WARN_OPEN_CHANNEL_TIMEOUT",e[e.WARN_OPEN_CHANNEL_REJECTED=107]="WARN_OPEN_CHANNEL_REJECTED",e[e.WARN_REQUEST_DEFERRED=108]="WARN_REQUEST_DEFERRED",e[e.ERR_DYNAMIC_KEY_TIMEOUT=109]="ERR_DYNAMIC_KEY_TIMEOUT",e[e.ERR_NO_AUTHORIZED=110]="ERR_NO_AUTHORIZED",e[e.ERR_VOM_SERVICE_UNAVAILABLE=111]="ERR_VOM_SERVICE_UNAVAILABLE",e[e.ERR_NO_CHANNEL_AVAILABLE_CODE=112]="ERR_NO_CHANNEL_AVAILABLE_CODE",e[e.ERR_MASTER_VOCS_UNAVAILABLE=114]="ERR_MASTER_VOCS_UNAVAILABLE",e[e.ERR_INTERNAL_ERROR=115]="ERR_INTERNAL_ERROR",e[e.ERR_NO_ACTIVE_STATUS=116]="ERR_NO_ACTIVE_STATUS",e[e.ERR_INVALID_UID=117]="ERR_INVALID_UID",e[e.ERR_DYNAMIC_KEY_EXPIRED=118]="ERR_DYNAMIC_KEY_EXPIRED",e[e.ERR_STATIC_USE_DYANMIC_KE=119]="ERR_STATIC_USE_DYANMIC_KE",e[e.ERR_DYNAMIC_USE_STATIC_KE=120]="ERR_DYNAMIC_USE_STATIC_KE",e[e.ERR_NO_VOCS_AVAILABLE=2e3]="ERR_NO_VOCS_AVAILABLE",e[e.ERR_NO_VOS_AVAILABLE=2001]="ERR_NO_VOS_AVAILABLE",e[e.ERR_JOIN_CHANNEL_TIMEOUT=2002]="ERR_JOIN_CHANNEL_TIMEOUT",e[e.ERR_REPEAT_JOIN_CHANNEL=2003]="ERR_REPEAT_JOIN_CHANNEL",e[e.ERR_JOIN_BY_MULTI_IP=2004]="ERR_JOIN_BY_MULTI_IP",e[e.ERR_NOT_JOINED=2011]="ERR_NOT_JOINED",e[e.ERR_REPEAT_JOIN_REQUEST=2012]="ERR_REPEAT_JOIN_REQUEST",e[e.ERR_INVALID_VENDOR_KEY=2013]="ERR_INVALID_VENDOR_KEY",e[e.ERR_INVALID_CHANNEL_NAME=2014]="ERR_INVALID_CHANNEL_NAME",e[e.ERR_INVALID_STRINGUID=2015]="ERR_INVALID_STRINGUID",e[e.ERR_TOO_MANY_USERS=2016]="ERR_TOO_MANY_USERS",e[e.ERR_SET_CLIENT_ROLE_TIMEOUT=2017]="ERR_SET_CLIENT_ROLE_TIMEOUT",e[e.ERR_SET_CLIENT_ROLE_NO_PERMISSION=2018]="ERR_SET_CLIENT_ROLE_NO_PERMISSION",e[e.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE=2019]="ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",e[e.ERR_PUBLISH_REQUEST_INVALID=2020]="ERR_PUBLISH_REQUEST_INVALID",e[e.ERR_SUBSCRIBE_REQUEST_INVALID=2021]="ERR_SUBSCRIBE_REQUEST_INVALID",e[e.ERR_NOT_SUPPORTED_MESSAGE=2022]="ERR_NOT_SUPPORTED_MESSAGE",e[e.ERR_ILLEAGAL_PLUGIN=2023]="ERR_ILLEAGAL_PLUGIN",e[e.ERR_REJOIN_TOKEN_INVALID=2024]="ERR_REJOIN_TOKEN_INVALID",e[e.ERR_REJOIN_USER_NOT_JOINED=2025]="ERR_REJOIN_USER_NOT_JOINED",e[e.ERR_INVALID_OPTIONAL_INFO=2027]="ERR_INVALID_OPTIONAL_INFO",e[e.ILLEGAL_AES_PASSWORD=2028]="ILLEGAL_AES_PASSWORD",e[e.ILLEGAL_CLIENT_ROLE_LEVEL=2029]="ILLEGAL_CLIENT_ROLE_LEVEL",e[e.ERR_TEST_RECOVER=9e3]="ERR_TEST_RECOVER",e[e.ERR_TEST_TRYNEXT=9001]="ERR_TEST_TRYNEXT",e[e.ERR_TEST_RETRY=9002]="ERR_TEST_RETRY"}(Fl||(Fl={})),function(e){e.CONNECTION_STATE_CHANGE="connection-state-change",e.MEDIA_RECONNECT_START="media-reconnect-start",e.MEDIA_RECONNECT_END="media-reconnect-end",e.IS_USING_CLOUD_PROXY="is-using-cloud-proxy",e.USER_JOINED="user-joined",e.USER_LEAVED="user-left",e.USER_PUBLISHED="user-published",e.USER_UNPUBLISHED="user-unpublished",e.USER_INFO_UPDATED="user-info-updated",e.CLIENT_BANNED="client-banned",e.CHANNEL_MEDIA_RELAY_STATE="channel-media-relay-state",e.CHANNEL_MEDIA_RELAY_EVENT="channel-media-relay-event",e.VOLUME_INDICATOR="volume-indicator",e.CRYPT_ERROR="crypt-error",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="token-privilege-will-expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="token-privilege-did-expire",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGED="stream-type-changed",e.STREAM_FALLBACK="stream-fallback",e.RECEIVE_METADATA="receive-metadata",e.STREAM_MESSAGE="stream-message",e.LIVE_STREAMING_ERROR="live-streaming-error",e.LIVE_STREAMING_WARNING="live-streaming-warning",e.INJECT_STREAM_STATUS="stream-inject-status",e.EXCEPTION="exception",e.ERROR="error"}(Vl||(Vl={})),function(e){e.NETWORK_ERROR="NETWORK_ERROR",e.SERVER_ERROR="SERVER_ERROR",e.MULTI_IP="MULTI_IP",e.TIMEOUT="TIMEOUT",e.OFFLINE="OFFLINE",e.LEAVE="LEAVE"}(Bl||(Bl={})),function(e){e.CONNECTING="connecting",e.CONNECTED="connected",e.RECONNECTING="reconnecting",e.CLOSED="closed"}(Wl||(Wl={})),function(e){e.WS_CONNECTED="ws_connected",e.WS_RECONNECTING="ws_reconnecting",e.WS_CLOSED="ws_closed",e.ON_BINARY_DATA="on_binary_data",e.REQUEST_RECOVER="request_recover",e.REQUEST_JOIN_INFO="request_join_info",e.REQUEST_REJOIN_INFO="req_rejoin_info",e.IS_P2P_DISCONNECTED="is_p2p_dis",e.DISCONNECT_P2P="dis_p2p",e.NEED_RENEW_SESSION="need-sid",e.REPORT_JOIN_GATEWAY="report_join_gateway",e.REQUEST_TIMEOUT="request_timeout",e.REQUEST_SUCCESS="request_success"}(Gl||(Gl={})),function(e){e.PING="ping",e.PING_BACK="ping_back",e.JOIN="join_v2",e.REJOIN="rejoin",e.LEAVE="leave",e.SET_CLIENT_ROLE="set_client_role",e.PUBLISH="publish",e.UNPUBLISH="unpublish",e.SUBSCRIBE="subscribe",e.UNSUBSCRIBE="unsubscribe",e.SUBSCRIBE_CHANGE="subscribe_change",e.TRAFFIC_STATS="traffic_stats",e.RENEW_TOKEN="renew_token",e.SWITCH_VIDEO_STREAM="switch_video_stream",e.SET_FALLBACK_OPTION="set_fallback_option",e.GATEWAY_INFO="gateway_info",e.CONTROL="control",e.SEND_METADATA="send_metadata",e.DATA_STREAM="data_stream",e.PICK_SVC_LAYER="pick_svc_layer"}(ql||(ql={})),function(e){e.PUBLISH_STATS="publish_stats",e.PUBLISH_RELATED_STATS="publish_related_stats",e.SUBSCRIBE_STATS="subscribe_stats",e.SUBSCRIBE_RELATED_STATS="subscribe_related_stats"}(Kl||(Kl={})),function(e){e.ON_USER_ONLINE="on_user_online",e.ON_USER_OFFLINE="on_user_offline",e.ON_STREAM_FALLBACK_UPDATE="on_stream_fallback_update",e.ON_PUBLISH_STREAM="on_publish_stream",e.ON_UPLINK_STATS="on_uplink_stats",e.ON_P2P_LOST="on_p2p_lost",e.ON_REMOVE_STREAM="on_remove_stream",e.ON_ADD_AUDIO_STREAM="on_add_audio_stream",e.ON_ADD_VIDEO_STREAM="on_add_video_stream",e.ON_TOKEN_PRIVILEGE_WILL_EXPIRE="on_token_privilege_will_expire",e.ON_TOKEN_PRIVILEGE_DID_EXPIRE="on_token_privilege_did_expire",e.ON_USER_BANNED="on_user_banned",e.ON_NOTIFICATION="on_notification",e.ON_CRYPT_ERROR="on_crypt_error",e.MUTE_AUDIO="mute_audio",e.MUTE_VIDEO="mute_video",e.UNMUTE_AUDIO="unmute_audio",e.UNMUTE_VIDEO="unmute_video",e.RECEIVE_METADATA="receive_metadata",e.ON_DATA_STREAM="on_data_stream",e.ENABLE_LOCAL_VIDEO="enable_local_video",e.DISABLE_LOCAL_VIDEO="disable_local_video",e.ENABLE_LOCAL_AUDIO="enable_local_audio",e.DISABLE_LOCAL_AUDIO="disable_local_audio"}(Hl||(Hl={})),function(e){e.CONNECTION_STATE_CHANGE="CONNECTION_STATE_CHANGE",e.NEED_ANSWER="NEED_ANSWER",e.NEED_RENEGOTIATE="NEED_RENEGOTIATE",e.P2P_LOST="P2P_LOST",e.GATEWAY_P2P_LOST="GATEWAY_P2P_LOST",e.NEED_UNPUB="NEED_UNPUB",e.NEED_UNSUB="NEED_UNSUB",e.NEED_UPLOAD="NEED_UPLOAD",e.START_RECONNECT="START_RECONNECT",e.END_RECONNECT="END_RECONNECT",e.NEED_SIGNAL_RTT="NEED_SIGNAL_RTT"}(zl||(zl={})),function(e){e.AUDIO_SOURCE_STATE_CHANGE="audio_source_state_change",e.RECEIVE_TRACK_BUFFER="receive_track_buffer",e.ON_AUDIO_BUFFER="on_audio_buffer"}(Yl||(Yl={}));var Xl,Jl,$l={sendVolumeLevel:0,sendBitrate:0,sendBytes:0,sendPackets:0,sendPacketsLost:0},Zl={sendBytes:0,sendBitrate:0,sendPackets:0,sendPacketsLost:0,sendResolutionHeight:0,sendResolutionWidth:0,captureResolutionHeight:0,captureResolutionWidth:0,targetSendBitrate:0,totalDuration:0,totalFreezeTime:0},ed={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveLevel:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,publishDuration:-1},td={uplinkNetworkQuality:0,downlinkNetworkQuality:0},nd={transportDelay:0,end2EndDelay:0,receiveBitrate:0,receiveBytes:0,receiveDelay:0,receivePackets:0,receivePacketsLost:0,receiveResolutionHeight:0,receiveResolutionWidth:0,totalDuration:0,totalFreezeTime:0,freezeRate:0,packetLossRate:0,publishDuration:-1};!function(e){e.CONNECTED="websocket:connected",e.RECONNECTING="websocket:reconnecting",e.WILL_RECONNECT="websocket:will_reconnect",e.CLOSED="websocket:closed",e.FAILED="websocket:failed",e.ON_MESSAGE="websocket:on_message",e.REQUEST_NEW_URLS="websocket:request_new_urls"}(Xl||(Xl={})),function(e){e.TRANSCODE="mix_streaming",e.RAW="raw_streaming",e.INJECT="inject_streaming"}(Jl||(Jl={}));var rd,id,od,ad,sd,cd,ud,ld,dd,fd,hd={alpha:1,height:640,width:360,x:0,y:0,zOrder:0,audioChannel:0},pd={x:0,y:0,width:160,height:160,zOrder:255,alpha:1},vd={audioBitrate:48,audioChannels:1,audioSampleRate:48e3,backgroundColor:0,height:360,lowLatency:!1,videoBitrate:400,videoCodecProfile:100,videoCodecType:1,videoFrameRate:15,videoGop:30,width:640,images:[],userConfigs:[],userConfigExtraInfo:""},md={audioBitrate:48,audioChannels:2,audioVolume:100,audioSampleRate:48e3,height:0,width:0,videoBitrate:400,videoFramerate:15,videoGop:30};!function(e){e.WARNING="@live_uap-warning",e.ERROR="@line_uap-error",e.PUBLISH_STREAM_STATUS="@live_uap-publish-status",e.INJECT_STREAM_STATUS="@live_uap-inject-status",e.WORKER_STATUS="@live_uap-worker-status",e.REQUEST_NEW_ADDRESS="@live_uap-request-address"}(rd||(rd={})),(id||(id={})).REQUEST_WORKER_MANAGER_LIST="@live_req_worker_manager",function(e){e[e.LIVE_STREAM_RESPONSE_SUCCEED=200]="LIVE_STREAM_RESPONSE_SUCCEED",e[e.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM=454]="LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM",e[e.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR=450]="LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_BAD_STREAM=451]="LIVE_STREAM_RESPONSE_BAD_STREAM",e[e.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR=400]="LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR",e[e.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST=404]="LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST",e[e.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED=456]="LIVE_STREAM_RESPONSE_NOT_AUTHORIZED",e[e.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE=457]="LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE",e[e.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN=429]="LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN",e[e.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH=452]="LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH",e[e.LIVE_STREAM_RESPONSE_NOT_SUPPORTED=453]="LIVE_STREAM_RESPONSE_NOT_SUPPORTED",e[e.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM=455]="LIVE_STREAM_RESPONSE_MAX_STREAM_NUM",e[e.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR=500]="LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR",e[e.LIVE_STREAM_RESPONSE_WORKER_LOST=501]="LIVE_STREAM_RESPONSE_WORKER_LOST",e[e.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT=502]="LIVE_STREAM_RESPONSE_RESOURCE_LIMIT",e[e.LIVE_STREAM_RESPONSE_WORKER_QUIT=503]="LIVE_STREAM_RESPONSE_WORKER_QUIT",e[e.ERROR_FAIL_SEND_MESSAGE=504]="ERROR_FAIL_SEND_MESSAGE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE=30]="PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT=31]="PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT",e[e.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH=32]="PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH",e[e.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN=33]="PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN"}(od||(od={})),function(e){e.CONNECT_FAILED="connect failed",e.CONNECT_TIMEOUT="connect timeout",e.WS_DISCONNECTED="websocket disconnected",e.REQUEST_TIMEOUT="request timeout",e.REQUEST_FAILED="request failed",e.WAIT_STATUS_TIMEOUT="wait status timeout",e.WAIT_STATUS_ERROR="wait status error",e.BAD_STATE="bad state",e.WS_ABORT="ws abort",e.AP_REQUEST_TIMEOUT="AP request timeout",e.AP_JSON_PARSE_ERROR="AP json parse error",e.AP_REQUEST_ERROR="AP request error",e.AP_REQUEST_ABORT="AP request abort"}(ad||(ad={})),function(e){e[e.SetSdkProfile=0]="SetSdkProfile",e[e.SetSourceChannel=1]="SetSourceChannel",e[e.SetSourceUserId=2]="SetSourceUserId",e[e.SetDestChannel=3]="SetDestChannel",e[e.StartPacketTransfer=4]="StartPacketTransfer",e[e.StopPacketTransfer=5]="StopPacketTransfer",e[e.UpdateDestChannel=6]="UpdateDestChannel",e[e.Reconnect=7]="Reconnect",e[e.SetVideoProfile=8]="SetVideoProfile"}(sd||(sd={})),function(e){e.DISCONNECT="disconnect",e.CONNECTION_STATE_CHANGE="connection-state-change",e.NETWORK_QUALITY="network-quality",e.STREAM_TYPE_CHANGE="stream-type-change",e.IS_P2P_DISCONNECTED="is-p2p-dis",e.DISCONNECT_P2P="dis-p2p",e.REQUEST_NEW_GATEWAY_LIST="req-gate-url",e.NEED_RENEW_SESSION="need-sid"}(cd||(cd={})),function(e){e.NEED_RENEGOTIATE="@need_renegotiate",e.NEED_REPLACE_TRACK="@need_replace_track",e.NEED_CLOSE="@need_close",e.NEED_ADD_TRACK="@need_add_track",e.NEED_REMOVE_TRACK="@need_remove_track",e.NEED_SESSION_ID="@need_sid",e.SET_OPTIMIZATION_MODE="@set_optimization_mode",e.GET_STATS="@get_stats",e.GET_LOW_VIDEO_TRACK="@get_low_video_track",e.NEED_RESET_REMOTE_SDP="@need_reset_remote_sdp"}(ud||(ud={})),function(e){e.SCREEN_TRACK="screen_track",e.LOW_STREAM="low_stream"}(ld||(ld={})),function(e){e.SOURCE_STATE_CHANGE="source-state-change",e.TRACK_ENDED="track-ended",e.BEAUTY_EFFECT_OVERLOAD="beauty-effect-overload"}(dd||(dd={})),(fd||(fd={})).FIRST_FRAME_DECODED="first-frame-decoded";var gd,yd="AFRICA ASIA CHINA EUROPE GLOBAL INDIA JAPAN NORTH_AMERICA OCEANIA OVERSEA SOUTH_AMERICA".split(" ");!function(e){e.CHINA="CN",e.ASIA="AS",e.NORTH_AMERICA="NA",e.EUROPE="EU",e.JAPAN="JP",e.INDIA="IN",e.OCEANIA="OC",e.SOUTH_AMERICA="SA",e.AFRICA="AF",e.OVERSEA="OVERSEA",e.GLOBAL="GLOBAL"}(gd||(gd={}));var _d,bd={CHINA:{},ASIA:{CODE:gd.ASIA,WEBCS_DOMAIN:["ap-web-1-asia.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-asia.agora.io"],PROXY_CS:["proxy-ap-web-asia.agora.io"],CDS_AP:["cds-ap-web-asia.agora.io","cds-ap-web-asia2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-asia.agora.io","sua-ap-web-asia2.agora.io"],UAP_AP:["uap-ap-web-asia.agora.io","uap-ap-web-asia2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-asia.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-asia.agora.io"],LOG_UPLOAD_SERVER:["logservice-asia.agora.io"],PROXY_SERVER_TYPE3:["southeast-asia.webrtc-cloud-proxy.sd-rtn.com"]},NORTH_AMERICA:{CODE:gd.NORTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-north-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-north-america.agora.io"],PROXY_CS:["proxy-ap-web-america.agora.io"],CDS_AP:["cds-ap-web-america.agora.io","cds-ap-web-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-america.agora.io","sua-ap-web-america2.agora.io"],UAP_AP:["uap-ap-web-america.agora.io","uap-ap-web-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-north-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-north-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-north-america.agora.io"],PROXY_SERVER_TYPE3:["east-usa.webrtc-cloud-proxy.sd-rtn.com"]},EUROPE:{CODE:gd.EUROPE,WEBCS_DOMAIN:["ap-web-1-europe.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-europe.agora.io"],PROXY_CS:["proxy-ap-web-europe.agora.io"],CDS_AP:["cds-ap-web-europe.agora.io","cds-ap-web-europe2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-europe.agora.io","sua-ap-web-europe.agora.io"],UAP_AP:["uap-ap-web-europe.agora.io","uap-ap-web-europe2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-europe.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-europe.agora.io"],LOG_UPLOAD_SERVER:["logservice-europe.agora.io"],PROXY_SERVER_TYPE3:["europe.webrtc-cloud-proxy.sd-rtn.com"]},JAPAN:{CODE:gd.JAPAN,WEBCS_DOMAIN:["ap-web-1-japan.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-japan.agora.io"],PROXY_CS:["proxy-ap-web-japan.agora.io"],CDS_AP:["cds-ap-web-japan.agora.io","cds-ap-web-japan2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-japan.agora.io","sua-ap-web-japan2.agora.io"],UAP_AP:["uap-ap-web-japan.agora.io","\tuap-ap-web-japan2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-japan.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-japan.agora.io"],LOG_UPLOAD_SERVER:["logservice-japan.agora.io"],PROXY_SERVER_TYPE3:["japan.webrtc-cloud-proxy.sd-rtn.com"]},INDIA:{CODE:gd.INDIA,WEBCS_DOMAIN:["ap-web-1-india.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-india.agora.io"],PROXY_CS:["proxy-ap-web-india.agora.io"],CDS_AP:["cds-ap-web-india.agora.io","cds-ap-web-india2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-india.agora.io","sua-ap-web-india2.agora.io"],UAP_AP:["uap-ap-web-india.agora.io","uap-ap-web-india2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-india.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-india.agora.io"],LOG_UPLOAD_SERVER:["logservice-india.agora.io"],PROXY_SERVER_TYPE3:["india.webrtc-cloud-proxy.sd-rtn.com"]},OVERSEA:{CODE:gd.OVERSEA,WEBCS_DOMAIN:["ap-web-1-oversea.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oversea.agora.io"],PROXY_CS:["proxy-ap-web-oversea.agora.io"],CDS_AP:["cds-ap-web-oversea.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oversea.agora.io"],UAP_AP:["uap-ap-web-oversea.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oversea.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oversea.agora.io"],LOG_UPLOAD_SERVER:["logservice-oversea.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.agora.io"]},GLOBAL:{CODE:gd.GLOBAL,WEBCS_DOMAIN:["webrtc2-ap-web-1.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-ap-web-3.agora.io"],PROXY_CS:["ap-proxy-1.agora.io","ap-proxy-2.agora.io"],CDS_AP:["cds-ap-web-1.agora.io","cds-ap-web-3.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-1.agora.io","sua-ap-web-3.agora.io"],UAP_AP:["uap-ap-web-1.agora.io","uap-ap-web-3.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2.agora.io"],LOG_UPLOAD_SERVER:["logservice.agora.io"],PROXY_SERVER_TYPE3:["webrtc-cloud-proxy.sd-rtn.com"]},OCEANIA:{CODE:gd.OCEANIA,WEBCS_DOMAIN:["ap-web-1-oceania.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-oceania.agora.io"],PROXY_CS:["proxy-ap-web-oceania.agora.io"],CDS_AP:["cds-ap-web-oceania.agora.io","cds-ap-web-oceania2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-oceania.agora.io","sua-ap-web-oceania2.agora.io"],UAP_AP:["uap-ap-web-oceania.agora.io","uap-ap-web-oceania2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-oceania.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-oceania.agora.io"],LOG_UPLOAD_SERVER:["logservice-oceania.agora.io"],PROXY_SERVER_TYPE3:["oceania.webrtc-cloud-proxy.sd-rtn.com"]},SOUTH_AMERICA:{CODE:gd.SOUTH_AMERICA,WEBCS_DOMAIN:["ap-web-1-south-america.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-south-america.agora.io"],PROXY_CS:["proxy-ap-web-south-america.agora.io"],CDS_AP:["cds-ap-web-south-america.agora.io","cds-ap-web-south-america2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-south-america.agora.io","sua-ap-web-south-america2.agora.io"],UAP_AP:["uap-ap-web-south-america.agora.io","uap-ap-web-south-america2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-south-america.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-south-america.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-america.agora.io"],PROXY_SERVER_TYPE3:["south-america.webrtc-cloud-proxy.sd-rtn.com"]},AFRICA:{CODE:gd.AFRICA,WEBCS_DOMAIN:["ap-web-1-africa.agora.io"],WEBCS_DOMAIN_BACKUP_LIST:["ap-web-2-africa.agora.io"],PROXY_CS:["proxy-ap-web-africa.agora.io"],CDS_AP:["cds-ap-web-africa.agora.io","cds-ap-web-africa2.agora.io"],ACCOUNT_REGISTER:["sua-ap-web-africa.agora.io","sua-ap-web-africa2.agora.io"],UAP_AP:["uap-ap-web-africa.agora.io","uap-ap-web-africa2.agora.io"],EVENT_REPORT_DOMAIN:["statscollector-1-africa.agora.io"],EVENT_REPORT_BACKUP_DOMAIN:["statscollector-2-africa.agora.io"],LOG_UPLOAD_SERVER:["logservice-south-africa.agora.io"],PROXY_SERVER_TYPE3:["africa.webrtc-cloud-proxy.sd-rtn.com"]}};Lu&&(bd.CHINA={CODE:gd.CHINA,WEBCS_DOMAIN:["webrtc2-2.ap.sd-rtn.com"],WEBCS_DOMAIN_BACKUP_LIST:["webrtc2-4.ap.sd-rtn.com"],PROXY_CS:["proxy-web.ap.sd-rtn.com"],CDS_AP:["cds-web-2.ap.sd-rtn.com","cds-web-4.ap.sd-rtn.com"],ACCOUNT_REGISTER:["sua-web-2.ap.sd-rtn.com","sua-web-4.ap.sd-rtn.com"],UAP_AP:["uap-web-2.ap.sd-rtn.com","uap-web-4.ap.sd-rtn.com"],EVENT_REPORT_DOMAIN:["web-3.statscollector.sd-rtn.com"],EVENT_REPORT_BACKUP_DOMAIN:["web-4.statscollector.sd-rtn.com"],LOG_UPLOAD_SERVER:["logservice-china.agora.io"],PROXY_SERVER_TYPE3:["east-cn.webrtc-cloud-proxy.sd-rtn.com"]}),(_d||(_d={})).UPDATE_BITRATE_LIMIT="update_bitrate_limit";var Ed={getDisplayMedia:!1,getStreamFromExtension:!1,supportUnifiedPlan:!1,supportMinBitrate:!1,supportSetRtpSenderParameters:!1,supportDualStream:!0,webAudioMediaStreamDest:!1,supportReplaceTrack:!1,supportWebGL:!1,webAudioWithAEC:!1,supportRequestFrame:!1,supportShareAudio:!1,supportDualStreamEncoding:!1};Fr({target:"Object",stat:!0,forced:!ir,sham:!ir},{defineProperties:yo});var wd=E((function(e){var t=Or.Object;e=e.exports=function(e,n){return t.defineProperties(e,n)},t.defineProperties.sham&&(e.sham=!0)})),Td=mo.concat("length","prototype"),Sd={f:Object.getOwnPropertyNames||function(e){return vo(e,Td)}},Id=Br("Reflect","ownKeys")||function(e){var t=Sd.f(Dr(e)),n=Ea.f;return n?t.concat(n(e)):t};Fr({target:"Object",stat:!0,sham:!ir},{getOwnPropertyDescriptors:function(e){var t,n;e=pr(e);for(var r=Tr,i=Id(e),o={},a=0;i.length>a;)void 0!==(n=r(e,t=i[a++]))&&Qa(o,t,n);return o}});var Rd=Or.Object.getOwnPropertyDescriptors,Ad=Sd.f,Cd={}.toString,kd="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[],Od=function(e){if(kd&&"[object Window]"==Cd.call(e))try{var t=Ad(e)}catch(n){t=kd.slice()}else t=Ad(pr(e));return t},Nd={f:ci},Pd=Lr.f,Dd=Yi("hidden"),xd=ci("toPrimitive"),Ld=io.set,Md=io.getterFor("Symbol"),Ud=Object.prototype,jd=nr.Symbol,Fd=Br("JSON","stringify"),Vd=Tr,Bd=Lr.f,Wd=Od,Gd=sr,qd=ni("symbols"),Kd=ni("op-symbols"),Hd=ni("string-to-symbol-registry"),zd=ni("symbol-to-string-registry"),Yd=ni("wks"),Qd=nr.QObject,Xd=!Qd||!Qd.prototype||!Qd.prototype.findChild,Jd=ir&&rr((function(){return 7!=To(Bd({},"a",{get:function(){return Bd(this,"a",{value:7}).a}})).a}))?function(e,t,n){var r=Vd(Ud,t);r&&delete Ud[t],Bd(e,t,n),r&&e!==Ud&&Bd(Ud,t,r)}:Bd,$d=function(e,t){var n=qd[e]=To(jd.prototype);return Ld(n,{type:"Symbol",tag:e,description:t}),ir||(n.description=t),n},Zd=ri&&"symbol"==typeof jd.iterator?function(e){return"symbol"==typeof e}:function(e){return Object(e)instanceof jd},ef=function e(t,n,r){return t===Ud&&e(Kd,n,r),Dr(t),n=mr(n,!0),Dr(r),yr(qd,n)?(r.enumerable?(yr(t,Dd)&&t[Dd][n]&&(t[Dd][n]=!1),r=To(r,{enumerable:cr(0,!1)})):(yr(t,Dd)||Bd(t,Dd,cr(1,{})),t[Dd][n]=!0),Jd(t,n,r)):Bd(t,n,r)},tf=function(e,t){Dr(e);var n=pr(t);return t=go(n).concat(af(n)),ji(t,(function(t){ir&&!nf.call(n,t)||ef(e,t,n[t])})),e},nf=function(e){e=mr(e,!0);var t=Gd.call(this,e);return!(this===Ud&&yr(qd,e)&&!yr(Kd,e))&&(!(t||!yr(this,e)||!yr(qd,e)||yr(this,Dd)&&this[Dd][e])||t)},rf=function(e,t){if(e=pr(e),t=mr(t,!0),e!==Ud||!yr(qd,t)||yr(Kd,t)){var n=Vd(e,t);return!n||!yr(qd,t)||yr(e,Dd)&&e[Dd][t]||(n.enumerable=!0),n}},of=function(e){e=Wd(pr(e));var t=[];return ji(e,(function(e){yr(qd,e)||yr(Qr,e)||t.push(e)})),t},af=function(e){var t=e===Ud;e=Wd(t?Kd:pr(e));var n=[];return ji(e,(function(e){!yr(qd,e)||t&&!yr(Ud,e)||n.push(qd[e])})),n};if(ri||(Ao((jd=function(){if(this instanceof jd)throw TypeError("Symbol is not a constructor");var e=arguments.length&&void 0!==arguments[0]?String(arguments[0]):void 0,t=$r(e),n=function e(n){this===Ud&&e.call(Kd,n),yr(this,Dd)&&yr(this[Dd],t)&&(this[Dd][t]=!1),Jd(this,t,cr(1,n))};return ir&&Xd&&Jd(Ud,t,{configurable:!0,set:n}),$d(t,e)}).prototype,"toString",(function(){return Md(this).tag})),sr=nf,Lr.f=ef,Tr=rf,Sd.f=Od=of,Ea.f=af,ir&&Bd(jd.prototype,"description",{configurable:!0,get:function(){return Md(this).description}})),ii||(Nd.f=function(e){return $d(ci(e),e)}),Fr({global:!0,wrap:!0,forced:!ri,sham:!ri},{Symbol:jd}),ji(go(Yd),(function(e){var t=Or.Symbol||(Or.Symbol={});yr(t,e)||Pd(t,e,{value:Nd.f(e)})})),Fr({target:"Symbol",stat:!0,forced:!ri},{for:function(e){if(e=String(e),yr(Hd,e))return Hd[e];var t=jd(e);return Hd[e]=t,zd[t]=e,t},keyFor:function(e){if(!Zd(e))throw TypeError(e+" is not a symbol");if(yr(zd,e))return zd[e]},useSetter:function(){Xd=!0},useSimple:function(){Xd=!1}}),Fr({target:"Object",stat:!0,forced:!ri,sham:!ir},{create:function(e,t){return void 0===t?To(e):tf(To(e),t)},defineProperty:ef,defineProperties:tf,getOwnPropertyDescriptor:rf}),Fr({target:"Object",stat:!0,forced:!ri},{getOwnPropertyNames:of,getOwnPropertySymbols:af}),Fr({target:"Object",stat:!0,forced:rr((function(){Ea.f(1)}))},{getOwnPropertySymbols:function(e){return Ea.f(Pi(e))}}),Fd){var sf=!ri||rr((function(){var e=jd();return"[null]"!=Fd([e])||"{}"!=Fd({a:e})||"{}"!=Fd(Object(e))}));Fr({target:"JSON",stat:!0,forced:sf},{stringify:function(e,t,n){for(var r,i=[e],o=1;arguments.length>o;)i.push(arguments[o++]);if(r=t,(vr(t)||void 0!==e)&&!Zd(e))return Di(t)||(t=function(e,t){if("function"==typeof r&&(t=r.call(this,e,t)),!Zd(t))return t}),i[1]=t,Fd.apply(null,i)}})}jd.prototype[xd]||Mr(jd.prototype,xd,jd.prototype.valueOf),Ni(jd,"Symbol"),Qr[Dd]=!0;var cf=Or.Object.getOwnPropertySymbols,uf=function(e,t,n){return t in e?Pa(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e},lf=da("Array").values,df=Array.prototype,ff={DOMTokenList:!0,NodeList:!0},hf=function(e){var t=e.values;return e===df||e instanceof Array&&t===df.values||ff.hasOwnProperty(wi(e))?lf:t},pf=!bs((function(e){Array.from(e)}));Fr({target:"Array",stat:!0,forced:pf},{from:function(e){var t=Pi(e),n="function"==typeof this?this:Array,r=arguments.length,i=1<r?arguments[1]:void 0,o=void 0!==i,a=0,s=Si(t);if(o&&(i=Pr(i,2<r?arguments[2]:void 0,2)),null==s||n==Array&&fi(s))for(n=new n(r=gi(t.length));r>a;a++)Qa(n,a,o?i(t[a],a):t[a]);else for(r=(t=s.call(t)).next,n=new n;!(s=r.call(t)).done;a++)Qa(n,a,o?Ii(t,i,[s.value,a],!0):s.value);return n.length=a,n}});var vf=Or.Array.from;Fr({target:"Date",stat:!0},{now:function(){return(new Date).getTime()}});var mf,gf=Or.Date.now,yf=function(){function e(){f(this,e),this._events={},this.addListener=this.on}return h(e,[{key:"getListeners",value:function(e){var t;return this._events[e]?Pc(t=this._events[e]).call(t,(function(e){return e.listener})):[]}},{key:"on",value:function(e,t){this._events[e]||(this._events[e]=[]),e=this._events[e],-1===this._indexOfListener(e,t)&&e.push({listener:t,once:!1})}},{key:"once",value:function(e,t){this._events[e]||(this._events[e]=[]),e=this._events[e],-1===this._indexOfListener(e,t)&&e.push({listener:t,once:!0})}},{key:"off",value:function(e,t){if(this._events[e]){var n=this._events[e];-1!==(t=this._indexOfListener(n,t))&&Uc(n).call(n,t,1),0===this._events[e].length&&delete this._events[e]}}},{key:"removeAllListeners",value:function(e){e?delete this._events[e]:this._events={}}},{key:"emit",value:function(e){var t;this._events[e]||(this._events[e]=[]);for(var n=Pc(t=this._events[e]).call(t,(function(e){return e})),r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];for(t=0;t<n.length;t+=1){var a=n[t];a.once&&this.off(e,a.listener),a.listener.apply(this,i||[])}}},{key:"_indexOfListener",value:function(e,t){for(var n=e.length;n--;)if(e[n].listener===t)return n;return-1}}]),e}(),_f=function(e){l(n,e);var t=d(n);function n(){var e;return f(this,n),(e=t.apply(this,arguments)).resultStorage=new ra,e}return h(n,[{key:"setLocalAudioStats",value:function(e,t,n){this.record("AUDIO_INPUT_LEVEL_TOO_LOW",e,this.checkAudioInputLevel(n)),this.record("SEND_AUDIO_BITRATE_TOO_LOW",e,this.checkSendAudioBitrate(n))}},{key:"setLocalVideoStats",value:function(e,t,n){this.record("SEND_VIDEO_BITRATE_TOO_LOW",e,this.checkSendVideoBitrate(n)),this.record("FRAMERATE_INPUT_TOO_LOW",e,this.checkFramerateInput(n,t)),this.record("FRAMERATE_SENT_TOO_LOW",e,this.checkFramerateSent(n))}},{key:"setRemoteAudioStats",value:function(e,t){e=e.getUserId(),this.record("AUDIO_OUTPUT_LEVEL_TOO_LOW",e,this.checkAudioOutputLevel(t))}},{key:"setRemoteVideoStats",value:function(e,t){e=e.getUserId(),this.record("RECV_VIDEO_DECODE_FAILED",e,this.checkVideoDecode(t))}},{key:"record",value:function(e,t,n){this.resultStorage.has(e)||this.resultStorage.set(e,{result:[],isPrevNormal:!0});var r,i=this.resultStorage.get(e);i&&(i.result.push(n),5<=i.result.length)&&(n=uu(r=i.result).call(r,!0),i.isPrevNormal&&!n&&this.emit("exception",bf[e],e,t),!i.isPrevNormal&&n&&this.emit("exception",bf[e]+2e3,e+"_RECOVER",t),i.isPrevNormal=n,i.result=[])}},{key:"checkAudioOutputLevel",value:function(e){return!(0<e.receiveBitrate&&0===e.receiveLevel)}},{key:"checkAudioInputLevel",value:function(e){return 0!==e.sendVolumeLevel}},{key:"checkFramerateInput",value:function(e,t){var n=null;return t._encoderConfig&&t._encoderConfig.frameRate&&(n=at(t._encoderConfig.frameRate)),e=e.captureFrameRate,!n||!e||!(10<n&&5>e||10>n&&5<=n&&1>=e)}},{key:"checkFramerateSent",value:function(e){return!(e.captureFrameRate&&e.sendFrameRate&&5<e.captureFrameRate&&1>=e.sendFrameRate)}},{key:"checkSendVideoBitrate",value:function(e){return 0!==e.sendBitrate}},{key:"checkSendAudioBitrate",value:function(e){return 0!==e.sendBitrate}},{key:"checkVideoDecode",value:function(e){return 0===e.receiveBitrate||0!==e.decodeFrameRate}}]),n}(yf),bf={FRAMERATE_INPUT_TOO_LOW:1001,FRAMERATE_SENT_TOO_LOW:1002,SEND_VIDEO_BITRATE_TOO_LOW:1003,RECV_VIDEO_DECODE_FAILED:1005,AUDIO_INPUT_LEVEL_TOO_LOW:2001,AUDIO_OUTPUT_LEVEL_TOO_LOW:2002,SEND_AUDIO_BITRATE_TOO_LOW:2003},Ef=function(){function e(t){var n=this;f(this,e),this.localConnectionsMap=new ra,this.remoteConnectionsMap=new ra,this.trafficStatsPeerList=[],this.updateStats=function(){var t,r;ba(t=n.remoteConnectionsMap).call(t,(function(t){var r,i=t.audioStats,o=t.videoStats,a=t.pcStats,s=it({},ed),c=it({},nd),u=it({},td),l=t.connection.pc.getStats(),d=l.audioRecv[0],f=l.videoRecv[0];a=a?a.videoRecv[0]:void 0;var h=!0===t.connection.pc._statsFilter.videoIsReady,p=n.trafficStats&&Zc(r=n.trafficStats.peer_delay).call(r,(function(e){return e.peer_uid===t.connection.getUserId()}));d&&("opus"!==d.codec&&"aac"!==d.codec||(s.codecType=d.codec),d.outputLevel?s.receiveLevel=Math.round(32767*d.outputLevel):t.connection.user.audioTrack&&(s.receiveLevel=Math.round(32767*t.connection.user.audioTrack.getVolumeLevel())),s.receiveBytes=d.bytes,s.receivePackets=d.packets,s.receivePacketsLost=d.packetsLost,s.packetLossRate=s.receivePacketsLost/(s.receivePackets+s.receivePacketsLost),s.receiveBitrate=i?8*Math.max(0,s.receiveBytes-i.receiveBytes):0,s.totalDuration=i?i.totalDuration+1:1,s.totalFreezeTime=i?i.totalFreezeTime:0,s.freezeRate=s.totalFreezeTime/s.totalDuration,s.receiveDelay=d.jitterBufferMs,r=t.connection.user.audioTrack,10<s.totalDuration&&e.isRemoteAudioFreeze(r)&&(s.totalFreezeTime+=1)),f&&("H264"!==f.codec&&"VP8"!==f.codec&&"VP9"!==f.codec&&"AV1"!==f.codec||(c.codecType=f.codec),c.receiveBytes=f.bytes,c.receiveBitrate=o?8*Math.max(0,c.receiveBytes-o.receiveBytes):0,c.decodeFrameRate=f.decodeFrameRate,c.renderFrameRate=f.decodeFrameRate,f.outputFrame&&(c.renderFrameRate=f.outputFrame.frameRate),f.receivedFrame?(c.receiveFrameRate=f.receivedFrame.frameRate,c.receiveResolutionHeight=f.receivedFrame.height,c.receiveResolutionWidth=f.receivedFrame.width):t.connection.user.videoTrack&&(c.receiveResolutionHeight=t.connection.user.videoTrack._videoHeight||0,c.receiveResolutionWidth=t.connection.user.videoTrack._videoWidth||0),void 0!==f.framesRateFirefox&&(c.receiveFrameRate=Math.round(f.framesRateFirefox)),c.receivePackets=f.packets,c.receivePacketsLost=f.packetsLost,c.packetLossRate=c.receivePacketsLost/(c.receivePackets+c.receivePacketsLost),c.totalDuration=o?o.totalDuration+1:1,c.totalFreezeTime=o?o.totalFreezeTime:0,c.receiveDelay=f.jitterBufferMs||0,o=t.connection.user.videoTrack,t.connection.subscribeOptions.video&&h&&e.isRemoteVideoFreeze(o,f,a)&&(c.totalFreezeTime+=1),c.freezeRate=c.totalFreezeTime/c.totalDuration),p&&(s.end2EndDelay=p.B_ad,c.end2EndDelay=p.B_vd,s.transportDelay=p.B_ed,c.transportDelay=p.B_ed,u.uplinkNetworkQuality=p.B_punq?p.B_punq:0,u.downlinkNetworkQuality=p.B_pdnq?p.B_punq:0),t.audioStats=s,t.videoStats=c,t.pcStats=l,t.networkStats=u,t.connection.user.audioTrack&&n.exceptionMonitor.setRemoteAudioStats(t.connection.user.audioTrack,s),t.connection.user.videoTrack&&n.exceptionMonitor.setRemoteVideoStats(t.connection.user.videoTrack,c)})),ba(r=n.localConnectionsMap).call(r,(function(e){var t=e.audioStats,r=e.videoStats,i=it({},$l),o=it({},Zl),a=e.connection.pc.getStats(),s=a.audioSend[0];a=a.videoSend[0];var c=e.connection.getUserId();s&&("opus"!==s.codec&&"aac"!==s.codec||(i.codecType=s.codec),s.inputLevel?i.sendVolumeLevel=Math.round(32767*s.inputLevel):e.connection.audioTrack&&(i.sendVolumeLevel=Math.round(32767*e.connection.audioTrack.getVolumeLevel())),i.sendBytes=s.bytes,i.sendPackets=s.packets,i.sendPacketsLost=s.packetsLost,i.sendBitrate=t?8*Math.max(0,i.sendBytes-t.sendBytes):0),a&&("H264"!==a.codec&&"VP8"!==a.codec&&"VP9"!==a.codec&&"AV1"!==a.codec||(o.codecType=a.codec),o.sendBytes=a.bytes,o.sendBitrate=r?8*Math.max(0,o.sendBytes-r.sendBytes):0,a.inputFrame?(o.captureFrameRate=a.inputFrame.frameRate,o.captureResolutionHeight=a.inputFrame.height,o.captureResolutionWidth=a.inputFrame.width):e.connection.videoTrack&&(o.captureResolutionWidth=e.connection.videoTrack._videoWidth||0,o.captureResolutionHeight=e.connection.videoTrack._videoHeight||0),a.sentFrame?(o.sendFrameRate=a.sentFrame.frameRate,o.sendResolutionHeight=a.sentFrame.height,o.sendResolutionWidth=a.sentFrame.width):e.connection.videoTrack&&(o.sendResolutionWidth=e.connection.videoTrack._videoWidth||0,o.sendResolutionHeight=e.connection.videoTrack._videoHeight||0),a.avgEncodeMs&&(o.encodeDelay=a.avgEncodeMs),e.connection.videoTrack&&e.connection.videoTrack._encoderConfig&&e.connection.videoTrack._encoderConfig.bitrateMax&&(o.targetSendBitrate=1e3*e.connection.videoTrack._encoderConfig.bitrateMax),o.sendPackets=a.packets,o.sendPacketsLost=a.packetsLost,o.totalDuration=r?r.totalDuration+1:1,o.totalFreezeTime=r?r.totalFreezeTime:0,n.isLocalVideoFreeze(a)&&(o.totalFreezeTime+=1)),e.audioStats=i,e.videoStats=o,e.audioStats&&e.connection.audioTrack&&n.exceptionMonitor.setLocalAudioStats(c,e.connection.audioTrack,e.audioStats),e.videoStats&&e.connection.videoTrack&&n.exceptionMonitor.setLocalVideoStats(c,e.connection.videoTrack,e.videoStats)}))},this.clientId=t,this.updateStatsInterval=window.setInterval(this.updateStats,1e3),this.exceptionMonitor=new _f,this.exceptionMonitor.on("exception",(function(e,t,r){n.onStatsException&&n.onStatsException(e,t,r)}))}return h(e,[{key:"reset",value:function(){this.localConnectionsMap=new ra,this.remoteConnectionsMap=new ra,this.trafficStats=void 0,this.trafficStatsPeerList=[],this.uplinkStats=void 0}},{key:"getLocalAudioTrackStats",value:function(e){return(e=this.localConnectionsMap.get(e))&&e.audioStats?e.audioStats:it({},$l)}},{key:"getLocalVideoTrackStats",value:function(e){return(e=this.localConnectionsMap.get(e))&&e.videoStats?e.videoStats:it({},Zl)}},{key:"getRemoteAudioTrackStats",value:function(e){var t,n=this.remoteConnectionsMap.get(e);return n&&n.audioStats?this.trafficStats?((e=Zc(t=this.trafficStats.peer_delay).call(t,(function(e){return e.peer_uid===n.connection.user.uid})))&&(n.audioStats.publishDuration=e.B_ppad+(gf()-this.trafficStats.timestamp)),n.audioStats):n.audioStats:it({},ed)}},{key:"getRemoteNetworkQualityStats",value:function(e){return(e=this.remoteConnectionsMap.get(e))&&e.networkStats?e.networkStats:it({},td)}},{key:"getRemoteVideoTrackStats",value:function(e){var t,n=this.remoteConnectionsMap.get(e);return n&&n.videoStats?this.trafficStats?((e=Zc(t=this.trafficStats.peer_delay).call(t,(function(e){return e.peer_uid===n.connection.user.uid})))&&(n.videoStats.publishDuration=e.B_ppvd+(gf()-this.trafficStats.timestamp)),n.videoStats):n.videoStats:it({},nd)}},{key:"getRTCStats",value:function(){var e,t,n=0,r=0,i=0,o=0;return ba(e=this.localConnectionsMap).call(e,(function(e){e.audioStats&&(n+=e.audioStats.sendBytes,r+=e.audioStats.sendBitrate),e.videoStats&&(n+=e.videoStats.sendBytes,r+=e.videoStats.sendBitrate)})),ba(t=this.remoteConnectionsMap).call(t,(function(e){e.audioStats&&(i+=e.audioStats.receiveBytes,o+=e.audioStats.receiveBitrate),e.videoStats&&(i+=e.videoStats.receiveBytes,o+=e.videoStats.receiveBitrate)})),e=1,this.trafficStats&&(e+=this.trafficStats.peer_delay.length),{Duration:0,UserCount:e,SendBitrate:r,SendBytes:n,RecvBytes:i,RecvBitrate:o,OutgoingAvailableBandwidth:this.uplinkStats?this.uplinkStats.B_uab/1e3:0,RTT:this.trafficStats?2*this.trafficStats.B_acd:0}}},{key:"removeConnection",value:function(e){this.localConnectionsMap.delete(e),this.remoteConnectionsMap.delete(e)}},{key:"addLocalConnection",value:function(e){var t=e.connectionId;this.localConnectionsMap.has(t)||this.localConnectionsMap.set(t,{connection:e})}},{key:"addRemoteConnection",value:function(e){var t=e.connectionId;this.remoteConnectionsMap.has(t)||this.remoteConnectionsMap.set(t,{connection:e})}},{key:"updateTrafficStats",value:function(e){var t,n=this,r=ds(t=e.peer_delay).call(t,(function(e){var t;return-1===Gc(t=n.trafficStatsPeerList).call(t,e.peer_uid)}));ba(r).call(r,(function(e){var t,r,i=Zc(t=vf(hf(r=n.remoteConnectionsMap).call(r))).call(t,(function(t){return t.connection._userId===e.peer_uid}));void 0!==e.B_ppad&&void 0!==e.B_ppvd&&(n.onUploadPublishDuration&&n.onUploadPublishDuration(e.peer_uid,e.B_ppad,e.B_ppvd,i?gf()-i.connection.startTime:0),n.trafficStatsPeerList.push(e.peer_uid))})),this.trafficStats=e}},{key:"updateUplinkStats",value:function(e){var t;this.uplinkStats&&this.uplinkStats.B_fir!==e.B_fir&&Rl.debug(cs(t="[".concat(this.clientId,"]: Period fir changes to ")).call(t,e.B_fir)),this.uplinkStats=e}},{key:"isLocalVideoFreeze",value:function(e){return!(!e.inputFrame||!e.sentFrame)&&5<e.inputFrame.frameRate&&3>e.sentFrame.frameRate}}],[{key:"isRemoteVideoFreeze",value:function(e,t,n){return!!e&&(e=!n||t.framesDecodeCount>n.framesDecodeCount,!!n&&t.framesDecodeFreezeTime>n.framesDecodeFreezeTime||!e)}},{key:"isRemoteAudioFreeze",value:function(e){return!!e&&e._isFreeze()}}]),e}(),wf=function(){},Tf={},Sf=[[[100,.00520833333333333],[66.6666666666666,.00434027777777778],[66.6666666666667,.00173611111111111]],[[233.333333333333,.00347222222222222],[266.666666666667],[.00173611111111111],[183.333333333333,.000217013888888889]],[[700,.001953125],[200,.001953125],[175,.000244140625]],[[899.999999999998,.00173611111111111],[1200,.000868055555555556],[160,.000260416666666667]],[[2666.66666666667,.000884130658436214],[1166.66666666667,.000884130658436214],[600,482253e-10]]],If=new(function(){function e(){f(this,e),this.fnMap=new ra}return h(e,[{key:"throttleByKey",value:function(e,t,n,r){for(var i=this,o=arguments.length,a=new Array(o>4?o-4:0),s=4;s<o;s++)a[s-4]=arguments[s];if(this.fnMap.has(t)){var c,l,d=this.fnMap.get(t);d.threshold!==n?((c=d).fn.apply(c,u(d.args)),clearTimeout(d.timer),d=window.setTimeout((function(){var e=i.fnMap.get(t);e&&e.fn.apply(e,u(e.args)),i.fnMap.delete(t)}),n),this.fnMap.set(t,{fn:e,threshold:n,timer:d,args:a,skipFn:r})):(d.skipFn&&(l=d).skipFn.apply(l,u(d.args)),this.fnMap.set(t,dt({},d,{fn:e,args:a,skipFn:r})))}else d=window.setTimeout((function(){var e=i.fnMap.get(t);e&&e.fn.apply(e,u(e.args)),i.fnMap.delete(t)}),n),this.fnMap.set(t,{fn:e,threshold:n,timer:d,args:a,skipFn:r})}}]),e}()),Rf=iu(mf=If.throttleByKey).call(mf,If),Af=null,Cf=1,kf=function(){function e(t){var n;f(this,e),this.lockingPromise=kc.resolve(),this.locks=0,this.name="",this.lockId=Cf++,t&&(this.name=t),Rl.debug(cs(n="[lock-".concat(this.name,"-")).call(n,this.lockId,"] is created."))}return h(e,[{key:"isLocked",get:function(){return 0<this.locks}},{key:"lock",value:function(){var e,t,n,r=this;this.locks+=1,Rl.debug(cs(e=cs(t="[lock-".concat(this.name,"-")).call(t,this.lockId,"] is locked, current queue ")).call(e,this.locks,"."));var i=new kc((function(e){n=function(){var t,n;--r.locks,Rl.debug(cs(t=cs(n="[lock-".concat(r.name,"-")).call(n,r.lockId,"] is not locked, current queue ")).call(t,r.locks,".")),e()}}));return e=this.lockingPromise.then((function(){return n})),this.lockingPromise=this.lockingPromise.then((function(){return i})),e}}]),e}(),Of=new kf("safari"),Nf=!1,Pf=!1,Df=new(function(e){l(n,e);var t=d(n);function n(){var e;return f(this,n),(e=t.call(this))._state=Dl.IDLE,e.lastAccessCameraPermission=e.lastAccessMicrophonePermission=e.isAccessCameraPermission=e.isAccessMicrophonePermission=!1,e.deviceInfoMap=new ra,e.init().then((function(){var t,n;navigator.mediaDevices&&navigator.mediaDevices.addEventListener&&navigator.mediaDevices.addEventListener("devicechange",iu(n=e.updateDevicesInfo).call(n,c(e))),window.setInterval(iu(t=e.updateDevicesInfo).call(t,c(e)),2500)})).catch((function(e){return Rl.error(e.toString())})),e}return h(n,[{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this.emit(xl.STATE_CHANGE,e),this._state=e)}},{key:"enumerateDevices",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,f,h,p,m,g=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=g.length>2&&void 0!==g[2]&&g[2],navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices){e.next=3;break}return e.abrupt("return",new Al($u.NOT_SUPPORTED,"enumerateDevices() not supported.").throw());case 3:return e.next=5,navigator.mediaDevices.enumerateDevices();case 5:if(i=e.sent,i=this.checkMediaDeviceInfoIsOk(i),o=!this.isAccessMicrophonePermission&&t,a=!this.isAccessCameraPermission&&n,i.audio&&(o=!1),i.video&&(a=!1),s=i=null,c=null,r||!o&&!a){e.next=67;break}if(e.t0=Of.isLocked,!e.t0){e.next=20;break}return Rl.debug("[device manager] wait GUM lock"),e.next=17,Of.lock();case 17:e.t1=e.sent,(0,e.t1)(),Rl.debug("[device manager] GUM unlock");case 20:if(Nf&&(o=!1,this.isAccessMicrophonePermission=!0),Pf&&(a=!1,this.isAccessCameraPermission=!0),Rl.debug("[device manager] check media device permissions",t,n,o,a),!o||!a){e.next=36;break}return e.prev=21,e.next=24,navigator.mediaDevices.getUserMedia({audio:!0,video:!0});case 24:c=e.sent,e.next=33;break;case 27:if(e.prev=27,e.t2=e.catch(21),(r=Ft(e.t2.name||e.t2.code||e.t2,e.t2.message)).code!==$u.PERMISSION_DENIED){e.next=32;break}throw r;case 32:Rl.warning("getUserMedia failed in getDevices",r);case 33:this.isAccessMicrophonePermission=this.isAccessCameraPermission=!0,e.next=66;break;case 36:if(!o){e.next=52;break}return e.prev=37,e.next=40,navigator.mediaDevices.getUserMedia({audio:t});case 40:i=e.sent,e.next=49;break;case 43:if(e.prev=43,e.t3=e.catch(37),(r=Ft(e.t3.name||e.t3.code||e.t3,e.t3.message)).code!==$u.PERMISSION_DENIED){e.next=48;break}throw r;case 48:Rl.warning("getUserMedia failed in getDevices",r);case 49:this.isAccessMicrophonePermission=!0,e.next=66;break;case 52:if(!a){e.next=66;break}return e.prev=53,e.next=56,navigator.mediaDevices.getUserMedia({video:n});case 56:s=e.sent,e.next=65;break;case 59:if(e.prev=59,e.t4=e.catch(53),(r=Ft(e.t4.name||e.t4.code||e.t4,e.t4.message)).code!==$u.PERMISSION_DENIED){e.next=64;break}throw r;case 64:Rl.warning("getUserMedia failed in getDevices",r);case 65:this.isAccessCameraPermission=!0;case 66:Rl.debug("[device manager] mic permission",t,"cam permission",n);case 67:return e.prev=67,e.next=70,navigator.mediaDevices.enumerateDevices();case 70:return f=e.sent,e.abrupt("return",(i&&ba(u=i.getTracks()).call(u,(function(e){return e.stop()})),s&&ba(l=s.getTracks()).call(l,(function(e){return e.stop()})),c&&ba(d=c.getTracks()).call(d,(function(e){return e.stop()})),i=null,s=null,c=null,f));case 74:return e.prev=74,e.t5=e.catch(67),i&&ba(h=i.getTracks()).call(h,(function(e){return e.stop()})),s&&ba(p=s.getTracks()).call(p,(function(e){return e.stop()})),c&&ba(m=c.getTracks()).call(m,(function(e){return e.stop()})),c=s=i=null,e.abrupt("return",new Al($u.ENUMERATE_DEVICES_FAILED,e.t5.toString()).throw());case 81:case"end":return e.stop()}}),e,this,[[21,27],[37,43],[53,59],[67,74]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getRecordingDevices",value:function(){var e=m(v.mark((function e(){var t,n=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.next=3,this.enumerateDevices(!0,!1,t);case 3:return t=e.sent,e.abrupt("return",ds(t).call(t,(function(e){return"audioinput"===e.kind})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getCamerasDevices",value:function(){var e=m(v.mark((function e(){var t,n=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.next=3,this.enumerateDevices(!1,!0,t);case 3:return t=e.sent,e.abrupt("return",ds(t).call(t,(function(e){return"videoinput"===e.kind})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getSpeakers",value:function(){var e=m(v.mark((function e(){var t,n=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.length>0&&void 0!==n[0]&&n[0],e.next=3,this.enumerateDevices(!0,!1,t);case 3:return t=e.sent,e.abrupt("return",ds(t).call(t,(function(e){return"audiooutput"===e.kind})));case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"searchDeviceNameById",value:function(e){return(e=this.deviceInfoMap.get(e))?e.device.label||e.device.deviceId:null}},{key:"searchDeviceIdByName",value:function(e){var t,n=null;return ba(t=this.deviceInfoMap).call(t,(function(t){t.device.label===e&&(n=t.device.deviceId)})),n}},{key:"getDeviceById",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enumerateDevices(!0,!0,!0);case 2:if(n=e.sent,n=Zc(n).call(n,(function(e){return e.deviceId===t}))){e.next=6;break}throw new Al($u.DEVICE_NOT_FOUND,"deviceId: ".concat(t));case 6:return e.abrupt("return",n);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"init",value:function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.state=Dl.INITING,e.prev=1,e.next=4,this.updateDevicesInfo();case 4:this.state=Dl.INITEND,e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(1),Rl.warning("Device Detection functionality cannot start properly.",e.t0.toString()),this.state=Dl.IDLE,("boolean"==typeof isSecureContext?isSecureContext:"https:"===location.protocol||"file:"===location.protocol||"localhost"===location.hostname||"127.0.0.1"===location.hostname||"::1"===location.hostname)||new Al($u.WEB_SECURITY_RESTRICT,"Your context is limited by web security, please try using https protocol or localhost.").throw(),e.t0;case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateDevicesInfo",value:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.enumerateDevices(!0,!0,!0);case 2:if(n=e.sent,r=gf(),i=[],o=this.checkMediaDeviceInfoIsOk(n),ba(n).call(n,(function(e){if(e.deviceId){var t=a.deviceInfoMap.get(e.deviceId);if("ACTIVE"!==(t?t.state:"INACTIVE")){var n={initAt:r,updateAt:r,device:e,state:"ACTIVE"};a.deviceInfoMap.set(e.deviceId,n),i.push(n)}t&&(t.updateAt=r)}})),ba(t=this.deviceInfoMap).call(t,(function(e,t){"ACTIVE"===e.state&&e.updateAt!==r&&(e.state="INACTIVE",i.push(e))})),this.state===Dl.INITEND){e.next=8;break}return e.abrupt("return",(o.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),void(o.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0))));case 8:ba(i).call(i,(function(e){switch(e.device.kind){case"audioinput":a.lastAccessMicrophonePermission&&a.isAccessMicrophonePermission&&a.emit(xl.RECORDING_DEVICE_CHANGED,e);break;case"videoinput":a.lastAccessCameraPermission&&a.isAccessCameraPermission&&a.emit(xl.CAMERA_DEVICE_CHANGED,e);break;case"audiooutput":a.lastAccessMicrophonePermission&&a.isAccessMicrophonePermission&&a.emit(xl.PLAYOUT_DEVICE_CHANGED,e)}})),o.audio&&(this.lastAccessMicrophonePermission=!0,this.isAccessMicrophonePermission=!0),o.video&&(this.lastAccessCameraPermission=!0,this.isAccessCameraPermission=!0);case 11:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"checkMediaDeviceInfoIsOk",value:function(e){var t=ds(e).call(e,(function(e){return"audioinput"===e.kind}));e=ds(e).call(e,(function(e){return"videoinput"===e.kind}));var n,r={audio:!1,video:!1},i=p(t);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.label&&o.deviceId){r.audio=!0;break}}}catch(u){i.e(u)}finally{i.f()}var a,s=p(e);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.label&&c.deviceId){r.video=!0;break}}}catch(u){s.e(u)}finally{s.f()}return r}}]),n}(yf)),xf=[].slice,Lf=/MSIE .\./.test(Xa),Mf=function(e){return function(t,n){var r=2<arguments.length,i=r?xf.call(arguments,2):void 0;return e(r?function(){("function"==typeof t?t:Function(t)).apply(this,i)}:t,n)}};Fr({global:!0,bind:!0,forced:Lf},{setTimeout:Mf(nr.setTimeout),setInterval:Mf(nr.setInterval)});var Uf,jf=Or.setTimeout,Ff=new(function(){function e(){var t,n;f(this,e),this.baseInfoMap=new ra,this.clientList=Gu,this.keyEventUploadPendingItems=[],this.normalEventUploadPendingItems=[],this.apiInvokeUploadPendingItems=[],this.apiInvokeCount=0,this.ltsList=[],this.lastSendNormalEventTime=gf(),this.customReportCount=0,this.eventUploadTimer=window.setInterval(iu(t=this.doSend).call(t,this),Bu.EVENT_REPORT_SEND_INTERVAL),this.setSessionIdTimer=window.setInterval(iu(n=this.appendSessionId).call(n,this),Bu.EVENT_REPORT_SEND_INTERVAL)}return h(e,[{key:"reportApiInvoke",value:function(e,t,n){var r=this;t.timeout=t.timeout||6e4,t.reportResult=void 0===t.reportResult||t.reportResult;var i=gf(),o=this.apiInvokeCount+=1,a=function(){return{tag:t.tag,invokeId:o,sid:e,name:t.name,apiInvokeTime:i,options:t.options}},s=!!Bu.SHOW_REPORT_INVOKER_LOG;s&&Rl.info("".concat(t.name," start"),t.options);var c=!1;ht(t.timeout).then((function(){c||(r.sendApiInvoke(Ht({},a(),{error:$u.API_INVOKE_TIMEOUT,success:!1})),Rl.debug("".concat(t.name," timeout")))}));var u=new Al($u.UNEXPECTED_ERROR,"".concat(t.name,": this api invoke is end"));return{onSuccess:function(e){var i=function(){if(c)throw u;return c=!0,r.sendApiInvoke(Ht({},a(),{success:!0},t.reportResult&&{result:e})),s&&Rl.info("".concat(t.name," onSuccess")),e};return n?Rf(i,t.name+"Success",n,(function(){return c=!0})):i()},onError:function(e){var i=function(){if(c)throw e;c=!0,r.sendApiInvoke(Ht({},a(),{success:!1,error:e.toString()})),s&&Rl.info("".concat(t.name," onFailure"),e.toString())};return n?Rf(i,t.name+"Error",n,(function(){return c=!0})):i()}}}},{key:"sessionInit",value:function(e,t){if(!this.baseInfoMap.has(e)){var n=gf();(e=this.createBaseInfo(e,n)).cname=t.cname;var r=Sa({},{willUploadConsoleLog:Bu.UPLOAD_LOG,maxTouchPoints:navigator.maxTouchPoints,areaVersion:Lu?"global":"oversea",areas:Bu.AREAS&&Bu.AREAS.join(",")},t.extend),i=gf();t=Ht({},e,{eventType:Cl.SESSION_INIT,appid:t.appid,browser:navigator.userAgent,build:"v4.4.0-0-g48538343(4/2/2021, 5:44:00 PM)",lts:i,elapse:i-n,extend:Yr(r),mode:t.mode,process:Bu.PROCESS_ID,success:!0,version:Du}),this.send({type:kl.SESSION,data:t},!0)}}},{key:"joinChooseServer",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.JOIN_CHOOSE_SERVER,lts:r,eventElapse:r-t.lts,chooseServerAddr:t.csAddr,errorCode:t.ec,elapse:r-e.startTime,success:t.succ,chooseServerAddrList:Yr(t.serverList),uid:t.uid?Ba(t.uid):null,cid:t.cid?Ba(t.cid):null}),this.send({type:kl.JOIN_CHOOSE_SERVER,data:t},!0)}}},{key:"reqUserAccount",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.REQ_USER_ACCOUNT,lts:r,success:t.success,serverAddress:t.serverAddr,stringUid:t.stringUid,uid:t.uid,errorCode:t.errorCode,elapse:r-e.startTime,eventElapse:r-t.lts,extend:Yr(t.extend)}),this.send({type:kl.REQ_USER_ACCOUNT,data:t},!0)}}},{key:"joinGateway",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info;t.vid&&(n.vid=t.vid),n.uid=t.uid,n.cid=t.cid;var r=gf();n=Ht({},n,{eventType:Cl.JOIN_GATEWAY,lts:r,gatewayAddr:t.addr,success:t.succ,errorCode:t.ec,elapse:r-e.startTime,eventElapse:r-t.lts}),t.succ&&(e.lastJoinSuccessTime=r),this.send({type:kl.JOIN_GATEWAT,data:n},!0)}}},{key:"joinChannelTimeout",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=gf();t=Ht({},e.info,{lts:n,timeout:t,elapse:n-e.startTime}),this.send({type:kl.JOIN_CHANNEL_TIMEOUT,data:t},!0)}}},{key:"publish",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.PUBLISH,lts:r,eventElapse:r-t.lts,elapse:r-e.startTime,success:t.succ,errorCode:t.ec,videoName:t.videoName,audioName:t.audioName,screenName:t.screenName,screenshare:t.screenshare,audio:t.audio,video:t.video,p2pid:t.p2pid,publishRequestid:t.publishRequestid}),this.send({type:kl.PUBLISH,data:t},!0)}}},{key:"subscribe",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();e=Ht({},n,{eventType:Cl.SUBSCRIBE,lts:r,eventElapse:r-t.lts,elapse:r-e.startTime,success:t.succ,errorCode:t.ec,video:t.video,audio:t.audio,subscribeRequestid:t.subscribeRequestid,p2pid:t.p2pid}),"string"==typeof t.peerid?e.peerSuid=t.peerid:e.peer=t.peerid,this.send({type:kl.SUBSCRIBE,data:e},!0)}}},{key:"firstRemoteFrame",value:function(e,t,n,r){if(e=this.baseInfoMap.get(e)){var i=e.info,o=gf();t=Ht({},i,{},r,{elapse:o-e.startTime,eventType:t,lts:o}),this.send({type:n,data:t},!0)}}},{key:"onGatewayStream",value:function(e,t,n,r){(e=this.baseInfoMap.get(e))&&(t=Ht({},e.info,{},r,{eventType:t,lts:gf()}),this.send({type:n,data:t},!0))}},{key:"streamSwitch",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.STREAM_SWITCH,lts:r,isDual:t.isdual,elapse:r-e.startTime,success:t.succ}),this.send({type:kl.STREAM_SWITCH,data:t},!0)}}},{key:"requestProxyAppCenter",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.REQUEST_PROXY_APPCENTER,lts:r,eventElapse:r-t.lts,elapse:r-e.startTime,APAddr:t.APAddr,workerManagerList:t.workerManagerList,response:t.response,errorCode:t.ec,success:t.succ}),this.send({type:kl.REQUEST_PROXY_APPCENTER,data:t},!0)}}},{key:"requestProxyWorkerManager",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{eventType:Cl.REQUEST_PROXY_WORKER_MANAGER,lts:r,eventElapse:r-t.lts,elapse:r-e.startTime,workerManagerAddr:t.workerManagerAddr,response:t.response,errorCode:t.ec,success:t.succ}),this.send({type:kl.REQUEST_PROXY_WORKER_MANAGER,data:t},!0)}}},{key:"setProxyServer",value:function(e){(this.proxyServer=e)?Rl.debug("reportProxyServerurl: ".concat(e)):Rl.debug("disable reportProxyServerurl: ".concat(e))}},{key:"peerPublishStatus",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{subscribeElapse:t.subscribeElapse,peer:t.peer,peerPublishDuration:Math.max(t.audioPublishDuration,t.videoPublishDuration),audiotag:0<t.audioPublishDuration?1:-1,videotag:0<t.videoPublishDuration?1:-1,lts:r,elapse:r-e.startTime,joinChannelSuccessElapse:r-(e.lastJoinSuccessTime||r)}),this.send({type:kl.PEER_PUBLISH_STATUS,data:t},!0)}}},{key:"workerEvent",value:function(e,t){var n=this;if(e=this.baseInfoMap.get(e)){var r=e.info,i=gf();t=function(e,t,n){var r=e[t];if(!r||"string"!=typeof r)return[e];e[t]="";for(var i=ft(Yr(e)),o=0,a=[],s=0,c=0;c<r.length;c++)(s+=127>=r.charCodeAt(c)?1:3)<=n-i||(a[a.length]=dt({},e,g({},t,r.substring(o,c))),o=c,s=127>=r.charCodeAt(c)?1:3);return o!==r.length-1&&(a[a.length]=dt({},e,g({},t,r.substring(o)))),a}(Ht({},r,{},t,{elapse:i-e.startTime,lts:i,productType:"WebRTC"}),"payload",1300),ba(t).call(t,(function(e){return n.send({type:kl.WORKER_EVENT,data:e},!0)}))}}},{key:"apworkerEvent",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{},t,{elapse:r-e.startTime,lts:r}),this.send({type:kl.AP_WORKER_EVENT,data:t},!0)}}},{key:"joinWebProxyAP",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{},t,{elapse:r-e.startTime,lts:r}),this.send({type:kl.JOIN_WEB_PROXY_AP,data:t},!0)}}},{key:"WebSocketQuit",value:function(e,t){if(e=this.baseInfoMap.get(e)){var n=e.info,r=gf();t=Ht({},n,{},t,{elapse:r-e.startTime,lts:r}),this.send({type:kl.WEBSOCKET_QUIT,data:t},!0)}}},{key:"sendCustomReportMessage",value:function(){var e=m(v.mark((function e(t,n){var r=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.customReportCount+=n.length,!(this.customReportCount>Bu.CUSTOM_REPORT_LIMIT)){e.next=2;break}throw new Al($u.CUSTOM_REPORT_FREQUENCY_TOO_HIGH);case 2:return this.customReportCounterTimer||(this.customReportCounterTimer=window.setInterval((function(){r.customReportCount=0}),5e3)),n=Pc(n).call(n,(function(e){return{type:kl.USER_ANALYTICS,data:Ht({sid:t},e)}})),n={msgType:"EventMessages",sentTs:Math.round(gf()/1e3),payloads:Pc(n).call(n,(function(e){return Yr(e)}))},e.prev=5,e.next=8,this.postDataToStatsCollector(n);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(5),Rl.error("send custom report message failed",e.t0.toString()),new Al($u.CUSTOM_REPORT_SEND_FAILED,e.t0.message);case 13:case"end":return e.stop()}}),e,this,[[5,10]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"sendApiInvoke",value:function(e){var t=Bu.NOT_REPORT_EVENT;if(e.tag&&uu(t)&&uu(t).call(t,e.tag))return!1;if(null===e.sid)return this.apiInvokeUploadPendingItems.push(e),!1;if(!(t=this.baseInfoMap.get(e.sid)))return this.apiInvokeUploadPendingItems.push(e),!1;var n=t.info,r=n.cname,i=n.uid,o=n.cid;return e.lts=e.lts||gf(),e={invokeId:e.invokeId,sid:e.sid,cname:r,cid:o,uid:i,lts:e.lts,success:e.success,elapse:e.lts-t.startTime,execElapse:e.lts-e.apiInvokeTime,apiName:e.name,options:e.options?Yr(e.options):void 0,execStates:e.states?Yr(e.states):void 0,execResult:e.result?Yr(e.result):void 0,errorCode:e.error?Yr(e.error):void 0},this.send({type:kl.API_INVOKE,data:e},!1),!0}},{key:"appendSessionId",value:function(){var e,t=this;ba(e=this.clientList).call(e,(function(e){if(e._sessionId)for(var n=t.apiInvokeUploadPendingItems.length,r=0;r<n;r++){var i=t.apiInvokeUploadPendingItems.shift();i&&(i.sid=e._sessionId,t.sendApiInvoke(Sa({},i)))}}))}},{key:"send",value:function(e,t){if(t)return this.keyEventUploadPendingItems.push(e),void this.sendItems(this.keyEventUploadPendingItems,!0);var n;this.normalEventUploadPendingItems.push(e),this.normalEventUploadPendingItems.length>Bu.NORMAL_EVENT_QUEUE_CAPACITY&&Uc(n=this.normalEventUploadPendingItems).call(n,0,1),10<=this.normalEventUploadPendingItems.length&&this.sendItems(this.normalEventUploadPendingItems,!1)}},{key:"doSend",value:function(){0<this.keyEventUploadPendingItems.length&&this.sendItems(this.keyEventUploadPendingItems,!0),0<this.normalEventUploadPendingItems.length&&5e3<=gf()-this.lastSendNormalEventTime&&this.sendItems(this.normalEventUploadPendingItems,!1)}},{key:"sendItems",value:function(e,t){for(var n=this,r=[],i=[];e.length;){var o=e.shift();20>r.length?r.push(o):i.push(o)}e.push.apply(e,u(i));for(var a=0,s=[].concat(r);a<s.length;a++){var c,l,d=s[a];-1!==Gc(c=this.ltsList).call(c,d.data.lts)?(d.data.lts=this.ltsList[this.ltsList.length-1]+1,this.ltsList.push(d.data.lts)):(this.ltsList.push(d.data.lts),Ju(l=this.ltsList).call(l,(function(e,t){return e-t})))}return t||(this.lastSendNormalEventTime=gf()),i={msgType:"EventMessages",sentTs:Math.round(gf()/1e3),payloads:Pc(r).call(r,(function(e){return Yr(e)})),vid:function(e){return(e=e&&e.data.sid&&n.baseInfoMap.get(e.data.sid))&&e.info.vid&&+e.info.vid||0}(r[0])},r.length&&this.postDataToStatsCollector(i).catch(function(e){return function(r){var i,o,a;t?n.keyEventUploadPendingItems=cs(i=n.keyEventUploadPendingItems).call(i,e):(n.normalEventUploadPendingItems=cs(o=n.normalEventUploadPendingItems).call(o,e),n.normalEventUploadPendingItems.length>Bu.NORMAL_EVENT_QUEUE_CAPACITY&&(Uc(a=n.normalEventUploadPendingItems).call(a,0,n.normalEventUploadPendingItems.length-Bu.NORMAL_EVENT_QUEUE_CAPACITY),Rl.warning("report: drop normal events")))}}(r)),e}},{key:"postDataToStatsCollector",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c,u,l,d=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=d.length>1&&void 0!==d[1]&&d[1],a=n?"/events/proto-raws":"/events/messages",s=this.url||(this.proxyServer?cs(r=cs(i="https://".concat(this.proxyServer,"/rs/?h=")).call(i,Bu.EVENT_REPORT_DOMAIN,"&p=6443&d=")).call(r,a):cs(o="https://".concat(Bu.EVENT_REPORT_DOMAIN,":6443")).call(o,a)),r=0;case 4:if(!(2>r)){e.next=25;break}if(1===r&&(s=this.backupUrl||(this.proxyServer?cs(c=cs(u="https://".concat(this.proxyServer,"/rs/?h=")).call(u,Bu.EVENT_REPORT_BACKUP_DOMAIN,"&p=6443&d=")).call(c,a):cs(l="https://".concat(Bu.EVENT_REPORT_BACKUP_DOMAIN,":6443")).call(l,a))),e.prev=6,!n){e.next=12;break}return e.next=10,Gt(s,{timeout:1e4,data:t});case 10:e.next=14;break;case 12:return e.next=14,Wt(s,{timeout:1e4,data:t});case 14:e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(6),1!==r){e.next=20;break}throw e.t0;case 20:return e.abrupt("continue",22);case 21:return e.abrupt("break",25);case 22:r+=1,e.next=4;break;case 25:case"end":return e.stop()}}),e,this,[[6,16]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createBaseInfo",value:function(e,t){var n=Sa({},Ql);return n.sid=e,this.baseInfoMap.set(e,{info:n,startTime:t}),n}}]),e}()),Vf=(g(_={},Ll.ACCESS_POINT,(g(e={},jl.NO_FLAG_SET,{desc:"flag is zero",retry:!1}),g(e,jl.FLAG_SET_BUT_EMPTY,{desc:"flag is empty",retry:!1}),g(e,jl.INVALID_FALG_SET,{desc:"invalid flag",retry:!1}),g(e,jl.NO_SERVICE_AVAILABLE,{desc:"no service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_P2P,{desc:"no unilbs p2p service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_VOET,{desc:"no unilbs voice service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_WEBRTC,{desc:"no unilbs webrtc service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_CDS,{desc:"no cds service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_CDN,{desc:"no cdn dispatcher service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_TDS,{desc:"no tds service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_REPORT,{desc:"no unilbs report service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_APP_CENTER,{desc:"no app center service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_ENV0,{desc:"no unilbs sig env0 service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_VOET,{desc:"no unilbs voet service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_STRING_UID,{desc:"no string uid service available",retry:!0}),g(e,jl.NO_SERVICE_AVAILABLE_WEBRTC_UNILBS,{desc:"no webrtc unilbs service available",retry:!0}),e)),g(_,Ll.UNILBS,(g(n={},Ul.INVALID_VENDOR_KEY,{desc:"invalid vendor key, can not find appid",retry:!1}),g(n,Ul.INVALID_CHANNEL_NAME,{desc:"invalid channel name",retry:!1}),g(n,Ul.INTERNAL_ERROR,{desc:"unilbs internal error",retry:!1}),g(n,Ul.NO_AUTHORIZED,{desc:"invalid token, authorized failed",retry:!1}),g(n,Ul.DYNAMIC_KEY_TIMEOUT,{desc:"dynamic key or token timeout",retry:!1}),g(n,Ul.NO_ACTIVE_STATUS,{desc:"no active status",retry:!1}),g(n,Ul.DYNAMIC_KEY_EXPIRED,{desc:"dynamic key expired",retry:!1}),g(n,Ul.STATIC_USE_DYNAMIC_KEY,{desc:"static use dynamic key",retry:!1}),g(n,Ul.DYNAMIC_USE_STATIC_KEY,{desc:"dynamic use static key",retry:!1}),g(n,Ul.USER_OVERLOAD,{desc:"amount of users over load",retry:!1}),g(n,Ul.FORBIDDEN_REGION,{desc:"the request is forbidden in this area",retry:!1}),g(n,Ul.CANNOT_MEET_AREA_DEMAND,{desc:"unable to allocate services in this area",retry:!1}),n)),g(_,Ll.STRING_UID_ALLOCATOR,(g(y={},Ml.IIIEGAL_APPID,{desc:"invalid appid",retry:!1}),g(y,Ml.IIIEGAL_UID,{desc:"invalid string uid",retry:!1}),g(y,Ml.INTERNAL_ERROR,{desc:"string uid allocator internal error",retry:!0}),y)),_),Bf=(g(b={},Fl.K_TIMESTAMP_EXPIRED,{desc:"K_TIMESTAMP_EXPIRED",action:"failed"}),g(b,Fl.K_CHANNEL_PERMISSION_INVALID,{desc:"K_CHANNEL_PERMISSION_INVALID",action:"failed"}),g(b,Fl.K_CERTIFICATE_INVALID,{desc:"K_CERTIFICATE_INVALID",action:"failed"}),g(b,Fl.K_CHANNEL_NAME_EMPTY,{desc:"K_CHANNEL_NAME_EMPTY",action:"failed"}),g(b,Fl.K_CHANNEL_NOT_FOUND,{desc:"K_CHANNEL_NOT_FOUND",action:"failed"}),g(b,Fl.K_TICKET_INVALID,{desc:"K_TICKET_INVALID",action:"failed"}),g(b,Fl.K_CHANNEL_CONFLICTED,{desc:"K_CHANNEL_CONFLICTED",action:"failed"}),g(b,Fl.K_SERVICE_NOT_READY,{desc:"K_SERVICE_NOT_READY",action:"tryNext"}),g(b,Fl.K_SERVICE_TOO_HEAVY,{desc:"K_SERVICE_TOO_HEAVY",action:"tryNext"}),g(b,Fl.K_UID_BANNED,{desc:"K_UID_BANNED",action:"failed"}),g(b,Fl.K_IP_BANNED,{desc:"K_IP_BANNED",action:"failed"}),g(b,Fl.ERR_INVALID_VENDOR_KEY,{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"}),g(b,Fl.ERR_INVALID_CHANNEL_NAME,{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"}),g(b,Fl.WARN_NO_AVAILABLE_CHANNEL,{desc:"WARN_NO_AVAILABLE_CHANNEL",action:"failed"}),g(b,Fl.WARN_LOOKUP_CHANNEL_TIMEOUT,{desc:"WARN_LOOKUP_CHANNEL_TIMEOUT",action:"tryNext"}),g(b,Fl.WARN_LOOKUP_CHANNEL_REJECTED,{desc:"WARN_LOOKUP_CHANNEL_REJECTED",action:"failed"}),g(b,Fl.WARN_OPEN_CHANNEL_TIMEOUT,{desc:"WARN_OPEN_CHANNEL_TIMEOUT",action:"tryNext"}),g(b,Fl.WARN_OPEN_CHANNEL_REJECTED,{desc:"WARN_OPEN_CHANNEL_REJECTED",action:"failed"}),g(b,Fl.WARN_REQUEST_DEFERRED,{desc:"WARN_REQUEST_DEFERRED",action:"failed"}),g(b,Fl.ERR_DYNAMIC_KEY_TIMEOUT,{desc:"ERR_DYNAMIC_KEY_TIMEOUT",action:"failed"}),g(b,Fl.ERR_NO_AUTHORIZED,{desc:"ERR_NO_AUTHORIZED",action:"failed"}),g(b,Fl.ERR_VOM_SERVICE_UNAVAILABLE,{desc:"ERR_VOM_SERVICE_UNAVAILABLE",action:"tryNext"}),g(b,Fl.ERR_NO_CHANNEL_AVAILABLE_CODE,{desc:"ERR_NO_CHANNEL_AVAILABLE_CODE",action:"failed"}),g(b,Fl.ERR_MASTER_VOCS_UNAVAILABLE,{desc:"ERR_MASTER_VOCS_UNAVAILABLE",action:"tryNext"}),g(b,Fl.ERR_INTERNAL_ERROR,{desc:"ERR_INTERNAL_ERROR",action:"tryNext"}),g(b,Fl.ERR_NO_ACTIVE_STATUS,{desc:"ERR_NO_ACTIVE_STATUS",action:"failed"}),g(b,Fl.ERR_INVALID_UID,{desc:"ERR_INVALID_UID",action:"failed"}),g(b,Fl.ERR_DYNAMIC_KEY_EXPIRED,{desc:"ERR_DYNAMIC_KEY_EXPIRED",action:"failed"}),g(b,Fl.ERR_STATIC_USE_DYANMIC_KE,{desc:"ERR_STATIC_USE_DYANMIC_KE",action:"failed"}),g(b,Fl.ERR_DYNAMIC_USE_STATIC_KE,{desc:"ERR_DYNAMIC_USE_STATIC_KE",action:"failed"}),g(b,Fl.ERR_NO_VOCS_AVAILABLE,{desc:"ERR_NO_VOCS_AVAILABLE",action:"tryNext"}),g(b,Fl.ERR_NO_VOS_AVAILABLE,{desc:"ERR_NO_VOS_AVAILABLE",action:"tryNext"}),g(b,Fl.ERR_JOIN_CHANNEL_TIMEOUT,{desc:"ERR_JOIN_CHANNEL_TIMEOUT",action:"tryNext"}),g(b,Fl.ERR_JOIN_BY_MULTI_IP,{desc:"ERR_JOIN_BY_MULTI_IP",action:"recover"}),g(b,Fl.ERR_NOT_JOINED,{desc:"ERR_NOT_JOINED",action:"failed"}),g(b,Fl.ERR_REPEAT_JOIN_REQUEST,{desc:"ERR_REPEAT_JOIN_REQUEST",action:"quit"}),g(b,Fl.ERR_REPEAT_JOIN_CHANNEL,{desc:"ERR_REPEAT_JOIN_CHANNEL",action:"quit"}),g(b,Fl.ERR_INVALID_VENDOR_KEY,{desc:"ERR_INVALID_VENDOR_KEY",action:"failed"}),g(b,Fl.ERR_INVALID_CHANNEL_NAME,{desc:"ERR_INVALID_CHANNEL_NAME",action:"failed"}),g(b,Fl.ERR_INVALID_STRINGUID,{desc:"ERR_INVALID_STRINGUID",action:"failed"}),g(b,Fl.ERR_TOO_MANY_USERS,{desc:"ERR_TOO_MANY_USERS",action:"tryNext"}),g(b,Fl.ERR_SET_CLIENT_ROLE_TIMEOUT,{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"}),g(b,Fl.ERR_SET_CLIENT_ROLE_NO_PERMISSION,{desc:"ERR_SET_CLIENT_ROLE_TIMEOUT",action:"failed"}),g(b,Fl.ERR_SET_CLIENT_ROLE_ALREADY_IN_USE,{desc:"ERR_SET_CLIENT_ROLE_ALREADY_IN_USE",action:"success"}),g(b,Fl.ERR_PUBLISH_REQUEST_INVALID,{desc:"ERR_PUBLISH_REQUEST_INVALID",action:"failed"}),g(b,Fl.ERR_SUBSCRIBE_REQUEST_INVALID,{desc:"ERR_SUBSCRIBE_REQUEST_INVALID",action:"failed"}),g(b,Fl.ERR_NOT_SUPPORTED_MESSAGE,{desc:"ERR_NOT_SUPPORTED_MESSAGE",action:"failed"}),g(b,Fl.ERR_ILLEAGAL_PLUGIN,{desc:"ERR_ILLEAGAL_PLUGIN",action:"failed"}),g(b,Fl.ILLEGAL_CLIENT_ROLE_LEVEL,{desc:"ILLEGAL_CLIENT_ROLE_LEVEL",action:"failed"}),g(b,Fl.ERR_REJOIN_TOKEN_INVALID,{desc:"ERR_REJOIN_TOKEN_INVALID",action:"failed"}),g(b,Fl.ERR_REJOIN_USER_NOT_JOINED,{desc:"ERR_REJOIN_NOT_JOINED",action:"failed"}),g(b,Fl.ERR_INVALID_OPTIONAL_INFO,{desc:"ERR_INVALID_OPTIONAL_INFO",action:"quit"}),g(b,Fl.ERR_TEST_RECOVER,{desc:"ERR_TEST_RECOVER",action:"recover"}),g(b,Fl.ERR_TEST_TRYNEXT,{desc:"ERR_TEST_TRYNEXT",action:"recover"}),g(b,Fl.ERR_TEST_RETRY,{desc:"ERR_TEST_RETRY",action:"recover"}),g(b,Fl.ILLEGAL_AES_PASSWORD,{desc:"ERR_TEST_RETRY",action:"failed"}),b),Wf={timeout:500,timeoutFactor:1.5,maxRetryCount:1/0,maxRetryTimeout:1e4},Gf=function(e){l(n,e);var t=d(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).currentURLIndex=i.connectionID=0,i.reconnectMode="tryNext",i._state="closed",i.reconnectCount=0,i.name=e,i.retryConfig=r,i}return h(n,[{key:"url",get:function(){return this.websocket?this.websocket.url:null}},{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&(this._state=e,"reconnecting"===this._state?this.emit(Xl.RECONNECTING,this.reconnectReason):"connected"===this._state?this.emit(Xl.CONNECTED):"closed"===this._state?this.emit(Xl.CLOSED):"failed"===this._state&&this.emit(Xl.FAILED))}},{key:"init",value:function(e){var t=this;return new kc((function(n,r){t.urls=e;var i=t.urls[t.currentURLIndex];t.state="connecting",t.createWebSocketConnection(i).then(n).catch(r),t.once(Xl.CLOSED,(function(){return r(new Al($u.WS_DISCONNECT))})),t.once(Xl.CONNECTED,(function(){return n()}))}))}},{key:"close",value:function(e,t){if(this.currentURLIndex=0,this.reconnectCount=0,this.websocket){this.websocket.onclose=null,this.websocket.onopen=null,this.websocket.onmessage=null;var n=this.websocket;t?jf((function(){return n.close()}),500):n.close(),this.websocket=void 0}this.state=e?"failed":"closed"}},{key:"reconnect",value:function(e,t){this.websocket?(void 0!==e&&(this.reconnectMode=e),Rl.debug("[".concat(this.name,"] reconnect is triggered initiative")),e=this.websocket.onclose,this.websocket.onclose=null,this.websocket.close(),e&&iu(e).call(e,this.websocket)({code:9999,reason:t})):Rl.warning("[".concat(this.name,"] can not reconnect, no websocket"))}},{key:"sendMessage",value:function(e){if(!this.websocket||this.websocket.readyState!==WebSocket.OPEN)throw new Al($u.WS_ABORT,"websocket is not ready");e=Yr(e);try{this.websocket.send(e)}catch(t){throw new Al($u.WS_ERR,"send websocket message error"+t.toString())}}},{key:"createWebSocketConnection",value:function(){var e=m(v.mark((function e(t){var n,r=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.connectionID+=1,e.abrupt("return",new kc((function(e,i){var o,a;r.websocket&&(r.websocket.onclose=null,r.websocket.close()),Bu.GATEWAY_WSS_ADDRESS&&bu(o=r.name).call(o,"gateway")&&(t=Bu.GATEWAY_WSS_ADDRESS),Rl.debug(cs(a="[".concat(r.name,"] start connect, url: ")).call(a,t));try{r.websocket=new WebSocket(t),r.websocket.binaryType="arraybuffer"}catch(c){var s;return o=new Al($u.WS_ERR,"init websocket failed! Error: ".concat(c.toString())),Rl.error(cs(s="[".concat(r.name,"]")).call(s,o)),void i(o)}ht(5e3).then((function(){n===r.connectionID&&r.websocket&&r.websocket.readyState!==WebSocket.OPEN&&r.websocket&&r.websocket.close()})),r.websocket.onopen=function(){Rl.debug("[".concat(r.name,"] websocket opened:"),t),r.reconnectMode="retry",r.state="connected",r.reconnectCount=0,e()},r.websocket.onclose=function(){var t=m(v.mark((function t(n){var o,a,s,c;return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Rl.debug(cs(o=cs(a=cs(s=cs(c="[".concat(r.name,"] websocket close ")).call(c,r.websocket&&r.websocket.url,", code: ")).call(s,n.code,", reason: ")).call(a,n.reason,", current mode: ")).call(o,r.reconnectMode)),!(r.reconnectCount<r.retryConfig.maxRetryCount)){t.next=13;break}return"connected"===r.state&&(r.reconnectReason=n.reason,r.state="reconnecting"),o=bt(r,Xl.WILL_RECONNECT,r.reconnectMode)||r.reconnectMode,t.next=5,r.reconnectWithAction(o);case 5:if(o=t.sent,"closed"!==r.state){t.next=8;break}return t.abrupt("return",void Rl.debug("[".concat(r.connectionID,"] ws is closed, no need to reconnect")));case 8:if(o){t.next=10;break}return t.abrupt("return",(i(new Al($u.WS_DISCONNECT,"websocket reconnect failed: ".concat(n.code))),void r.close(!0)));case 10:e(),t.next=14;break;case 13:i(new Al($u.WS_DISCONNECT,"websocket close: ".concat(n.code))),r.close();case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),r.websocket.onmessage=function(e){r.emit(Xl.ON_MESSAGE,e)}})));case 2:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"reconnectWithAction",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(!n&&this.reconnectCount>=this.retryConfig.maxRetryCount||!this.urls||"closed"===this.state)){e.next=2;break}return e.abrupt("return",!1);case 2:return this.onlineReconnectListener||!navigator||void 0===navigator.onLine||navigator.onLine||(this.onlineReconnectListener=new kc((function(e){var t=function t(){s.onlineReconnectListener=void 0,window.removeEventListener("online",t),e()};window.addEventListener("online",t)}))),n=function(e,t){return Math.min(t.maxRetryTimeout,t.timeout*Math.pow(t.timeoutFactor,e))}(this.reconnectCount,this.retryConfig),Rl.debug(cs(r=cs(i="[".concat(this.name,"] wait ")).call(i,n,"ms to reconnect websocket, mode: ")).call(r,t)),e.next=7,kc.race([ht(n),this.onlineReconnectListener||new kc((function(){}))]);case 7:if("closed"!==this.state){e.next=9;break}return e.abrupt("return",!1);case 9:if(this.reconnectCount+=1,e.prev=10,"retry"!==t){e.next=16;break}return e.next=14,this.createWebSocketConnection(this.urls[this.currentURLIndex]);case 14:e.next=35;break;case 16:if("tryNext"!==t){e.next=26;break}if(this.currentURLIndex+=1,!(this.currentURLIndex>=this.urls.length)){e.next=21;break}return e.next=20,this.reconnectWithAction("recover");case 20:return e.abrupt("return",e.sent);case 21:return Rl.debug(cs(o=cs(a="[".concat(this.name,"] websocket url length: ")).call(a,this.urls.length," current index: ")).call(o,this.currentURLIndex)),e.next=24,this.createWebSocketConnection(this.urls[this.currentURLIndex]);case 24:e.next=35;break;case 26:if(e.t0="recover"===t,!e.t0){e.next=35;break}return Rl.debug("[".concat(this.name,"] request new urls")),e.next=31,yt(this,Xl.REQUEST_NEW_URLS);case 31:return this.urls=e.sent,this.currentURLIndex=0,e.next=35,this.createWebSocketConnection(this.urls[this.currentURLIndex]);case 35:return e.abrupt("return",!0);case 38:return e.prev=38,e.t1=e.catch(10),Rl.error("[".concat(this.name,"] reconnect failed"),e.t1.toString()),e.next=43,this.reconnectWithAction(t);case 43:return e.abrupt("return",e.sent);case 44:case"end":return e.stop()}}),e,this,[[10,38]])})));function t(t,n){return e.apply(this,arguments)}return t}()}]),n}(yf),qf=function(){function e(t){f(this,e),this.input=[],this.size=t}return h(e,[{key:"add",value:function(e){var t;this.input.push(e),this.input.length>this.size&&Uc(t=this.input).call(t,0,1)}},{key:"mean",value:function(){var e;return 0===this.input.length?0:Na(e=this.input).call(e,(function(e,t){return e+t}))/this.input.length}}]),e}(),Kf=function(e){l(n,e);var t=d(n);function n(e){var r;return f(this,n),(r=t.call(this))._connectionState=Wl.CLOSED,r.openConnectionTime=gf(),r.lastMsgTime=gf(),r.uploadCache=[],r.rttRolling=new qf(5),r.pingpongTimeoutCount=0,r.onWebsocketMessage=function(e){if(e.data instanceof ArrayBuffer)r.emit(Gl.ON_BINARY_DATA,e.data);else if(e=JSON.parse(e.data),r.lastMsgTime=gf(),Object.prototype.hasOwnProperty.call(e,"_id")){var t="res-@".concat(e._id);r.emit(t,e._result,e._message)}else if(Object.prototype.hasOwnProperty.call(e,"_type")&&(r.emit(e._type,e._message),e._type===Hl.ON_NOTIFICATION&&r.handleNotification(e._message),e._type===Hl.ON_USER_BANNED))switch(e._message.error_code){case 14:r.close("UID_BANNED");break;case 15:r.close("IP_BANNED");break;case 16:r.close("CHANNEL_BANNED")}},r.clientId=e.clientId,r.spec=e,r.websocket=new Gf("gateway-".concat(r.clientId),r.spec.retryConfig),r.handleWebsocketEvents(),window.addEventListener("offline",(function(){r.connectionState===Wl.CONNECTED&&r.reconnect("retry",Bl.OFFLINE)})),r}return h(n,[{key:"connectionState",get:function(){return this._connectionState},set:function(e){e!==this._connectionState&&(this._connectionState=e,e===Wl.CONNECTED?this.emit(Gl.WS_CONNECTED):e===Wl.RECONNECTING?this.emit(Gl.WS_RECONNECTING,this._websocketReconnectReason):e===Wl.CLOSED&&this.emit(Gl.WS_CLOSED,this._disconnectedReason))}},{key:"currentURLIndex",get:function(){return this.websocket.currentURLIndex}},{key:"url",get:function(){return this.websocket?this.websocket.url:null}},{key:"rtt",get:function(){return this.rttRolling.mean()}},{key:"request",value:function(){var e=m(v.mark((function e(t,n,r){var i,o,a,s,c,u,l,d,f,h,p=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(u=vt(6,""),l={_id:u,_type:t,_message:n},d=this.websocket.connectionID,f=function(){return new kc((function(e,t){if(p.connectionState===Wl.CONNECTED)return e();var n=function(){p.off(Gl.WS_CLOSED,r),e()},r=function(){p.off(Gl.WS_CONNECTED,n),t(new Al($u.WS_ABORT))};p.once(Gl.WS_CONNECTED,n),p.once(Gl.WS_CLOSED,r)}))},e.t0=this.connectionState!==Wl.CONNECTING&&this.connectionState!==Wl.RECONNECTING||t===ql.JOIN||t===ql.REJOIN,e.t0){e.next=8;break}return e.next=8,f();case 8:return h=new kc((function(e,r){var i=!1,o=function(r,o){i=!0,e({isSuccess:"success"===r,message:o||{}}),p.off(Gl.WS_CLOSED,a),p.off(Gl.WS_RECONNECTING,a),p.emit(Gl.REQUEST_SUCCESS,t,n)};p.once("res-@".concat(u),o);var a=function e(){r(new Al($u.WS_ABORT,"type: ".concat(t))),p.off(Gl.WS_CLOSED,e),p.off(Gl.WS_RECONNECTING,e),p.off("res-@".concat(u),o)};p.once(Gl.WS_CLOSED,a),p.once(Gl.WS_RECONNECTING,a),ht(Bu.SIGNAL_REQUEST_TIMEOUT).then((function(){p.websocket.connectionID!==d||i||(Rl.warning("ws request timeout, type: ".concat(t)),p.emit(Gl.REQUEST_TIMEOUT,t,n))}))})),this.websocket.sendMessage(l),l=null,e.prev=11,e.next=14,h;case 14:l=e.sent,e.next=36;break;case 17:if(e.prev=17,e.t1=e.catch(11),this.connectionState!==Wl.CLOSED&&t!==ql.LEAVE){e.next=21;break}throw new Al($u.WS_ABORT);case 21:if(this.spec.forceWaitGatewayResponse&&!r){e.next=25;break}e.t2=e.t1.throw(),e.next=35;break;case 25:if(t!==ql.JOIN&&t!==ql.REJOIN){e.next=29;break}e.t3=null,e.next=34;break;case 29:return e.next=31,f();case 31:return e.next=33,this.request(t,n);case 33:e.t3=e.sent;case 34:e.t2=e.t3;case 35:return e.abrupt("return",e.t2);case 36:if(!l.isSuccess){e.next=38;break}return e.abrupt("return",l.message);case 38:if(r=Number(l.message.error_code||l.message.code),f=Qt(r),h=new Al($u.UNEXPECTED_RESPONSE,cs(i="".concat(f.desc,": ")).call(i,l.message.error_str),{code:r,data:l.message}),"success"!==f.action){e.next=45;break}e.t4=l.message,e.next=65;break;case 45:if(Rl.warning(cs(o=cs(a=cs(s=cs(c="[".concat(this.websocket.connectionID,"] unexpected response from type ")).call(c,t,", error_code: ")).call(s,r,", message: ")).call(a,f.desc,", action: ")).call(o,f.action)),"failed"!==f.action){e.next=50;break}e.t5=h.throw(),e.next=64;break;case 50:if("quit"!==f.action){e.next=54;break}e.t6=(this.initError=h,this.close(),h.throw()),e.next=63;break;case 54:if(r===Fl.ERR_JOIN_BY_MULTI_IP?(this.multiIpOption=l.message.option,Rl.warning("[".concat(this.clientId,"] detect multi ip, recover")),this.reconnect("recover",Bl.MULTI_IP)):this.reconnect(f.action,Bl.SERVER_ERROR),t!==ql.JOIN&&t!==ql.REJOIN){e.next=59;break}e.t7=null,e.next=62;break;case 59:return e.next=61,this.request(t,n);case 61:e.t7=e.sent;case 62:e.t6=e.t7;case 63:e.t5=e.t6;case 64:e.t4=e.t5;case 65:return e.abrupt("return",e.t4);case 66:case"end":return e.stop()}}),e,this,[[11,17]])})));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"waitMessage",value:function(e,t){var n=this;return new kc((function(r){var i=function i(o){t&&!t(o)||(n.off(e,i),r(o))};n.on(e,i)}))}},{key:"upload",value:function(e,t){var n=this;e={_type:e,_message:t};try{this.websocket.sendMessage(e)}catch(i){var r;Rl.info("[".concat(this.clientId,"] upload failed, cache message"),i),t=Bu.MAX_UPLOAD_CACHE||50,this.uploadCache.push(e),this.uploadCache.length>t&&Uc(r=this.uploadCache).call(r,0,1),0<this.uploadCache.length&&!this.uploadCacheInterval&&(this.uploadCacheInterval=window.setInterval((function(){var e;if(n.connectionState===Wl.CONNECTED){var t=Uc(e=n.uploadCache).call(e,0,1)[0];0===n.uploadCache.length&&(window.clearInterval(n.uploadCacheInterval),n.uploadCacheInterval=void 0),n.upload(t._type,t._message)}}),Bu.UPLOAD_CACHE_INTERVAL||2e3))}}},{key:"send",value:function(e,t){this.websocket.sendMessage({_type:e,_message:t})}},{key:"init",value:function(e){var t=this;return this.initError=void 0,this.multiIpOption=void 0,this.joinResponse=void 0,this.reconnectToken=void 0,new kc((function(n,r){t.once(Gl.WS_CONNECTED,(function(){return n(t.joinResponse)})),t.once(Gl.WS_CLOSED,(function(){return r(t.initError||new Al($u.WS_ABORT))})),t.connectionState=Wl.CONNECTING,t.websocket.init(e).catch(r)}))}},{key:"close",value:function(e){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.joinResponse=this.reconnectToken=void 0,this._disconnectedReason=e||"LEAVE",this.connectionState=Wl.CLOSED,this.websocket.close()}},{key:"join",value:function(){var e=m(v.mark((function e(){var t,n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.joinResponse){e.next=9;break}return n=Et(this,Gl.REQUEST_JOIN_INFO),e.next=4,this.request(ql.JOIN,n);case 4:if(n=e.sent){e.next=7;break}return e.abrupt("return",(this.emit(Gl.REPORT_JOIN_GATEWAY,$u.TIMEOUT,this.url||""),!1));case 7:this.joinResponse=n,this.reconnectToken=this.joinResponse.rejoin_token;case 9:return e.abrupt("return",(this.connectionState=Wl.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(iu(t=this.handlePingPong).call(t,this),3e3),!0));case 10:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"rejoin",value:function(){var e=m(v.mark((function e(){var t,n,r,i=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reconnectToken){e.next=2;break}throw new Al($u.UNEXPECTED_ERROR,"can not rejoin, no rejoin token");case 2:return(r=Et(this,Gl.REQUEST_REJOIN_INFO)).token=this.reconnectToken,e.next=6,this.request(ql.REJOIN,r);case 6:return r=e.sent,e.abrupt("return",!!r&&(this.connectionState=Wl.CONNECTED,this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval(iu(t=this.handlePingPong).call(t,this),3e3),r.peers&&ba(n=r.peers).call(n,(function(e){i.emit(Hl.ON_USER_ONLINE,{uid:e.uid}),e.audio_mute?i.emit(Hl.MUTE_AUDIO,{uid:e.uid}):i.emit(Hl.UNMUTE_AUDIO,{uid:e.uid}),e.video_mute?i.emit(Hl.MUTE_VIDEO,{uid:e.uid}):i.emit(Hl.UNMUTE_VIDEO,{uid:e.uid}),e.audio_enable_local?i.emit(Hl.ENABLE_LOCAL_AUDIO,{uid:e.uid}):i.emit(Hl.DISABLE_LOCAL_AUDIO,{uid:e.uid}),e.video_enable_local?i.emit(Hl.ENABLE_LOCAL_VIDEO,{uid:e.uid}):i.emit(Hl.DISABLE_LOCAL_VIDEO,{uid:e.uid}),e.audio||e.video||i.emit(Hl.ON_REMOVE_STREAM,{uid:e.uid,uint_id:e.uint_id}),e.audio&&i.emit(Hl.ON_ADD_AUDIO_STREAM,{uid:e.uid,uint_id:e.uint_id,audio:!0}),e.video&&i.emit(Hl.ON_ADD_VIDEO_STREAM,{uid:e.uid,uint_id:e.uint_id,video:!0})})),!0));case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reconnect",value:function(e,t){this.pingpongTimer&&(this.pingpongTimeoutCount=0,window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0),this.websocket.reconnect(e,t)}},{key:"handleNotification",value:function(e){if(Rl.debug("[".concat(this.clientId,"] receive notification: "),e),"success"!==(e=Qt(e.code)).action){if("failed"!==e.action)return"quit"===e.action?("ERR_REPEAT_JOIN_CHANNEL"===e.desc&&this.close("UID_BANNED"),void this.close()):void this.reconnect(e.action,Bl.SERVER_ERROR);Rl.error("[".concat(this.clientId,"] ignore error: "),e.desc)}}},{key:"handlePingPong",value:function(){var e=this;if(this.websocket&&"connected"===this.websocket.state){0<this.pingpongTimeoutCount&&this.rttRolling.add(3e3),this.pingpongTimeoutCount+=1;var t=Bu.PING_PONG_TIME_OUT,n=gf();this.pingpongTimeoutCount>=t&&(Rl.warning("PINGPONG Timeout. Last Socket Message: ".concat(n-this.lastMsgTime,"ms")),n-this.lastMsgTime>Bu.WEBSOCKET_TIMEOUT_MIN)?this.reconnect("retry",Bl.TIMEOUT):this.request(ql.PING,void 0,!0).then((function(){e.pingpongTimeoutCount=0;var t=gf()-n;e.rttRolling.add(t),Bu.REPORT_STATS&&e.send(ql.PING_BACK,{pingpongElapse:t})})).catch((function(e){}))}}},{key:"handleWebsocketEvents",value:function(){var e=this;this.websocket.on(Xl.ON_MESSAGE,this.onWebsocketMessage),this.websocket.on(Xl.CLOSED,(function(){e.connectionState=Wl.CLOSED})),this.websocket.on(Xl.FAILED,(function(){e._disconnectedReason="NETWORK_ERROR",e.connectionState=Wl.CLOSED})),this.websocket.on(Xl.RECONNECTING,(function(t){e._websocketReconnectReason=t,e.joinResponse=void 0,e.connectionState===Wl.CONNECTED?e.connectionState=Wl.RECONNECTING:e.connectionState=Wl.CONNECTING})),this.websocket.on(Xl.WILL_RECONNECT,(function(t,n){if(Et(e,Gl.IS_P2P_DISCONNECTED)&&"retry"===t)return e.reconnectToken=void 0,e.emit(Gl.NEED_RENEW_SESSION),e.emit(Gl.DISCONNECT_P2P),n("tryNext");"retry"!==t&&(e.reconnectToken=void 0,e.emit(Gl.NEED_RENEW_SESSION),e.emit(Gl.DISCONNECT_P2P)),n(t)})),this.websocket.on(Xl.CONNECTED,(function(){e.openConnectionTime=gf(),e.reconnectToken?e.rejoin().catch((function(t){var n;Rl.warning(cs(n="[".concat(e.clientId,"] rejoin failed ")).call(n,t)),e.reconnect("tryNext",Bl.SERVER_ERROR)})):e.join().catch((function(t){if(e.emit(Gl.REPORT_JOIN_GATEWAY,t.code,e.url||""),t instanceof Al&&t.code===$u.UNEXPECTED_RESPONSE&&t.data.code===Fl.ERR_NO_AUTHORIZED)return Rl.warning("[".concat(e.clientId,"] reconnect no authorized, recover")),void e.reconnect("recover",Bl.SERVER_ERROR);Rl.error("[".concat(e.clientId,"] join gateway request failed"),t.toString()),e.spec.forceWaitGatewayResponse?e.reconnect("tryNext",Bl.SERVER_ERROR):(e.initError=t,e.close())}))})),this.websocket.on(Xl.REQUEST_NEW_URLS,(function(t,n){yt(e,Gl.REQUEST_RECOVER,e.multiIpOption).then(t).catch(n)}))}}]),n}(yf),Hf=function(e){l(n,e);var t=d(n);function n(e,r){var i;return f(this,n),(i=t.call(this))._hints=[],i._ID=r||vt(8,"track-"),i._mediaStreamTrack=i._originMediaStreamTrack=e,i}return h(n,[{key:"toString",value:function(){return this._ID}},{key:"getTrackId",value:function(){return this._ID}},{key:"getMediaStreamTrack",value:function(){return this._mediaStreamTrack}}]),n}(yf),zf=function(e){l(n,e);var t=d(n);function n(e,r){var i;return f(this,n),(i=t.call(this,e,r))._enabled=!0,i._isClosed=!1,i._trackProcessors=[],i._handleTrackEnded=function(){Rl.debug("[".concat(i.getTrackId,"] track ended")),i.emit(dd.TRACK_ENDED)},i._enabledMutex=new kf("".concat(r)),e.addEventListener("ended",i._handleTrackEnded),i}return h(n,[{key:"getTrackLabel",value:function(){return this._originMediaStreamTrack.label}},{key:"close",value:function(){var e;this._isClosed||(this.stop(),ba(e=this._trackProcessors).call(e,(function(e){return e.destroy()})),this._trackProcessors=[],this._originMediaStreamTrack.stop(),this._mediaStreamTrack!==this._originMediaStreamTrack&&(this._mediaStreamTrack.stop(),this._mediaStreamTrack=null),this._originMediaStreamTrack=null,this._enabledMutex=null,Rl.debug("[".concat(this.getTrackId(),"] close")),this.emit(ud.NEED_CLOSE),this._isClosed=!0)}},{key:"_registerTrackProcessor",value:function(){var e=m(v.mark((function e(t){var n,r,i=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(-1!==Gc(n=this._trackProcessors).call(n,t)){e.next=12;break}if(r=this._trackProcessors[this._trackProcessors.length-1],this._trackProcessors.push(t),t.onOutputChange=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i._mediaStreamTrack=t.output||i._originMediaStreamTrack,i._updatePlayerSource(),e.next=4,_t(i,ud.NEED_REPLACE_TRACK,i._mediaStreamTrack);case 4:case"end":return e.stop()}}),e)}))),!r){e.next=10;break}return r.onOutputChange=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=r.output,!e.t0){e.next=4;break}return e.next=4,t.setInput(r.output);case 4:case"end":return e.stop()}}),e)}))),e.next=8,t.setInput(r.output||r.input||this._originMediaStreamTrack);case 8:e.next=12;break;case 10:return e.next=12,t.setInput(this._originMediaStreamTrack);case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_getOutputFromProcessors",value:function(){if(0===this._trackProcessors.length)return this._originMediaStreamTrack;var e=this._trackProcessors[this._trackProcessors.length-1];return e.output||e.input||this._originMediaStreamTrack}},{key:"_updateOriginMediaStreamTrack",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=t!==this._originMediaStreamTrack,!e.t0){e.next=12;break}if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop(),t.addEventListener("ended",this._handleTrackEnded),this._originMediaStreamTrack=t,!(0<this._trackProcessors.length)){e.next=8;break}return e.next=5,this._trackProcessors[0].setInput(t);case 5:this._mediaStreamTrack=this._getOutputFromProcessors(),e.next=9;break;case 8:this._mediaStreamTrack=this._originMediaStreamTrack;case 9:return this._updatePlayerSource(),e.next=12,_t(this,ud.NEED_REPLACE_TRACK,this._mediaStreamTrack);case 12:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"_getDefaultPlayerConfig",value:function(){return{}}}]),n}(Hf),Yf=window.AudioContext||window.webkitAudioContext,Qf=null,Xf=new yf,Jf=null,$f=function(e){l(n,e);var t=d(n);function n(){var e;return f(this,n),(e=t.call(this)).isPlayed=!1,e.audioOutputLevel=e.audioLevelBase=0,e.audioOutputLevelCache=null,e.audioOutputLevelCacheMaxLength=Bu.AUDIO_SOURCE_AVG_VOLUME_DURATION/Bu.AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL||15,e.isDestroyed=!1,e._noAudioInputCount=0,e.context=$t(),e.playNode=e.context.destination,e.outputNode=e.context.createGain(),Zt(e.outputNode),e.analyserNode=e.context.createAnalyser(),e}return h(n,[{key:"isNoAudioInput",get:function(){return 3<=this.noAudioInputCount}},{key:"noAudioInputCount",get:function(){return this._noAudioInputCount},set:function(e){3>this._noAudioInputCount&&3<=e?this.onNoAudioInput&&this.onNoAudioInput():3<=this._noAudioInputCount&&0==this._noAudioInputCount%10&&this.onNoAudioInput&&this.onNoAudioInput(),this._noAudioInputCount=e}},{key:"startGetAudioBuffer",value:function(e){var t=this;this.audioBufferNode||(this.audioBufferNode=this.context.createScriptProcessor(e),this.outputNode.connect(this.audioBufferNode),this.audioBufferNode.connect(this.context.destination),this.audioBufferNode.onaudioprocess=function(e){t.emit(Yl.ON_AUDIO_BUFFER,function(e){for(var t=0;t<e.outputBuffer.numberOfChannels;t+=1)for(var n=e.outputBuffer.getChannelData(t),r=0;r<n.length;r+=1)n[r]=0;return e.inputBuffer}(e))})}},{key:"stopGetAudioBuffer",value:function(){this.audioBufferNode&&(this.audioBufferNode.onaudioprocess=null,this.outputNode.disconnect(this.audioBufferNode),this.audioBufferNode=void 0)}},{key:"createOutputTrack",value:function(){if(!Ed.webAudioMediaStreamDest)throw new Al($u.NOT_SUPPORTED,"your browser is not support audio processor");return this.destNode&&this.outputTrack||(this.destNode=this.context.createMediaStreamDestination(),this.outputNode.connect(this.destNode),this.outputTrack=this.destNode.stream.getAudioTracks()[0]),this.outputTrack}},{key:"play",value:function(e){"running"!==this.context.state&&St((function(){Xf.emit("autoplay-failed")})),this.isPlayed=!0,this.playNode=e||this.context.destination,this.outputNode.connect(this.playNode)}},{key:"stop",value:function(){if(this.isPlayed)try{this.outputNode.disconnect(this.playNode)}catch(wl){}this.isPlayed=!1}},{key:"getAudioLevel",value:function(){return this.audioOutputLevel}},{key:"getAccurateVolumeLevel",value:function(){var e=new Uint8Array(this.analyserNode.frequencyBinCount);this.analyserNode.getByteFrequencyData(e);for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length}},{key:"getAudioAvgLevel",value:function(){var e;return null===this.audioOutputLevelCache&&(this.audioOutputLevelCache=[this.audioOutputLevel]),Na(e=this.audioOutputLevelCache).call(e,(function(e,t){return e+t}))/this.audioOutputLevelCache.length}},{key:"getAudioVolume",value:function(){return this.outputNode.gain.value}},{key:"setVolume",value:function(e){this.outputNode.gain.setValueAtTime(e,this.context.currentTime)}},{key:"setMute",value:function(e){e?(this.disconnect(),this.audioLevelBase=0,this.audioOutputLevel=0):this.connect()}},{key:"destroy",value:function(){this.disconnect(),this.stop(),this.isDestroyed=!0,this.onNoAudioInput=void 0}},{key:"disconnect",value:function(){this.sourceNode&&this.sourceNode.disconnect(),this.outputNode&&this.outputNode.disconnect(),window.clearInterval(this.updateAudioOutputLevelInterval)}},{key:"connect",value:function(){var e;this.sourceNode&&this.sourceNode.connect(this.outputNode),this.outputNode.connect(this.analyserNode),this.updateAudioOutputLevelInterval=window.setInterval(iu(e=this.updateAudioOutputLevel).call(e,this),Bu.AUDIO_SOURCE_VOLUME_UPDATE_INTERVAL||400)}},{key:"updateAudioOutputLevel",value:function(){if(this.context&&"running"!==this.context.state&&this.context.resume(),this.analyserNode){if(this.analyserNode.getFloatTimeDomainData){var e=new Float32Array(this.analyserNode.frequencyBinCount);this.analyserNode.getFloatTimeDomainData(e)}else{var t;e=new Uint8Array(this.analyserNode.frequencyBinCount),this.analyserNode.getByteTimeDomainData(e);var n=!0;e=new Float32Array(Pc(t=vf(e)).call(t,(function(e){return 128!==e&&(n=!1),.0078125*(e-128)}))),n?this.noAudioInputCount+=1:this.noAudioInputCount=0}for(t=0;t<e.length;t+=1)Math.abs(e[t])>this.audioLevelBase&&(this.audioLevelBase=Math.abs(e[t]),1<this.audioLevelBase&&(this.audioLevelBase=1));this.audioOutputLevel=this.audioLevelBase,this.audioLevelBase/=4,null!==this.audioOutputLevelCache&&(this.audioOutputLevelCache.push(this.audioOutputLevel),this.audioOutputLevelCache.length>this.audioOutputLevelCacheMaxLength&&this.audioOutputLevelCache.shift())}}}]),n}(yf),Zf=function(e){l(n,e);var t=d(n);function n(e,r){var i;if(f(this,n),(i=t.call(this)).isCurrentTrackCloned=!1,i.isRemoteTrack=!1,i.rebuildWebAudio=function(){if(!i.isNoAudioInput||i.isDestroyed)return document.body.removeEventListener("click",i.rebuildWebAudio,!0),void Rl.debug("rebuild web audio success, current volume",i.getAudioLevel());i.context.resume().then((function(){return Rl.info("resume success")})),Rl.debug("rebuild web audio because of ios 12 bugs"),i.disconnect();var e=i.track;i.track=i.track.clone(),i.isCurrentTrackCloned?e.stop():i.isCurrentTrackCloned=!0,e=new MediaStream([i.track]),i.sourceNode=i.context.createMediaStreamSource(e),Zt(i.sourceNode),i.analyserNode=i.context.createAnalyser();var t=i.outputNode.gain.value;i.outputNode=i.context.createGain(),i.outputNode.gain.setValueAtTime(t,i.context.currentTime),Zt(i.outputNode),i.connect(),i.audioElement.srcObject=e,i.isPlayed&&i.play(i.playNode)},"audio"!==e.kind)throw new Al($u.UNEXPECTED_ERROR);return i.track=e,e=new MediaStream([i.track]),i.isRemoteTrack=!!r,i.sourceNode=i.context.createMediaStreamSource(e),Zt(i.sourceNode),i.connect(),i.audioElement=document.createElement("audio"),i.audioElement.srcObject=e,e=Ze(),r&&e.os===Eu.IOS&&(Xf.on("state-change",i.rebuildWebAudio),i.onNoAudioInput=function(){document.body.addEventListener("click",i.rebuildWebAudio,!0),i.rebuildWebAudio(),document.body.click()}),o(i)}return h(n,[{key:"isFreeze",get:function(){return!1}},{key:"updateTrack",value:function(e){this.sourceNode.disconnect(),this.track=e,this.isCurrentTrackCloned=!1,e=new MediaStream([e]),this.sourceNode=this.context.createMediaStreamSource(e),Zt(this.sourceNode),this.sourceNode.connect(this.outputNode),this.audioElement.srcObject=e}},{key:"destroy",value:function(){this.audioElement.remove(),Xf.off("state-change",this.rebuildWebAudio),a(s(n.prototype),"destroy",this).call(this)}}]),n}($f),eh=new(function(){function e(){f(this,e),this.elementMap=new ra,this.elementsNeedToResume=[],this.sinkIdMap=new ra,this.autoResumeAudioElement()}return h(e,[{key:"setSinkID",value:function(){var e=m(v.mark((function e(t,n){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.elementMap.get(t),this.sinkIdMap.set(t,n),!r){e.next=10;break}return e.prev=2,e.next=5,r.setSinkId(n);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),new Al($u.PERMISSION_DENIED,"can not set sink id: "+e.t0.toString());case 10:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"play",value:function(e,t){var n=this;if(!this.elementMap.has(t)){var r=document.createElement("audio");r.autoplay=!0,r.srcObject=new MediaStream([e]),this.elementMap.set(t,r),(e=this.sinkIdMap.get(t))&&r.setSinkId(e).catch((function(e){Rl.warning("[".concat(t,"] set sink id failed"),e.toString())})),(e=r.play())&&e.then&&e.catch((function(e){Rl.warning("audio element play warning",e.toString()),n.elementMap.has(t)&&"NotAllowedError"===e.name&&(Rl.warning("detected audio element autoplay failed"),n.elementsNeedToResume.push(r),St((function(){n.onAutoplayFailed&&n.onAutoplayFailed()})))}))}}},{key:"updateTrack",value:function(e,t){(e=this.elementMap.get(e))&&(e.srcObject=new MediaStream([t]))}},{key:"isPlaying",value:function(e){return this.elementMap.has(e)}},{key:"setVolume",value:function(e,t){(e=this.elementMap.get(e))&&(t=Math.max(0,Math.min(100,t)),e.volume=t/100)}},{key:"stop",value:function(e){var t,n,r=this.elementMap.get(e);if(this.sinkIdMap.delete(e),r){var i=Gc(t=this.elementsNeedToResume).call(t,r);Uc(n=this.elementsNeedToResume).call(n,i,1),r.srcObject=null,r.remove(),this.elementMap.delete(e)}}},{key:"autoResumeAudioElement",value:function(){var e=this,t=function(){var t;ba(t=e.elementsNeedToResume).call(t,(function(e){e.play().then((function(e){Rl.debug("Auto resume audio element success")})).catch((function(e){Rl.warning("Auto resume audio element failed!",e)}))})),e.elementsNeedToResume=[]};new kc((function(e){document.body?e():window.addEventListener("load",(function(){return e()}))})).then((function(){document.body.addEventListener("touchstart",t,!0),document.body.addEventListener("mousedown",t,!0)}))}}]),e}()),th=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return f(this,n),(o=t.call(this,e,i)).trackMediaType="audio",o._enabled=!0,o._useAudioElement=!1,o._encoderConfig=r,o._source=new Zf(e),Ed.webAudioWithAEC||(o._useAudioElement=!0),o}return h(n,[{key:"isPlaying",get:function(){return this._useAudioElement?eh.isPlaying(this.getTrackId()):this._source.isPlayed}},{key:"setVolume",value:function(e){var t=this;Fe(e,"volume",0,1e3);var n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_AUDIO_TRACK_SET_VOLUME,options:[this.getTrackId(),e]},300);this._source.setVolume(e/100);try{var r=this._source.createOutputTrack();this._mediaStreamTrack!==r&&(this._mediaStreamTrack=r,_t(this,ud.NEED_REPLACE_TRACK,this._mediaStreamTrack).then((function(){Rl.debug("[".concat(t.getTrackId(),"] replace web audio track success"))})).catch((function(e){Rl.warning("[".concat(t.getTrackId(),"] replace web audio track failed"),e)})))}catch(i){}n.onSuccess()}},{key:"getVolumeLevel",value:function(){return this._source.getAudioLevel()}},{key:"setPlaybackDevice",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),t]}),this._useAudioElement){e.next=3;break}throw new Al($u.NOT_SUPPORTED,"your browser does not support setting the audio output device");case 3:return e.prev=3,e.next=6,eh.setSinkID(this.getTrackId(),t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),n.onError(e.t0),e.t0;case 11:n.onSuccess();case 12:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setEnabled",value:function(){var e=m(v.mark((function e(t){var n,r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this._enabled){e.next=28;break}return Rl.info("[".concat(this.getTrackId(),"] start setEnabled"),t),e.next=4,this._enabledMutex.lock();case 4:if(r=e.sent,t){e.next=16;break}return this._originMediaStreamTrack.enabled=!1,e.prev=7,e.next=10,_t(this,ud.NEED_REMOVE_TRACK,this);case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(7),Rl.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.t0.toString()),r(),e.t0;case 15:return e.abrupt("return",(this._enabled=!1,r()));case 16:return this._originMediaStreamTrack.enabled=!0,e.prev=17,e.next=20,_t(this,ud.NEED_ADD_TRACK,this);case 20:e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(17),Rl.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.t1.toString()),r(),e.t1;case 25:Rl.info(cs(n="[".concat(this.getTrackId(),"] setEnabled to ")).call(n,t," success")),this._enabled=!0,r();case 28:case"end":return e.stop()}}),e,this,[[7,12],[17,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getStats",value:function(){return It((function(){Rl.warning("[deprecated] LocalAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalAudioStats instead")}),"localAudioTrackGetStatsWarning"),bt(this,ud.GET_STATS)||nn({},$l)}},{key:"setAudioFrameCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Yl.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Yl.ON_AUDIO_BUFFER),this._source.on(Yl.ON_AUDIO_BUFFER,(function(t){return e(t)}))}},{key:"play",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rl.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rl.debug("[".concat(this.getTrackId(),"] start audio playback in element")),eh.play(this._mediaStreamTrack,this.getTrackId())):this._source.play(),e.onSuccess()}},{key:"stop",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rl.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?eh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}},{key:"close",value:function(){a(s(n.prototype),"close",this).call(this),this._source.destroy()}},{key:"_updatePlayerSource",value:function(){Rl.debug("[track-".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&eh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}},{key:"_updateOriginMediaStreamTrack",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this._originMediaStreamTrack!==t,!e.t0){e.next=13;break}if(this._originMediaStreamTrack.removeEventListener("ended",this._handleTrackEnded),t.addEventListener("ended",this._handleTrackEnded),n&&this._originMediaStreamTrack.stop(),this._originMediaStreamTrack=t,this._source.updateTrack(this._originMediaStreamTrack),e.t1=this._mediaStreamTrack!==this._source.outputTrack,!e.t1){e.next=13;break}return this._mediaStreamTrack=this._originMediaStreamTrack,this._updatePlayerSource(),e.next=13,_t(this,ud.NEED_REPLACE_TRACK,this._mediaStreamTrack);case 13:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()}]),n}(zf),nh=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this,e,r.encoderConfig?_e(r.encoderConfig):{},o))._deviceName="default",a._enabled=!0,a._config=r,a._constraints=i,a._deviceName=e.label,a}return h(n,[{key:"setDevice",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.MIC_AUDIO_TRACK_SET_DEVICE,options:[this.getTrackId(),t]}),Rl.info(cs(n="[".concat(this.getTrackId,"] start set device to ")).call(n,t)),!this._enabled){e.next=38;break}return e.prev=2,e.next=5,Df.getDeviceById(t);case 5:return o=e.sent,(n={}).audio=nn({},this._constraints),n.audio.deviceId={exact:t},this._originMediaStreamTrack.stop(),a=null,e.prev=11,e.next=14,Lt(n,this.getTrackId());case 14:a=e.sent,e.next=26;break;case 17:return e.prev=17,e.t0=e.catch(11),Rl.error("[track-".concat(this.getTrackId(),"] setDevice failed"),e.t0.toString()),e.next=22,Lt({video:this._constraints},this.getTrackId());case 22:return a=e.sent,e.next=25,this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1);case 25:throw e.t0;case 26:return e.next=28,this._updateOriginMediaStreamTrack(a.getAudioTracks()[0],!1);case 28:this._deviceName=o.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t},e.next=36;break;case 33:throw e.prev=33,e.t1=e.catch(2),i.onError(e.t1),Rl.error("[track-".concat(this.getTrackId(),"] setDevice error"),e.t1.toString()),e.t1;case 36:e.next=49;break;case 38:return e.prev=38,e.next=41,Df.getDeviceById(t);case 41:this._deviceName=e.sent.label,this._config.microphoneId=t,this._constraints.deviceId={exact:t},e.next=49;break;case 46:throw e.prev=46,e.t2=e.catch(38),i.onError(e.t2),Rl.error("[track-".concat(this.getTrackId(),"] setDevice error"),e.t2.toString()),e.t2;case 49:i.onSuccess(),Rl.info(cs(r="[".concat(this.getTrackId,"] set device to ")).call(r,t," success"));case 51:case"end":return e.stop()}}),e,this,[[2,33],[11,17],[38,46]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setEnabled",value:function(){var e=m(v.mark((function e(t,r){var i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=5;break}return Rl.debug("[".concat(this.getTrackId,"] setEnabled false (do not close microphone)")),e.next=4,a(s(n.prototype),"setEnabled",this).call(this,t);case 4:return e.abrupt("return",e.sent);case 5:if(t===this._enabled){e.next=42;break}return Rl.info("[".concat(this.getTrackId(),"] start setEnabled"),t),e.next=9,this._enabledMutex.lock();case 9:if(r=e.sent,t){e.next=23;break}return this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),this._enabled=!1,e.prev=14,e.next=17,_t(this,ud.NEED_REMOVE_TRACK,this);case 17:e.next=22;break;case 19:throw e.prev=19,e.t0=e.catch(14),Rl.error("[".concat(this.getTrackId(),"] setEnabled false failed"),e.t0.toString()),r(),e.t0;case 22:return e.abrupt("return",void r());case 23:return t=nn({},this._constraints),(i=Df.searchDeviceIdByName(this._deviceName))&&!t.deviceId&&(t.deviceId=i),e.prev=26,e.next=29,Lt({audio:this._constraints},this.getTrackId());case 29:return o=e.sent,e.next=32,this._updateOriginMediaStreamTrack(o.getAudioTracks()[0],!1);case 32:return e.next=34,_t(this,ud.NEED_ADD_TRACK,this);case 34:e.next=39;break;case 36:throw e.prev=36,e.t1=e.catch(26),r(),Rl.error("[".concat(this.getTrackId(),"] setEnabled true failed"),e.t1.toString()),e.t1;case 39:this._enabled=!0,Rl.info("[".concat(this.getTrackId(),"] setEnabled success")),r();case 42:case"end":return e.stop()}}),e,this,[[14,19],[26,36]])})));function t(t,n){return e.apply(this,arguments)}return t}()}]),n}(th),rh=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;f(this,n),(a=t.call(this,r.createOutputTrack(),i,o)).source=e,a._bufferSource=r,a._bufferSource.on(Yl.AUDIO_SOURCE_STATE_CHANGE,(function(e){a.emit(dd.SOURCE_STATE_CHANGE,e)}));try{a._mediaStreamTrack=a._source.createOutputTrack()}catch(s){}return a}return h(n,[{key:"currentState",get:function(){return this._bufferSource.currentState}},{key:"duration",get:function(){return this._bufferSource.duration}},{key:"getCurrentTime",value:function(){return this._bufferSource.currentTime}},{key:"startProcessAudioBuffer",value:function(e){var t=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.BUFFER_AUDIO_TRACK_START,options:[this.getTrackId(),e,this.duration]});e&&this._bufferSource.updateOptions(e),this._bufferSource.startProcessAudioBuffer(),t.onSuccess()}},{key:"pauseProcessAudioBuffer",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.BUFFER_AUDIO_TRACK_PAUSE,options:[this.getTrackId()]});this._bufferSource.pauseProcessAudioBuffer(),e.onSuccess()}},{key:"seekAudioBuffer",value:function(e){var t=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.BUFFER_AUDIO_TRACK_SEEK,options:[this.getTrackId()]});this._bufferSource.seekAudioBuffer(e),t.onSuccess()}},{key:"resumeProcessAudioBuffer",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.BUFFER_AUDIO_TRACK_RESUME,options:[this.getTrackId()]});this._bufferSource.resumeProcessAudioBuffer(),e.onSuccess()}},{key:"stopProcessAudioBuffer",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.BUFFER_AUDIO_TRACK_STOP,options:[this.getTrackId()]});this._bufferSource.stopProcessAudioBuffer(),e.onSuccess()}}]),n}(th),ih=function(e){l(n,e);var t=d(n);function n(){var e;f(this,n);var r=$t().createMediaStreamDestination();e=t.call(this,r.stream.getAudioTracks()[0]);try{e._mediaStreamTrack=e._source.createOutputTrack()}catch(i){}return e.destNode=r,e.trackList=[],e}return h(n,[{key:"hasAudioTrack",value:function(e){var t;return-1!==Gc(t=this.trackList).call(t,e)}},{key:"addAudioTrack",value:function(e){var t;-1===Gc(t=this.trackList).call(t,e)?(Rl.debug("add ".concat(e.getTrackId()," to mixing track")),e._source.outputNode.connect(this.destNode),this.trackList.push(e),this.updateEncoderConfig()):Rl.warning("track is already added")}},{key:"removeAudioTrack",value:function(e){var t;if(-1!==Gc(t=this.trackList).call(t,e)){Rl.debug("remove ".concat(e.getTrackId()," from mixing track"));try{e._source.outputNode.disconnect(this.destNode)}catch(n){}wt(this.trackList,e),this.updateEncoderConfig()}}},{key:"updateEncoderConfig",value:function(){var e,t={};ba(e=this.trackList).call(e,(function(e){e._encoderConfig&&((e._encoderConfig.bitrate||0)>(t.bitrate||0)&&(t.bitrate=e._encoderConfig.bitrate),(e._encoderConfig.sampleRate||0)>(t.sampleRate||0)&&(t.sampleRate=e._encoderConfig.sampleRate),(e._encoderConfig.sampleSize||0)>(t.sampleSize||0)&&(t.sampleSize=e._encoderConfig.sampleSize),e._encoderConfig.stereo&&(t.stereo=!0))})),this._encoderConfig=t}}]),n}(th),oh=function(e,t){var n,r=e.length;for(n=e,n=function(e,t){if(0===t)return e;var n=new e.constructor(e.length+t);return t=new e.constructor(t),n.set(e,0),n.set(t,e.length),n}(e=(new TextEncoder).encode(n),(4-e.length%4)%4),r=function(e,t,n){return(n=new n(e.length+t.length)).set(e,0),n.set(t,e.length),n}([r],new Uint32Array(n.buffer),Uint32Array),n=0;n<r.length;n++)r[n]^=t,r[n]=~r[n];return At(new Uint8Array(r.buffer))},ah=new ra,sh=function(e){l(n,e);var t=d(n);function n(e){var r;return f(this,n),(r=t.call(this)).inChannelInfo={joinAt:null,duration:0},r._state="DISCONNECTED",r.needToSendUnpubUnsub=new ra,r.hasChangeBGPAddress=r.isSignalRecover=!1,r.joinGatewayStartTime=0,r._signalTimeout=!1,r.clientId=e.clientId,r.spec=e,r.signal=new Kf(on({},e,{retryConfig:e.websocketRetryConfig})),r._statsCollector=e.statsCollector,r.role=e.role||"audience",r._clientRoleOptions=e.clientRoleOptions,r.handleSignalEvents(),r}return h(n,[{key:"state",get:function(){return this._state},set:function(e){if(e!==this._state){var t=this._state;this._state=e,"DISCONNECTED"===e&&this._disconnectedReason?this.emit(cd.CONNECTION_STATE_CHANGE,e,t,this._disconnectedReason):this.emit(cd.CONNECTION_STATE_CHANGE,e,t)}}},{key:"join",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("disabled"!==t.cloudProxyServer&&(this.hasChangeBGPAddress=!0),o=gf(),(a=ah.get(t.cname))||(a=new ra,ah.set(t.cname,a)),!a.has(t.uid)){e.next=5;break}throw a=new Al($u.UID_CONFLICT),Ff.joinGateway(t.sid,{lts:o,succ:!1,ec:a.code,addr:null,uid:t.uid,cid:t.cid}),a;case 5:return a.set(t.uid,!0),this.joinInfo=t,this.key=n,n=t.proxyServer?Pc(r=t.gatewayAddrs).call(r,(function(e){var n,r;return e=e.split(":"),cs(n=cs(r="wss://".concat(t.proxyServer,"/ws/?h=")).call(r,e[0],"&p=")).call(n,e[1])})):Pc(i=t.gatewayAddrs).call(i,(function(e){return"wss://".concat(e)})),r=0,this.joinGatewayStartTime=o,e.prev=11,e.next=14,this.signal.init(n);case 14:r=e.sent.uid,e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(11),Rl.error("[".concat(this.clientId,"] User join failed"),e.t0.toString()),Ff.joinGateway(t.sid,{lts:o,succ:!1,ec:e.t0.code===$u.UNEXPECTED_ERROR?e.t0.message:e.t0.code,addr:this.signal.url,uid:t.uid,cid:t.cid}),a.delete(t.uid),this.signal.close(),e.t0;case 20:return e.abrupt("return",(this.state="CONNECTED",this.inChannelInfo.joinAt=gf(),Rl.debug("[".concat(this.clientId,"] Connected to gateway server")),this.trafficStatsInterval=window.setInterval((function(){s.updateTrafficStats().catch((function(e){Rl.warning("[".concat(s.clientId,"] get traffic stats error"),e.toString())}))}),3e3),this.networkQualityInterval=window.setInterval((function(){navigator&&void 0!==navigator.onLine&&!navigator.onLine?s.emit(cd.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6}):s._signalTimeout?s.emit(cd.NETWORK_QUALITY,{downlinkNetworkQuality:5,uplinkNetworkQuality:5}):"CONNECTED"===s.state&&s._statsCollector.trafficStats?s.emit(cd.NETWORK_QUALITY,{uplinkNetworkQuality:ct(s._statsCollector.trafficStats.B_unq),downlinkNetworkQuality:ct(s._statsCollector.trafficStats.B_dnq)}):s.emit(cd.NETWORK_QUALITY,{uplinkNetworkQuality:0,downlinkNetworkQuality:0})}),2e3),r));case 21:case"end":return e.stop()}}),e,this,[[11,17]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"leave",value:function(){var e=m(v.mark((function e(){var t,n,r=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=r.length>0&&void 0!==r[0]&&r[0],"DISCONNECTED"===this.state){e.next=16;break}if(this.state="DISCONNECTING",e.prev=3,t||this.signal.connectionState!==Wl.CONNECTED){e.next=8;break}return n=this.signal.request(ql.LEAVE,void 0,!0),e.next=8,kc.race([n,pt(3e3)]);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(3),Rl.warning("[".concat(this.clientId,"] leave request failed, ignore"),e.t0);case 13:this.signal.close(),this.reset(),this.state="DISCONNECTED";case 16:case"end":return e.stop()}}),e,this,[[3,10]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"publish",value:function(){var e=m(v.mark((function e(t,n){var r,i,o=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.joinInfo){e.next=2;break}throw new Al($u.UNEXPECTED_ERROR,"publish no joinInfo");case 2:if(r=t.getUserId(),i=t.videoTrack?function(e){var t;if(!(e=e._encoderConfig))return{};var n={resolution:e.width&&e.height?cs(t="".concat(at(e.width),"x")).call(t,at(e.height)):void 0,maxVideoBW:e.bitrateMax,minVideoBW:e.bitrateMin};return"number"==typeof e.frameRate?(n.maxFrameRate=e.frameRate,n.minFrameRate=e.frameRate):e.frameRate&&(n.maxFrameRate=e.frameRate.max||e.frameRate.ideal||e.frameRate.exact||e.frameRate.min,n.minFrameRate=e.frameRate.min||e.frameRate.ideal||e.frameRate.exact||e.frameRate.max),n}(t.videoTrack):{},t.on(zl.NEED_ANSWER,(function(e,a,s){var c,u={state:"offer",stream_type:n,p2p_id:t.pc.ID,sdp:Yr(e),audio:!!t.audioTrack,video:!!t.videoTrack,screen:t.videoTrack&&-1!==Gc(c=t.videoTrack._hints).call(c,ld.SCREEN_TRACK),attributes:i,dtx:t.audioTrack instanceof nh&&t.audioTrack._config.DTX,hq:!1,lq:!1,stereo:!1,speech:!1,mode:o.spec.mode,codec:o.spec.codec,extend:Bu.PUB_EXTEND};o.signal.request(ql.PUBLISH,u,!0).then((function(e){r&&o.needToSendUnpubUnsub.set(r,!0),a(JSON.parse(e.sdp))})).catch((function(n){if(e.retry&&n.data&&n.data.code===Fl.ERR_PUBLISH_REQUEST_INVALID)return Rl.warning("[".concat(o.clientId,"] receiver publish error code, retry"),n.toString()),yt(t,zl.NEED_UNPUB).then((function(){e.retry=!1,yt(t,zl.NEED_ANSWER,e).then(a).catch(s)}));n.code!==$u.WS_ABORT&&s(n)}))})),t.on(zl.NEED_RENEGOTIATE,(function(e,r,i){o.signal.request(ql.PUBLISH,{state:"negotiation",stream_type:n,p2p_id:t.pc.ID,sdp:e},!0).then((function(e){r(JSON.parse(e.sdp))})).catch((function(e){e.code!==$u.WS_ABORT&&i(e)}))})),t.on(zl.NEED_UNPUB,(function(e){return r&&!o.needToSendUnpubUnsub.has(r)?e(!1):"RECONNECTING"===o.state?e(!0):void o.signal.request(ql.UNPUBLISH,{stream_id:t.getUserId(),stream_type:n},!0).then((function(){return e(!1)})).catch((function(t){Rl.warning("unpublish warning: ",t),e(!0)}))})),t.on(zl.NEED_UPLOAD,(function(e,t){o.signal.upload(e,{stream_type:n,stats:t})})),t.on(zl.NEED_SIGNAL_RTT,(function(e){e(o.signal.rtt)})),"RECONNECTING"===this.state){e.next=10;break}if("CONNECTED"===this.state){e.next=6;break}return e.abrupt("return",new Al($u.INVALID_OPERATION,"can not publish when connection state is ".concat(this.state)).throw());case 6:return e.next=8,t.startP2PConnection();case 8:e.next=11;break;case 10:t.readyToReconnectPC();case 11:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"subscribe",value:function(){var e=m(v.mark((function e(t){var n,r=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.joinInfo){e.next=2;break}throw new Al($u.UNEXPECTED_ERROR,"subscribe no joinInfo");case 2:if(n=t.getUserId(),t.on(zl.NEED_ANSWER,(function(e,i,o){var a=t.subscribeOptions;a={stream_id:t.getUserId(),audio:!!a.audio,video:!!a.video,mode:r.spec.mode,codec:r.spec.codec,p2p_id:t.pc.ID,sdp:Yr(e),tcc:!!Bu.SUBSCRIBE_TCC,extend:Bu.SUB_EXTEND},r.signal.request(ql.SUBSCRIBE,a,!0).then((function(e){r.needToSendUnpubUnsub.set(n,!0),i(JSON.parse(e.sdp))})).catch((function(n){if(e.retry&&n.data&&n.data.code===Fl.ERR_SUBSCRIBE_REQUEST_INVALID)return Rl.warning("[".concat(r.clientId,"] receiver subscribe error code, retry"),n.toString()),yt(t,zl.NEED_UNSUB).then((function(){e.retry=!1,yt(t,zl.NEED_ANSWER,e).then(i).catch(o)}));n.code!==$u.WS_ABORT&&o(n)}))})),t.on(zl.NEED_UNSUB,(function(e){return r.needToSendUnpubUnsub.has(n)?"RECONNECTING"===r.state?e(!0):void r.signal.request(ql.UNSUBSCRIBE,{stream_id:t.getUserId()},!0).then((function(){return e(!1)})).catch((function(t){Rl.warning("unsubscribe warning",t),e(!0)})):e(!1)})),t.on(zl.NEED_UPLOAD,(function(e,n){r.signal.upload(e,{stream_id:t.getUserId(),stats:n})})),t.on(zl.NEED_SIGNAL_RTT,(function(e){e(r.signal.rtt)})),"RECONNECTING"===this.state){e.next=10;break}if("CONNECTED"===this.state){e.next=6;break}return e.abrupt("return",new Al($u.INVALID_OPERATION,"can not subscribe when connection state is ".concat(this.state)).throw());case 6:return e.next=8,t.startP2PConnection();case 8:e.next=11;break;case 10:t.readyToReconnectPC();case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"subscribeChange",value:function(){var e=m(v.mark((function e(t,n){var r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.joinInfo){e.next=2;break}throw new Al($u.UNEXPECTED_ERROR,"subscribe no joinInfo");case 2:return e.next=4,t.setSubscribeOptions(n);case 4:if("RECONNECTING"===this.state){e.next=10;break}if("CONNECTED"===this.state){e.next=7;break}return e.abrupt("return",new Al($u.INVALID_OPERATION,"can not subscribe change when connection state is ".concat(this.state)).throw());case 7:return Rl.debug(cs(r=cs(i="[".concat(this.clientId,"] send subscribe change, audio: ")).call(i,n.audio,", video: ")).call(r,n.video)),e.next=10,this.signal.request(ql.SUBSCRIBE_CHANGE,{stream_id:t.getUserId(),audio:!!n.audio,video:!!n.video},!0);case 10:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"unsubscribe",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.closeP2PConnection();case 2:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getGatewayInfo",value:function(){return this.signal.request(ql.GATEWAY_INFO)}},{key:"renewToken",value:function(e){return this.signal.request(ql.RENEW_TOKEN,{token:e})}},{key:"setClientRole",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&(this._clientRoleOptions=Sa({},n)),"CONNECTED"===this.state){e.next=2;break}return e.abrupt("return",void(this.role=t));case 2:return e.next=4,this.signal.request(ql.SET_CLIENT_ROLE,{role:t,level:"audience"===t?this._clientRoleOptions&&this._clientRoleOptions.level?this._clientRoleOptions.level:2:0});case 4:this.role=t;case 5:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setRemoteVideoStreamType",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signal.request(ql.SWITCH_VIDEO_STREAM,{stream_id:t,stream_type:n});case 2:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setStreamFallbackOption",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signal.request(ql.SET_FALLBACK_OPTION,{stream_id:t,fallback_type:n});case 2:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"pickSVCLayer",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signal.request(ql.PICK_SVC_LAYER,{stream_id:t,spatial_layer:n.spatialLayer,temporal_layer:n.temporalLayer});case 2:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"getInChannelInfo",value:function(){return this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=gf()-this.inChannelInfo.joinAt),on({},this.inChannelInfo)}},{key:"getGatewayVersion",value:function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.signal.request(ql.GATEWAY_INFO);case 2:return e.abrupt("return",e.sent.version);case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"reset",value:function(){if(this.inChannelInfo.joinAt&&(this.inChannelInfo.duration=gf()-this.inChannelInfo.joinAt,this.inChannelInfo.joinAt=null),this.trafficStatsInterval&&(window.clearInterval(this.trafficStatsInterval),this.trafficStatsInterval=void 0),this.joinInfo){var e=ah.get(this.joinInfo.cname);e&&e.delete(this.joinInfo.uid)}this.needToSendUnpubUnsub=new ra,this.key=this.joinInfo=void 0,this.networkQualityInterval&&(window.clearInterval(this.networkQualityInterval),this.networkQualityInterval=void 0)}},{key:"updateTurnConfigFromSignal",value:function(){if(this.joinInfo){var e,t,n=(n=(("disabled"===this.joinInfo.cloudProxyServer?this.signal.url:this.joinInfo.gatewayAddrs[this.signal.currentURLIndex])||"").match(/(wss:\/\/)?([^:]+):(\d+)/))?{username:Mu.username,password:Mu.password,turnServerURL:n[2],tcpport:Ba(n[3])+30,udpport:Ba(n[3])+30,forceturn:!1}:null;this.joinInfo.turnServer.serversFromGateway=[],n&&"off"!==this.joinInfo.turnServer.mode&&"disabled"===this.joinInfo.cloudProxyServer&&(ze(this.joinInfo.turnServer.serversFromGateway)?this.joinInfo.turnServer.serversFromGateway.push({credential:Mu.password,credentialType:"password",urls:cs(e="turn:".concat(n.turnServerURL,":")).call(e,n.udpport,"?transport=udp"),username:Mu.username},{credential:Mu.password,credentialType:"password",urls:cs(t="turn:".concat(n.turnServerURL,":")).call(t,n.tcpport,"?transport=tcp"),username:Mu.username}):this.joinInfo.turnServer.serversFromGateway.push(on({},Mu,{turnServerURL:n.turnServerURL,tcpport:n.tcpport,udpport:n.udpport})))}}},{key:"updateTrafficStats",value:function(){var e=m(v.mark((function e(){var t,n,r=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("CONNECTED"!==this.state){e.next=7;break}return e.next=3,this.signal.request(ql.TRAFFIC_STATS,void 0,!0);case 3:(n=e.sent).timestamp=gf(),ba(t=n.peer_delay).call(t,(function(e){var t,n=r._statsCollector.trafficStats&&Zc(t=r._statsCollector.trafficStats.peer_delay).call(t,(function(t){return t.peer_uid===e.peer_uid}));n&&n.B_st!==e.B_st&&St((function(){r.emit(cd.STREAM_TYPE_CHANGE,e.peer_uid,e.B_st)}))})),this._statsCollector.updateTrafficStats(n);case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getJoinMessage",value:function(){if(!this.joinInfo||!this.key)throw new Al($u.UNEXPECTED_ERROR,"can not generate join message, no join info");var e=Sa({},this.joinInfo.apResponse),t=Bu.REPORT_APP_SCENARIO;if("string"!=typeof t)try{t=Yr(t)}catch(n){t=void 0}return t&&128<t.length&&(t=void 0),t={session_id:this.joinInfo.sid,app_id:this.joinInfo.appId,channel_key:this.key,channel_name:this.joinInfo.cname,sdk_version:Du,browser:navigator.userAgent,process_id:Bu.PROCESS_ID,mode:this.spec.mode,codec:this.spec.codec,role:this.role,has_changed_gateway:this.hasChangeBGPAddress,ap_response:e,extends:Bu.JOIN_EXTEND,details:{6:this.joinInfo.stringUid},features:{rejoin:!0},optionalInfo:this.joinInfo.optionalInfo,appScenario:t},this.joinInfo.stringUid&&(t.string_uid=this.joinInfo.stringUid),this.joinInfo.aesmode&&this.joinInfo.aespassword&&(t.aes_mode=this.joinInfo.aesmode,Bu.ENCRYPT_AES?(t.aes_secret=oh(this.joinInfo.aespassword,e.uid),t.aes_encrypt=!0):t.aes_secret=this.joinInfo.aespassword),e.addresses[this.signal.websocket.currentURLIndex]&&(t.ap_response.ticket=e.addresses[this.signal.websocket.currentURLIndex].ticket,delete e.addresses),t}},{key:"getRejoinMessage",value:function(){if(!this.joinInfo)throw new Al($u.UNEXPECTED_ERROR,"can not generate rejoin message, no join info");return{session_id:this.joinInfo.sid,channel_name:this.joinInfo.cname,cid:this.joinInfo.cid,uid:this.joinInfo.uid,vid:Number(this.joinInfo.vid)}}},{key:"handleSignalEvents",value:function(){var e=this;this.signal.on(Gl.WS_RECONNECTING,(function(t){e.joinInfo&&Ff.WebSocketQuit(e.joinInfo.sid,{lts:gf(),succ:-1,cname:e.joinInfo.cname,uid:e.joinInfo.uid,cid:e.joinInfo.cid,errorCode:t||Bl.NETWORK_ERROR}),e.joinInfo&&(e.state="RECONNECTING",Ff.sessionInit(e.joinInfo.sid,{lts:(new Date).getTime(),extend:e.isSignalRecover?{recover:!0}:{rejoin:!0},cname:e.joinInfo.cname,appid:e.joinInfo.appId,mode:e.spec.mode}),e.isSignalRecover=!1,e.joinGatewayStartTime=gf())})),this.signal.on(Gl.WS_CLOSED,(function(t){var n;switch(t){case"LEAVE":n=Bl.LEAVE;break;case"UID_BANNED":case"IP_BANNED":case"CHANNEL_BANNED":case"SERVER_ERROR":n=Bl.SERVER_ERROR;break;default:n=Bl.NETWORK_ERROR}Rl.debug("[signal] websocket closed, reason: ".concat(n||"undefined -> "+Bl.NETWORK_ERROR)),e.joinInfo&&Ff.WebSocketQuit(e.joinInfo.sid,{lts:gf(),succ:"LEAVE"===t?1:-1,cname:e.joinInfo.cname,uid:e.joinInfo.uid,cid:e.joinInfo.cid,errorCode:n}),e.reset(),e._disconnectedReason=t,e.state="DISCONNECTED"})),this.signal.on(Gl.WS_CONNECTED,(function(){var t,n;e.updateTurnConfigFromSignal(),e.state="CONNECTED",e.joinInfo&&("audience"===e.role&&e._clientRoleOptions&&e._clientRoleOptions.level&&(Rl.debug(cs(t=cs(n="[".concat(e.clientId,"] patch to send set client role, role: ")).call(n,e.role,", type: ")).call(t,e._clientRoleOptions.level)),e.setClientRole(e.role,e._clientRoleOptions)),Ff.joinGateway(e.joinInfo.sid,{lts:e.joinGatewayStartTime,succ:!0,ec:null,vid:e.joinInfo.vid,addr:e.signal.url,uid:e.joinInfo.uid,cid:e.joinInfo.cid}))})),this.signal.on(Hl.ON_UPLINK_STATS,(function(t){e._statsCollector.updateUplinkStats(t)})),this.signal.on(Gl.REQUEST_RECOVER,(function(t,n,r){if(!e.joinInfo)return r(new Al($u.UNEXPECTED_ERROR,"gateway: can not recover, no join info"));t&&(e.joinInfo.multiIP=t,e.hasChangeBGPAddress=!0),e.isSignalRecover=!0,yt(e,cd.REQUEST_NEW_GATEWAY_LIST).then(n).catch(r)})),this.signal.on(Gl.REQUEST_JOIN_INFO,(function(t){t(e.getJoinMessage())})),this.signal.on(Gl.REQUEST_REJOIN_INFO,(function(t){t(e.getRejoinMessage())})),this.signal.on(Gl.REPORT_JOIN_GATEWAY,(function(t,n){e.joinInfo&&Ff.joinGateway(e.joinInfo.sid,{lts:e.joinGatewayStartTime,succ:!1,ec:t,addr:n,uid:e.joinInfo.uid,cid:e.joinInfo.cid})})),this.signal.on(Gl.IS_P2P_DISCONNECTED,(function(t){t(Et(e,cd.IS_P2P_DISCONNECTED))})),this.signal.on(Gl.DISCONNECT_P2P,(function(){e.needToSendUnpubUnsub=new ra,e.emit(cd.DISCONNECT_P2P)})),this.signal.on(Gl.NEED_RENEW_SESSION,(function(){e.emit(cd.NEED_RENEW_SESSION)})),this.signal.on(Gl.REQUEST_SUCCESS,(function(){e._signalTimeout=!1})),this.signal.on(Gl.REQUEST_TIMEOUT,(function(){e._signalTimeout=!0}))}}]),n}(yf),ch=1,uh=1,lh=function(){var e=Bu.AREAS;return 0===e.length&&e.push("GLOBAL"),Na(e).call(e,(function(e,t,n){var r,i,o,a,s,c;return(t="OVERSEA"===t?cs(r=cs(i=cs(o=cs(a=cs(s="".concat(gd.ASIA,",")).call(s,gd.EUROPE,",")).call(a,gd.AFRICA,",")).call(o,gd.NORTH_AMERICA,",")).call(i,gd.SOUTH_AMERICA,",")).call(r,gd.OCEANIA):gd[t])?0===n?t:cs(c="".concat(e,",")).call(c,t):e}),"")},dh=new(function(e){l(n,e);var t=d(n);function n(){var e;return f(this,n),(e=t.call(this)).retryConfig={timeout:3e3,timeoutFactor:1.5,maxRetryCount:1,maxRetryTimeout:1e4},e.mutex=new kf("config-distribute"),e}return h(n,[{key:"startGetConfigDistribute",value:function(e,t){var n=this;this.joinInfo=e,this.cancelToken=t,this.interval&&this.stopGetConfigDistribute(),this.updateConfigDistribute(),this.interval=window.setInterval((function(){n.updateConfigDistribute()}),Bu.CONFIG_DISTRIBUTE_INTERVAL)}},{key:"stopGetConfigDistribute",value:function(){this.interval&&clearInterval(this.interval),this.cancelToken=this.joinInfo=this.interval=void 0}},{key:"awaitConfigDistributeComplete",value:function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.mutex.isLocked,!e.t0){e.next=6;break}return e.next=4,this.mutex.lock();case 4:e.t1=e.sent,(0,e.t1)();case 6:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"updateConfigDistribute",value:function(){var e=m(v.mark((function e(){var t,n,r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.joinInfo&&this.cancelToken&&this.retryConfig){e.next=2;break}return e.abrupt("return",void Rl.debug("[config-distribute] get config distribute interrupted have no joininfo"));case 2:return e.next=4,this.mutex.lock();case 4:return n=e.sent,e.prev=5,e.next=8,vn(this.joinInfo,this.cancelToken,this.retryConfig);case 8:t=e.sent,Rl.debug("[config-distribute] get config distribute",Yr(t)),t.limit_bitrate&&this.handleBitrateLimit(t.limit_bitrate),this.configs=t,e.next=18;break;case 14:e.prev=14,e.t0=e.catch(5),r=new Al($u.NETWORK_RESPONSE_ERROR,e.t0),Rl.warning("[config-distribute] ".concat(r.toString()));case 18:return e.prev=18,n(),e.finish(18);case 21:case"end":return e.stop()}}),e,this,[[5,14,18,21]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getBitrateLimit",value:function(){return this.configs?this.configs.limit_bitrate:void 0}},{key:"handleBitrateLimit",value:function(e){e&&e.uplink&&e.id&&void 0!==e.uplink.max_bitrate&&void 0!==e.uplink.min_bitrate&&(this.configs&&this.configs.limit_bitrate?this.configs&&this.configs.limit_bitrate&&this.configs.limit_bitrate.id!==e.id&&this.emit(_d.UPDATE_BITRATE_LIMIT,e):this.emit(_d.UPDATE_BITRATE_LIMIT,e))}},{key:"getLowStreamConfigDistribute",value:function(){return this.configs&&this.configs.limit_bitrate&&function(e){for(var t=1;t<arguments.length;t++){var n,r=null!=arguments[t]?arguments[t]:{};if(t%2)ba(n=En(Object(r),!0)).call(n,(function(t){uf(e,t,r[t])}));else if(Rd)wd(e,Rd(r));else{var i;ba(i=En(Object(r))).call(i,(function(t){Da(e,t,Ya(r,t))}))}}return e}({},this.configs.limit_bitrate.low_stream_uplink)}}]),n}(yf)),fh=function(){function e(e){this.input=[],this.size=e}return e.prototype.add=function(e){this.input.push(e),this.input.length>this.size&&this.input.splice(0,1)},e.prototype.diffMean=function(){return 0===this.input.length?0:(this.input[this.input.length-1]-this.input[0])/this.input.length},e}(),hh=function(e,t){return(hh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},ph=function(){return(ph=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},vh={timestamp:0,bitrate:{actualEncoded:0,transmit:0},sendPacketLossRate:0,recvPacketLossRate:0,videoRecv:[],videoSend:[],audioRecv:[],audioSend:[]},mh={firsCount:0,nacksCount:0,plisCount:0,framesDecodeCount:0,framesDecodeInterval:0,framesDecodeFreezeTime:0,decodeFrameRate:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0},gh={firsCount:0,nacksCount:0,plisCount:0,frameCount:0,bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},yh={bytes:0,packets:0,packetsLost:0,packetLostRate:0,ssrc:0,rttMs:0},_h={jitterBufferMs:0,jitterMs:0,bytes:0,packetsLost:0,packetLostRate:0,packets:0,ssrc:0,receivedFrames:0,droppedFrames:0},bh=function(){function e(e,t){var n=this;this.videoIsReady=!1,this.stats=wn(vh),this.isFirstAudioDecoded=this.isFirstAudioReceived=this.isFirstVideoDecoded=this.isFirstVideoReceived=!1,this.lossRateWindowStats=[],this.pc=e,this.options=t,this.intervalTimer=window.setInterval((function(){return In(n,void 0,void 0,(function(){return Rn(this,(function(e){return this.updateStats(),[2]}))}))}),this.options.updateInterval)}return e.prototype.getStats=function(){return this.stats},e.prototype.setVideoIsReady=function(e){this.videoIsReady=e},e.prototype.setIsFirstAudioDecoded=function(e){this.isFirstAudioDecoded=e},e.prototype.destroy=function(){window.clearInterval(this.intervalTimer)},e.prototype.calcLossRate=function(e){var t=this;this.lossRateWindowStats.push(e),this.lossRateWindowStats.length>this.options.lossRateInterval&&this.lossRateWindowStats.splice(0,1);for(var n=this.lossRateWindowStats.length,r=0,i=0,o=0,a=0,s=function(s){e[s].forEach((function(e,c){if(t.lossRateWindowStats[n-1][s][c]&&t.lossRateWindowStats[0][s][c]){var u=t.lossRateWindowStats[n-1][s][c].packets-t.lossRateWindowStats[0][s][c].packets;c=t.lossRateWindowStats[n-1][s][c].packetsLost-t.lossRateWindowStats[0][s][c].packetsLost,"videoSend"===s||"audioSend"===s?(r+=u,o+=c):(i+=u,a+=c),Number.isNaN(u)||Number.isNaN(u)?e.packetLostRate=0:e.packetLostRate=0>=u||0>=c?0:c/(u+c)}}))},c=0,u=["videoSend","audioSend","videoRecv","audioRecv"];c<u.length;c++)s(u[c]);e.sendPacketLossRate=0>=r||0>=o?0:o/(r+o),e.recvPacketLossRate=0>=i||0>=a?0:a/(i+a)},e}(),Eh=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=vh,t.lastDecodeVideoReceiverStats=new Map,t}return Sn(t,e),t.prototype.updateStats=function(){return In(this,void 0,void 0,(function(){var e,t,n,r;return Rn(this,(function(i){switch(i.label){case 0:return[4,this._getStats()];case 1:return e=i.sent(),t=this.statsResponsesToObjects(e),this._stats=wn(vh),n=t.filter((function(e){return"ssrc"===e.type})),this.processSSRCStats(n),(r=t.find((function(e){return"VideoBwe"===e.type})))&&this.processBandwidthStats(r),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processBandwidthStats=function(e){this._stats.bitrate={actualEncoded:Number(e.googActualEncBitrate),targetEncoded:Number(e.googTargetEncBitrate),retransmit:Number(e.googRetransmitBitrate),transmit:Number(e.googTransmitBitrate)},this._stats.sendBandwidth=Number(e.googAvailableSendBandwidth)},t.prototype.processSSRCStats=function(e){var t=this;e.forEach((function(e){var n=e.id.includes("send");switch(e.mediaType+"_"+(n?"send":"recv")){case"video_send":(n=wn(gh)).codec=e.googCodecName,n.adaptionChangeReason="none",e.googCpuLimitedResolution&&(n.adaptionChangeReason="cpu"),e.googBandwidthLimitedResolution&&(n.adaptionChangeReason="bandwidth"),n.avgEncodeMs=Number(e.googAvgEncodeMs),n.inputFrame={width:Number(e.googFrameWidthInput)||Number(e.googFrameWidthSent),height:Number(e.googFrameHeightInput)||Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},n.sentFrame={width:Number(e.googFrameWidthSent),height:Number(e.googFrameHeightSent),frameRate:Number(e.googFrameRateInput)},n.firsCount=Number(e.googFirReceived),n.nacksCount=Number(e.googNacksReceived),n.plisCount=Number(e.googPlisReceived),n.frameCount=Number(e.framesEncoded),n.bytes=Number(e.bytesSent),n.packets=Number(e.packetsSent),n.packetsLost=Number(e.packetsLost),n.ssrc=Number(e.ssrc),n.rttMs=Number(e.googRtt||0),t._stats.videoSend.push(n),t._stats.rtt=n.rttMs;break;case"video_recv":n=wn(mh);var r=t.lastDecodeVideoReceiverStats.get(Number(e.ssrc));if(n.codec=e.googCodecName,n.targetDelayMs=Number(e.googTargetDelayMs),n.renderDelayMs=Number(e.googRenderDelayMs),n.currentDelayMs=Number(e.googCurrentDelayMs),n.minPlayoutDelayMs=Number(e.googMinPlayoutDelayMs),n.decodeMs=Number(e.googDecodeMs),n.maxDecodeMs=Number(e.googMaxDecodeMs),n.receivedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateReceived)},n.decodedFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateDecoded)},n.outputFrame={width:Number(e.googFrameWidthReceived),height:Number(e.googFrameHeightReceived),frameRate:Number(e.googFrameRateOutput)},n.jitterBufferMs=Number(e.googJitterBufferMs),n.firsCount=Number(e.googFirsSent),n.nacksCount=Number(e.googNacksSent),n.plisCount=Number(e.googPlisSent),n.framesDecodeCount=Number(e.framesDecoded),n.bytes=Number(e.bytesReceived),n.packets=Number(e.packetsReceived),n.packetsLost=Number(e.packetsLost),n.ssrc=Number(e.ssrc),0<n.packets&&!t.isFirstVideoReceived&&(t.onFirstVideoReceived&&t.onFirstVideoReceived(),t.isFirstVideoReceived=!0),0<n.framesDecodeCount&&!t.isFirstVideoDecoded&&(t.onFirstVideoDecoded&&t.onFirstVideoDecoded(n.decodedFrame.width,n.decodedFrame.height),t.isFirstVideoDecoded=!0),r){e=r.stats;var i=Date.now()-r.lts;n.framesDecodeFreezeTime=e.framesDecodeFreezeTime,n.framesDecodeInterval=e.framesDecodeInterval,n.framesDecodeCount>e.framesDecodeCount&&t.isFirstVideoDecoded?(r.lts=Date.now(),n.framesDecodeInterval=i,500<=n.framesDecodeInterval&&(t.videoIsReady?n.framesDecodeFreezeTime+=n.framesDecodeInterval:t.setVideoIsReady(!0))):n.framesDecodeCount<r.stats.framesDecodeCount&&(n.framesDecodeInterval=0)}t.lastDecodeVideoReceiverStats.set(n.ssrc,{stats:ph({},n),lts:Date.now()}),t._stats.videoRecv.push(n);break;case"audio_recv":(n=wn(_h)).codec=e.googCodecName,n.outputLevel=Math.abs(Number(e.audioOutputLevel))/32767,n.decodingCNG=Number(e.googDecodingCNG),n.decodingCTN=Number(e.googDecodingCTN),n.decodingCTSG=Number(e.googDecodingCTSG),n.decodingNormal=Number(e.googDecodingNormal),n.decodingPLC=Number(e.googDecodingPLC),n.decodingPLCCNG=Number(e.googDecodingPLCCNG),n.expandRate=Number(e.googExpandRate),n.accelerateRate=Number(e.googAccelerateRate),n.preemptiveExpandRate=Number(e.googPreemptiveExpandRate),n.secondaryDecodedRate=Number(e.googSecondaryDecodedRate),n.speechExpandRate=Number(e.googSpeechExpandRate),n.preferredJitterBufferMs=Number(e.googPreferredJitterBufferMs),n.jitterBufferMs=Number(e.googJitterBufferMs),n.jitterMs=Number(e.googJitterReceived),n.bytes=Number(e.bytesReceived),n.packets=Number(e.packetsReceived),n.packetsLost=Number(e.packetsLost),n.ssrc=Number(e.ssrc),n.receivedFrames=Number(e.googDecodingCTN)||Number(e.packetsReceived),n.droppedFrames=Number(e.googDecodingPLC)+Number(e.googDecodingPLCCNG)||Number(e.packetsLost),0<n.receivedFrames&&!t.isFirstAudioReceived&&(t.onFirstAudioReceived&&t.onFirstAudioReceived(),t.isFirstAudioReceived=!0),0<n.decodingNormal&&!t.isFirstAudioDecoded&&(t.onFirstAudioDecoded&&t.onFirstAudioDecoded(),t.isFirstAudioDecoded=!0),t._stats.audioRecv.push(n);break;case"audio_send":(n=wn(yh)).codec=e.googCodecName,n.inputLevel=Math.abs(Number(e.audioInputLevel))/32767,n.aecReturnLoss=Number(e.googEchoCancellationReturnLoss||0),n.aecReturnLossEnhancement=Number(e.googEchoCancellationReturnLossEnhancement||0),n.residualEchoLikelihood=Number(e.googResidualEchoLikelihood||0),n.residualEchoLikelihoodRecentMax=Number(e.googResidualEchoLikelihoodRecentMax||0),n.bytes=Number(e.bytesSent),n.packets=Number(e.packetsSent),n.packetsLost=Number(e.packetsLost),n.ssrc=Number(e.ssrc),n.rttMs=Number(e.googRtt||0),t._stats.rtt=n.rttMs,t._stats.audioSend.push(n)}}))},t.prototype._getStats=function(){var e=this;return new Promise((function(t,n){e.pc.getStats(t,n)}))},t.prototype.statsResponsesToObjects=function(e){var t=[];return e.result().forEach((function(e){var n={id:e.id,timestamp:e.timestamp.valueOf().toString(),type:e.type};e.names().forEach((function(t){n[t]=e.stat(t)})),t.push(n)})),t},t}(bh);!function(e){e.CERTIFICATE="certificate",e.CODEC="codec",e.CANDIDATE_PAIR="candidate-pair",e.LOCAL_CANDIDATE="local-candidate",e.REMOTE_CANDIDATE="remote-candidate",e.INBOUND="inbound-rtp",e.TRACK="track",e.OUTBOUND="outbound-rtp",e.PC="peer-connection",e.REMOTE_INBOUND="remote-inbound-rtp",e.REMOTE_OUTBOUND="remote-outbound-rtp",e.TRANSPORT="transport",e.CSRC="csrc",e.DATA_CHANNEL="data-channel",e.STREAM="stream",e.SENDER="sender",e.RECEIVER="receiver"}(Uf||(Uf={}));var wh,Th=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._stats=vh,t.lastDecodeVideoReceiverStats=new Map,t.lastVideoFramesRecv=new Map,t.lastVideoFramesSent=new Map,t.lastVideoFramesDecode=new Map,t.lastVideoJBDelay=new Map,t.lastAudioJBDelay=new Map,t.mediaBytesSent=new Map,t.mediaBytesRetransmit=new Map,t.mediaBytesTargetEncode=new Map,t.lastEncoderMs=new Map,t}return Sn(t,e),t.prototype.updateStats=function(){return In(this,void 0,void 0,(function(){var e,t=this;return Rn(this,(function(n){switch(n.label){case 0:return e=this,[4,this.pc.getStats()];case 1:return e.report=n.sent(),this._stats=wn(vh),this.report.forEach((function(e){switch(e.type){case Uf.OUTBOUND:"audio"===e.mediaType?t.processAudioOutboundStats(e):"video"===e.mediaType&&t.processVideoOutboundStats(e);break;case Uf.INBOUND:"audio"===e.mediaType?t.processAudioInboundStats(e):"video"===e.mediaType&&t.processVideoInboundStats(e);break;case Uf.TRANSPORT:(e=t.report.get(e.selectedCandidatePairId))&&t.processCandidatePairStats(e);break;case Uf.CANDIDATE_PAIR:e.selected&&t.processCandidatePairStats(e)}})),this.updateSendBitrate(),this._stats.timestamp=Date.now(),this.calcLossRate(this._stats),this.stats=this._stats,[2]}}))}))},t.prototype.processCandidatePairStats=function(e){this._stats.sendBandwidth=e.availableOutgoingBitrate||0,e.currentRoundTripTime&&(this._stats.rtt=1e3*e.currentRoundTripTime),this._stats.videoSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)})),this._stats.audioSend.forEach((function(t){!t.rttMs&&e.currentRoundTripTime&&(t.rttMs=1e3*e.currentRoundTripTime)}))},t.prototype.processAudioInboundStats=function(e){var t=this._stats.audioRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=wn(_h),this._stats.audioRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.jitterMs=1e3*e.jitter,e.trackId&&this.processAudioTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),t.receivedFrames||(t.receivedFrames=e.packetsReceived),t.droppedFrames||(t.droppedFrames=e.packetsLost),0<t.receivedFrames&&!this.isFirstAudioReceived&&(this.onFirstAudioReceived&&this.onFirstAudioReceived(),this.isFirstAudioReceived=!0),t.outputLevel&&0<t.outputLevel&&!this.isFirstAudioDecoded&&(this.onFirstAudioDecoded&&this.onFirstAudioDecoded(),this.isFirstAudioDecoded=!0)},t.prototype.processVideoInboundStats=function(e){var t=this._stats.videoRecv.find((function(t){return t.ssrc===e.ssrc}));t||(t=wn(mh),this._stats.videoRecv.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsReceived,t.packetsLost=e.packetsLost,t.bytes=e.bytesReceived,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.framesDecodeCount=e.framesDecoded;var n=this.lastDecodeVideoReceiverStats.get(t.ssrc),r=this.lastVideoFramesDecode.get(t.ssrc),i=Date.now();if(0<t.framesDecodeCount&&!this.isFirstVideoDecoded){var o=t.decodedFrame?t.decodedFrame.width:0,a=t.decodedFrame?t.decodedFrame.height:0;this.onFirstVideoDecoded&&this.onFirstVideoDecoded(o,a),this.isFirstVideoDecoded=!0}n&&(o=n.stats,a=i-n.lts,t.framesDecodeFreezeTime=o.framesDecodeFreezeTime,t.framesDecodeInterval=o.framesDecodeInterval,t.framesDecodeCount>o.framesDecodeCount&&this.isFirstVideoDecoded?(n.lts=Date.now(),t.framesDecodeInterval=a,500<=t.framesDecodeInterval&&(this.videoIsReady?t.framesDecodeFreezeTime+=t.framesDecodeInterval:this.setVideoIsReady(!0))):t.framesDecodeCount<o.framesDecodeCount&&(t.framesDecodeInterval=0)),r&&800<=i-r.lts?(t.decodeFrameRate=Math.round((t.framesDecodeCount-r.count)/((i-r.lts)/1e3)),this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:t.decodeFrameRate})):r?t.decodeFrameRate=r.rate:this.lastVideoFramesDecode.set(t.ssrc,{count:t.framesDecodeCount,lts:i,rate:0}),e.totalDecodeTime&&(t.decodeMs=1e3*e.totalDecodeTime),e.trackId&&this.processVideoTrackReceiverStats(e.trackId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.framerateMean&&(t.framesRateFirefox=e.framerateMean),0<t.packets&&!this.isFirstVideoReceived&&(this.onFirstVideoReceived&&this.onFirstVideoReceived(),this.isFirstVideoReceived=!0),this.lastDecodeVideoReceiverStats.set(t.ssrc,{stats:ph({},t),lts:n?n.lts:Date.now()})},t.prototype.processVideoOutboundStats=function(e){var t=this._stats.videoSend.find((function(t){return t.ssrc===e.ssrc}));t||(t=wn(gh),this._stats.videoSend.push(t));var n,r=this.mediaBytesSent.get(e.ssrc);r?r.add(e.bytesSent):((n=new fh(10)).add(e.bytesSent),this.mediaBytesSent.set(e.ssrc,n)),void 0!==e.retransmittedBytesSent&&((r=this.mediaBytesRetransmit.get(e.ssrc))?r.add(e.retransmittedBytesSent):((n=new fh(10)).add(e.retransmittedBytesSent),this.mediaBytesRetransmit.set(e.ssrc,n))),e.totalEncodedBytesTarget&&((r=this.mediaBytesTargetEncode.get(e.ssrc))?r.add(e.totalEncodedBytesTarget):((n=new fh(10)).add(e.totalEncodedBytesTarget),this.mediaBytesTargetEncode.set(e.ssrc,n))),t.ssrc=e.ssrc,t.bytes=e.bytesSent,t.packets=e.packetsSent,t.firsCount=e.firCount,t.nacksCount=e.nackCount,t.plisCount=e.pliCount,t.frameCount=e.framesEncoded,t.adaptionChangeReason=e.qualityLimitationReason,e.totalEncodeTime&&e.framesEncoded&&(r=this.lastEncoderMs.get(e.ssrc),t.avgEncodeMs=!r||r.lastFrameCount>e.framesEncoded?1e3*e.totalEncodeTime/e.framesEncoded:1e3*(e.totalEncodeTime-r.lastEncoderTime)/(e.framesEncoded-r.lastFrameCount),this.lastEncoderMs.set(e.ssrc,{lastFrameCount:e.framesEncoded,lastEncoderTime:e.totalEncodeTime,lts:Date.now()})),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.mediaSourceId&&this.processVideoMediaSource(e.mediaSourceId,t),e.trackId&&this.processVideoTrackSenderStats(e.trackId,t),e.remoteId?this.processRemoteInboundStats(e.remoteId,t):(r=this.findRemoteStatsId(e.ssrc,Uf.REMOTE_INBOUND))&&this.processRemoteInboundStats(r,t)},t.prototype.processAudioOutboundStats=function(e){var t=this._stats.audioSend.find((function(t){return t.ssrc===e.ssrc}));if(t||(t=wn(yh),this._stats.audioSend.push(t)),t.ssrc=e.ssrc,t.packets=e.packetsSent,t.bytes=e.bytesSent,e.mediaSourceId&&this.processAudioMediaSource(e.mediaSourceId,t),e.codecId&&(t.codec=this.getCodecFromCodecStats(e.codecId)),e.trackId&&this.processAudioTrackSenderStats(e.trackId,t),e.remoteId)this.processRemoteInboundStats(e.remoteId,t);else{var n=this.findRemoteStatsId(e.ssrc,Uf.REMOTE_INBOUND);n&&this.processRemoteInboundStats(n,t)}},t.prototype.findRemoteStatsId=function(e,t){var n=Array.from(this.report.values()).find((function(n){return n.type===t&&n.ssrc===e}));return n?n.id:null},t.prototype.processVideoMediaSource=function(e,t){(e=this.report.get(e))&&e.width&&e.height&&e.framesPerSecond&&(t.inputFrame={width:e.width,height:e.height,frameRate:e.framesPerSecond})},t.prototype.processAudioMediaSource=function(e,t){(e=this.report.get(e))&&(t.inputLevel=e.audioLevel)},t.prototype.processVideoTrackSenderStats=function(e,t){if(e=this.report.get(e)){var n=0,r=Date.now(),i=this.lastVideoFramesSent.get(t.ssrc);i&&800<=r-i.lts?(n=Math.round((e.framesSent-i.count)/((r-i.lts)/1e3)),this.lastVideoFramesSent.set(t.ssrc,{count:e.framesSent,lts:r,rate:n})):i?n=i.rate:this.lastVideoFramesSent.set(t.ssrc,{count:e.framesSent,lts:r,rate:0}),t.sentFrame={width:e.frameWidth,height:e.frameHeight,frameRate:n}}},t.prototype.processVideoTrackReceiverStats=function(e,t){if(e=this.report.get(e)){var n=this.lastVideoFramesRecv.get(t.ssrc),r=Date.now();t.framesReceivedCount=e.framesReceived;var i=0;n&&800<=r-n.lts?(i=Math.round((e.framesReceived-n.count)/((r-n.lts)/1e3)),this.lastVideoFramesRecv.set(t.ssrc,{count:e.framesReceived,lts:r,rate:i})):n?i=n.rate:this.lastVideoFramesRecv.set(t.ssrc,{count:e.framesReceived,lts:r,rate:0}),t.receivedFrame={width:e.frameWidth||0,height:e.frameHeight||0,frameRate:i||0},t.decodedFrame={width:e.frameWidth||0,height:e.frameHeight||0,frameRate:t.decodeFrameRate||0},t.outputFrame={width:e.frameWidth||0,height:e.frameHeight||0,frameRate:t.decodeFrameRate||0},e.jitterBufferDelay&&e.jitterBufferEmittedCount&&(n=this.lastVideoJBDelay.get(t.ssrc),this.lastVideoJBDelay.set(t.ssrc,{jitterBufferDelay:e.jitterBufferDelay,jitterBufferEmittedCount:e.jitterBufferEmittedCount}),n||(n={jitterBufferDelay:0,jitterBufferEmittedCount:0}),e=1e3*(e.jitterBufferDelay-n.jitterBufferDelay)/(e.jitterBufferEmittedCount-n.jitterBufferEmittedCount),t.jitterBufferMs=e,t.currentDelayMs=Math.round(e))}},t.prototype.processAudioTrackSenderStats=function(e,t){(e=this.report.get(e))&&(t.aecReturnLoss=e.echoReturnLoss||0,t.aecReturnLossEnhancement=e.echoReturnLossEnhancement||0)},t.prototype.processAudioTrackReceiverStats=function(e,t){if(e=this.report.get(e)){if(e.removedSamplesForAcceleration&&e.totalSamplesReceived&&(t.accelerateRate=e.removedSamplesForAcceleration/e.totalSamplesReceived),e.jitterBufferDelay&&e.jitterBufferEmittedCount){var n=this.lastAudioJBDelay.get(t.ssrc);this.lastAudioJBDelay.set(t.ssrc,{jitterBufferDelay:e.jitterBufferDelay,jitterBufferEmittedCount:e.jitterBufferEmittedCount}),n||(n={jitterBufferDelay:0,jitterBufferEmittedCount:0}),t.jitterBufferMs=Math.round(1e3*(e.jitterBufferDelay-n.jitterBufferDelay)/(e.jitterBufferEmittedCount-n.jitterBufferEmittedCount))}t.outputLevel=e.audioLevel,n=1920,e.totalSamplesDuration&&e.totalSamplesReceived&&(n=e.totalSamplesReceived/e.totalSamplesDuration/50,t.receivedFrames=Math.round(e.totalSamplesReceived/n)),e.concealedSamples&&(t.droppedFrames=Math.round(e.concealedSamples/n))}},t.prototype.processRemoteInboundStats=function(e,t){(e=this.report.get(e))&&(t.packetsLost=e.packetsLost,e.roundTripTime&&(t.rttMs=1e3*e.roundTripTime))},t.prototype.getCodecFromCodecStats=function(e){return(e=this.report.get(e))&&(e=e.mimeType.match(/\/(.*)$/))&&e[1]?e[1]:""},t.prototype.updateSendBitrate=function(){var e=0,t=null,n=null;this.mediaBytesSent.forEach((function(t){e+=t.diffMean()})),this.mediaBytesRetransmit.forEach((function(e){t=null===t?e.diffMean():t+e.diffMean()})),this.mediaBytesTargetEncode.forEach((function(e){n=null===n?e.diffMean():n+e.diffMean()})),this._stats.bitrate={actualEncoded:8*(null!==t?e-t:e)/(this.options.updateInterval/1e3),transmit:8*e/(this.options.updateInterval/1e3)},null!==t&&(this._stats.bitrate.retransmit=8*t/(this.options.updateInterval/1e3)),null!==n&&(this._stats.bitrate.targetEncoded=8*n/(this.options.updateInterval/1e3))},t}(bh),Sh=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Sn(t,e),t.prototype.updateStats=function(){return Promise.resolve()},t}(bh),Ih=function(){function e(t){f(this,e),this.localCandidateCount=0,this.allCandidateReceived=!1,this.videoTrack=this.audioTrack=null,this.mediaStream=new MediaStream,this.ID=Ch,Ch+=1,this.spec=t,this.createPeerConnection(),t=this.pc;var n=void 0,r=void 0;void 0===n&&(n=250),void 0===r&&(r=8);var i,o=(i=navigator.userAgent.toLocaleLowerCase().match(/chrome\/[\d]./i))&&i[0]?Number(i[0].split("/")[1]):null;this.statsFilter=o?76>o?new Eh(t,{updateInterval:n,lossRateInterval:r}):new Th(t,{updateInterval:n,lossRateInterval:r}):window.RTCStatsReport&&t.getStats()instanceof Promise?new Th(t,{updateInterval:n,lossRateInterval:r}):new Sh(t,{updateInterval:n,lossRateInterval:r})}return h(e,[{key:"_statsFilter",get:function(){return this.statsFilter}},{key:"getStats",value:function(){return this.statsFilter.getStats()}},{key:"createOfferSDP",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pc.createOffer(this.offerOptions);case 3:if((t=e.sent).sdp){e.next=6;break}throw Error("offer sdp is empty");case 6:return e.abrupt("return",t.sdp);case 9:throw e.prev=9,e.t0=e.catch(0),Rl.error("create offer error:",e.t0.toString()),new Al($u.CREATE_OFFER_FAILED,e.t0.toString());case 12:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setOfferSDP",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pc.setLocalDescription({type:"offer",sdp:t});case 3:e.next=8;break;case 5:throw e.prev=5,e.t0=e.catch(0),Rl.error("set local offer error",e.t0.toString()),new Al($u.CREATE_OFFER_FAILED,e.t0.toString());case 8:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setAnswerSDP",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pc.setRemoteDescription({type:"answer",sdp:t});case 3:e.next=10;break;case 5:if(e.prev=5,e.t0=e.catch(0),"InvalidStateError"===e.t0.name&&"stable"===this.pc.signalingState){e.next=9;break}throw Rl.error("set remote answer error",e.t0.toString()),new Al($u.SET_ANSWER_FAILED,e.t0.toString());case 9:Rl.debug("[pc-".concat(this.ID,"] ignore invalidstate error"));case 10:case"end":return e.stop()}}),e,this,[[0,5]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"close",value:function(){this.onConnectionStateChange=this.onICEConnectionStateChange=void 0;try{this.pc.close()}catch(wl){}this.statsFilter.destroy()}},{key:"createPeerConnection",value:function(){var e,t,n,r=this,i={iceServers:[{urls:"stun:webcs.agora.io:3478"}]},o=function(e){var t=[];return ba(e).call(e,(function(e){var n,r,i,o;e.security?e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:cs(n="turns:".concat((o=e.turnServerURL,o.match(/^[\.:\d]+$/)?"".concat(o.replace(/[^\d]/g,"-"),".edge.agora.io"):(Rl.info("Cannot recognized as IP address ".concat(o,". Used As Host instead")),o)),":")).call(n,e.tcpport,"?transport=tcp")}):(e.udpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:cs(r="turn:".concat(e.turnServerURL,":")).call(r,e.udpport,"?transport=udp")}),e.tcpport&&t.push({username:e.username,credential:e.password,credentialType:"password",urls:cs(i="turn:".concat(e.turnServerURL,":")).call(i,e.tcpport,"?transport=tcp")}))})),t};this.spec.iceServers?i.iceServers=this.spec.iceServers:this.spec.turnServer&&"off"!==this.spec.turnServer.mode&&(ze(this.spec.turnServer.servers)?i.iceServers=this.spec.turnServer.servers:(i.iceServers&&(e=i.iceServers).push.apply(e,u(o(this.spec.turnServer.servers))),i.iceServers&&this.spec.turnServer.serversFromGateway&&(t=i.iceServers).push.apply(t,u(o(this.spec.turnServer.serversFromGateway))),ba(n=this.spec.turnServer.servers).call(n,(function(e){e.forceturn&&(i.iceTransportPolicy="relay")})))),Bu.CHROME_FORCE_PLAN_B&&nt()&&(i.sdpSemantics="plan-b",Ed.supportUnifiedPlan=!1),this.pc=new RTCPeerConnection(i,{optional:[{googDscp:!0}]}),this.pc.oniceconnectionstatechange=function(){r.onICEConnectionStateChange&&r.onICEConnectionStateChange(r.pc.iceConnectionState)},this.pc.onconnectionstatechange=function(){r.onConnectionStateChange&&r.onConnectionStateChange(r.pc.connectionState)},this.pc.onsignalingstatechange=function(){"closed"===r.pc.connectionState&&r.onConnectionStateChange&&r.onConnectionStateChange(r.pc.connectionState)},this.pc.onicecandidateerror=function(e){var t,n,i;e&&Rl.debug(cs(t=cs(n=cs(i="[pc-".concat(r.ID,"] ice candidate error ")).call(i,e.url,", code: ")).call(n,e.errorCode,", ")).call(t,e.errorText))},this.pc.onicecandidate=function(e){if(!e.candidate)return r.pc.onicecandidate=null,r.allCandidateReceived=!0,void Rl.debug("[pc-".concat(r.ID,"] local candidate count"),r.localCandidateCount);r.localCandidateCount+=1},jf((function(){r.allCandidateReceived||(r.allCandidateReceived=!0,Rl.debug("[pc-".concat(r.ID,"] onicecandidate timeout, local candidate count"),r.localCandidateCount))}),Bu.CANDIDATE_TIMEOUT)}}]),e}(),Rh=function(e){l(n,e);var t=d(n);function n(e){return f(this,n),t.call(this,e)}return h(n,[{key:"setOfferSDP",value:function(){var e=m(v.mark((function e(t){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bu.CUSTOM_PUB_OFFER_MODIFIER)&&(t=r(t)),e.next=4,a(s(n.prototype),"setOfferSDP",this).call(this,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setAnswerSDP",value:function(){var e=m(v.mark((function e(t){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bu.CUSTOM_PUB_ANSWER_MODIFIER)&&(t=r(t)),e.next=4,a(s(n.prototype),"setAnswerSDP",this).call(this,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getAnswerSDP",value:function(){return this.pc.remoteDescription}},{key:"getOfferSDP",value:function(){return this.pc.localDescription}},{key:"addStream",value:function(){var e=m(v.mark((function e(t){var n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=t.getTracks(),n=p(t),e.prev=2,n.s();case 4:if((r=n.n()).done){e.next=10;break}return i=r.value,e.next=8,this.addTrack(i);case 8:e.next=4;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(2),n.e(e.t0);case 15:return e.prev=15,n.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[2,12,15,18]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"replaceTrack",value:function(){var e=m(v.mark((function e(t){var n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ed.supportReplaceTrack){e.next=8;break}if(n="audio"===t.kind?this.audioTrack:this.videoTrack){e.next=4;break}throw new Al($u.UNEXPECTED_ERROR,"can not find replaced track");case 4:return this.removeTrack(n),e.next=7,this.addTrack(t);case 7:return e.abrupt("return",!0);case 8:return r=this.getSender(t.kind),(i=Zc(n=this.mediaStream.getTracks()).call(n,(function(e){return e.kind===t.kind})))&&this.mediaStream.removeTrack(i),this.mediaStream.addTrack(t),e.prev=11,e.next=14,r.replaceTrack(t);case 14:"audio"===t.kind?this.audioTrack=t:this.videoTrack=t,e.next=20;break;case 17:throw e.prev=17,e.t0=e.catch(11),new Al($u.SENDER_REPLACE_FAILED,e.t0.toString());case 20:return e.abrupt("return",!1);case 21:case"end":return e.stop()}}),e,this,[[11,17]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeTrack",value:function(e){var t=this.getSender(e.kind);this.mediaStream.removeTrack(e);try{this.pc.removeTrack(t)}catch(n){Rl.warning("[pc-".concat(this.ID,"] remove track error, ignore"),n)}"audio"===e.kind?(this.audioTrack=null,this.audioSender=void 0,this.audioTransceiver&&(this.audioTransceiver.direction="inactive"),this.audioTransceiver=void 0):(this.videoTrack=null,this.videoSender=void 0,this.videoTransceiver&&(this.videoTransceiver.direction="inactive"),this.videoTransceiver=void 0)}},{key:"onOfferSettled",value:function(){nt()&&(this.audioSender&&Bu.DSCP_TYPE&&this.setAudioRtpEncodingParameters({networkPriority:Bu.DSCP_TYPE}).catch((function(e){Rl.debug("set audio sender`s network priority failed")})),this.videoSender&&Bu.DSCP_TYPE&&this.setVideoRtpEncodingParameters({networkPriority:Bu.DSCP_TYPE}).catch((function(e){Rl.debug("set video sender`s network priority failed")})))}},{key:"addTrack",value:function(){var e=m(v.mark((function e(t){var n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ed,!("audio"===t.kind&&this.audioTrack||"video"===t.kind&&this.videoTrack)){e.next=3;break}throw new Al($u.UNEXPECTED_ERROR,"Can't add multiple stream");case 3:if(this.mediaStream.addTrack(t),!n.supportUnifiedPlan){e.next=11;break}return e.next=7,function(){var e=m(v.mark((function e(t,n,r){var i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(o=Zc(i=t.getTransceivers()).call(i,(function(e){return"inactive"===e.direction&&e.receiver.track.kind===n.kind})))){e.next=8;break}return o.direction="sendrecv",e.next=5,o.sender.replaceTrack(n);case 5:e.t0=o,e.next=9;break;case 8:e.t0=t.addTransceiver(n,{direction:"sendrecv",streams:[r]});case 9:return e.abrupt("return",e.t0);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()(this.pc,t,this.mediaStream);case 7:r=e.sent,i=r.sender,e.next=12;break;case 11:i=this.pc.addTrack(t,this.mediaStream);case 12:"audio"===t.kind?(this.audioTrack=t,this.audioSender=i,this.audioTransceiver=r):(this.videoTrack=t,this.videoSender=i,this.videoTransceiver=r);case 13:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setRtpSenderParameters",value:function(){var e=m(v.mark((function e(t,n){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.videoSender||(this.videoTransceiver?this.videoTransceiver.sender:void 0))){e.next=11;break}return(r=t.getParameters()).degradationPreference=n,e.prev=3,e.next=6,t.setParameters(r);case 6:e.next=11;break;case 8:e.prev=8,e.t0=e.catch(3),Rl.debug("[".concat(this.ID,"] ignore RtpSender.setParameters"),e.t0.toString());case 11:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setVideoRtpEncodingParameters",value:function(){var e=m(v.mark((function e(t){var n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.videoSender||(this.videoTransceiver?this.videoTransceiver.sender:void 0)){e.next=3;break}throw new Al($u.LOW_STREAM_ENCODING_ERROR,"Low stream has no video sender.");case 3:if((r=n.getParameters()).encodings&&r.encodings[0]){e.next=6;break}throw new Al($u.LOW_STREAM_ENCODING_ERROR,"Low stream RtpEncodingParameters is empty.");case 6:return t.scaleResolutionDownBy&&(r.encodings[0].scaleResolutionDownBy=t.scaleResolutionDownBy),t.maxBitrate&&(r.encodings[0].maxBitrate=t.maxBitrate),t.maxFramerate&&(r.encodings[0].maxFramerate=t.maxFramerate),i=["very-low","low","medium","high"],t.networkPriority&&uu(i).call(i,t.networkPriority)&&(Rl.debug("set video sender network quality:",t.networkPriority),r.encodings[0].networkPriority=t.networkPriority),e.next=13,n.setParameters(r);case 13:return e.abrupt("return",n.getParameters());case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setAudioRtpEncodingParameters",value:function(){var e=m(v.mark((function e(t){var n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.audioSender||(this.audioTransceiver?this.audioTransceiver.sender:void 0)){e.next=3;break}throw new Al($u.SET_ENCODING_PARAMETER_ERROR,"pc has no audio sender.");case 3:if((r=n.getParameters()).encodings&&r.encodings[0]){e.next=6;break}throw new Al($u.SET_ENCODING_PARAMETER_ERROR,"pc RtpEncodingParameters is empty.");case 6:return i=["very-low","low","medium","high"],t.networkPriority&&uu(i).call(i,t.networkPriority)&&(Rl.debug("set audio sender network quality:",t.networkPriority),r.encodings[0].networkPriority=t.networkPriority),e.next=10,n.setParameters(r);case 10:return e.abrupt("return",n.getParameters());case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSender",value:function(e){var t,n,r=null;if(!(r=Ed.supportUnifiedPlan?(r=Zc(t=this.pc.getTransceivers()).call(t,(function(t){return t.sender.track&&t.sender.track.kind===e})))?r.sender:null:Zc(n=this.pc.getSenders()).call(n,(function(t){return t.track&&t.track.kind===e}))||null))throw new Al($u.SENDER_NOT_FOUND);return r}}]),n}(Ih),Ah=function(e){l(n,e);var t=d(n);function n(e){var r;return f(this,n),(r=t.call(this,e)).statsFilter.onFirstAudioDecoded=function(){return r.onFirstAudioDecoded&&r.onFirstAudioDecoded()},r.statsFilter.onFirstVideoDecoded=function(e,t){return r.onFirstVideoDecoded&&r.onFirstVideoDecoded(e,t)},r.statsFilter.onFirstAudioReceived=function(){return r.onFirstAudioReceived&&r.onFirstAudioReceived()},r.statsFilter.onFirstVideoReceived=function(){return r.onFirstVideoReceived&&r.onFirstVideoReceived()},Ed.supportUnifiedPlan?(r.audioTransceiver=r.pc.addTransceiver("audio",{direction:"recvonly"}),r.videoTransceiver=r.pc.addTransceiver("video",{direction:"recvonly"})):r.offerOptions={offerToReceiveAudio:!0,offerToReceiveVideo:!0},r.pc.ontrack=function(e){"audio"===e.track.kind?r.audioTrack=e.track:r.videoTrack=e.track,r.onTrack&&r.onTrack(e.track,e.streams[0])},r}return h(n,[{key:"setOfferSDP",value:function(){var e=m(v.mark((function e(t){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bu.CUSTOM_SUB_OFFER_MODIFIER)&&(t=r(t)),e.next=4,a(s(n.prototype),"setOfferSDP",this).call(this,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setAnswerSDP",value:function(){var e=m(v.mark((function e(t){var r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=Bu.CUSTOM_SUB_ANSWER_MODIFIER)&&(t=r(t)),e.next=4,a(s(n.prototype),"setAnswerSDP",this).call(this,t);case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()}]),n}(Ih),Ch=1,kh=1,Oh=function(e){l(n,e);var t=d(n);function n(e,r){var i;return f(this,n),(i=t.call(this)).startTime=gf(),i.createTime=gf(),i.readyToReconnect=!1,i._connectionState="disconnected",i.currentReconnectCount=0,i.ID=kh,kh+=1,i.joinInfo=e,i._userId=r,i.createPC(),i}return h(n,[{key:"connectionState",get:function(){return this._connectionState},set:function(e){e!==this._connectionState&&(this.emit(zl.CONNECTION_STATE_CHANGE,e,this._connectionState),this._connectionState=e)}},{key:"connectionId",get:function(){var e,t;return cs(e=cs(t="".concat(this.joinInfo.clientId,"-")).call(t,this.type?this.type:"sub(".concat(this._userId,")"),"-")).call(e,this.ID)}},{key:"getUserId",value:function(){return this._userId}},{key:"startUploadStats",value:function(){var e=this;this.statsUploadInterval=window.setInterval((function(){var t=e.pc.getStats();e.uploadStats(t,e.lastUploadPCStats),e.lastUploadPCStats=t}),3e3),this.statsUploadSlowInterval=window.setInterval((function(){var t=e.pc.getStats();e.uploadSlowStats(t)}),6e4),this.relatedStatsUploadInterval=window.setInterval((function(){var t=e.pc.getStats();e.uploadRelatedStats(t,e.lastRelatedPcStats),e.lastRelatedPcStats=t}),1e3)}},{key:"stopUploadStats",value:function(){this.statsUploadInterval&&window.clearInterval(this.statsUploadInterval),this.relatedStatsUploadInterval&&window.clearInterval(this.relatedStatsUploadInterval),this.relatedStatsUploadInterval=this.statsUploadInterval=void 0}},{key:"createWaitConnectionConnectedPromise",value:function(){var e=this;return new kc((function(t,n){"disconnected"===e.connectionState?n():"connected"===e.connectionState?t():e.once(zl.CONNECTION_STATE_CHANGE,(function(e){"connected"===e?t():n()}))}))}},{key:"reconnectPC",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.readyToReconnect=!1,t&&this.onPCDisconnected(t),!(1/0<this.currentReconnectCount)){e.next=2;break}throw Rl.debug("[".concat(this.connectionId,"] cannot reconnect pc")),t||new Al($u.UNEXPECTED_ERROR);case 2:return this.stopUploadStats(),Rl.debug("[".concat(this.connectionId,"] start reconnect pc")),this.connectionState="connecting",this.currentReconnectCount+=1,e.next=8,this.closePC();case 8:if(!e.sent){e.next=10;break}return e.abrupt("return",(Rl.debug("[".concat(this.connectionId,"] abort reconnect pc, wait ws")),void this.readyToReconnectPC()));case 10:return this.createPC(),e.next=13,this.startP2PConnection();case 13:this.currentReconnectCount=0;case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"readyToReconnectPC",value:function(){this.stopUploadStats(),this.readyToReconnect=!0,this.pc.onICEConnectionStateChange=void 0,this.connectionState="connecting"}},{key:"updateICEPromise",value:function(){var e=this;this.removeAllListeners(zl.GATEWAY_P2P_LOST),this.icePromise=new kc((function(t,n){e.pc.onICEConnectionStateChange=function(r){var i,o;Rl.info(cs(i=cs(o="[".concat(e.connectionId,"] ice-state: ")).call(o,e.type," p2p ")).call(i,r)),"connected"===r&&t(),"failed"!==r&&"closed"!==r||e.reconnectPC(new Al($u.ICE_FAILED)).catch((function(t){e.emit(zl.P2P_LOST),n(t)}))},e.pc.onConnectionStateChange=function(t){var r,i;Rl.info(cs(r=cs(i="[".concat(e.connectionId,"] connection-state: ")).call(i,e.type," p2p ")).call(r,t)),"failed"!==t&&"closed"!==t||e.reconnectPC(new Al($u.PC_CLOSED)).catch((function(t){e.emit(zl.P2P_LOST),n(t)}))},e.removeAllListeners(zl.GATEWAY_P2P_LOST),e.once(zl.GATEWAY_P2P_LOST,(function(t){var r;if(e.pc.ID.toString()===t.toString()){if(Rl.info(cs(r="[".concat(e.connectionId,"] ")).call(r,e.type," p2p gateway lost")),e.pc.allCandidateReceived&&0===e.pc.localCandidateCount)return e.disconnectedReason=new Al($u.NO_ICE_CANDIDATE,"can not get candidate in this pc"),void e.closeP2PConnection(!0);e.reconnectPC(new Al($u.GATEWAY_P2P_LOST)).catch((function(t){e.emit(zl.P2P_LOST),n(t)}))}}))}))}}]),n}(yf),Nh=function(){function e(t){var n=this;f(this,e),this.freezeTimeCounterList=[],this.lastTimeUpdatedTime=this.playbackTime=this.freezeTime=this.timeUpdatedCount=0,this._videoElementStatus=El.NONE,this.isGettingVideoDimensions=!1,this.handleVideoEvents=function(e){switch(e.type){case"play":case"playing":n.startGetVideoDimensions(),n.videoElementStatus=El.PLAYING;break;case"loadeddata":n.onFirstVideoFrameDecoded&&n.onFirstVideoFrameDecoded();break;case"canplay":n.videoElementStatus=El.CANPLAY;break;case"stalled":n.videoElementStatus=El.STALLED;break;case"suspend":n.videoElementStatus=El.SUSPEND;break;case"pause":n.videoElementStatus=El.PAUSED,n.videoElement&&(Rl.debug("[track-".concat(n.trackId,"] video element paused, auto resume")),n.videoElement.play());break;case"waiting":n.videoElementStatus=El.WAITING;break;case"abort":n.videoElementStatus=El.ABORT;break;case"ended":n.videoElementStatus=El.ENDED;break;case"emptied":n.videoElementStatus=El.EMPTIED;break;case"timeupdate":if(e=gf(),n.timeUpdatedCount+=1,10>n.timeUpdatedCount)return void(n.lastTimeUpdatedTime=e);var t=e-n.lastTimeUpdatedTime;for(n.lastTimeUpdatedTime=e,500<t&&(n.freezeTime+=t),n.playbackTime+=t;6e3<=n.playbackTime;)n.playbackTime-=6e3,n.freezeTimeCounterList.push(Math.min(6e3,n.freezeTime)),n.freezeTime=Math.max(0,n.freezeTime-6e3)}},this.startGetVideoDimensions=function(){var e=function e(){if(n.isGettingVideoDimensions=!0,n.videoElement&&4<n.videoElement.videoWidth*n.videoElement.videoHeight)return Rl.debug("[".concat(n.trackId,"] current video dimensions:"),n.videoElement.videoWidth,n.videoElement.videoHeight),void(n.isGettingVideoDimensions=!1);jf(e,500)};!n.isGettingVideoDimensions&&e()},this.slot=t.element,this.trackId=t.trackId,this.updateConfig(t)}return h(e,[{key:"videoElementStatus",get:function(){return this._videoElementStatus},set:function(e){var t,n;e!==this._videoElementStatus&&(Rl.debug(cs(t=cs(n="[".concat(this.trackId,"] video-element-status change ")).call(n,this._videoElementStatus," => ")).call(t,e)),this._videoElementStatus=e)}},{key:"updateConfig",value:function(e){this.config=e,this.trackId=e.trackId,(e=e.element)!==this.slot&&(this.destroy(),this.slot=e),this.createElements()}},{key:"updateVideoTrack",value:function(e){this.videoTrack!==e&&(this.videoTrack=e,this.createElements())}},{key:"play",value:function(){var e=this;if(this.videoElement){var t=this.videoElement.play();t&&t.catch&&t.catch((function(t){Rl.warning("[".concat(e.trackId,"] play warning: "),t)}))}}},{key:"getCurrentFrame",value:function(){if(!this.videoElement)return new ImageData(2,2);var e=document.createElement("canvas");e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight;var t=e.getContext("2d");return t?(t.drawImage(this.videoElement,0,0,e.width,e.height),t=t.getImageData(0,0,e.width,e.height),e.remove(),t):(Rl.error("create canvas context failed!"),new ImageData(2,2))}},{key:"destroy",value:function(){if(this.videoElement&&(this.videoElement.srcObject=null,this.videoElement=void 0),this.container){try{this.slot.removeChild(this.container)}catch(wl){}this.container=void 0}this.freezeTimeCounterList=[]}},{key:"createElements",value:function(){this.container||(this.container=document.createElement("div")),this.container.id="agora-video-player-".concat(this.trackId),this.container.style.width="100%",this.container.style.height="100%",this.container.style.position="relative",this.container.style.overflow="hidden",this.videoTrack?(this.container.style.backgroundColor="black",this.createVideoElement(),this.container.appendChild(this.videoElement)):this.removeVideoElement(),this.slot.appendChild(this.container)}},{key:"createVideoElement",value:function(){var e=this;this.videoElement||(this.videoElementStatus=El.INIT,this.videoElement=document.createElement("video"),this.videoElement.onerror=function(){return e.videoElementStatus=El.ERROR},this.container&&this.container.appendChild(this.videoElement),ba(Ph).call(Ph,(function(t){e.videoElement&&e.videoElement.addEventListener(t,e.handleVideoEvents)})),this.videoElementCheckInterval=window.setInterval((function(){!document.getElementById("video_".concat(e.trackId))&&e.videoElement&&(e.videoElementStatus=El.DESTROYED)}),1e3)),this.videoElement.id="video_".concat(this.trackId),this.videoElement.className="agora_video_player",this.videoElement.style.width="100%",this.videoElement.style.height="100%",this.videoElement.style.position="absolute",this.videoElement.controls=!1,this.videoElement.setAttribute("playsinline",""),this.videoElement.style.left="0",this.videoElement.style.top="0",this.config.mirror&&(this.videoElement.style.transform="rotateY(180deg)"),this.config.fit?this.videoElement.style.objectFit=this.config.fit:this.videoElement.style.objectFit="cover",this.videoElement.setAttribute("muted",""),this.videoElement.muted=!0,this.videoElement.srcObject&&this.videoElement.srcObject instanceof MediaStream?this.videoElement.srcObject.getVideoTracks()[0]!==this.videoTrack&&(this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null):this.videoElement.srcObject=this.videoTrack?new MediaStream([this.videoTrack]):null;var t=this.videoElement.play();void 0!==t&&t.catch((function(t){Rl.debug("[".concat(e.trackId,"] playback interrupted"),t.toString())}))}},{key:"removeVideoElement",value:function(){var e=this;if(this.videoElement){ba(Ph).call(Ph,(function(t){e.videoElement&&e.videoElement.removeEventListener(t,e.handleVideoEvents)})),this.videoElementCheckInterval&&(window.clearInterval(this.videoElementCheckInterval),this.videoElementCheckInterval=void 0);try{this.container&&this.container.removeChild(this.videoElement)}catch(wl){}this.videoElement=void 0,this.videoElementStatus=El.NONE}}}]),e}(),Ph="play playing loadeddata canplay pause stalled suspend waiting abort emptied ended timeupdate".split(" ");!document.documentMode&&window.StyleMedia&&(HTMLCanvasElement.prototype.getContext=(wh=HTMLCanvasElement.prototype.getContext,function(){var e=arguments;return"webgl"===e[0]&&((e=Qc([]).call(arguments))[0]="experimental-webgl"),wh.apply(null,e)}));var Dh=[31,222,239,159,192,236,164,81,54,227,176,149,2,247,75,141,183,54,213,216,158,92,111,49,228,111,150,6,135,79,35,212,4,155,200,168,37,107,243,110,144,179,51,81,55,78,223,242,191,211,74,119,203,151,142,62,31,41,132,22,35,155,87,123,119,117,216,57,201,53,228,67,201,40,106,24,80,176,187,253,60,63,136,100,20,12,177,99,64,38,101,143,111,176,251,211,145,136,34,23,79,136,202,95,105,199,125,67,180,44,210,179,228,4,85,160,188,64,26,46,6,61,201,103,248,18,97,254,140,36,115,106,48,124,102,216,155,120,36,227,165,217,7,227,191,128,212,157,80,37,117,175,24,214,47,221,183,211,51,174,251,223,159,167,152,53,36,107,199,223,91,62,46,194,11,80,121,188,219,2,99,99,232,229,173,234,21,30,236,177,243,142,97,48,108,56,62,172,56,216,3,42,79,138,23,88,182,39,5,118,68,135,178,56,9,94,189,44,104,9,238,231,174,122,85,247,231,86,74,8,189,147,218,180,58,76,227,17,46,90,194,100,51,178,72,163,151,243,166,130,85,1,223,130,152,242,85,255,28,173,97,252,119,215,177,119,86,104,136,82,40,72,53,11,18,26,240,188,76,110,39,31,189],xh=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,152,221,191,124,116,248,106,130,251,59,105,43,91,135,199,181,223,10,51,134,194,240,46,9,3,141,22,35,146,76,23,109,117,208,41,201,45,218,76,203,105,51,58,97,154,145,236,49,18,183,127,27,12,210,122,73,42,37,143,36,207,251,211,145,191,56,10,88,222,181,125,22,238,123,71,177,107,218,254,173,28,34,253,249,67,83,97,73,111,219,43,181,82,38,230,136,109,22,67],Lh=function(){function e(t,n){f(this,e),this.gl=t,this.kernel=n||xh,t=this.gl,n=kn(this.kernel),n=Cn(t,[kn(Dh),n]);var r=t.getAttribLocation(n,"a_position"),i=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),r=t.getAttribLocation(n,"a_texCoord"),i=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,0,1,1,0,1,1]),t.STATIC_DRAW),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),this.program=t=n}return h(e,[{key:"setUniforms",value:function(){var e=this.gl.getUniformLocation(this.program,"u_flipY");this.gl.uniform1f(e,1)}}]),e}(),Mh=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this,e,r)).denoiseLevel=5,a.xOffset=1/i,a.yOffset=1/o,a}return h(n,[{key:"setUniforms",value:function(){var e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_singleStepOffset"),n=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform2f(t,this.xOffset,this.yOffset),this.gl.uniform1f(n,this.denoiseLevel),this.gl.uniform1f(e,1)}},{key:"setParameters",value:function(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel)}},{key:"setSize",value:function(e,t){this.xOffset=1/e,this.yOffset=1/t}}]),n}(Lh),Uh=[11,196,242,139,198,252,188,5,59,170,161,152,17,229,24,141,133,54,214,206,133,26,66,126,255,11,245,10,146,92,52,134,108,155,210,164,99,114,228,96,130,251,59,105,43,91,135,199,181,223,10,51,133,194,247,34,31,39,142,28,2,130,18,109,84,124,223,62,140,52,128,47,208,47,115,39,4,200,220,171,53,36,150,101,10,75,247,121,74,36,35,143,108,176,235,211,135,164,36,11,88,160,148,35,6,221,41,32,166,109,205,171,228,4,26,169,244,82,119,102,86,61,201,103,248,18,97,242,182,34,121,70,28,71,126,197,223,126,14,244,149,192,12,176,187,149,212,156,22,44,36,133,10,216,63,198,213,154,116,230,253,154,154,249,215,55,60,34,196,229,76,50,44,135,22,77,113,247,142,94,60,23,172,145,175,218,81,86,162,239,180,205,63,118,3,110,123,224,127,158,124,15,127,157,27,66,176,33,24,51,53,194,178,56,6,74,191,111,51,78,174,157,229,17,22,178,231,92,25,23,191,157,137,188,54,64,176,13,22,81,207,45,108,203,83,186,130,237,186,153,110,8,196,168,152,161,28,238,46,184,36,185,20,203,183,98,95,41,149,93,105,37,116,91,68,105,164,217,30,42,60,53,173,213,177,216,195,53,204,173,128,243,42,122,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,220,161,39,214,146,183,193,225,23,177,201,243,128,160,33,75,86,126,139,254,232,14,13,85,2,112,17,150,36,180,86,226,225,126,197,17,228,225,142,245,37,170,39,96,187,190,2,35,85,237,11,189,1,79,237,2,1,114,246,109,190,66,54,153,43,218,204,70,6,204,162,247,18,130,123,30,60,165,130,142,210,133,91,127,117,71,38,145,172,7,5,16,220,222,111,98,141,239,208,125,26,238,28,0,216,89,13,7,119,134,194,75,41,67,174,1,217,80,101,40,26,59,28,59,46,108,138,38,157,167,28,234,73,177,42,42,102,108,26,181,27,178,42,43,52,28,110,117,198,173,176,178,101,225,150,36,139,108,105,10,237,222,3,143,126,18,144,115,74,56,114,134,231,159,212,62,126,80,173,216,167,4,81,18,52,17,144,218,32,139,207,104,128,229,99,84,120,31,87,227,154,91,196,63,123,111,125,36,52,57,168,113,150,189,204,24,104,196,237,86,163,68,197,202,170,212,191,81,193,111,255,162,181,202,156,146,196,96,16,118,117,55,71,156,31,163,242,204,239,11,150,27,126,115,154,107,247,134,158,125,255,146,35,183,209,36,116,87,215,172,5,251,133,114,254,141,195,6,145,4,111,182,167,74,154,152,68,18,146,88,106,200,154,15,176,94,86,66,178,101,219,35,188,129,66,28,41,110,174,53,88,174,64,191,206,127,48,126,214,216,93,119,2,166,99,181,222,29,218,28,195,219,125,44,50,16,99,174,225,51,133,120,184,159,168,75,242,162,124,255,81,25,153,109,69,220,176,4,237,196,233,19,8,240,160,39,122,81,29,188,144,249,170,174,137,30,10,93,133,151,199,248,175,38,41,144,229,245,149,25,240,138,179,114,182,84,50,103,95,31,199,31,87,208,203,199,135,49,211,43,52,36,74,59,37,22,136,171,244,126,18,251,39,159,241,66,206,127,149,159,182,143,232,199,136,46,150,32,51,221,74,22,102,93,22,44,132,140,199,43,69,249,77,75,140,70,4,252,98,235,77,190,125,18,56,21,10,244,42,2,246,62,127,241,123,137,22,247,219,177,160,84,18,10,84,97,251,127,102,16,209,181,100,94,56,238,209,207,76,189,95,15,165,139,143,189,96,225,55,112,178,27,218,198,223,251,52,123,94,130,220,142,216,116,237,18,254,49,59,128,41,29,15,179,164,85,76,167,166,151,39,221,2,190,68,167,26,177,114,141,4,67,25,69,182,38,166,160,27,151,148,108,48,227,60,112,48,22,159,76,127,251,63,254,177,113,217,197,95,179,109,128,138,99,27,249,10,174,155,129,80,39,165,252,85,60,131,183,98,107,68,207,19,233,231,55,225,126,77,49,53,145,203,113,29,208,64,237,182,229,165,7,11,169,106,253,116,141,200,62,16,38,121,55,148,91,83,160,140,126,121,12,79,189,72,172,31,243,240,209,229,32,220,91,229,81,94,247,121,153,151,232,182,171,198,50,31,152,245,172,151,130,55,62,125,38,155,229,78,207,148,201,2,78,63,119,107,168,78,139,141,163,177,191,239,141,39,182,174,40,76,226,62,125,209,6,6,34,37,147,85,204,103,51,191,36,248,17,175,20,1,53,16,35,143,237,177,125,86,29,219,235,20,121,205,59,5,250,107,109,32,224,30,152,143,113,151,95,85,19,254,164,135,124,68,136,199,29,31,244,91,10,84,127,101,210,70,226,195,140,70,166,54,217,165,84,42,165,175,100,234,124,121,105,53,101,118,174,101,220,147,68,161,37,0,182,220,142,221,155,230,115,164,10,214,208,120,91,152,66,27,81,184,48,84,70,7,128,153,217,218,249,226,70,130,200,156,61,227,21,164,137,193,221,119,10,134,204,23,20,17,90,94,105,204,39,99,1,64,153,45,213,19,247,97,194,49,35,125,255,195,139,63,209,175,208,147,189,244,204,24,211,99,142,18,92,130,254,182,231,235,93,10,127,175,87,35,62,110,137,184,39,114,200,150,11,190,40,162,168,223,203,110,242,192,234,26,11,54,155,38,48,79,109,101,119,165,187,223,5,20,168,171,241,20,243,108,199,3,155,69,244,149,0,187,110,12,233,42,151,189,139,133,104,3,30,16,200,69,4,123,103,144,12,106,182,1,127,91,125,158,12,144,238,232,209,101,159,56,163,240,179,50,169,120,219,176,87,77,45,247,153,190,82,132,50,137,209,97,19,35,247,161,62,77,16,71,152,72,61,50,99,157,154,56,58,175,27,73,121,229,195,228,132,69,233,169,100,21,123,17,3,164,6,146,106,196,29,3,250,217,164,23,171,203,14,242,239,249,169,116,138,209,98,113,181,122,35,162,216,46,230,4,155,142,118,216,232,229,28,12,158,153,126,149,171,172,231,99,211,57,114,136,183,114,74,35,233,115,127,253,157,38,49,136,141,25,161,255,232,110,101,208,166,186,226,12,185,19,155,53,93,155,39,161,7,124,213,52,223,125,211,242,253,22,13,131,115,167,198,188,90,209,63,224,92,112,118,220,165,31,164,43,58,197,77,17,247,77,164,74,77,218,18,187,41,76,189,127,98,18,226,231,71,115,236,68,183,111,50,168,88,247,9,123,65,180,88,74,44,101,101,173,11],jh=function(e){l(n,e);var t=d(n);function n(e,r,i){return f(this,n),t.call(this,e,Uh,r,i)}return n}(Mh),Fh=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,165,108,122,254,125,130,229,55,109,113,11,210,238,163,213,86,116,156,248,215,63,20,48,173,31,55,133,18,105,32,16,204,35,128,38,212,87,200,97,114,40,12,210,193,171,59,33,158,108,14,75,228,74,65,32,57,192,112,156,234,250,140,189,40,20,6,230,135,52,17,200,123,68,183,44,215,187,234,2,13,169,234,94,115,60,6,107,224,118,254,88,2,235,134,36,120,5,85,94,126,222,223,101,105,227,147,199,64,185,246,143,183,210,30,37,127,226,79,156,118,147,208,131,51,248,232,217,206,181,218,58,61,112,244,227,68,45,41,206,69,12,45,163,205,75,6,23,167,145,250,237,92,84,164,240,253,216,54,85,7,108,62,255,42,217,3,27,0,196,94,28,241,120,80,92,89,135,228,125,2,3,242,39,116,64,248,216,177,122,66,178,180,9,7,33,186,208,213,188,59,78,243,95,123,28,142,45,99,130,7,167,194,156,238,199,10,71,141,251,221,158,16,255,38,181,36,184,20,136,240,55,27,51,191,82,105,55,97,78,74,121,191,161,91,126,105,103,174,139,223,145,150,120,156,240,252,182,105,104,205,65,97,129,194,68,218,91,141,11,224,124,132,138,119,36,201,211,39,203,146,225,246,252,21,161,250,188,137,190,42,4,90,126,211,171,240,113,67,28,92,57,77,200,125,224,19,178,142,112,202,5,233,229,128,235,105,239,102,52,179,224,87,45,68,211,10,187,9,38,190,86,25,43,175,56,231,11,108,220,36,129,131,19,93,163,239,169,118,205,50,77,121,139,139,141,197,170,20,44,39,19,97,205,228,8,106,67,210,135,111,127,141,185,175,123,26,226,42,29,217,16,99,9,46,157,232,22,3,105,174,73,144,23,110,55,84,46,4,116,39,113,205,58,158,242,7,208,75,162,55,115,35,52,124,235,114,178,55,43,98,17,100,33,134,237,190,230,60,184,192,104,146,52,58,79,174,180,81,155,114,0,153,113,90,51,86,150,254,136,205,104,39,11,190,187,233,80,81,81,56,18,222,148,116,155,156,33,132,226,127,84,34,83,28,249,153,18,197,10,116,102,125,45,47,36,235,46,212,166,209,3,125,132,237,124,163,68,197,202,232,152,234,75,235,103,248,160,241,213,151,144,130,37,23,51,48,55,12,227,31,163,242,251,245,22,129,77,20,35,150,20,181,203,138,69,233,215,109,178,209,52,85,96,221,179,56,249,138,111,250,141,134,95,152,92,109,183,174,104,151,156,31,66,211,10,57,141,167,18,177,27,126,74,252,29,143,121,173,203,8,27,44,123,148,57,88,163,68,228,158,62,98,121,192,228,94,92,72,241,33,230,173,0,197,1,194,144,111,91,60,0,106,181,203,51,133,120,250,158,184,93,216,184,126,253,21,22,155,99,80,205,227,69,231,141,165,71,70,252,223,105,51,93,22,165,135,233,177,164,139,53,5,85,151,134,214,165,249,100,24,186,207,245,149,68,218,204,252,32,190,90,48,76,57,31,201,15,52,130,135,152,206,63,198,100,126,36,2,104,116,0,160,163,186,2,91,165,57,149,163,12,239,121,152,209,224,136,248,135,136,46,150,32,51,154,6,105,0,71,30,44,175,147,139,34,91,184,78,31,145,18,3,250,122,166,47,252,109,19,40,10,123,163,99,76,133,119,37,180,38,207,79,171,185,188],Vh=function(e){l(n,e);var t=d(n);function n(e,r,i){return f(this,n),t.call(this,e,Fh,r,i)}return n}(Mh),Bh=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,160,96,121,255,120,207,227,114,120,38,72,149,145,165,227,75,122,158,250,232,46,34,52,135,9,30,144,17,110,126,110,130,71,156,46,210,67,202,51,119,97,3,211,214,227,45,109,151,97,21,10,229,53,80,26,51,202,119,128,230,197,140,135,40,14,88,128,202,95,21,208,96,83,185,98,216,242,224,15,25,224,233,86,96,46,80,120,220,48,187,86,30,240,140,46,95,81,48,90,117,140,177,51,107,235,158,137,5,241,191,154,149,219,30,126,85,175,10,216,63,139,216,151,122,251,224,202,220,227,221,53,122,34,213,224,94,45,14,200,68,31,61,175,208,17,120,82,244,138,208,165,21,19,236,232,180,217,50,74,70,126,114,227,62,192,124,9,85,148,33,77,255,117,75,102,87,151,255,87,74,74,181,111,108,9,249,220,174,59,80,254,168,29,30,94,171,133,133,195,105,64,254,68,65,18,158,54,73,203,65,175,151,170,236,138,17,119,128,237,214,189,28,250,38,149,97,242,81,212,254,57,18,120,155,64,96,108,75,78,74,121,191,243,30,42,60,103,165,196,160,195,216,99,182,173,214,182,105,53,231,3,45,212,144,101,217,65,141,44,230,125,151,154,123,57,134,223,98,133,156,238,137,181,80,175,230,167,131,180,13,69,77,44,156,165,252,14,27,85,71,1,82,196,64,243,26,167,146,98,201,6,195,247,200,224,44,177,104,109,187,231,83,118,28,159,92,179,28,14,162,81,84,21,168,34,156,21,127,215,88,218,208,11,92,161,239,239,82,221,59,86,83,201,199,216,151,139,23,54,39,52,103,204,247,24,102,94,157,138,42,49,131,183,208,50,95,236,54,6,211,26,68,72,56,212,134,24,91,114,132,1,217,80,38,47,29,47,0,107,102,99,129,33,140,243,74,251,89,247,103,12,114,58,113,240,72,188,39,48,72,89,45,102,206,245,247,231,56,167,129,122,222,47,40,78,227,159,64,206,34,127,203,127,87,40,108,152,238,147,231,46,104,89,182,180,232,86,89,91,57,10,222,202,59,199,135,60,199,189,40,84,125,28,84,162,210,91,143,34,106,117,118,3,125,126,237,60,131,173,153,69,49,212,204,117,163,31,239,202,232,152,234,3,162,32,176,184,184,196,154,131,144,115,6,53,122,55,69,166,19,230,183,175,244,1,156,11,37,121,134,121,152,142,158,125,229,150,44,183,216,109,7,65,222,169,56,222,140,110,233,157,138,66,208,6,111,166,188,76,208,222,4,104,211,10,57,141,243,65,228,86,85,88,169,91,237,56,249,133,77,21,32,37,230,55,0,184,110,228,158,62,98,45,147,177,19,119,89,164,103,132,239,84,139,68,204,157,49,41,50,89,113,159,203,51,133,120,184,210,237,15,249,187,100,253,50,16,154,112,64,193,254,10,235,200,253,84,31,169,171,39,122,70,46,186,139,212,162,173,158,41,23,86,148,172,196,237,242,58,102,180,150,238,191,25,240,204,252,125,148,29,124,51,95,10,196,55,49,159,138,144,255,126,205,43,49,42,17,59,60,77,139,177,239,64,36,224,98,205,234,70,199,103,139,218,206,207,178,217,255,32,134,59,25,221,74,22,102,82,19,20,170,142,134,42,106,249,64,80,222,28,21,169,50,235,4,237,56,81,87,76,32,251,42,6,173,105,54,191,8,136,5,245,206,239,176,9,116,24],Wh=function(e){l(n,e);var t=d(n);function n(e,r,i){return f(this,n),t.call(this,e,Bh,r,i)}return n}(Mh),Gh=[11,196,242,139,198,252,188,5,32,162,171,128,13,160,25,222,172,102,207,244,158,69,103,57,239,111,150,18,157,82,55,210,20,131,156,190,100,112,230,97,199,225,96,74,99,94,248,222,162,213,95,122,158,212,233,42,22,37,217,115,36,152,30,123,116,104,212,109,129,41,220,77,213,97,124,45,4,219,197,171,40,18,149,104,20,4,248,102,64,9,50,217,124,131,180,188,159,170,63,1,84,130,150,117,14,212,118,67,165,97,207,242,251,15,30,187,188,77,79,122,67,101,252,109,244,82,37,191,227,35,114,87,57,71,99,218,155,54,101,239,138,197,13,226,228,176,157,158,87,98,55,251,79,150,64,138,200,135,40,132,135,207,146,252,222,57,58,111,151,225,78,59,36,210,70,29,121,160,210,31,109,67,167,194,177,236,91,108,164,229,130,211,59,66,93,18,107,226,54,210,51,8,77,217,19,73,187,33,30,59,9,135,162,49,5,11,225,111,119,11,247,218,129,115,83,205,170,21,4,69,210,133,134,245,109,15,177,9,81,81,203,105,42,158,12,255,151,165,230,205,5,92,196,251,211,187,27,214,43,186,91,233,85,192,229,15,71,38,220,20,38,101,44,78,7,60,251,186,75,103,108,53,166,220,186,208,194,120,207,230,159,248,22,32,142,124,96,157,222,60,191,65,145,6,239,125,151,147,50,58,130,207,110,131,223,231,137,238,28,182,216,167,198,191,37,67,76,1,144,232,218,79,72,28,65,101,43,216,64,253,16,173,179,123,140,27,233,245,199,230,36,181,102,114,247,162,18,34,20,212,25,171,24,28,143,80,94,40,167,34,209,61,117,130,1,198,196,7,21,252,180,255,92,128,119,9,48,156,138,136,151,143,23,44,52,3,40,197,228,31,123,67,163,140,32,54,204,187,149,80,19,255,82,120,195,12,110,65,56,212,143,22,78,44,234,72,140,29,118,103,18,36,7,122,50,37,139,47,142,243,25,208,88,237,126,50,103,127,19,183,29,169,29,1,55,23,100,32,129,239,243,160,61,178,197,117,199,45,57,26,165,135,92,218,59,0,197,54,13,96,40,141,212,221,131,103,46,22,228,191,167,73,20,86,62,11,147,217,116,205,203,110,134,249,51,6,123,23,86,231,157,8,144,83,126,115,118,35,96,36,229,36,220,228,143,71,45,223,129,48,236,5,145,202,188,208,184,70,241,104,255,188,181,146,210,206,144,53,77,101,120,38,8,245,80,230,165,160,183,83,202,79,127,57,214,126,242,150,208,40,239,148,35,163,201,97,74,70,214,181,63,240,147,33,253,149,140,77,197,82,126,189,231,7,196,212,80,14,151,24,57,144,243,81,234,66,24,19,236,2,137,121,246,129,65,7,99,110,174,54,74,182,81,234,142,37,72,110,220,255,64,119,10,188,111,191,228,1,205,9,204,143,56,62,125,84,106,225,131,97,192,43,240,157,161,75,168,247,44,175,65,81,192,48,21,157,167,80,191,130,161,75,85,186,174,42,117,1,68,252,204,138,254,203,152,21,13,64,144,195,207,238,229,54,103,247,159,245,211,85,191,141,168,32,234,85,46,118,12,5,199,4,19,217,203,202,156,33,143,114,116,60,66,40,58,77,208,237,171,26,72,175,114,205,248,87,137,62,210,143,151,197,167,210,241,122,150,104,122,154,2,70,102,83,19,36,141,136,199,42,79,229,71,86,194,109,31,236,80,166,17,230,109,1,40,28,46,224,56,20,230,47,100,254,116,208,76,169,157,241,175,3,70,85,31,38,245,58,33,80,145,237,8,22,71,224,158,156,31,249,81,87,247,230,199,237,96,167,123,63,243,79,156,206,203,160,54,124,68,253,215,132,235,57,185,92,238,55,59,210,104,71,26,183,180,71,12,255,224,192,65,154,72,244,8,164,10,248,46,207,30,92,1,80,244,31,189,138,88,216,218,63,100,227,116,57,119,94,135,5,126,255,32,191,163,61,209,194,88,248,112,139,173,43,69,134,3,160,151,137,25,98,239,166,19,123,208,180,31,120,30,191,75,183,179,126,180,125,92,107,105,206,138,28,67,139,3,188,230,184,255,121,13,181,45,160,114,202,194,123,87,55,124,97,164,82,95,232,216,117,62,5,90,176,82,167,52,160,153,174,168,105,146,91,248,81,79,249,97,138,133,170,245,229,132,61,5,149,224,246,194,213,61,12,109,44,136,235,95,219,133,220,27,93,36,93,124,180,81,141,152,220,170,163,229,197,124,171,232,48,70,251,106,119,150,20,16,49,119,247,42,132,36,76,254,124,177,66,175,9,1,39,92,127,195,171,198,34,2,64,144,179,72,40,151,110,89,229,42,125,33,238,16,220,228,51,203,8,1,68,145,253,133,118,93,163,129,22,13,248,65,12,4,63,101,210,70,170,138,203,14,246,54,194,195,27,107,241,175,35,171,49,52,106,121,45,36,152,85,215,132,78,167,34,18,167,245,152,133,134,170,120,182,10,146,191,37,2,205,47,125,20,203,44,88,81,32,150,223,220,218,238,254,30,212,167,221,115,156,82,226,137,220,221,97,3,139,202,33,9,27,26,126,40,215,25,126,9,82,208,49,217,14,161,81,196,61,60,87,254,213,194,81,216,161,151,209,166,222,230,24,128,117,140,92,4,203,254,170,253,249,88,90,112,226,18,44,122,39,158,158,56,69,204,159,5,179,51,197,233,139,216,102,226,206,248,15,78,112,214,126,67,28,40,38,98,190,178,206,67,94,245,254,160,101,176,32,157,26,132,83,252,228,87,242,32,127,160,112,210,224,133,149,115,41,30,16,200,69,89,81,77,144,12,106,182,73,54,28,53,195,28,216,179,179,136,35,141,102,234,177,240,34,186,106,145,245,3,84,48,251,157,245,11,217,111,227,138,42,67,114,211,177,37,103,16,71,152,72,117,123,36,213,202,56,124,227,84,8,45,229,149,165,214,69,244,169,55,68,62,94,104,228,74,205,123,222,17,7,172,158,227,74,206,149,67,175,171,251,185,121,151,223,63,35,229,32,49,190,209,120,137,69,213,214,19,150,187,177,28,12,158,153,126,149,171,167,234,120,129,109,32,157,180,75,66,56,233,115,127,230,157,32,34,143,156,31,230,168,174,125,118,195,249,243,165,81,246,10,144,15,103,139,55,173,7,59,136,69,172,54,132,165,140,78,77,230,33,169,129,188,71,209,109,161,8,57,57,199,143,31,164,43,58,130,1,110,145,31,229,13,46,149,94,244,106,76,238,105,107,1,183,177,10,61,225,94,185,116,58,183,95,225,22,119,19,248,28,13,123,125,108,158,64,184,77,245,153,162,217,227,208,41,185,211,235,41,153,181,54,166,165,11,154,55,21,184,209,192,249,44,164,160,29,229,159,82,156,198,241,183,114,83,137,186,151,148,31,21,197,216,145,32,13,50,22,241,137,39,71,28,142,160,215,107,221,45,202,104,227,110,186,12,150,145,240,51,49,44,196,115,224,238,149,189,134,99,67,241,62,157,240,114,247,195,26,200,141,97,147,249,23,150,174,10,13,219,81,73,58,242,96,250,243,15,49,218,58,230,104,252,175,150,123,86,185,84,90,198,6,36,0,99,72,28,166,238,115,231,171,249,179,71,174,68,156,227,17,198,79,73,142,99,144,20,80,62,80,191,142,46,71,9,243,6,8,214,116,72,190,106,161,19,185,100,9,187,64,94,86,203,174,156,245,222,95,54,30,148,19,11,50,112,96,61,237,159,173,7,154,127,175,79,48,97,89,78,126,66,171,204,158,195,27,226,205,222,157,89,251,90,125,37,212,27,97,3,141,247,175,50,121,7,187,68,196,181,202,167,189,57,84,81,222,23,27,84,130,176,98,66,240,207,18,23,28,163,163,194,45,37,129,202,170,97,189,0,81,238,0,39,199,163,35,211,206,247,65,29,116,242,67,102,235,13,136,232,230,114,146,187,7,254,142,26,121,16,237,5,160,201,114,94,178,199,95,212,241,45,112,180,188,72,86,114,189,155,149,149,163,210,112,101,12,69,225,75,202,223,28,242,90,215,156,169,224,245,135,128,92,148,217,131,208,255,25,135,117,136,5,104,185,249,161,228,214,16,105,204,9,182,135,153,220,101,244,160,207,58,182,118,185,240,57,245,123,13,112,182,106,229,220,90,29,86,215,96,147,232,2,55,131,225,137,68,245,89,141,252,97,3,129,155,216,223,98,116,45,78,85,141,161,74,215,7,150,171,225,59,78,221,152,236,14,117,100,208,158,86,13,185,124,87,157,111,40,187,182,124,173,71,173,23,199,52,155,190,134,11,23,64,25,215,39,115,231,173,77,72,114,54,252,116,178,59,221,106,241,119,254,30,226,241,204,233,113,197,96,146,0,41,67,3,231,126,12,218,202,22,171,114,249,176,134,160,19,216,31,229,118,226,62,242,126,126,42,127,130,68,218,218,81,202,106,217,191,25,177,82,97,81,36,232,137,58,90,216,190,117,235,20,194,144,76,178,27,213,13,208,18,29,118,126,49,98,203,179,128,237,100,32,242,189,212,6,210,210,188,161,205,13,124,119,13,215,112,41,183,176,215,168,210,182,111,1,115,2,239,141,8,177,124,112,48,197,2,239,11,99,4,36,77,69,47,244,19,153,61,19,2,96,176,7,112,122,131,169,25,189,116,171,49,12,121,162,79,154,74,251,50,233,182,63,180,224,118,49,253,21,20,16,31,144,184,93,174,231,244,183,13,49,225,189,211,73,185,49,110,142,25,226,45,176,233,204,74,33,16,205,88,131,92,157,170,175,68,170,61,53,116,165,16,27,182,160,181,87,241,15,151,85,107,76,167,129,25,172,127,184,138,153,222,228,125,64,44,45,32,12,227,148,106,152,83,240,166,54,235,32,190,12,242,164,123,189,53,194,141,104,43,202,110,4,168,119,245,232,179,178,198,1,224,87,86,160,31,19,140,233,102,191,204,4,98,138,163,191,106,24,213,47,208,82,137,132,131,16,253,84,25,144,90,159,148,16,196,84,166,61,160,101,229,227,93,118,59,87,66,16,128,59,96,131,250,20,184,150,205,91,227,201,62,35,79,180,172,173,85,197,106,153,238,229,60,204,65,193,230,94,101,177,134,6,165,53,171,142,208,155,2,11,4,202,127,54,17,142,117,227,121,128,204,192,147,147,92,189,5,224,148,72,18,83,101,126,124,228,153,242,123,229,247,92,221,6,73,227,250,87,167,194,129,187,73,38,185,109,217,240,193,88,50,178,180,151,54,197,187,137,190,166,233,1,103,204,88,31,127,185,29,65,1,29,254,223,14,83,167,215,114,248,30,173,89,173,187,69,5,105,117,15,106,94,173,63,227,25,230,190,136,168,177,175,107,91,126,254,34,188,25,118,48,12,226,130,153,162,57,47,181,212,79,160,97,64,157,246,90,53,43,149,76,102,15,195,107,58,242,84,172,29,81,198,113,81,251,138,182,154,111,30,171,129,56,17,45,214,153,112,117,203,174,40,38,234,236,32,4,112,225,26,187,195,246,252,9,218,69,160,223,178,54,148,81,8,134,151,75,248,63,224,240,48,75,250,221,85,46,100,50,3,70,64,102,111,160,155,233,59,147,184,57,61,6,126,79,176,16,185,94,166,33,135,78,42,75,140,208,140,44,153,187,64,103,119,160,236,16,239,74,218,219,212,207,110,53,30,76,248,40,111,98,44,20,113,204,233,109,135,96,107,39,163,203,125,45,157,152,71,239,175,174,159,147,80,111,93,38,253,228,154,225,181,101,12,241,127,65,49,189,5,85,151,237,213,143,14,104,138,54,52,27,4,132,67,35,156,86,157,73,16,229,222,245,110,79,165,179,56,179,53,218,229,100,58,87,149,48,231,64,63,115,67,3,172,6,186,115,154,60,53,214,152,149,89,234,37,143,82,255,64,28,183,93,112,39,70,185,57,0,199,9,61,175,219,41,76,37,176,82,125,65,53,160,214,105,62,153,244,222,96,205,6,178,85,41,240,113,0,96,149,38,3,195,18,152,41,246,3,103,29,110,134,30,101,75,46,103,199,184,20,230,8,55,120,4,229,168,35,43,7,28,161,143,87,27,87,79,255,186,44,195,158,155,181,119,81,172,217,107,95,98,55,243,186,66,105,48,224,123,232,84,156,20,10,156,208,204,52,34,228,136,97,242,200,246,211,67,202,40,241,91,92,253,9,54,72,131,221,106,178,32,44,182,4,225,193,37,20,249,249,231,10,206,18,71,254,221,187,172,88,204,6,127,138,102,7,208,75,147,219,199,177,79,36,170,101,207,177,109,95,143,217,41,199,80,183,201,2,254,12,55,23,198,14,255,69,245,138,155,129,227,167,168,130,156,135,14,96,93,48,99,143,107,126,92,117,143,112,108,193,228,84,13,41,186,27,172,92,201,149,116,19,112,197,116,209,128,102,1,55,152,177,28,37,34,50,83,41,199,74,178,59,111,67,118,35,252,36,33,87,28,170,17,215,47,90,154,124,137,15,14,211,59,75,59,30,77,0,49,37,225,191,87,101,127,214,227,160,99,174,234,82,148,235,16,241,219,147,170,127,221,250,116,39,218,156,72,227,172,55,0,79,188,76,51,222,232,24,36,62,94,154,3,61,230,146,114,253,0,128,58,253,90,72,211,242,38,39,133,153,161,119,105,195,152,225,208,105,140,80,217,186,196,157,21,116,230,116,139,25,159,143,118,128,77,201,238,247,228,15,168,4,133,148,21,148,12,44,241,7,115,17,129,176,202,46,130,122,129,235,141,223,85,21,199,65,181,169,52,174,161,153,62,25,164,115,213,89,138,199,103,79,200,165,135,249,244,27,209,178,240,129,211,61,9,111,157,147,119,36,119,255,110,130,84,49,210,225,247,100,26,121,127,163,160,26,79,99,24,77,65,32,178,109,36,27,253,173,110,183,11,14,211,57,130,254,124,104,165,219,31,70,97,14,194,39,61,26,141,125,228,126,194,184,101,160,204,106,128,144,106,103,171,18,246,129,220,85,172,151,123,5,73,155,192,175,91,157,239,61,237,116,170,65,233,56,19,49,114,168,190,3,214,53,250,90,213,244,88,101,30,229,248,124,15,71,141,27,172,235,21,129,211,72,61,172,112,170,128,135,96,196,221,255,27,176,105,188,183,121,33,37,149,53,131,226,233,29,167,234,218,109,53,185,152,36,248,53,61,235,78,21,201,214,210,163,12,251,187,45,188,137,126,127,237,92,234,91,240,225,38,194,57,213,251,237,171,30,99,52,14,49,84,101,252,237,7,166,122,114,32,107,32,207,239,136,168,178,12,11,241,233,230,146,132,18,83,233,41,172,17,6,161,42,113,87,40,255,185,1,146,128,5,240,126,131,71,42,54,124,205,2,122,71,30,222,229,40,134,142,102,97,239,151,177,1,230,231,49,123,219,28,129,91,152,112,13,154,81,197,226,255,112,158,178,177,55,181,108,138,185,245,29,186,21,73,188,209,154,200,89,116,235,198,144,36,87,248,22,7,200,122,7,148,44,42,87,140,238,204,95,231,252,0,136,0,22,39,70,123,125,165,113,227,172,146,163,128,158,36,52,91,19,36,245,27,150,138,141,11,67,239,224,65,24,116,101,7,39,46,142,172,164,243,148,0,33,226,59,47,203,137,156,241,66,250,157,30,204,101,143,134,98,238,155,226,25,184,136,219,89,100,193,11,143,71,139,243,230,151,0,249,1,78,26,32,93,104,157,67,97,164,248,86,124,146,93,74,222,228,167,55,53,100,135,216,109,13,64,37,106,177,200,200,182,92,251,69,31,243,89,80,198,14,132,203,72,103,28,104,217,24,97,223,113,11,29,178,191,210,46,162,255,68,99,8,237,213,162,152,193,183,121,203,19,108,182,29,86,26,192,103,220,103,205,154,179,197,9,22,73,127,175,146,38,119,210,0,24,180,21,245,215,204,91,186,119,138,183,239,15,155,231,248,133,39,24,101,144,236,10,230,54,174,227,73,21,110,10,160,241,232,131,14,212,127,232,59,122,65,146,54,163,9,189,190,121,88,170,62,194,14,204,152,245,38,131,37,91,81,72,114,29,115,239,182,56,44,156,159,177,180,82,160,93,97,86,183,236,50,95,85,39,71,181,225,152,143,63,123,117,34,44,109,160,166,229,240,91,138,102,54,180,173,44,50,80,42,124,7,50,124,211,239,21,94,197,185,239,213,107,142,64,95,124,125,17,180,97,189,101,52,48,19,112,12,70,9,212,177,54,118,66,84,147,236,248,26,124,95,103,135,254,124,49,112,186,99,120,90,8,194,191,88,57,242,65,61,10,104,246,197,252,19,159,58,194,75,173,242,103,8,115,84,69,238,149,26,15,159,182,141,132,119,70,29,53,20,143,46,163,204,6,236,59,45,185,172,89,119,83,38,144,36,222,96,151,26,99,195,163,170,133,92,159,214,53,150,116,90,176,69,145,130,15,172,140,217,215,101,163,115,161,65,101,8,7,183,113,213,134,58,175,130,251,143,173,248,168,135,60,159,30,194,68,208,119,120,2,40,178,227,247,161,77,47,136,46,244,163,72,65,158,25,225,195,61,132,182,204,177,186,200,81,2,65,105,212,72,94,203,232,217,182,123,251,228,160,1,161,204,123,20,37,1,77,208,179,45,149,181,122,102,190,123,213,164,231,41,216,130,234,248,208,251,252,220,84,209,67,47,61,220,5,142,162,26,236,121,142,248,132,255,65,122,203,196,102,191,187,2,195,127,255,193,92,49,91,186,154,39,156,29,211,172,49,104,245,114,153,223,211,199,249,35,130,160,128,0,152,176,183,20,236,113,193,108,26,255,11,237,102,133,245,94,115,114,10,89,229,214,221,99,149,30,99,37,246,10,26,26,39,92,123,170,73,211,127,227,54,30,86,133,159,112,225,91,148,100,174,149,75,143,14,140,20,44,64,212,5,243,8,116,63,30,97,42,123,20,73,212,85,207,83,122,27,251,233,84,10,17,236,232,83,200,127,119,143,163,204,220,167,59,231,20,106,186,222,191,8,40,234,21,25,180,13,116,250,152,224,174,75,3,205,38,173,215,236,151,185,121,254,244,154,239,17,53,106,164,61,49,116,216,118,94,150,35,181,26,238,66,49,211,221,132,146,166,115,39,136,36,205,230,179,31,197,51,148,165,109,38,70,37,148,52,44,209,250,98,58,246,225,103,198,101,26,25,196,207,8,166,21,88,252,175,253,10,88,107,157,19,225,61,12,246,221,37,239,186,167,137,142,135,222,128,174,62,95,216,38,141,157,45,232,97,217,173,203,234,116,129,69,206,189,94,221,12,54,139,186,247,184,16,200,121,244,104,8,7,35,111,47,188,10,140,92,73,143,206,203,72,122,184,20,102,197,130,64,150,63,96,239,8,132,111,217,84,91,198,32,43,100,138,241,15,160,42,190,253,193,184,164,124,29,210,96,67,224,221,182,29,218,129,149,29,128,174,98,88,88,125,56,40,255,120,5,0,87,174,42,150,90,112,201,183,169,19,57,195,191,12,58,244,235,132,25,145,72,146,214,8,125,100,135,12,5,102,97,248,174,24,159,90,33,43,187,6,61,212,241,225,190,219,252,197,123,129,164,108,123,55,230,4,153,166,105,234,15,85,216,23,56,32,3,41,110,68,146,172,133,202,98,41,7,47,152,35,255,168,106,241,226,222,77,244,52,185,65,252,227,32,66,38,11,172,60,28,28,103,84,1,1,205,182,190,28,189,102,253,43,1,191,148,116,10,227,18,81,93,80,239,157,232,215,180,163,165,161,109,177,71,150,244,144,208,160,110,22,174,60,206,43,103,121,55,103,114,115,173,238,13,10,227,251,41,176,216,158,229,216,55,234,128,128,20,167,106,181,86,163,130,215,110,149,191,10,227,215,8,214,154,178,181,15,19,0,247,250,97,74,43,157,55,94,174,41,41,9,199,97,20,91,32,18,10,43,98,240,247,203,20,250,117,160,44,229,202,187,64,54,124,15,184,169,129,27,160,240,26,61,255,60,166,60,144,209,84,55,187,186,168,13,124,125,29,17,100,249,227,62,205,78,179,163,168,139,168,21,38,83,239,151,74,43,66,2,92,72,71,94,216,134,238,20,45,158,213,164,73,57,80,47,198,184,130,223,227,71,132,133,235,177,85,174,142,124,172,200,54,229,40,126,60,76,92,216,153,56,241,174,66,141,90,226,3,30,68,234,71,187,163,112,146,255,22,143,170,204,3,127,179,81,139,160,37,77,246,128,220,196,158,153,73,177,65,199,119,29,197,144,130,248,206,155,253,108,213,124,7,223,221,162,146,134,242,65,99,162,107,120,247,214,207,96,150,169,131,208,218,221,28,24,112,208,23,1,130,142,232,56,104,45,33,158,95,255,123,31,74,76,120,178,155,213,6,195,164,8,8,69,241,197,127,83,169,21,167,19,94,143,252,33,159,248,241,170,153,147,1,149,199,201,131,170,79,236,212,209,143,107,98,24,123,56,33,193,85,247,64,225,135,210,78,145,57,16,145,71,170,20,133,87,235,4,166,239,100,82,235,81,50,223,9,193,52,49,86,129,190,196,82,165,107,63,115,161,98,33,20,193,29,42,151,205,252,124,72,245,48,181,67,7,13,21,127,59,226,188,144,129,112,244,192,121,213,80,42,196,1,13,107,108,78,0,40,121,225,148,237,234,209,216,238,9,147,226,254,96,89,212,72,193,106,75,135,74,227,67,255,92,191,81,188,124,226,149,152,142,15,159,195,238,114,55,255,166,157,230,59,148,170,166,151,65,213,104,253,253,112,150,82,147,137,27,214,100,247,65,81,92,47,86,217,7,45,120,81,130,31,236,243,76,78,3,45,105,172,220,71,48,220,94,196,249,163,193,133,50,236,205,20,55,2,63,14,127,69,113,212,204,12,58,79,89,86,29,61,199,201,64,149,6,144,182,150,129,31,18,167,120,248,82,107,25,143,128,27,161,28,25,153,183,217,238,78,186,106,92,27,202,219,165,96,0,216,234,169,73,101,39,182,113,217,240,170,116,172,221,250,233,48,49,242,83,227,92,181,184,72,230,180,21,15,108,135,25,38,153,25,124,227,26,149,73,236,39,211,244,149,58,183,132,26,223,219,174,144,117,233,219,165,205,157,159,222,184,52,47,241,201,123,65,24,44,55,215,177,168,250,179,115,190,227,123,158,163,179,224,69,196,66,207,254,243,101,221,193,140,250,4,28,222,52,96,138,160,33,218,64,118,214,234,201,152,148,91,178,111,107,144,142,6,182,102,72,188,34,213,181,26,223,58,255,103,81,17,47,169,11,245,224,123,148,215,237,186,107,75,152,90,202,166,22,149,197,5,246,238,78,76,229,106,199,94,127,195,0,45,82,6,159,103,96,138,231,71,46,107,59,216,39,43,12,221,27,214,56,155,145,66,187,169,250,235,78,211,179,239,183,198,163,93,5,196,24,174,143,225,106,139,89,98,13,127,207,184,194,30,1,165,198,169,8,197,118,86,163,221,138,23,209,61,116,79,99,233,43,130,60,244,85,229,243,172,123,148,200,120,192,127,211,52,11,159,41,95,212,230,188,169,156,137,29,212,12,148,168,148,133,243,44,241,139,127,24,246,220,227,125,209,97,60,52,162,192,146,49,161,92,138,112,189,128,59,126,125,46,207,60,79,231,174,152,209,68,223,205,2,38,14,91,116,159,255,28,27,178,248,164,104,158,79,69,214,234,157,12,75,163,83,253,245,202,61,213,176,6,197,230,29,208,166,253,194,254,235,29,141,241,70,249,15,62,0,148,163,135,52,122,40,96,87,31,179,152,51,216,133,184,122,198,203,60,115,218,191,193,16,178,25,148,252,112,104,103,252,36,92,221,28,179,43,199,198,151,128,100,252,217,161,249,34,201,172,118,52,180,252,104,7,223,44,116,102,212,21,40,224,184,55,163,210,21,207,161,239,51,54,155,41,133,18,67,48,3,165,130,251,4,79,214,57,72,130,157,212,144],qh=[0,1,3,4,6,7,9,10,12,13,15,16,18,19,21,22,24,26,29,31,34,36,39,41,44,46,49,51,54,56,59,61,64,65,66,67,68,69,70,72,73,74,75,76,77,79,80,81,82,83,84,85,87,88,89,90,91,92,94,95,96,97,98,99,101,102,103,104,105,106,107,109,110,111,112,113,114,116,117,118,119,120,121,123,124,125,126,127,128,129,131,132,133,134,135,136,138,139,140,141,142,143,145,146,147,148,149,150,151,153,154,155,156,157,158,160,161,162,163,164,165,166,168,169,170,171,172,173,175,176,177,178,179,180,182,183,184,185,186,187,188,190,191,192,193,194,195,197,198,199,200,201,202,204,205,206,207,208,209,210,212,213,214,215,216,217,219,220,221,222,223,224,226,226,226,227,227,227,228,228,228,229,229,229,230,230,231,231,231,232,232,232,233,233,233,234,234,235,235,235,236,236,236,237,237,237,238,238,239,239,239,240,240,240,241,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Kh=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,32,33,35,36,37,39,40,42,43,44,46,47,49,50,51,53,54,56,57,58,59,61,62,63,64,66,67,68,69,71,72,73,74,76,77,78,79,81,82,83,84,86,87,88,90,91,92,93,95,96,97,98,100,101,102,103,105,106,107,108,110,111,112,113,115,116,117,118,120,121,122,124,125,126,127,129,130,131,132,134,135,136,137,139,140,141,142,144,145,146,147,149,150,151,152,154,155,156,158,159,160,161,163,164,165,166,168,169,170,171,173,174,175,176,178,179,180,181,183,184,185,186,188,189,190,192,193,194,195,197,198,199,200,202,203,204,205,207,208,209,210,212,213,214,215,217,218,219,220,222,223,224,226,226,226,227,227,228,228,229,229,230,230,231,231,232,232,233,233,234,234,234,235,235,236,236,237,237,238,238,239,239,240,240,241,241,242,242,243,243,243,244,244,244,245,245,245,246,246,246,247,247,247,248,248,248,249,249,249,250,250,250,251,251,251,252,252,252,253,253,253,254,254,254,255],Hh=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,35,36,37,38,39,40,41,43,44,45,46,47,48,50,51,52,53,54,55,56,58,59,60,61,62,63,65,66,67,68,69,70,72,73,74,76,77,78,80,81,83,84,85,87,88,89,91,92,94,95,96,98,99,100,102,103,105,106,107,109,110,111,113,114,116,117,118,120,121,122,124,125,127,128,129,131,132,133,135,136,138,139,140,142,143,144,146,147,149,150,151,153,154,155,157,158,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,192,193,193,194,195,195,196,197,197,198,199,199,200,201,201,202,203,203,204,205,205,206,207,207,208,209,209,210,211,211,212,213,213,214,215,215,216,217,217,218,219,219,220,221,221,222,223,223,224,225,225,226,227,227,228,229,229,230,231,231,232,233,233,234,235,235,236,237,237,238,239,239,240,241,241,242,243,243,244,245,245,246,247,247,248,249,249,250,251,251,252,253,253,254,255],zh=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this,e,Gh,i,o)).lightLevel=.1,a.rednessLevel=.5,a.mskin_he_max=175/180*3.141593,a.mskin_he_min=115/180*3.141593,a.mskin_hc_max=173/180*3.141593,a.mskin_hc_min=116/180*3.141593,a.mskin_hc_axis=2.04203545,a.mfacts_rotate_ge=a.mfacts_rotate_le=a.mfacts_rotate_c=0,a.tab_addr=null,a.lutTextures=[],a.inputTexture=r,a.init(),a}return h(n,[{key:"setUniforms",value:function(){var e=this.gl.getUniformLocation(this.program,"u_flipY"),t=this.gl.getUniformLocation(this.program,"u_denoiseLevel");this.gl.uniform1f(t,this.denoiseLevel),this.gl.uniform1f(e,1),e=this.gl.getUniformLocation(this.program,"light"),this.gl.uniform1f(e,this.lightLevel),e=this.gl.getUniformLocation(this.program,"redness"),this.gl.uniform1f(e,this.rednessLevel),e=this.gl.getUniformLocation(this.program,"skin_he_max"),t=this.gl.getUniformLocation(this.program,"skin_he_min");var n=this.gl.getUniformLocation(this.program,"skin_hc_max"),r=this.gl.getUniformLocation(this.program,"skin_hc_min"),i=this.gl.getUniformLocation(this.program,"skin_hc_axis"),o=this.gl.getUniformLocation(this.program,"facts_rotate_c"),a=this.gl.getUniformLocation(this.program,"facts_rotate_le"),s=this.gl.getUniformLocation(this.program,"facts_rotate_ge");for(this.gl.uniform1f(e,this.mskin_he_max),this.gl.uniform1f(t,this.mskin_he_min),this.gl.uniform1f(n,this.mskin_hc_max),this.gl.uniform1f(r,this.mskin_hc_min),this.gl.uniform1f(i,this.mskin_hc_axis),this.gl.uniform1f(o,this.mfacts_rotate_c),this.gl.uniform1f(a,this.mfacts_rotate_le),this.gl.uniform1f(s,this.mfacts_rotate_ge),e=this.gl.getUniformLocation(this.program,"u_originImage"),this.gl.activeTexture(this.gl.TEXTURE2),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.uniform1i(e,2),e=["lighten_lut"],t=[this.gl.TEXTURE3],n=0;n<e.length;n++)r=this.gl.getUniformLocation(this.program,e[n]),this.gl.activeTexture(t[n]),this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[n]),this.gl.uniform1i(r,n+3)}},{key:"setParameters",value:function(e){void 0!==e.denoiseLevel&&(this.denoiseLevel=e.denoiseLevel),void 0!==e.lightLevel&&(this.lightLevel=e.lightLevel),void 0!==e.rednessLevel&&(this.rednessLevel=e.rednessLevel,this.updateRedness(this.rednessLevel)),e.lighteningContrastLevel&&this.updateLut(e.lighteningContrastLevel)}},{key:"init",value:function(){this.tab_addr=new Uint8Array(Kh);for(var e=[this.tab_addr],t=[256],n=[1],r=0;r<e.length;r++){var i=this.gl.createTexture();if(!i)throw new Al($u.WEBGL_INTERNAL_ERROR,"create lut texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,i),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,t[r],n[r],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e[r]),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR),this.lutTextures.push(i)}}},{key:"updateRedness",value:function(e){var t=e;1<e&&(e=1),0>e&&(e=0),1<t&&(t=1),0>t&&(t=0),this.mfacts_rotate_c=.8*e,.8>t&&(t=0),this.mskin_he_max=175/180*3.141593,this.mskin_hc_max=173/180*3.141593,this.mskin_he_min=(115-4*t)/180*3.141593,this.mskin_hc_min=(116-4*t)/180*3.141593,this.mskin_hc_axis=(117-4*t)/180*3.141593,this.mskin_hc_axis<this.mskin_hc_min&&(this.mskin_hc_axis=this.mskin_hc_min),1.5707965>this.mskin_hc_min&&(this.mskin_hc_min=1.5707965),1.5707965>this.mskin_hc_axis&&(this.mskin_hc_axis=1.5707965),1.5707965>this.mskin_he_min&&(this.mskin_he_min=1.5707965),3.141593<this.mskin_hc_max&&(this.mskin_hc_max=3.141593),3.141593<this.mskin_hc_axis&&(this.mskin_hc_axis=3.141593),3.141593<this.mskin_he_max&&(this.mskin_he_max=3.141593),e=this.mskin_he_max-this.mskin_hc_max,t=this.mskin_hc_max-this.mskin_hc_axis,this.mfacts_rotate_ge=.01<e?this.mfacts_rotate_c*t/e:this.mfacts_rotate_c,e=this.mskin_hc_min-this.mskin_he_min,t=this.mskin_hc_axis-this.mskin_hc_min,this.mfacts_rotate_le=.01<e?this.mfacts_rotate_c*t/e:this.mfacts_rotate_c}},{key:"updateLut",value:function(e){var t=null;if(0===e&&(t=Kh),1===e&&(t=Hh),2===e&&(t=qh),!t)throw new Al($u.WEBGL_INTERNAL_ERROR,"invalid ylut_table value:"+e);this.tab_addr=new Uint8Array(t),e=[this.tab_addr],t=[256];for(var n=[1],r=0;r<e.length;r++)this.gl.bindTexture(this.gl.TEXTURE_2D,this.lutTextures[r]),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.LUMINANCE,t[r],n[r],0,this.gl.LUMINANCE,this.gl.UNSIGNED_BYTE,e[r])}}]),n}(Mh),Yh=function(){function e(){f(this,e),this.canvas=this.gl=null,this.programs=[],this.inputTexture=this.commonProgram=null,this.outputTextures=[],this.fbos=[],this.originalFrameHeight=this.originalFrameWidth=0,this.enableBeauty=!1,this.denoiseLevel=5,this.lightLevel=.35,this.rednessLevel=.5,this.lighteningContrastLevel=1}return h(e,[{key:"setEnableBeauty",value:function(e){this.enableBeauty=!!e}},{key:"init",value:function(e,t,n){if(!Ed.supportWebGL)throw new Al($u.NOT_SUPPORTED,"your browser is not support webGL");if(this.gl=n.getContext("webgl"),!this.gl)throw new Al($u.WEBGL_INTERNAL_ERROR,"can not get webgl context");if(this.initGL(e,t),!this.inputTexture)throw new Al($u.WEBGL_INTERNAL_ERROR,"can not find input texture");this.canvas=n,this.programs.push(new Lh(this.gl)),this.programs.push(new jh(this.gl,e,t)),this.programs.push(new Vh(this.gl,e,t)),this.programs.push(new Wh(this.gl,e,t)),this.programs.push(new zh(this.gl,this.inputTexture,e,t)),this.commonProgram=this.programs[0].program,this.setDenoiseLevel(this.denoiseLevel),this.setLightLevel(this.lightLevel),this.setRednessLevel(this.rednessLevel),this.setContrastLevel(this.lighteningContrastLevel)}},{key:"render",value:function(e){if(this.gl&&this.commonProgram&&this.canvas){var t=0;if(this.originalFrameHeight===e.videoWidth&&this.originalFrameWidth===e.videoHeight)t=2;else if(this.originalFrameHeight!==e.videoHeight||this.originalFrameWidth!==e.videoWidth){var n,r,i;if(Rl.debug(cs(n=cs(r=cs(i="beauty effect: resolution changed ".concat(this.originalFrameWidth,"x")).call(i,this.originalFrameHeight," -> ")).call(r,e.videoWidth,"x")).call(n,e.videoHeight)),0===e.videoHeight||0===e.videoWidth)return void Rl.debug("beauty effect: skip 0 resolution frame");this.canvas.width=e.videoWidth,this.canvas.height=e.videoHeight,e.setAttribute("width",e.videoWidth.toString()),e.setAttribute("height",e.videoHeight.toString()),this.release(),this.init(e.videoWidth,e.videoHeight,this.canvas)}for(this.gl.viewport(0,0,e.videoWidth,e.videoHeight),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,e),e=this.enableBeauty?this.programs.length-1:0,n=0;n<=e;n++)r=this.programs[n].program,this.gl.useProgram(r),r=this.gl.getUniformLocation(r,"u_image"),this.programs[n].setUniforms(),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,this.fbos[t+n%2]),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6),this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,this.outputTextures[t+n%2]),this.gl.uniform1i(r,0);this.gl.useProgram(this.commonProgram),t=this.gl.getUniformLocation(this.commonProgram,"u_flipY"),this.gl.uniform1f(t,-1),this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,null),this.gl.clearColor(0,0,0,1),this.gl.clear(this.gl.COLOR_BUFFER_BIT),this.gl.drawArrays(this.gl.TRIANGLES,0,6)}else Rl.warning("video effect manager is not init!")}},{key:"setDenoiseLevel",value:function(e){var t;ba(t=this.programs).call(t,(function(t){t instanceof Mh&&t.setParameters({denoiseLevel:e})})),this.denoiseLevel=e}},{key:"setLightLevel",value:function(e){var t;ba(t=this.programs).call(t,(function(t){t instanceof Mh&&t.setParameters({lightLevel:e})})),this.lightLevel=e}},{key:"setRednessLevel",value:function(e){var t;ba(t=this.programs).call(t,(function(t){t instanceof Mh&&t.setParameters({rednessLevel:e})})),this.rednessLevel=e}},{key:"setContrastLevel",value:function(e){var t;ba(t=this.programs).call(t,(function(t){t instanceof Mh&&t.setParameters({lighteningContrastLevel:e})})),this.lighteningContrastLevel=e}},{key:"setSize",value:function(e,t){var n;ba(n=this.programs).call(n,(function(n){n instanceof Mh&&n.setSize(e,t)}))}},{key:"release",value:function(){this.inputTexture=this.commonProgram=this.gl=null,this.programs=[],this.outputTextures=[],this.fbos=[]}},{key:"initGL",value:function(e,t){if(!this.gl)throw new Al($u.WEBGL_INTERNAL_ERROR,"can not find webgl context");this.inputTexture=this.gl.createTexture(),this.gl.bindTexture(this.gl.TEXTURE_2D,this.inputTexture),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.LINEAR);for(var n=0;4>n;n++){var r=this.gl.createTexture();if(!r)throw new Al($u.WEBGL_INTERNAL_ERROR,"create texture failed");this.gl.bindTexture(this.gl.TEXTURE_2D,r),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_S,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_WRAP_T,this.gl.CLAMP_TO_EDGE),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MIN_FILTER,this.gl.LINEAR),2>n?this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,e,t,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null):this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,t,e,0,this.gl.RGBA,this.gl.UNSIGNED_BYTE,null);var i=this.gl.createFramebuffer();if(!i)throw new Al($u.WEBGL_INTERNAL_ERROR,"create frame buffer failed");this.gl.bindFramebuffer(this.gl.FRAMEBUFFER,i),this.gl.framebufferTexture2D(this.gl.FRAMEBUFFER,this.gl.COLOR_ATTACHMENT0,this.gl.TEXTURE_2D,r,0),this.outputTextures.push(r),this.fbos.push(i)}this.gl.viewport(0,0,e,t),this.originalFrameWidth=e,this.originalFrameHeight=t}}]),e}(),Qh=function(){function e(){f(this,e),this.recordedFrameCount=this.targetFrameRate=0,this.recordingTime=2}return h(e,[{key:"startRecordBeautyEffectOutput",value:function(){var e=m(v.mark((function e(t){var n,r,i=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:4,!this.recordID){e.next=3;break}throw new Al($u.UNEXPECTED_ERROR,"another beauty effect recording is in progress");case 3:return r=vt(6,""),this.recordID=r,this.targetFrameRate=t,this.recordedFrameCount=0,this.recordingTime=n,e.next=10,ht(1e3*this.recordingTime);case 10:return e.abrupt("return",this.recordID!==r?(this.recordID=void 0,!0):(this.recordID=void 0,this.recordedFrameCount<this.targetFrameRate*this.recordingTime/2?(Rl.warning("detect beauty effect overload, current framerate",this.recordedFrameCount/2),!1):(Rl.debug("beauty effect current framerate",this.recordedFrameCount/2),!0)));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"stopRecordBeautyEffectOutput",value:function(){this.recordedFrameCount=this.targetFrameRate=0,this.recordID=void 0}},{key:"addFrame",value:function(){this.recordID&&(this.recordedFrameCount+=1)}}]),e}(),Xh=function(e){l(n,e);var t=d(n);function n(){var e;return f(this,n),(e=t.call(this)).kind="video",e.fps=15,e.overloadDetector=new Qh,e.enabled=!1,e.stopChromeBackgroundLoop=null,e.lastRenderTime=0,e.fps=30,e.manager=new Yh,e}return h(n,[{key:"setBeautyEffectOptions",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0!==n.smoothnessLevel&&Fe(n.smoothnessLevel,"options.smoothnessLevel",0,1,!1),void 0!==n.lighteningLevel&&Fe(n.lighteningLevel,"options.lighteningLevel",0,1,!1),void 0!==n.rednessLevel&&Fe(n.rednessLevel,"options.rednessLevel",0,1,!1),void 0!==n.lighteningContrastLevel&&je(n.lighteningContrastLevel,"options.lighteningContrastLevel",[0,1,2]),void 0!==n.smoothnessLevel&&this.manager.setDenoiseLevel(Math.max(.1,10*n.smoothnessLevel)),void 0!==n.lighteningLevel&&this.manager.setLightLevel(Math.max(.1,n.lighteningLevel/2)),void 0!==n.rednessLevel&&this.manager.setRednessLevel(Math.max(.01,n.rednessLevel)),void 0!==n.lighteningContrastLevel&&this.manager.setContrastLevel(n.lighteningContrastLevel),e.t0=this.enabled!==t,!e.t0){e.next=21;break}if(this.manager.setEnableBeauty(t),this.enabled=t,!t){e.next=19;break}if(e.t1=this.input,!e.t1){e.next=17;break}return e.next=17,this.startEffect();case 17:e.next=21;break;case 19:return e.next=21,this.stopEffect();case 21:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"destroy",value:function(){this.onOutputChange=void 0,this.stopEffect(),this.enabled=!1}},{key:"startEffect",value:function(){var e=m(v.mark((function e(){var t,n,r,i=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ze(),this.input){e.next=3;break}return e.abrupt("return",void Rl.warning("video track is null, fail to start video effect!"));case 3:if(!this.output){e.next=5;break}return e.abrupt("return",void Rl.warning("video effect is already enabled"));case 5:return e.next=7,this.renderWithWebGL();case 7:return n=e.sent,e.next=10,this.updateOutput(n);case 10:Rl.info("start video effect, output:",this.output),this.overloadDetector.startRecordBeautyEffectOutput(this.fps).then((function(e){e||i.onOverload&&i.onOverload()})),r=function e(){requestAnimationFrame(e);var t=gf(),n=1e3/i.fps,r=i.lastRenderTime?t-i.lastRenderTime:n;r<n||(i.lastRenderTime=t-(r-n),i.video&&i.video.paused&&i.video.play(),i.enabled&&i.video&&(i.manager.render(i.video),i.output&&i.output.requestFrame&&i.output.requestFrame(),i.overloadDetector.addFrame()))},requestAnimationFrame(r),t.name===wu.CHROME&&document.addEventListener("visibilitychange",(function(){document.hidden?i.stopChromeBackgroundLoop=en((function(){i.enabled&&i.video&&i.manager.render(i.video),i.output&&i.output.requestFrame&&i.output.requestFrame(),i.overloadDetector.addFrame()}),i.fps):i.stopChromeBackgroundLoop&&(i.stopChromeBackgroundLoop(),i.stopChromeBackgroundLoop=null)}),!1);case 15:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"stopEffect",value:function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Rl.info("stop video effect"),this.overloadDetector.stopRecordBeautyEffectOutput(),this.manager.release(),this.canvas&&this.canvas.remove(),this.video&&this.video.remove(),this.video=this.canvas=void 0,e.next=8,this.updateOutput(void 0);case 8:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"_setInput",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.enabled&&!this.video,!e.t0){e.next=4;break}return e.next=4,this.startEffect();case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_removeInput",value:function(){this.stopEffect()}},{key:"renderWithWebGL",value:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.input){e.next=2;break}throw new Al($u.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not renderWithWebGL, no input");case 2:if(this.canvas&&(this.canvas.remove(),this.canvas=void 0),this.video&&(this.video.remove(),this.video=void 0),this.canvas=document.createElement("canvas"),this.video=document.createElement("video"),this.video.setAttribute("autoplay",""),this.video.setAttribute("muted",""),this.video.muted=!0,this.video.setAttribute("playsinline",""),this.video.setAttribute("style","display:none"),this.video.srcObject=new MediaStream([this.input]),n=new kc((function(e){var t=function t(){a.video&&a.video.removeEventListener("playing",t),e(void 0)};a.video&&a.video.addEventListener("playing",t)})),r=this.input.getSettings(),i=r.width,o=r.height,r.frameRate&&this.fps!==r.frameRate&&(this.fps=r.frameRate,Rl.debug("beauty video processor: set fps to",this.fps)),Rl.debug(cs(t="beauty video processor: width ".concat(i," height ")).call(t,o)),i&&o){e.next=15;break}throw new Al($u.BEAUTY_PROCESSOR_INTERNAL_ERROR,"can not get track resolution");case 15:return this.canvas.width=i,this.canvas.height=o,this.video.setAttribute("width",i.toString()),this.video.setAttribute("height",o.toString()),this.manager.init(i,o,this.canvas),this.video.play(),e.next=23,n;case 23:return e.abrupt("return",this.canvas.captureStream(Ed.supportRequestFrame?0:this.fps).getVideoTracks()[0]);case 24:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()}]),n}(function(){function e(){f(this,e)}return h(e,[{key:"output",get:function(){return this._output}},{key:"setInput",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this.input){e.next=7;break}if(t.kind===this.kind){e.next=3;break}throw new Al($u.UNEXPECTED_ERROR);case 3:return this.input&&this.removeInput(),this.input=t,e.next=7,this._setInput(t);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeInput",value:function(){this.input=void 0,this._removeInput()}},{key:"updateOutput",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0=this.output!==t,!e.t0){e.next=7;break}if(this._output=t,e.t1=this.onOutputChange,!e.t1){e.next=7;break}return e.next=7,this.onOutputChange();case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"replaceOriginMediaStream",value:function(e,t){var n,r,i=this,o=Zc(n=e.getTracks()).call(n,(function(e){return e.kind===i.kind}));o&&e.removeTrack(o),t=Zc(r=t.getTracks()).call(r,(function(e){return e.kind===i.kind})),void 0===this.output&&t&&e.addTrack(t),this.output&&(Rl.debug("replace ".concat(this.output.kind," track to origin media stream")),e.addTrack(this.output))}}]),e}()),Jh=function(e){l(n,e);var t=d(n);function n(e,r,o,a,s){var c;return f(this,n),(c=t.call(this,e,s)).trackMediaType="video",c._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1},c._enabled=!0,mt(e).then((function(e){var t=i(e,2),n=t[0],r=t[1];c._videoHeight=r,c._videoWidth=n})).catch(wf),c._encoderConfig=r,c._scalabiltyMode=o,c._optimizationMode=a,c}return h(n,[{key:"isPlaying",get:function(){return!(!this._player||this._player.videoElementStatus!==El.PLAYING)}},{key:"play",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",t]});if(!(e instanceof HTMLElement)){var r,i=document.getElementById(e.toString());i?e=i:(Rl.warning(cs(r="[track-".concat(this.getTrackId(),'] can not find "#')).call(r,e,'" element, use document.body')),e=document.body)}Rl.debug("[track-".concat(this.getTrackId(),"] start video playback"),Yr(t)),e=Dn({},this._getDefaultPlayerConfig(),{},t,{trackId:this.getTrackId(),element:e}),this._player?this._player.updateConfig(e):(this._player=new Nh(e),this._player.updateVideoTrack(this._mediaStreamTrack)),this._player.play(),n.onSuccess()}},{key:"stop",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._player.destroy(),this._player=void 0,Rl.debug("[track-".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}},{key:"setEnabled",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this._enabled){e.next=28;break}return Rl.info("[".concat(this.getTrackId(),"] start setEnabled"),t),e.next=4,this._enabledMutex.lock();case 4:if(n=e.sent,t){e.next=16;break}return this._originMediaStreamTrack.enabled=!1,e.prev=7,e.next=10,_t(this,ud.NEED_REMOVE_TRACK,this);case 10:e.next=15;break;case 12:throw e.prev=12,e.t0=e.catch(7),Rl.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.t0.toString()),n(),e.t0;case 15:return e.abrupt("return",(this._enabled=!1,Rl.info("[".concat(this.getTrackId(),"] setEnabled to false success")),n()));case 16:return this._originMediaStreamTrack.enabled=!0,e.prev=17,e.next=20,_t(this,ud.NEED_ADD_TRACK,this);case 20:e.next=25;break;case 22:throw e.prev=22,e.t1=e.catch(17),Rl.error("[".concat(this.getTrackId(),"] setEnabled to true error"),e.t1.toString()),n(),e.t1;case 25:Rl.info("[".concat(this.getTrackId(),"] setEnabled to true success")),this._enabled=!0,n();case 28:case"end":return e.stop()}}),e,this,[[7,12],[17,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getStats",value:function(){return It((function(){Rl.warning("[deprecated] LocalVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getLocalVideoStats instead")}),"localVideoTrackGetStatsWarning"),bt(this,ud.GET_STATS)||Dn({},Zl)}},{key:"setBeautyEffect",value:function(){var e=m(v.mark((function e(t){var n,r,i=this,o=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=o.length>1&&void 0!==o[1]?o[1]:{},r=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.LOCAL_VIDEO_TRACK_BEAUTY,options:[this.getTrackId(),t,n]}),!t&&!this._videoBeautyProcessor){e.next=27;break}if(Ze().os!==Eu.IOS&&Ze().os!==Eu.ANDROID){e.next=5;break}throw t=new Al($u.INVALID_OPERATION,"can not enable beauty effect on mobile device"),r.onError(t),t;case 5:if(this._enabled||!t){e.next=7;break}throw t=new Al($u.TRACK_IS_DISABLED,"can not enable beauty effect when track is disabled"),r.onError(t),t;case 7:if(Rl.info("[".concat(this.getTrackId(),"] start setBeautyEffect"),t,Yr(n)),e.prev=8,!this._videoBeautyProcessor){e.next=14;break}return e.next=12,this._videoBeautyProcessor.setBeautyEffectOptions(t,n);case 12:e.next=20;break;case 14:return this._videoBeautyProcessor=new Xh,this._videoBeautyProcessor.onOverload=function(){St((function(){return i.emit(dd.BEAUTY_EFFECT_OVERLOAD)}))},e.next=18,this._videoBeautyProcessor.setBeautyEffectOptions(t,n);case 18:return e.next=20,this._registerTrackProcessor(this._videoBeautyProcessor);case 20:e.next=25;break;case 22:throw e.prev=22,e.t0=e.catch(8),Rl.error("[".concat(this.getTrackId(),"] setBeautyEffect error"),e.t0.toString()),r.onError(e.t0),e.t0;case 25:Rl.info("[".concat(this.getTrackId(),"] setBeautyEffect success")),r.onSuccess();case 27:case"end":return e.stop()}}),e,this,[[8,22]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getCurrentFrameData",value:function(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}},{key:"clone",value:function(e,t,r,i){return new n(this._mediaStreamTrack.clone(),e,t,r,i)}},{key:"setBitrateLimit",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Rl.debug(cs(n="[".concat(this.getTrackId(),"] set bitrate limit, ")).call(n,Yr(t))),!t){e.next=11;break}return this._forceBitrateLimit=t,this._encoderConfig&&(this._encoderConfig.bitrateMax?this._encoderConfig.bitrateMax=this._encoderConfig.bitrateMax<t.max_bitrate?this._encoderConfig.bitrateMax:t.max_bitrate:this._encoderConfig.bitrateMax=t.max_bitrate,this._encoderConfig.bitrateMin,this._encoderConfig.bitrateMin=t.min_bitrate),e.prev=3,e.next=6,_t(this,ud.NEED_RESET_REMOTE_SDP);case 6:e.next=11;break;case 8:return e.prev=8,e.t0=e.catch(3),e.abrupt("return",e.t0.throw());case 11:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setOptimizationMode",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("motion"!==t&&"detail"!==t&&"balanced"!==t){e.next=13;break}return e.prev=1,e.next=4,_t(this,ud.SET_OPTIMIZATION_MODE,t);case 4:e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(1),Rl.error("[".concat(this.getTrackId(),"] set optimization mode failed"),e.t0.toString()),e.t0;case 9:this._optimizationMode=t,Rl.info(cs(n="[".concat(this.getTrackId(),"] set optimization mode success (")).call(n,t,")")),e.next=14;break;case 13:Rl.error($u.INVALID_PARAMS,"optimization mode must be motion, detail or balanced");case 14:case"end":return e.stop()}}),e,this,[[1,6]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setScalabiltyMode",value:function(e){var t;if(1===e.numSpatialLayers&&1!==e.numTemporalLayers)return Rl.error($u.INVALID_PARAMS,"scalability mode currently not supported, no SVC."),void(this._scalabiltyMode={numSpatialLayers:1,numTemporalLayers:1});this._scalabiltyMode=e,Rl.info(cs(t="[".concat(this.getTrackId(),"] set scalability mode success (")).call(t,e,")"))}},{key:"_updatePlayerSource",value:function(){this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}},{key:"_getDefaultPlayerConfig",value:function(){return{fit:"contain"}}}]),n}(zf),$h=function(e){l(n,e);var t=d(n);function n(e,r,i,o,a,s){var c;return f(this,n),(c=t.call(this,e,r.encoderConfig?me(r.encoderConfig):{},o,a,s))._enabled=!0,c._deviceName="default",c._config=r,c._constraints=i,c._deviceName=e.label,c._config.encoderConfig&&(c._encoderConfig=me(c._config.encoderConfig)),c}return h(n,[{key:"setDevice",value:function(){var e=m(v.mark((function e(t){var n,r,o,a,s=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CAM_VIDEO_TRACK_SET_DEVICE,options:[this.getTrackId(),t]}),Rl.info(cs(n="[track-".concat(this.getTrackId(),"] set device to ")).call(n,t)),!this._enabled){e.next=40;break}return e.prev=2,e.next=5,Df.getDeviceById(t);case 5:return o=e.sent,(n={}).video=Dn({},this._constraints),n.video.deviceId={exact:t},n.video.facingMode=void 0,this._originMediaStreamTrack.stop(),a=null,e.prev=12,e.next=15,Lt(n,this.getTrackId());case 15:a=e.sent,e.next=27;break;case 18:return e.prev=18,e.t0=e.catch(12),Rl.error("[".concat(this.getTrackId(),"] setDevice failed"),e.t0.toString()),e.next=23,Lt({video:this._constraints},this.getTrackId());case 23:return a=e.sent,e.next=26,this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1);case 26:throw e.t0;case 27:return e.next=29,this._updateOriginMediaStreamTrack(a.getVideoTracks()[0],!1);case 29:mt(this._originMediaStreamTrack).then((function(e){var t=i(e,2),n=t[0],r=t[1];s._videoHeight=r,s._videoWidth=n})),this._deviceName=o.label,this._config.cameraId=t,this._constraints.deviceId={exact:t},e.next=38;break;case 35:throw e.prev=35,e.t1=e.catch(2),r.onError(e.t1),Rl.error("[".concat(this.getTrackId(),"] setDevice error"),e.t1.toString()),e.t1;case 38:e.next=51;break;case 40:return e.prev=40,e.next=43,Df.getDeviceById(t);case 43:this._deviceName=e.sent.label,this._config.cameraId=t,this._constraints.deviceId={exact:t},e.next=51;break;case 48:throw e.prev=48,e.t2=e.catch(40),r.onError(e.t2),Rl.error("[track-".concat(this.getTrackId(),"] setDevice error"),e.t2.toString()),e.t2;case 51:Rl.info("[".concat(this.getTrackId(),"] setDevice success")),r.onSuccess();case 53:case"end":return e.stop()}}),e,this,[[2,35],[12,18],[40,48]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setEnabled",value:function(){var e=m(v.mark((function e(t){var n,r,o,a=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t===this._enabled){e.next=38;break}return Rl.info("[".concat(this.getTrackId(),"] start setEnabled"),t),e.next=4,this._enabledMutex.lock();case 4:if(n=e.sent,t){e.next=18;break}return this._originMediaStreamTrack.onended=null,this._originMediaStreamTrack.stop(),this._enabled=!1,e.prev=9,e.next=12,_t(this,ud.NEED_REMOVE_TRACK,this);case 12:e.next=17;break;case 14:throw e.prev=14,e.t0=e.catch(9),Rl.error("[".concat(this.getTrackId(),"] setEnabled to false error"),e.t0.toString()),n(),e.t0;case 17:return e.abrupt("return",(Rl.info("[".concat(this.getTrackId(),"] setEnabled to false success")),n()));case 18:return t=Dn({},this._constraints),(r=Df.searchDeviceIdByName(this._deviceName))&&!t.deviceId&&(t.deviceId={exact:r}),e.prev=21,e.next=24,Lt({video:this._constraints},this.getTrackId());case 24:return o=e.sent,e.next=27,this._updateOriginMediaStreamTrack(o.getVideoTracks()[0],!1);case 27:return e.next=29,_t(this,ud.NEED_ADD_TRACK,this);case 29:e.next=34;break;case 31:throw e.prev=31,e.t1=e.catch(21),Rl.error("[".concat(this.getTrackId(),"] setEnabled true error"),e.t1.toString()),n(),e.t1;case 34:mt(this._originMediaStreamTrack).then((function(e){var t=i(e,2),n=t[0],r=t[1];a._videoHeight=r,a._videoWidth=n})),Rl.info("[".concat(this.getTrackId(),"] setEnabled to true success")),this._enabled=!0,n();case 38:case"end":return e.stop()}}),e,this,[[9,14],[21,31]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setEncoderConfiguration",value:function(){var e=m(v.mark((function e(t,n){var r,o,a=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CAM_VIDEO_TRACK_SET_ENCODER_CONFIG,options:[this.getTrackId(),t]}),this._enabled){e.next=3;break}throw t=new Al($u.TRACK_IS_DISABLED,"can not set encoder configuration when track is disabled"),n.onError(t),t;case 3:return t=me(t),this._forceBitrateLimit&&(t.bitrateMax=this._forceBitrateLimit.max_bitrate?this._forceBitrateLimit.max_bitrate:t.bitrateMax,t.bitrateMin=this._forceBitrateLimit.min_bitrate?this._forceBitrateLimit.min_bitrate:t.bitrateMin),o=this._config,(r=JSON.parse(Yr(o))).encoderConfig=t,o=On(r),Rl.debug("[".concat(this.getTrackId(),"] setEncoderConfiguration applyConstraints"),Yr(t),Yr(o)),e.prev=9,e.next=12,this._originMediaStreamTrack.applyConstraints(o);case 12:mt(this._originMediaStreamTrack).then((function(e){var t=i(e,2),n=t[0],r=t[1];a._videoHeight=r,a._videoWidth=n})),e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(9),t=new Al($u.UNEXPECTED_ERROR,e.t0.toString()),Rl.error("[track-".concat(this.getTrackId(),"] applyConstraints error"),t.toString()),n.onError(t),t;case 18:return this._config=r,this._constraints=o,this._encoderConfig=t,e.prev=21,e.next=24,_t(this,ud.NEED_RENEGOTIATE);case 24:e.next=29;break;case 26:return e.prev=26,e.t1=e.catch(21),e.abrupt("return",(n.onError(e.t1),e.t1.throw()));case 29:n.onSuccess();case 30:case"end":return e.stop()}}),e,this,[[9,15],[21,26]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"_getDefaultPlayerConfig",value:function(){return{mirror:!0,fit:"cover"}}}]),n}(Jh),Zh=!0;"findIndex"in[]&&Array(1).findIndex((function(){Zh=!1})),Fr({target:"Array",proto:!0,forced:Zh},{findIndex:function(e){return Gi(this,e,1<arguments.length?arguments[1]:void 0)}});var ep=da("Array").findIndex,tp=Array.prototype,np=function(e){var t=e.findIndex;return e===tp||e instanceof Array&&t===tp.findIndex?ep:t},rp=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this,r,r.stringUid||r.uid)).type="pub",a._waitingSuccessResponse=a.detecting=!1,a.renegotiateWithGateway=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",(Rl.debug("[pc-".concat(a.pc.ID,"] renegotiate start")),new kc(function(){var e=m(v.mark((function e(t,n){var r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a.connectionState="connecting",r=function e(r){"connected"===r&&(a.off(zl.CONNECTION_STATE_CHANGE,e),t()),"disconnected"===r&&(a.off(zl.CONNECTION_STATE_CHANGE,e),n(new Al($u.OPERATION_ABORTED,"renegotiate abort")))},a.on(zl.CONNECTION_STATE_CHANGE,r),e.next=5,a.pc.createOfferSDP();case 5:return i=e.sent,a.audioTrack&&a.audioTrack._encoderConfig&&(i=xn(i,a.audioTrack._encoderConfig)),a.videoTrack&&a.videoTrack._scalabiltyMode&&("vp9"!==a.codec?(a.videoTrack._scalabiltyMode.numSpatialLayers=1,a.videoTrack._scalabiltyMode.numTemporalLayers=1):i=Mn(i,a.codec,a.videoTrack._scalabiltyMode),Rl.debug("renegoation spatial layers: ",a.videoTrack._scalabiltyMode.numSpatialLayers)),e.next=10,a.pc.setOfferSDP(i);case 10:return a.pc.onOfferSettled(),e.next=13,yt(c(a),zl.NEED_RENEGOTIATE,i);case 13:return o=e.sent,i=function(e,t){var n,r,i,o=iu(n=RegExp.prototype.test).call(n,/^([a-z])=(.*)/);e=ds(r=e.split(/(\r\n|\r|\n)/)).call(r,o),t=ds(i=t.split(/(\r\n|\r|\n)/)).call(i,o);var a=null,s=new ra;return ba(e).call(e,(function(e){var t=e.match(/m=(audio|video)/);t&&t[1]?a=t[1]:a&&(e=e.match(/=(sendrecv|recvonly|sendonly|inactive)/))&&e[1]&&s.set(a,e[1])})),a=null,Pc(t).call(t,(function(e){var t=e.match(/m=(audio|video)/);if(t&&t[1])return a=t[1],e;if(!a)return e;if((t=e.match(/=(sendrecv|recvonly|sendonly|inactive)/))&&t[1]){var n=s.get(a);if(n&&n!==t[1])return e.replace(t[1],n)}return e})).join("\r\n")+"\r\n"}(i,a.updateAnswerSDP(o.sdp)),e.next=17,a.pc.setAnswerSDP(i);case 17:Rl.debug("[pc-".concat(a.pc.ID,"] renegotiate success")),a.connectionState="connected";case 19:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())));case 1:case"end":return e.stop()}}),e)}))),a.handleStreamRenegotiate=function(e,t){"connected"===a.connectionState?a.renegotiateWithGateway().then(e).catch(t):e()},a.handleReplaceTrack=function(e,t,n){if(a.audioTrack instanceof ih&&"audio"===e.kind)return kc.resolve();a.pc.replaceTrack(e).then((function(e){return e?a.renegotiateWithGateway():kc.resolve()})).then(t).catch(n)},a.handleCloseAudioTrack=function(e){},a.handleCloseVideoTrack=function(){a.lowStreamConnection&&a.lowStreamConnection.videoTrack&&a.lowStreamConnection.videoTrack.close()},a.handleGetSessionID=function(e){e(a.joinInfo.sid)},a.handleGetLocalVideoStats=function(e){e(a.statsCollector.getLocalVideoTrackStats(a.connectionId))},a.handleGetLocalAudioStats=function(e){e(a.statsCollector.getLocalAudioTrackStats(a.connectionId))},a.handleSetOptimizationMode=function(e,t,n){a.pc.setRtpSenderParameters({},"detail"===e?"maintain-resolution":"motion"===e?"maintain-framerate":e).then(t).catch(n)},a.isLowStreamConnection=!!o,a.codec=i,a.statsCollector=e,a.statsCollector.addLocalConnection(c(a)),a}return h(n,[{key:"getAllTracks",value:function(){var e=[];return this.videoTrack&&e.push(this.videoTrack),this.audioTrack&&this.audioTrack instanceof ih?e=cs(e).call(e,this.audioTrack.trackList):this.audioTrack&&e.push(this.audioTrack),e}},{key:"addTracks",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ed,"connecting"!==this.connectionState){e.next=13;break}return e.prev=2,e.next=5,this.createWaitConnectionConnectedPromise();case 5:return e.next=7,this.addTracks(t);case 7:return e.abrupt("return",e.sent);case 10:throw e.prev=10,e.t0=e.catch(2),new Al($u.OPERATION_ABORTED,"publish abort");case 13:r=!1,i=this.getAllTracks(),t=Tt(t=ds(t).call(t,(function(e){return-1===Gc(i).call(i,e)}))),o=0;case 17:if(!(o<t.length)){e.next=60;break}if((a=t[o])instanceof zf){e.next=21;break}return e.abrupt("return",new Al($u.INVALID_LOCAL_TRACK).throw());case 21:if(!(a instanceof Jh&&this.disabledVideoTrack)){e.next=25;break}if(this.disabledVideoTrack===a){e.next=24;break}return e.abrupt("return",new Al($u.EXIST_DISABLED_VIDEO_TRACK).throw());case 24:this.disabledVideoTrack=void 0;case 25:if(!(a instanceof Jh&&this.videoTrack)){e.next=27;break}return e.abrupt("return",new Al($u.CAN_NOT_PUBLISH_MULTIPLE_VIDEO_TRACKS).throw());case 27:if(!(a instanceof th&&this.audioTrack)){e.next=42;break}if(!(this.audioTrack instanceof ih)){e.next=32;break}this.audioTrack.addAudioTrack(a),e.next=40;break;case 32:if(n.webAudioMediaStreamDest){e.next=34;break}throw new Al($u.NOT_SUPPORTED,"your browser is not support audio mixing");case 34:return(r=new ih).addAudioTrack(this.audioTrack),r.addAudioTrack(a),e.next=39,this.addTrackWithPC(r);case 39:r=e.sent;case 40:e.next=57;break;case 42:if(!(a instanceof Jh&&this.isLowStreamConnection)){e.next=52;break}return r=Fn({},{width:160,height:120,framerate:15,bitrate:50},{},this.lowStreamParameter),n.supportDualStreamEncoding?(Rl.debug("[".concat(this.connectionId,"] creating low stream using rtp encoding.")),this.lowStreamEncoding=ut(r,a),a=a.clone({bitrateMax:r.bitrate,bitrateMin:r.bitrate})):(Rl.debug("[".concat(this.connectionId,"] creating low stream using canvas.")),a=Un(a,r),a=new Jh(a,{bitrateMax:r.bitrate,bitrateMin:r.bitrate})),a._hints.push(ld.LOW_STREAM),e.next=48,this.addTrackWithPC(a);case 48:r=e.sent,this.bindTrackEvents(a),e.next=57;break;case 52:return this.detecting=!0,jf((function(){s.detecting=!1}),8e3),e.next=56,this.addTrackWithPC(a);case 56:r=e.sent;case 57:o+=1,e.next=17;break;case 60:if(e.t1=r,!e.t1){e.next=64;break}return e.next=64,this.renegotiateWithGateway();case 64:ba(t).call(t,(function(e){return s.bindTrackEvents(e)}));case 65:case"end":return e.stop()}}),e,this,[[2,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"removeTracks",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s,c,u,l,d=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.getAllTracks(),t=Tt(t=ds(t).call(t,(function(e){return-1!==Gc(r).call(r,e)||e===d.disabledVideoTrack}))),i=[],o=0;case 4:if(!(o<t.length)){e.next=27;break}if(a=t[o],this.unbindTrackEvents(a),!(this.audioTrack instanceof ih&&a instanceof th)){e.next=10;break}this.audioTrack.removeAudioTrack(a),0===this.audioTrack.trackList.length&&(i.push(this.audioTrack),this.audioTrack=void 0),e.next=24;break;case 10:if(!(a instanceof th)){e.next=14;break}i.push(a),this.audioTrack=void 0,e.next=24;break;case 14:if(!(a instanceof Jh)){e.next=24;break}if(!n){e.next=20;break}if(this.disabledVideoTrack!==a){e.next=18;break}return e.abrupt("return",void(this.disabledVideoTrack=void 0));case 18:e.next=21;break;case 20:this.disabledVideoTrack=this.videoTrack;case 21:i.push(a),this.isLowStreamConnection&&a.close(),this.videoTrack=void 0;case 24:o+=1,e.next=4;break;case 27:if(!this.videoTrack&&!this.audioTrack){e.next=60;break}if(0===i.length){e.next=58;break}if("connecting"!==this.connectionState){e.next=38;break}return e.prev=30,e.next=33,this.createWaitConnectionConnectedPromise();case 33:e.next=38;break;case 35:return e.prev=35,e.t0=e.catch(30),e.abrupt("return");case 38:s=p(i),e.prev=39,s.s();case 41:if((c=s.n()).done){e.next=48;break}return u=c.value,Rl.debug(cs(l="[".concat(this.connectionId,"] remove ")).call(l,u.trackMediaType," from pc")),e.next=46,this.pc.removeTrack(u._mediaStreamTrack);case 46:e.next=41;break;case 48:e.next=53;break;case 50:e.prev=50,e.t1=e.catch(39),s.e(e.t1);case 53:return e.prev=53,s.f(),e.finish(53);case 56:return e.next=58,this.renegotiateWithGateway();case 58:e.next=62;break;case 60:return e.next=62,this.closeP2PConnection();case 62:case"end":return e.stop()}}),e,this,[[30,35],[39,50,53,56]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"startP2PConnection",value:function(){var e=this;return new kc(function(){var t=m(v.mark((function t(n,r){var i,o,a,s;return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.audioTrack||e.videoTrack){t.next=2;break}return t.abrupt("return",r(new Al($u.UNEXPECTED_ERROR,"no track to publish")));case 2:if(i=function t(i){if("connected"===i&&(e.off(zl.CONNECTION_STATE_CHANGE,t),n()),"disconnected"===i){if(e.off(zl.CONNECTION_STATE_CHANGE,t),e.disconnectedReason)return r(e.disconnectedReason);r(new Al($u.OPERATION_ABORTED,"publish abort"))}},e.on(zl.CONNECTION_STATE_CHANGE,i),e.disconnectedReason=void 0,e.connectionState="connecting",e._waitingSuccessResponse=!0,e.startTime=gf(),t.prev=8,t.t0=!e.pc.videoTrack&&e.videoTrack,!t.t0){t.next=13;break}return t.next=13,e.pc.addTrack(e.videoTrack._mediaStreamTrack);case 13:if(t.t1=!e.pc.audioTrack&&e.audioTrack,!t.t1){t.next=17;break}return t.next=17,e.pc.addTrack(e.audioTrack._mediaStreamTrack);case 17:return t.next=19,e.pc.createOfferSDP();case 19:return o=t.sent,e.audioTrack&&e.audioTrack._encoderConfig&&(o=xn(o,e.audioTrack._encoderConfig)),e.videoTrack&&e.videoTrack._scalabiltyMode&&("vp9"!==e.codec&&"av1"!==e.codec?(e.videoTrack._scalabiltyMode.numSpatialLayers=1,e.videoTrack._scalabiltyMode.numTemporalLayers=1):o=Mn(o,e.codec,e.videoTrack._scalabiltyMode),Rl.debug("spatial layers: ",e.videoTrack._scalabiltyMode.numSpatialLayers)),t.next=24,e.pc.setOfferSDP(o);case 24:if(e.pc.onOfferSettled(),Rl.debug("[".concat(e.connectionId,"] create and set offer success")),o={messageType:"OFFER",sdp:o,offererSessionId:104,retry:!0},t.t2=Ed.supportDualStreamEncoding&&e.isLowStreamConnection&&e.lowStreamEncoding&&e.videoTrack,!t.t2){t.next=31;break}return t.next=31,e.setLowStreamEncoding(e.lowStreamEncoding,e.videoTrack);case 31:return t.next=33,yt(e,zl.NEED_ANSWER,o);case 33:return a=t.sent,s=e.updateAnswerSDP(a.sdp),t.next=37,e.pc.setAnswerSDP(s);case 37:return Rl.debug("[".concat(e.connectionId,"] set answer success")),t.next=40,e.icePromise;case 40:e.connectionState="connected",e.startUploadStats(),t.next=47;break;case 44:t.prev=44,t.t3=t.catch(8),e.off(zl.CONNECTION_STATE_CHANGE,i),e.connectionState="disconnected",e.reportPublishEvent(!1,t.t3.code),Rl.error("[".concat(e.connectionId,"] connection error"),t.t3.toString()),r(t.t3);case 47:case"end":return t.stop()}}),t,null,[[8,44]])})));return function(e,n){return t.apply(this,arguments)}}())}},{key:"reportPublishEvent",value:function(e,t,n){var r;this._waitingSuccessResponse=!1,Ff.publish(this.joinInfo.sid,{lts:this.startTime,succ:e,ec:t,audioName:this.audioTrack&&this.audioTrack.getTrackLabel(),videoName:this.videoTrack&&this.videoTrack.getTrackLabel(),screenshare:!(!this.videoTrack||-1===Gc(r=this.videoTrack._hints).call(r,ld.SCREEN_TRACK)),audio:!!this.audioTrack,video:!!this.videoTrack,p2pid:this.pc.ID,publishRequestid:this.ID,extend:n})}},{key:"closeP2PConnection",value:function(){var e=m(v.mark((function e(t){var n,r,i=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getAllTracks(),ba(n).call(n,(function(e){i.unbindTrackEvents(e)})),this.isLowStreamConnection&&this.videoTrack&&this.videoTrack.close(),this.videoTrack=void 0,this.audioTrack instanceof ih&&ba(r=this.audioTrack.trackList).call(r,(function(e){i.audioTrack.removeAudioTrack(e)})),this.audioTrack=void 0,this.stopUploadStats(),this.statsCollector.removeConnection(this.connectionId),e.next=7,this.closePC(t);case 7:this.connectionState="disconnected",this.removeAllListeners();case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getNetworkQuality",value:function(){var e,t=this.pc.getStats();if(!t.videoSend[0]&&!t.audioSend[0])return 1;var n=bt(this,zl.NEED_SIGNAL_RTT),r=t.videoSend[0]?t.videoSend[0].rttMs:void 0,i=t.audioSend[0]?t.audioSend[0].rttMs:void 0;return r=r&&i?(r+i)/2:r||i,n=.17>(n=70*t.sendPacketLossRate/50+.3*((r&&n?(r+n)/2:r||n)||0)/1500)?1:.36>n?2:.59>n?3:.1>n?4:5,this.videoTrack&&this.videoTrack._encoderConfig&&-1===Gc(e=this.videoTrack._hints).call(e,ld.SCREEN_TRACK)&&(e=this.videoTrack._encoderConfig.bitrateMax,t=t.bitrate.actualEncoded,e&&t)?Wu[.15>(t=(1e3*e-t)/(1e3*e))?0:.3>t?1:.45>t?2:.6>t?3:4][n]:n}},{key:"handleUpdateBitrateLimit",value:function(e){this.videoTrack&&this.videoTrack.setBitrateLimit(e)}},{key:"uploadStats",value:function(e,t){var n=this,r=this.audioTrack?function(e,t){var n=e.audioSend[0];return n?((e={id:vt(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:n.ssrc.toString()}).A_astd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1",n.inputLevel?e.A_ail=Math.round(100*n.inputLevel).toString():e.A_ail=Math.round(100*t._source.getAudioAvgLevel()).toString(),e.A_apil=Math.round(100*t._source.getAudioAvgLevel()).toString(),e):null}(e,this.audioTrack):void 0,i=this.videoTrack?function(e,t){var n=e.videoSend[0];if(!n)return null;switch((e={id:vt(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:n.ssrc.toString()}).A_vstd=t._originMediaStreamTrack&&!t._originMediaStreamTrack.enabled||!t._mediaStreamTrack.enabled?"1":"0",n.sentFrame&&(e.A_fhs=n.sentFrame.height.toString(),e.A_frs=n.sentFrame.frameRate.toString(),e.A_fws=n.sentFrame.width.toString()),n.adaptionChangeReason){case"none":e.A_ac="0";break;case"cpu":e.A_ac="1";break;case"bandwidth":e.A_ac="2";break;case"other":e.A_ac="3"}return e.A_nr=n.nacksCount.toString(),n.avgEncodeMs&&(e.A_aem=n.avgEncodeMs.toFixed(0).toString()),e}(e,this.videoTrack):void 0,o=st(e,t),a=function(e){var t={id:"bweforvideo",timestamp:new Date(e.timestamp).toISOString(),type:"VideoBwe"};return e.bitrate.retransmit&&(t.A_rb=e.bitrate.retransmit.toString()),e.bitrate.targetEncoded&&(t.A_teb=e.bitrate.targetEncoded.toString()),t.A_aeb=e.bitrate.actualEncoded.toString(),t.A_tb=e.bitrate.transmit.toString(),void 0!==e.sendBandwidth&&(t.A_asb=e.sendBandwidth.toString()),t}(e);r&&St((function(){return n.emit(zl.NEED_UPLOAD,Kl.PUBLISH_STATS,r)})),i&&St((function(){return n.emit(zl.NEED_UPLOAD,Kl.PUBLISH_STATS,Fn({},i,{},o))})),a&&St((function(){return n.emit(zl.NEED_UPLOAD,Kl.PUBLISH_STATS,a)}))}},{key:"uploadSlowStats",value:function(e){var t=this,n=st(e);n&&St((function(){return t.emit(zl.NEED_UPLOAD,Kl.PUBLISH_STATS,n)}))}},{key:"uploadRelatedStats",value:function(e){var t=this,n=function(e){return(e=e.videoSend[0])?{mediaType:"video",isVideoMute:!1,frameRateInput:e.inputFrame&&e.inputFrame.frameRate.toString(),frameRateSent:e.sentFrame&&e.sentFrame.frameRate.toString(),googRtt:e.rttMs.toString()}:null}(e);n&&St((function(){t.emit(zl.NEED_UPLOAD,Kl.PUBLISH_RELATED_STATS,n)}))}},{key:"bindTrackEvents",value:function(e){var t;e.addListener(ud.NEED_RESET_REMOTE_SDP,iu(t=this.handleResetRemoteSdp).call(t,this)),this.isLowStreamConnection||(e instanceof th?(e.addListener(ud.GET_STATS,this.handleGetLocalAudioStats),e.addListener(ud.NEED_CLOSE,this.handleCloseAudioTrack)):e instanceof Jh&&(e.addListener(ud.GET_STATS,this.handleGetLocalVideoStats),e.addListener(ud.NEED_CLOSE,this.handleCloseVideoTrack),e.addListener(ud.SET_OPTIMIZATION_MODE,this.handleSetOptimizationMode)),e.addListener(ud.NEED_RENEGOTIATE,this.handleStreamRenegotiate),e.addListener(ud.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.addListener(ud.NEED_SESSION_ID,this.handleGetSessionID))}},{key:"unbindTrackEvents",value:function(e){this.isLowStreamConnection||(e instanceof th?(e.off(ud.GET_STATS,this.handleGetLocalAudioStats),e.off(ud.NEED_CLOSE,this.handleCloseAudioTrack)):e instanceof Jh&&(e.off(ud.GET_STATS,this.handleGetLocalVideoStats),e.off(ud.NEED_CLOSE,this.handleCloseVideoTrack)),e.off(ud.NEED_RENEGOTIATE,this.handleStreamRenegotiate),e.off(ud.NEED_REPLACE_TRACK,this.handleReplaceTrack),e.off(ud.NEED_SESSION_ID,this.handleGetSessionID))}},{key:"addTrackWithPC",value:function(){var e=m(v.mark((function e(t){var n,r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("connecting"!==this.connectionState){e.next=2;break}return e.abrupt("return",new Al($u.INVALID_OPERATION,"last publish operation has not finished").throw());case 2:if(n=this.videoTrack,r=!1,!(this.audioTrack&&t instanceof th)){e.next=12;break}return this.audioTrack=t,Rl.debug("[".concat(this.connectionId,"] replace pc audio track")),e.next=9,this.pc.replaceTrack(t._mediaStreamTrack);case 9:r=e.sent,e.next=35;break;case 12:if(!(this.videoTrack&&t instanceof Jh)){e.next=20;break}return this.videoTrack=t,Rl.debug("[".concat(this.connectionId,"] replace pc video track")),e.next=17,this.pc.replaceTrack(t._mediaStreamTrack);case 17:r=e.sent,e.next=35;break;case 20:if(!(t instanceof th)){e.next=28;break}return this.audioTrack=t,Rl.debug("[".concat(this.connectionId,"] add audio track to pc")),e.next=25,this.pc.addTrack(t._mediaStreamTrack);case 25:r=!0,e.next=35;break;case 28:if(e.t0=t instanceof Jh,!e.t0){e.next=35;break}return this.videoTrack=t,Rl.debug("[".concat(this.connectionId,"] add video track to pc")),e.next=34,this.pc.addTrack(t._mediaStreamTrack);case 34:r=!0;case 35:if(t=Ed,e.t1=this.videoTrack!==n&&this.videoTrack&&t.supportSetRtpSenderParameters,!e.t1){e.next=45;break}return n={},t="balanced",this.videoTrack._encoderConfig&&(n.maxBitrate=this.videoTrack._encoderConfig.bitrateMax?1e3*this.videoTrack._encoderConfig.bitrateMax:void 0),"motion"===this.videoTrack._optimizationMode?t="maintain-framerate":"detail"===this.videoTrack._optimizationMode&&(t="maintain-resolution"),Rl.debug("[".concat(this.connectionId,"] set pc rtp sender"),n,t),e.next=45,this.pc.setRtpSenderParameters(n,t);case 45:return e.abrupt("return","disconnected"!==this.connectionState&&r);case 46:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handleResetRemoteSdp",value:function(){var e=this;return new kc((function(t,n){var r;Rl.info("[pc-".concat(e.pc.ID,"] start reset remote sdp"));var i,o=e.pc.getOfferSDP(),a=e.pc.getAnswerSDP();if(!a||!o)return t();a=a.sdp,e.videoTrack&&e.videoTrack._encoderConfig&&-1===Gc(r=e.videoTrack._hints).call(r,ld.SCREEN_TRACK)&&(i=function(e,t){var n,r,i=t.bitrateMin;t=t.bitrateMax;var o=iu(n=RegExp.prototype.test).call(n,/^([a-z])=(.*)/);if(e=ds(r=e.split(/(\r\n|\r|\n)/)).call(r,o),t){var a,s="AS";Ze().name===wu.FIREFOX&&(t=1e3*(t>>>0),s="TIAS"),0<(r=np(e).call(e,(function(e){return uu(e).call(e,s)})))&&(e[r]=cs(a="b=".concat(s,":")).call(a,t))}return i&&0<(a=np(e).call(e,(function(e){return uu(e).call(e,"x-google-min-bitrate")})))&&(e[a]=e[a].replace(/x-google-min-bitrate=(.*)/,"x-google-min-bitrate=".concat(i))),e.join("\r\n")+"\r\n"}(a,e.videoTrack._encoderConfig)),a!==i?e.pc.setOfferSDP(o.sdp).then((function(){if(i)return e.pc.setAnswerSDP(i)})).then(t).catch((function(t){var r;Rl.error(cs(r="[pc-".concat(e.pc.ID,"] reset remote sdp error, ")).call(r,t)),n(t)})):Rl.debug("[pc-".concat(e.pc.ID,"] remote sdp have no not changed"))}))}},{key:"updateAnswerSDP",value:function(e){var t,n;return e=e.replace(/a=x-google-flag:conference\r\n/g,""),this.videoTrack&&Gc(t=this.videoTrack._hints).call(t,ld.SCREEN_TRACK),this.videoTrack&&this.videoTrack._encoderConfig&&-1===Gc(n=this.videoTrack._hints).call(n,ld.SCREEN_TRACK)&&(e=function(e,t,n){var r=Ed,i=n.bitrateMin;n=n.bitrateMax;var o,a,s,c,u=e.match(/m=video.*\r\n/)||e.match(/m=video.*\n/);return u&&0<u.length&&r.supportMinBitrate&&i&&(r=null,"h264"===t?r=e.match(/a=rtpmap:(\d+) H264\/90000\r\n/)||e.match(/a=rtpmap:(\d+) H264\/90000\n/):"vp8"===t?r=e.match(/a=rtpmap:(\d+) VP8\/90000\r\n/)||e.match(/a=rtpmap:(\d+) VP8\/90000\n/):"vp9"===t?r=e.match(/a=rtpmap:(\d+) VP9\/90000\r\n/)||e.match(/a=rtpmap:(\d+) VP9\/90000\n/):"av1"===t&&(r=e.match(/a=rtpmap:(\d+) AV1X\/90000\r\n/)||e.match(/a=rtpmap:(\d+) AV1X\/90000\n/)),r&&r[1]&&(e=e.replace(u[0],cs(o=cs(a="".concat(u[0],"a=fmtp:")).call(a,r[1]," x-google-min-bitrate=")).call(o,i,"\r\n")))),u&&0<u.length&&n&&(t="AS",Ze().name===wu.FIREFOX&&(n=1e3*(n>>>0),t="TIAS"),e=e.replace(u[0],cs(s=cs(c="".concat(u[0],"b=")).call(c,t,":")).call(s,n,"\r\n"))),e}(e,this.codec,this.videoTrack._encoderConfig)),this.audioTrack&&this.audioTrack._encoderConfig&&(e=xn(e,this.audioTrack._encoderConfig)),function(e){var t=Ze();return t.name!==wu.SAFARI&&t.os!==Eu.IOS?e:e.replace(/a=.*video-orientation\r\n/g,"")}(e)}},{key:"createPC",value:function(){this.pc=new Rh({turnServer:this.joinInfo.turnServer}),this.updateICEPromise()}},{key:"closePC",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pc.onICEConnectionStateChange=void 0,this.pc.close(),e.t0=!t,!e.t0){e.next=7;break}return e.next=6,yt(this,zl.NEED_UNPUB);case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onPCDisconnected",value:function(e){this.reportPublishEvent(!1,e.code)}},{key:"setLowStreamEncoding",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.pc.setVideoRtpEncodingParameters(t);case 3:if(r=e.sent,i=n.getMediaStreamTrack(),!t.scaleResolutionDownBy||r.encodings[0].scaleResolutionDownBy===t.scaleResolutionDownBy){e.next=11;break}if(o=n._videoHeight||i.getSettings().height,a=n._videoWidth||i.getSettings().width,e.t0=o&&a,!e.t0){e.next=11;break}return e.next=11,i.applyConstraints({height:o/t.scaleResolutionDownBy,width:a/t.scaleResolutionDownBy});case 11:if(e.t1=t.maxFramerate&&r.encodings[0].maxFramerate!==t.maxFramerate,!e.t1){e.next=15;break}return e.next=15,i.applyConstraints({frameRate:t.maxFramerate});case 15:e.next=22;break;case 17:if(e.prev=17,e.t2=e.catch(0),!(e.t2 instanceof Al)){e.next=21;break}throw e.t2;case 21:throw new Al($u.LOW_STREAM_ENCODING_ERROR,e.t2.message);case 22:case"end":return e.stop()}}),e,this,[[0,17]])})));function t(t,n){return e.apply(this,arguments)}return t}()}]),n}(Oh),ip=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return f(this,n),(o=t.call(this,e))._isDestroyed=!1,o._userId=r,o._uintId=i,o}return h(n,[{key:"getUserId",value:function(){return this._userId}},{key:"_updateOriginMediaStreamTrack",value:function(e){this._mediaStreamTrack=this._originMediaStreamTrack=e,this._updatePlayerSource()}},{key:"_destroy",value:function(){this._isDestroyed=!0,Rl.info("[track-".concat(this.getTrackId(),"] is destroyed")),this.stop()}}]),n}(Hf),op=function(e){l(n,e);var t=d(n);function n(e,r,o){var a;return f(this,n),(a=t.call(this,e,r,o)).trackMediaType="video",mt(e).then((function(e){var t=i(e,2),n=t[0],r=t[1];a._videoHeight=r,a._videoWidth=n})).catch(wf),a}return h(n,[{key:"isPlaying",get:function(){return!(!this._player||this._player.videoElementStatus!==El.PLAYING)}},{key:"getStats",value:function(){return It((function(){Rl.warning("[deprecated] RemoteVideoTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteVideoStats instead")}),"remoteVideoTrackGetStatsWarning"),bt(this,ud.GET_STATS)||Bn({},nd)}},{key:"play",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_VIDEO_TRACK_PLAY,options:[this.getTrackId(),"string"==typeof e?e:"HTMLElement",n]});if("string"==typeof e){var i,o=document.getElementById(e);o?e=o:(Rl.warning(cs(i="[track-".concat(this.getTrackId(),'] can not find "#')).call(i,e,'" element, use document.body')),e=document.body)}Rl.debug("[track-".concat(this.getTrackId(),"] start video playback"),Yr(n)),e=Bn({fit:"cover"},n,{trackId:this.getTrackId(),element:e}),this._player?this._player.updateConfig(e):(this._player=new Nh(e),this._player.updateVideoTrack(this._mediaStreamTrack),this._player.onFirstVideoFrameDecoded=function(){t.emit(fd.FIRST_FRAME_DECODED)}),this._player.play(),r.onSuccess()}},{key:"stop",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_VIDEO_TRACK_STOP,options:[this.getTrackId()]});if(!this._player)return e.onSuccess();this._player.destroy(),this._player=void 0,Rl.debug("[track-".concat(this.getTrackId(),"] stop video playback")),e.onSuccess()}},{key:"getCurrentFrameData",value:function(){return this._player?this._player.getCurrentFrame():new ImageData(2,2)}},{key:"_updatePlayerSource",value:function(){Rl.debug("[track-".concat(this.getTrackId(),"] update player source track")),this._player&&this._player.updateVideoTrack(this._mediaStreamTrack)}}]),n}(ip),ap=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return f(this,n),(o=t.call(this,e,r,i)).trackMediaType="audio",o._useAudioElement=!1,o._source=new Zf(e,!0),o._source.once(Yl.RECEIVE_TRACK_BUFFER,(function(){o.emit(fd.FIRST_FRAME_DECODED)})),Ed.webAudioWithAEC||(o._useAudioElement=!0),o}return h(n,[{key:"isPlaying",get:function(){return this._useAudioElement?eh.isPlaying(this.getTrackId()):this._source.isPlayed}},{key:"setAudioFrameCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4096;if(!e)return this._source.removeAllListeners(Yl.ON_AUDIO_BUFFER),void this._source.stopGetAudioBuffer();this._source.startGetAudioBuffer(t),this._source.removeAllListeners(Yl.ON_AUDIO_BUFFER),this._source.on(Yl.ON_AUDIO_BUFFER,(function(t){return e(t)}))}},{key:"setVolume",value:function(e){var t=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_AUDIO_SET_VOLUME,options:[this.getTrackId(),e]},300);this._useAudioElement?eh.setVolume(this.getTrackId(),e):this._source.setVolume(e/100),t.onSuccess()}},{key:"setPlaybackDevice",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_AUDIO_SET_OUTPUT_DEVICE,options:[this.getTrackId(),t]}),this._useAudioElement){e.next=3;break}throw new Al($u.NOT_SUPPORTED,"your browser does not support setting the audio output device");case 3:return e.prev=3,e.next=6,eh.setSinkID(this.getTrackId(),t);case 6:e.next=11;break;case 8:throw e.prev=8,e.t0=e.catch(3),n.onError(e.t0),e.t0;case 11:n.onSuccess();case 12:case"end":return e.stop()}}),e,this,[[3,8]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getVolumeLevel",value:function(){return this._source.getAudioLevel()}},{key:"getStats",value:function(){return It((function(){Rl.warning("[deprecated] RemoteAudioTrack.getStats will be removed in the future, use AgoraRTCClient.getRemoteAudioStats instead")}),"remoteAudioTrackGetStatsWarning"),bt(this,ud.GET_STATS)||Bn({},ed)}},{key:"play",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_AUDIO_TRACK_PLAY,options:[this.getTrackId()]});Rl.debug("[".concat(this.getTrackId(),"] start audio playback")),this._useAudioElement?(Rl.debug("[track-".concat(this.getTrackId(),"] use audio element to play")),eh.play(this._mediaStreamTrack,this.getTrackId())):this._source.play(),e.onSuccess()}},{key:"stop",value:function(){var e=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.REMOTE_AUDIO_TRACK_STOP,options:[this.getTrackId()]});Rl.debug("[".concat(this.getTrackId(),"] stop audio playback")),this._useAudioElement?eh.stop(this.getTrackId()):this._source.stop(),e.onSuccess()}},{key:"_destroy",value:function(){a(s(n.prototype),"_destroy",this).call(this),this._source.destroy()}},{key:"_isFreeze",value:function(){return this._source.isFreeze}},{key:"_updatePlayerSource",value:function(){Rl.debug("[track-".concat(this.getTrackId(),"] update player source track")),this._source.updateTrack(this._mediaStreamTrack),this._useAudioElement&&eh.updateTrack(this.getTrackId(),this._mediaStreamTrack)}}]),n}(ip),sp=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this,i,e.uid)).type="sub",a.unusedTracks=[],a.onTrack=function(e){var t,n,r,i;if("audio"===e.kind&&!a.subscribeOptions.audio||"video"===e.kind&&!a.subscribeOptions.video)return a.unusedTracks.push(e),void Rl.debug(cs(n="[".concat(a.connectionId,"] unused ontrack event, kind: ")).call(n,e.kind));Rl.debug(cs(t="[".concat(a.connectionId,"] emit pc ontrack after subscribe ")).call(t,e.kind),e),(t="audio"===e.kind?a.user._audioTrack:a.user._videoTrack)?t._updateOriginMediaStreamTrack(e):"audio"===e.kind?(a.pc._statsFilter.setIsFirstAudioDecoded(!1),a.user._audioTrack=new ap(e,a.getUserId(),a.user._uintid),Rl.info(cs(r="[".concat(a.connectionId,"] create remote audio track: ")).call(r,a.user._audioTrack.getTrackId())),a.bindTrackEvents(a.user._audioTrack)):(a.user._videoTrack=new op(e,a.getUserId(),a.user._uintid),Rl.info(cs(i="[".concat(a.connectionId,"] create remote video track: ")).call(i,a.user._videoTrack.getTrackId())),a.bindTrackEvents(a.user._videoTrack))},a.handleGetRemoteAudioStats=function(e){e(a.statsCollector.getRemoteAudioTrackStats(a.connectionId))},a.handleGetRemoteVideoStats=function(e){e(a.statsCollector.getRemoteVideoTrackStats(a.connectionId))},a.handleGetSessionID=function(e){e(a.joinInfo.sid)},a.user=e,a.statsCollector=r,a.statsCollector.addRemoteConnection(c(a)),a.subscribeOptions=o,a}return h(n,[{key:"startP2PConnection",value:function(){var e=m(v.mark((function e(){var t=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new kc(function(){var e=m(v.mark((function e(n,r){var i,o,a,s,c,u,l,d,f,h;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=function e(i){if("connected"===i&&(Ff.subscribe(t.joinInfo.sid,{lts:t.startTime,succ:!0,video:t.subscribeOptions.video,audio:t.subscribeOptions.audio,peerid:t.user.uid,ec:null,subscribeRequestid:t.ID,p2pid:t.pc.ID}),t.off(zl.CONNECTION_STATE_CHANGE,e),n()),"disconnected"===i){if(t.off(zl.CONNECTION_STATE_CHANGE,e),t.disconnectedReason)return r(t.disconnectedReason);r(new Al($u.OPERATION_ABORTED,"subscribe abort"))}},t.on(zl.CONNECTION_STATE_CHANGE,i),t.disconnectedReason=void 0,t.connectionState="connecting",t.startTime=gf(),t.subscribeOptions){e.next=3;break}return e.abrupt("return",void r(new Al($u.UNEXPECTED_ERROR,"no subscribe options")));case 3:return o=new MediaStream,a=new kc((function(e){t.pc.onTrack=function(n,r){var i,a;if("audio"===n.kind&&!t.subscribeOptions.audio||"video"===n.kind&&!t.subscribeOptions.video)return t.unusedTracks.push(n),void Rl.debug(cs(a="[".concat(t.connectionId,"] unused ontrack event ")).call(a,n.kind));o.addTrack(n),a={audio:0<o.getAudioTracks().length,video:0<o.getVideoTracks().length},Rl.debug(cs(i="[".concat(t.connectionId,"] subscribe ontrack: ")).call(i,n.kind),r,n);e:{var s,c;for(n=t.subscribeOptions,r=Ju(s=Ra(a)).call(s),s=Ju(c=Ra(n)).call(c),c=0;c<r.length;c+=1){if(r[c]!==s[c]){a=!1;break e}if(a[r[c]]!==n[r[c]]){a=!1;break e}}a=!0}a&&(t.pc.onTrack=t.onTrack,Rl.debug("[".concat(t.connectionId,"] get all subscribed tracks")),e(o))}})),e.prev=4,e.t0=function(e){return Ze().name!==wu.FIREFOX?e:e.replace("/recvonly http://www.webrtc.org/experiments/rtp-hdrext/playout-delay"," http://www.webrtc.org/experiments/rtp-hdrext/playout-delay")},e.t1=Ln,e.next=9,t.pc.createOfferSDP();case 9:return e.t2=e.sent,e.t3=(0,e.t1)(e.t2),s=(0,e.t0)(e.t3),e.next=14,t.pc.setOfferSDP(s);case 14:return Rl.debug("[".concat(t.connectionId,"] create and set offer success")),e.next=17,yt(t,zl.NEED_ANSWER,{messageType:"OFFER",sdp:s,offererSessionId:104,retry:!0});case 17:return c=e.sent,e.next=20,t.pc.setAnswerSDP(Ln(c.sdp));case 20:return Rl.debug("[".concat(t.connectionId,"] set answer success")),e.next=23,kc.all([a,t.icePromise]);case 23:u=e.sent,l=u[0].getAudioTracks()[0],d=u[0].getVideoTracks()[0],l&&(t.user._audioTrack?t.user._audioTrack._updateOriginMediaStreamTrack(l):(t.user._audioTrack=new ap(l,t.getUserId(),t.user._uintid),Rl.info(cs(f="[".concat(t.connectionId,"] create remote audio track: ")).call(f,t.user._audioTrack.getTrackId())),t.bindTrackEvents(t.user._audioTrack))),d&&(t.user._videoTrack?t.user._videoTrack._updateOriginMediaStreamTrack(d):(t.user._videoTrack=new op(d,t.getUserId(),t.user._uintid),Rl.info(cs(h="[".concat(t.connectionId,"] create remote video track: ")).call(h,t.user._videoTrack.getTrackId())),t.bindTrackEvents(t.user._videoTrack))),t.connectionState="connected",t.startUploadStats(),e.next=35;break;case 32:e.prev=32,e.t4=e.catch(4),t.off(zl.CONNECTION_STATE_CHANGE,i),t.connectionState="disconnected",Ff.subscribe(t.joinInfo.sid,{lts:t.startTime,succ:!1,video:t.subscribeOptions.video,audio:t.subscribeOptions.audio,peerid:t.user.uid,ec:e.t4.code,subscribeRequestid:t.ID,p2pid:t.pc.ID}),r(e.t4);case 35:case"end":return e.stop()}}),e,null,[[4,32]])})));return function(t,n){return e.apply(this,arguments)}}()));case 1:case"end":return e.stop()}}),e)})));function t(){return e.apply(this,arguments)}return t}()},{key:"closeP2PConnection",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.t0="disconnected"!==this.connectionState,!e.t0){e.next=10;break}return this.stopUploadStats(),this.statsCollector.removeConnection(this.connectionId),this.connectionState="disconnected",e.next=7,this.setSubscribeOptions({audio:!1,video:!1});case 7:return e.next=9,this.closePC(t);case 9:this.removeAllListeners();case 10:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getNetworkQuality",value:function(){var e=this.pc.getStats();if(!e.audioRecv[0]&&!e.videoRecv[0])return 1;var t=bt(this,zl.NEED_SIGNAL_RTT),n=e.rtt;t=(n&&t?(n+t)/2:n||t)||0,n=e.audioRecv[0]?e.audioRecv[0].jitterMs:void 0;var r=70*(e=e.recvPacketLossRate)/50+.3*t/1500;return n&&(r=60*e/50+.2*t/1500+.2*n/400),.1>r?1:.17>r?2:.36>r?3:.59>r?4:5}},{key:"uploadStats",value:function(e){var t=this,n=this.user.audioTrack?function(e,t){var n=e.audioRecv[0];return n?((e={id:vt(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"audio",type:"ssrc",ssrc:n.ssrc.toString()}).bytesReceived=n.bytes.toString(),e.packetsLost=n.packetsLost.toString(),e.packetsReceived=n.packets.toString(),n.outputLevel?e.A_aol=Math.round(100*n.outputLevel).toString():e.A_aol=Math.round(100*t._source.getAudioAvgLevel()).toString(),e.A_apol=Math.round(100*t._source.getAudioAvgLevel()).toString(),t&&(e.A_artd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1"),e.A_jr=n.jitterMs.toString(),e.A_jbm=Math.floor(n.jitterBufferMs).toString(),e.A_cdm=Math.floor(n.jitterBufferMs).toString(),e):null}(e,this.user.audioTrack):void 0,r=this.user.videoTrack?function(e,t){var n,r=e.videoRecv[0];return r?((e={id:vt(10,""),timestamp:new Date(e.timestamp).toISOString(),mediaType:"video",type:"ssrc",ssrc:r.ssrc.toString()}).bytesReceived=r.bytes.toString(),e.packetsLost=r.packetsLost.toString(),e.packetsReceived=r.packets.toString(),r.framesRateFirefox&&(e.A_frr=r.framesRateFirefox.toString()),r.receivedFrame&&(e.A_frr=r.receivedFrame.frameRate.toString()),e.A_frd=r.decodeFrameRate.toString(),r.outputFrame&&(e.A_fro=r.outputFrame.frameRate.toString()),void 0!==r.jitterBufferMs&&(e.A_jbm=Math.floor(r.jitterBufferMs).toString()),void 0!==r.currentDelayMs&&(e.A_cdm=Math.floor(r.currentDelayMs).toString()),e.A_fs=r.firsCount.toString(),e.A_ns=r.nacksCount.toString(),e.A_ps=r.plisCount.toString(),t&&(e.A_vrtd=t._originMediaStreamTrack.enabled&&t._mediaStreamTrack.enabled?"0":"1"),t._player&&0<t._player.freezeTimeCounterList.length&&(e.A_vrft=Uc(n=t._player.freezeTimeCounterList).call(n,0,1)[0].toString()),e):null}(e,this.user.videoTrack):void 0;n&&St((function(){return t.emit(zl.NEED_UPLOAD,Kl.SUBSCRIBE_STATS,n)})),r&&St((function(){return t.emit(zl.NEED_UPLOAD,Kl.SUBSCRIBE_STATS,r)}))}},{key:"uploadSlowStats",value:function(e){}},{key:"uploadRelatedStats",value:function(e,t){var n=this,r=!0===this.pc._statsFilter.videoIsReady,i=function(e,t,n){return(e=e.audioRecv[0])?(n=Ef.isRemoteAudioFreeze(n),{mediaType:"audio",isAudioMute:!1,peerId:t,googJitterReceived:e.jitterMs.toString(),isFreeze:n,bytesReceived:e.bytes.toString(),packetsReceived:e.packets.toString(),packetsLost:e.packetsLost.toString(),frameReceived:e.receivedFrames.toString(),frameDropped:e.droppedFrames.toString()}):null}(e,this.getUserId(),this.user.audioTrack),o=function(e,t,n,r,i){return(t=t.videoRecv[0])?(e=Ef.isRemoteVideoFreeze(i,t,r?r.videoRecv[0]:void 0)&&e,n={mediaType:"video",isVideoMute:!1,peerId:n,frameRateReceived:t.receivedFrame&&t.receivedFrame.frameRate.toString(),frameRateDecoded:t.decodedFrame&&t.decodedFrame.frameRate.toString(),isFreeze:e,bytesReceived:t.bytes.toString(),packetsReceived:t.packets.toString(),packetsLost:t.packetsLost.toString()},t.framesRateFirefox&&(n.frameRateDecoded=t.framesRateFirefox.toString(),n.frameRateReceived=t.framesRateFirefox.toString()),n):null}(r,e,this.getUserId(),t,this.user.videoTrack);i&&St((function(){n.emit(zl.NEED_UPLOAD,Kl.SUBSCRIBE_RELATED_STATS,i)})),o&&St((function(){n.emit(zl.NEED_UPLOAD,Kl.SUBSCRIBE_RELATED_STATS,o)}))}},{key:"emitOnTrackFromUnusedTracks",value:function(){if(this.subscribeOptions){var e,t=this.subscribeOptions.video;if(this.subscribeOptions.audio){var n,r=Zc(n=this.unusedTracks).call(n,(function(e){return"audio"===e.kind&&"live"===e.readyState}));wt(this.unusedTracks,r),r&&this.onTrack(r)}t&&(t=Zc(e=this.unusedTracks).call(e,(function(e){return"video"===e.kind&&"live"===e.readyState})),wt(this.unusedTracks,t),t&&this.onTrack(t))}}},{key:"setSubscribeOptions",value:function(){var e=m(v.mark((function e(t){var n,r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.audio===this.subscribeOptions.audio&&t.video===this.subscribeOptions.video){e.next=11;break}if("connecting"!==this.connectionState){e.next=10;break}return e.prev=2,e.next=5,this.createWaitConnectionConnectedPromise();case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),new Al($u.OPERATION_ABORTED,"can not update subscribe options, operation abort");case 10:t.audio===this.subscribeOptions.audio&&t.video===this.subscribeOptions.video||(Rl.debug(cs(n=cs(r=cs(i=cs(o="[".concat(this.connectionId,"] update subscribe options [a: ")).call(o,this.subscribeOptions.audio,", v: ")).call(i,this.subscribeOptions.video,"] -> [a: ")).call(r,t.audio,", v: ")).call(n,t.video,"]")),this.subscribeOptions=t,!t.audio&&this.user._audioTrack&&(this.unusedTracks.push(this.user._audioTrack._originMediaStreamTrack),this.user._audioTrack._destroy(),this.unbindTrackEvents(this.user._audioTrack),this.user._audioTrack=void 0),!t.video&&this.user._videoTrack&&(this.unusedTracks.push(this.user._videoTrack._originMediaStreamTrack),this.user._videoTrack._destroy(),this.unbindTrackEvents(this.user._videoTrack),this.user._videoTrack=void 0),this.emitOnTrackFromUnusedTracks());case 11:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"createPC",value:function(){var e=this;this.pc=new Ah({turnServer:this.joinInfo.turnServer}),this.pc.onFirstAudioDecoded=function(){e.user.audioTrack&&e.user.audioTrack.emit(fd.FIRST_FRAME_DECODED),Ff.firstRemoteFrame(e.joinInfo.sid,Cl.FIRST_AUDIO_DECODE,kl.FIRST_AUDIO_DECODE,{peer:e.user._uintid,subscribeElapse:gf()-e.startTime,subscribeRequestid:e.ID,p2pid:e.pc.ID})},this.pc.onFirstAudioReceived=function(){Ff.firstRemoteFrame(e.joinInfo.sid,Cl.FIRST_AUDIO_RECEIVED,kl.FIRST_AUDIO_RECEIVED,{peer:e.user._uintid,subscribeElapse:gf()-e.startTime,subscribeRequestid:e.ID,p2pid:e.pc.ID})},this.pc.onFirstVideoDecoded=function(t,n){Ff.firstRemoteFrame(e.joinInfo.sid,Cl.FIRST_VIDEO_DECODE,kl.FIRST_VIDEO_DECODE,{peer:e.user._uintid,videowidth:t,videoheight:n,subscribeElapse:gf()-e.startTime,subscribeRequestid:e.ID,p2pid:e.pc.ID})},this.pc.onFirstVideoReceived=function(){Ff.firstRemoteFrame(e.joinInfo.sid,Cl.FIRST_VIDEO_RECEIVED,kl.FIRST_VIDEO_RECEIVED,{peer:e.user._uintid,subscribeElapse:gf()-e.startTime,subscribeRequestid:e.ID,p2pid:e.pc.ID})},this.updateICEPromise()}},{key:"closePC",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.pc.audioTrack&&this.pc.audioTrack.stop(),this.pc.videoTrack&&this.pc.videoTrack.stop(),this.pc.onTrack=void 0,this.pc.onICEConnectionStateChange=void 0,this.pc.close(),!t){e.next=4;break}e.t0=!1,e.next=7;break;case 4:return e.next=6,yt(this,zl.NEED_UNSUB);case 6:e.t0=e.sent;case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"onPCDisconnected",value:function(e){Ff.subscribe(this.joinInfo.sid,{lts:this.startTime,succ:!1,video:this.subscribeOptions.video,audio:this.subscribeOptions.audio,peerid:this.user.uid,ec:e.code,subscribeRequestid:this.ID,p2pid:this.pc.ID})}},{key:"bindTrackEvents",value:function(e){e instanceof ap?e.addListener(ud.GET_STATS,this.handleGetRemoteAudioStats):e instanceof op&&e.addListener(ud.GET_STATS,this.handleGetRemoteVideoStats)}},{key:"unbindTrackEvents",value:function(e){e instanceof ap?e.off(ud.GET_STATS,this.handleGetRemoteAudioStats):e instanceof op&&e.off(ud.GET_STATS,this.handleGetRemoteVideoStats)}}]),n}(Oh),cp=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this)).reconnectMode="retry",a.commandReqId=a.reqId=0,a.handleWebSocketOpen=function(){a.reconnectMode="retry",a.startPingPong()},a.handleWebSocketMessage=function(e){var t;e.data&&((e=JSON.parse(e.data)).requestId?a.emit(cs(t="@".concat(e.requestId,"-")).call(t,e.sid),e):a.serviceMode===Jl.INJECT?a.emit(rd.INJECT_STREAM_STATUS,e):(Ff.workerEvent(a.spec.sid,{actionType:"status",serverCode:e.code,workerType:a.serviceMode===Jl.TRANSCODE?1:2}),a.emit(rd.PUBLISH_STREAM_STATUS,e)))},a.spec=r,a.token=e,a.serviceMode=o,a.websocket=new Gf("live-streaming",i),a.websocket.on(Xl.CONNECTED,a.handleWebSocketOpen),a.websocket.on(Xl.ON_MESSAGE,a.handleWebSocketMessage),a.websocket.on(Xl.REQUEST_NEW_URLS,(function(e,t){yt(c(a),rd.REQUEST_NEW_ADDRESS).then(e).catch(t)})),a.websocket.on(Xl.RECONNECTING,(function(){a.websocket.reconnectMode=a.reconnectMode})),a}return h(n,[{key:"init",value:function(e){return this.websocket.init(e)}},{key:"request",value:function(){var e=m(v.mark((function e(t,n,r,i){var o,a,s,c,u,l,d=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.reqId+=1,"request"===t&&(this.commandReqId+=1),o=this.commandReqId,(a=this.reqId)&&this.websocket){e.next=5;break}throw new Al($u.UNEXPECTED_ERROR);case 5:if(s=Gn({command:t,sdkVersion:"4.4.0"===Du?"0.0.1":Du,seq:a,requestId:a,allocate:r,cname:this.spec.cname,appId:this.spec.appId,sid:this.spec.sid,uid:this.spec.uid.toString(),ts:Math.floor(gf()/1e3)},n),"closed"!==this.websocket.state){e.next=8;break}throw new Al($u.WS_DISCONNECT);case 8:if(c=function(){return new kc((function(e,t){d.websocket.once(Xl.CLOSED,(function(){return t(new Al($u.WS_ABORT))})),d.websocket.once(Xl.CONNECTED,e)}))},e.t0="connected"!==this.websocket.state,!e.t0){e.next=13;break}return e.next=13,c();case 13:return s.clientRequest&&(s.clientRequest.workerToken=this.token),u=new kc((function(e,t){var n,r=function(){t(new Al($u.WS_ABORT))};d.websocket.once(Xl.RECONNECTING,r),d.websocket.once(Xl.CLOSED,r),d.once(cs(n="@".concat(a,"-")).call(n,d.spec.sid),(function(t){e(t)}))})),i&&Ff.workerEvent(this.spec.sid,Gn({},i,{requestId:o,actionType:"request",payload:Yr(n.clientRequest),serverCode:0,code:0})),l=gf(),this.websocket.sendMessage(s),s=null,e.prev=19,e.next=22,u;case 22:s=e.sent,e.next=34;break;case 25:if(e.prev=25,e.t1=e.catch(19),"closed"!==this.websocket.state){e.next=29;break}throw e.t1;case 29:return e.next=31,c();case 31:return e.next=33,this.request(t,n,r);case 33:return e.abrupt("return",e.sent);case 34:return e.abrupt("return",(i&&Ff.workerEvent(this.spec.sid,Gn({},i,{requestId:o,actionType:"response",payload:Yr(s.serverResponse),serverCode:s.code,success:200===s.code,responseTime:gf()-l})),200!==s.code&&this.handleResponseError(s),s));case 35:case"end":return e.stop()}}),e,this,[[19,25]])})));function t(t,n,r,i){return e.apply(this,arguments)}return t}()},{key:"tryNextAddress",value:function(){this.reconnectMode="tryNext",this.websocket.reconnect("tryNext")}},{key:"close",value:function(){var e="4.4.0"===Du?"0.0.1":Du;this.reqId+=1,"connected"===this.websocket.state?(this.websocket.sendMessage({command:"request",appId:this.spec.appId,cname:this.spec.cname,uid:this.spec.uid.toString(),sdkVersion:e,sid:this.spec.sid,seq:this.reqId,ts:Math.floor(gf()/1e3),requestId:this.reqId,clientRequest:{command:"DestroyWorker"}}),this.websocket.close(!1,!0)):this.websocket.close(!1),this.pingpongTimer&&(window.clearInterval(this.pingpongTimer),this.pingpongTimer=void 0)}},{key:"handleResponseError",value:function(e){switch(e.code){case od.LIVE_STREAM_RESPONSE_ALREADY_EXISTS_STREAM:return void Rl.warning("live stream response already exists stream");case od.LIVE_STREAM_RESPONSE_TRANSCODING_PARAMETER_ERROR:case od.LIVE_STREAM_RESPONSE_BAD_STREAM:case od.LIVE_STREAM_RESPONSE_WM_PARAMETER_ERROR:return new Al($u.LIVE_STREAMING_INVALID_ARGUMENT,"",{code:e.code}).throw();case od.LIVE_STREAM_RESPONSE_WM_WORKER_NOT_EXIST:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)break;throw new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case od.LIVE_STREAM_RESPONSE_NOT_AUTHORIZED:return new Al($u.LIVE_STREAMING_PUBLISH_STREAM_NOT_AUTHORIZED,"",{code:e.code}).throw();case od.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:var t=new Al($u.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE);return this.emit(rd.WARNING,t,e.serverResponse.url);case od.LIVE_STREAM_RESPONSE_REQUEST_TOO_OFTEN:return t=new Al($u.LIVE_STREAMING_WARN_FREQUENT_REQUEST),this.emit(rd.WARNING,t,e.serverResponse.url);case od.LIVE_STREAM_RESPONSE_NOT_FOUND_PUBLISH:throw new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream response wm worker not exist",{retry:!0});case od.LIVE_STREAM_RESPONSE_NOT_SUPPORTED:return new Al($u.LIVE_STREAMING_TRANSCODING_NOT_SUPPORTED,"",{code:e.code}).throw();case od.LIVE_STREAM_RESPONSE_MAX_STREAM_NUM:return t=new Al($u.LIVE_STREAMING_WARN_STREAM_NUM_REACH_LIMIT),this.emit(rd.WARNING,t,e.serverResponse.url);case od.LIVE_STREAM_RESPONSE_INTERNAL_SERVER_ERROR:return new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code}).throw();case od.LIVE_STREAM_RESPONSE_RESOURCE_LIMIT:throw new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"live stream resource limit",{retry:!0,changeAddress:!0});case od.LIVE_STREAM_RESPONSE_WORKER_LOST:case od.LIVE_STREAM_RESPONSE_WORKER_QUIT:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)break;throw new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case od.ERROR_FAIL_SEND_MESSAGE:if("UnpublishStream"===e.serverResponse.command||"UninjectStream"===e.serverResponse.command)break;if("UpdateTranscoding"===e.serverResponse.command||"ControlStream"===e.serverResponse.command)return new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{code:e.code}).throw();throw new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"error fail send message",{retry:!0,changeAddress:!0});case od.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:return new Al($u.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}).throw()}}},{key:"startPingPong",value:function(){var e=this;this.pingpongTimer&&window.clearInterval(this.pingpongTimer),this.pingpongTimer=window.setInterval((function(){"connected"===e.websocket.state&&e.request("ping",{}).catch(wf)}),6e3)}}]),n}(yf),up=function(e){l(n,e);var t=d(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wf,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wf;return f(this,n),(r=t.call(this)).retryTimeout=1e4,r.streamingTasks=new ra,r.isStartingStreamingTask=!1,r.taskMutex=new kf("live-streaming"),r.cancelToken=Tl.CancelToken.source(),r.injectConfig=Kn({},md),r.injectLoopTimes=0,r.lastTaskId=1,r.statusError=new ra,r.spec=e,r.httpRetryConfig=o,r.wsRetryConfig=i,r}return h(n,[{key:"setTranscodingConfig",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c,l,d,f,h,p,m=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return 66!==(i=Kn({},vd,{},t)).videoCodecProfile&&77!==i.videoCodecProfile&&100!==i.videoCodecProfile&&(Rl.debug(cs(o="[".concat(this.spec.clientId,"] set transcoding config, fix video codec profile: ")).call(o,i.videoCodecProfile," -> 100")),i.videoCodecProfile=100),i.transcodingUsers||(i.transcodingUsers=i.userConfigs),i.transcodingUsers&&(i.transcodingUsers=Pc(a=i.transcodingUsers).call(a,(function(e){return Kn({},hd,{},e,{zOrder:e.zOrder?e.zOrder+1:1})}))),function(e){var t,n;null==e.width||Fe(e.width,"config.width",0,1e4),null==e.height||Fe(e.height,"config.height",0,1e4),null==e.videoBitrate||Fe(e.videoBitrate,"config.videoBitrate",1,1e6),null==e.videoFrameRate||Fe(e.videoFrameRate,"config.videoFrameRate"),null==e.lowLatency||Ue(e.lowLatency,"config.lowLatency"),null==e.audioSampleRate||je(e.audioSampleRate,"config.audioSampleRate",[32e3,44100,48e3]),null==e.audioBitrate||Fe(e.audioBitrate,"config.audioBitrate",1,128),null==e.audioChannels||je(e.audioChannels,"config.audioChannels",[1,2,3,4,5]),null==e.videoGop||Fe(e.videoGop,"config.videoGop"),null==e.videoCodecProfile||je(e.videoCodecProfile,"config.videoCodecProfile",[66,77,100]),null==e.userCount||Fe(e.userCount,"config.userCount",0,17),null==e.backgroundColor||Fe(e.backgroundColor,"config.backgroundColor",0,16777215),null==e.userConfigExtraInfo||Ve(e.userConfigExtraInfo,"config.userConfigExtraInfo",0,4096,!1),e.transcodingUsers&&null!=e.transcodingUsers&&(Be(e.transcodingUsers,"config.transcodingUsers"),ba(t=e.transcodingUsers).call(t,(function(e,t){Ge(e.uid),null==e.x||Fe(e.x,"transcodingUser[".concat(t,"].x"),0,1e4),null==e.y||Fe(e.y,"transcodingUser[".concat(t,"].y"),0,1e4),null==e.width||Fe(e.width,"transcodingUser[".concat(t,"].width"),0,1e4),null==e.height||Fe(e.height,"transcodingUser[".concat(t,"].height"),0,1e4),null==e.zOrder||Fe(e.zOrder-1,"transcodingUser[".concat(t,"].zOrder"),0,100),null==e.alpha||Fe(e.alpha,"transcodingUser[".concat(t,"].alpha"),0,1,!1)}))),null==e.watermark||Xe(e.watermark,"watermark"),null==e.backgroundImage||Xe(e.backgroundImage,"backgroundImage"),e.images&&null!=e.images&&(Be(e.images,"config.images"),ba(n=e.images).call(n,(function(e,t){Xe(e,"images[".concat(t,"]"))})))}(i),t=[],i.images&&(n=t).push.apply(n,u(Pc(s=i.images).call(s,(function(e){return Kn({},pd,{},e,{zOrder:255})})))),i.backgroundImage&&(t.push(Kn({},pd,{},i.backgroundImage,{zOrder:0})),delete i.backgroundImage),i.watermark&&(t.push(Kn({},pd,{},i.watermark,{zOrder:255})),delete i.watermark),i.images=t,i.transcodingUsers&&(i.userConfigs=Pc(c=i.transcodingUsers).call(c,(function(e){return Kn({},e)})),i.userCount=i.transcodingUsers.length,delete i.transcodingUsers),s=Pc(r=i.userConfigs||[]).call(r,(function(e){return"number"==typeof e.uid?kc.resolve(e.uid):hn(e.uid,m.spec,m.cancelToken.token,m.httpRetryConfig)})),e.next=10,kc.all(s);case 10:if(r=e.sent,ba(r).call(r,(function(e,t){i.userConfigs&&i.userConfigs[t]&&(i.userConfigs[t].uid=e)})),this.transcodingConfig=i,!this.connection){e.next=25;break}return e.prev=12,e.next=15,this.connection.request("request",{clientRequest:{command:"UpdateTranscoding",transcodingConfig:this.transcodingConfig}},!1,{command:"UpdateTranscoding",workerType:1,requestByUser:!0,tid:Pc(l=vf(hf(d=this.streamingTasks).call(d))).call(l,(function(e){return e.taskId})).join("#")});case 15:h=e.sent,Rl.debug(cs(f="[".concat(this.spec.clientId,"] update live transcoding config success, code: ")).call(f,h.code,", config:"),Yr(this.transcodingConfig)),e.next=25;break;case 19:if(e.prev=19,e.t0=e.catch(12),e.t0.data&&e.t0.data.retry){e.next=23;break}throw e.t0;case 23:e.t0.data.changeAddress&&this.connection.tryNextAddress(),ba(p=this.streamingTasks).call(p,(function(t){Rl.warning("[".concat(m.spec.clientId,"] live streaming receive error"),e.t0.toString(),"try to republish",t.url),m.startLiveStreamingTask(t.url,t.mode,e.t0).then((function(){var e;Rl.debug(cs(e="[".concat(m.spec.clientId,"] live streaming republish ")).call(e,t.url," success"))})).catch((function(e){Rl.error("[".concat(m.spec.clientId,"] live streaming republish failed"),t.url,e.toString()),m.onLiveStreamError&&m.onLiveStreamError(t.url,e)}))}));case 25:case"end":return e.stop()}}),e,this,[[12,19]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"setInjectStreamConfig",value:function(e,t){this.injectConfig=Sa({},this.injectConfig,e),this.injectLoopTimes=t}},{key:"startLiveStreamingTask",value:function(){var e=m(v.mark((function e(t,n,r){var i,o,a,s,c,u,l,d=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Zc(i=vf(hf(o=this.streamingTasks).call(o))).call(i,(function(e){return e.mode===Jl.INJECT}))||n!==Jl.INJECT){e.next=2;break}return e.abrupt("return",new Al($u.LIVE_STREAMING_TASK_CONFLICT,"inject stream over limit").throw());case 2:if(this.transcodingConfig||n!==Jl.TRANSCODE){e.next=4;break}throw new Al($u.INVALID_OPERATION,"[LiveStreaming] no transcoding config found, can not start transcoding streaming task");case 4:return i={command:"PublishStream",ts:gf(),url:t,uid:this.spec.uid.toString(),autoDestroyTime:100,acceptImageTimeout:!0},Rl.debug(cs(a=cs(s="[".concat(this.spec.clientId,"] start live streaming ")).call(s,t,", mode: ")).call(a,n)),e.next=8,this.taskMutex.lock();case 8:if(a=e.sent,this.connection||!r){e.next=11;break}return e.abrupt("return",void a());case 11:if(!this.streamingTasks.get(t)||r){e.next=13;break}return e.abrupt("return",(a(),new Al($u.LIVE_STREAMING_TASK_CONFLICT).throw()));case 13:if(e.prev=13,e.t0=this.connection,e.t0){e.next=19;break}return e.next=18,this.connect(n);case 18:this.connection=e.sent;case 19:e.next=24;break;case 21:throw e.prev=21,e.t1=e.catch(13),a(),e.t1;case 24:e.t2=n,e.next=e.t2===Jl.TRANSCODE?27:e.t2===Jl.INJECT?29:30;break;case 27:return i.transcodingConfig=Kn({},this.transcodingConfig),e.abrupt("break",30);case 29:i={cname:this.spec.cname,command:"InjectStream",sid:this.spec.sid,transcodingConfig:this.injectConfig,ts:gf(),url:t,loopTimes:this.injectLoopTimes};case 30:return this.uapResponse&&this.uapResponse.vid&&(i.vid=this.uapResponse.vid),this.isStartingStreamingTask=!0,s=this.lastTaskId++,e.prev=33,u=new kc((function(e,n){ht(d.retryTimeout).then((function(){if(r)return n(r);var e=d.statusError.get(t);return e?(d.statusError.delete(t),n(e)):void 0}))})),e.next=37,kc.race([this.connection.request("request",{clientRequest:i},!0,{url:t,command:"PublishStream",workerType:n===Jl.TRANSCODE?1:2,requestByUser:!r,tid:s.toString()}),u]);case 37:l=e.sent,this.isStartingStreamingTask=!1,Rl.debug(cs(c="[".concat(this.spec.clientId,"] live streaming started, code: ")).call(c,l.code)),this.streamingTasks.set(t,{clientRequest:i,mode:n,url:t,taskId:s}),a(),e.next=59;break;case 44:if(e.prev=44,e.t3=e.catch(33),a(),this.isStartingStreamingTask=!1,e.t3.data&&e.t3.data.retry&&!r){e.next=48;break}throw e.t3;case 48:if(!e.t3.data.changeAddress){e.next=55;break}return this.connection.tryNextAddress(),e.next=52,this.startLiveStreamingTask(t,n,e.t3);case 52:e.t4=e.sent,e.next=58;break;case 55:return e.next=57,this.startLiveStreamingTask(t,n,e.t3);case 57:e.t4=e.sent;case 58:return e.abrupt("return",e.t4);case 59:case"end":return e.stop()}}),e,this,[[13,21],[33,44]])})));function t(t,n,r){return e.apply(this,arguments)}return t}()},{key:"stopLiveStreamingTask",value:function(e){var t=this;return new kc((function(n,r){var i=t.streamingTasks.get(e);if(!i||!t.connection)return new Al($u.UNEXPECTED_ERROR,"can not find streaming task to stop").throw();var o=i.mode;i.abortTask=function(){Rl.debug("[".concat(t.spec.clientId,"] stop live streaming success(worker exception)")),t.streamingTasks.delete(e),n()},t.connection.request("request",{clientRequest:{command:o===Jl.INJECT?"UninjectStream":"UnpublishStream",url:i.url}},!1,{url:e,command:"UnPublishStream",workerType:o===Jl.TRANSCODE?1:2,requestByUser:!0,tid:(t.lastTaskId++).toString()}).then((function(r){var i;Rl.debug(cs(i="[".concat(t.spec.clientId,"] stop live streaming success, code: ")).call(i,r.code)),t.streamingTasks.delete(e),0===t.streamingTasks.size&&o!==Jl.INJECT&&(t.connection&&t.connection.close(),t.connection=void 0),n(),o===Jl.INJECT&&t.onInjectStatusChange&&t.onInjectStatusChange(5,t.spec.uid,e)})).catch(r)}))}},{key:"controlInjectStream",value:function(){var e=m(v.mark((function e(t,n,r,i){var o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this.streamingTasks.get(t))&&this.connection&&o.mode===Jl.INJECT){e.next=3;break}throw new Al($u.INVALID_OPERATION,"can not find inject stream task to control");case 3:return e.next=5,this.connection.request("request",{clientRequest:{command:"ControlStream",url:t,control:n,audioVolume:r,position:i}});case 5:return e.abrupt("return",e.sent.serverResponse);case 6:case"end":return e.stop()}}),e,this)})));function t(t,n,r,i){return e.apply(this,arguments)}return t}()},{key:"resetAllTask",value:function(){var e,t=this,n=vf(hf(e=this.streamingTasks).call(e));this.terminate();var r,i=p(n);try{var o=function(){var e=r.value;t.startLiveStreamingTask(e.url,e.mode).catch((function(n){t.onLiveStreamError&&t.onLiveStreamError(e.url,n)}))};for(i.s();!(r=i.n()).done;)o()}catch(a){i.e(a)}finally{i.f()}}},{key:"terminate",value:function(){this.cancelToken&&this.cancelToken.cancel(),this.streamingTasks=new ra,this.isStartingStreamingTask=!1,this.statusError=new ra,this.cancelToken=Tl.CancelToken.source(),this.uapResponse=void 0,this.connection&&this.connection.close(),this.connection=void 0}},{key:"connect",value:function(){var e=m(v.mark((function e(t){var n,r=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.connection){e.next=2;break}throw new Al($u.UNEXPECTED_ERROR,"live streaming connection has already connected");case 2:return e.next=4,yt(this,id.REQUEST_WORKER_MANAGER_LIST,t);case 4:return n=e.sent,this.uapResponse=n,this.connection=new cp(n.workerToken,this.spec,this.wsRetryConfig,t),this.connection.on(rd.WARNING,(function(e,t){return r.onLiveStreamWarning&&r.onLiveStreamWarning(t,e)})),this.connection.on(rd.PUBLISH_STREAM_STATUS,(function(e){return r.handlePublishStreamServer(e)})),this.connection.on(rd.INJECT_STREAM_STATUS,(function(e){return r.handleInjectStreamServerStatus(e)})),this.connection.on(rd.REQUEST_NEW_ADDRESS,(function(e,n){if(!r.connection)return n(new Al($u.UNEXPECTED_ERROR,"can not get new live streaming address list"));yt(r,id.REQUEST_WORKER_MANAGER_LIST,t).then((function(t){r.uapResponse=t,e(t.addressList)})).catch(n)})),e.next=13,this.connection.init(n.addressList);case 13:return e.abrupt("return",this.connection);case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"handlePublishStreamServer",value:function(e){var t=this,n=e.serverStatus&&e.serverStatus.url||"empty_url",r=this.streamingTasks.get(n),i=e.reason;switch(e.code){case od.PUBLISH_STREAM_STATUS_ERROR_PUBLISH_BROKEN:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_CONNECT:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_HANDSHAKE:case od.PUBLISH_STREAM_STATUS_ERROR_RTMP_PUBLISH:if(e=new Al($u.LIVE_STREAMING_CDN_ERROR,"",{code:e.code}),r)return Rl.error(e.toString()),this.onLiveStreamError&&this.onLiveStreamError(n,e);if(!this.isStartingStreamingTask)break;this.statusError.set(n,e);case od.LIVE_STREAM_RESPONSE_FAILED_LOAD_IMAGE:return e=new Al($u.LIVE_STREAMING_WARN_FAILED_LOAD_IMAGE,i),this.onLiveStreamWarning&&this.onLiveStreamWarning(n,e);case od.LIVE_STREAM_RESPONSE_WORKER_LOST:case od.LIVE_STREAM_RESPONSE_WORKER_QUIT:var o;if(this.connection){this.connection.tryNextAddress(),n=vf(hf(o=this.streamingTasks).call(o));var a,s=p(n);try{var c=function(){var n=a.value;n.abortTask?n.abortTask():(Rl.warning("[".concat(t.spec.clientId,"] publish stream status code"),e.code,"try to republish",n.url),t.startLiveStreamingTask(n.url,n.mode,new Al($u.LIVE_STREAMING_INTERNAL_SERVER_ERROR,"",{code:e.code})).then((function(){Rl.debug("[".concat(t.spec.clientId,"] republish live stream success"),n.url)})).catch((function(e){Rl.error(e.toString()),t.onLiveStreamError&&t.onLiveStreamError(n.url,e)})))};for(s.s();!(a=s.n()).done;)c()}catch(u){s.e(u)}finally{s.f()}}}}},{key:"handleInjectStreamServerStatus",value:function(e){var t=Number(e.uid),n=e.serverStatus&&e.serverStatus.url;switch(e.code){case 200:return void(this.onInjectStatusChange&&this.onInjectStatusChange(0,t,n));case 451:return this.onInjectStatusChange&&this.onInjectStatusChange(1,t,n),void this.streamingTasks.delete(n);case 453:return this.onInjectStatusChange&&this.onInjectStatusChange(2,t,n),void this.streamingTasks.delete(n);case 470:return this.onInjectStatusChange&&this.onInjectStatusChange(10,t,n),void this.streamingTasks.delete(n);case 499:return this.onInjectStatusChange&&this.onInjectStatusChange(3,t,n),void this.streamingTasks.delete(n);default:return void Rl.debug("inject stream server status",e)}}},{key:"hasUrl",value:function(e){return this.streamingTasks.has(e)}}]),n}(yf),lp=function(){function e(){f(this,e),this.destChannelMediaInfos=new ra}return h(e,[{key:"setSrcChannelInfo",value:function(e){Je(e),this.srcChannelMediaInfo=e}},{key:"addDestChannelInfo",value:function(e){Je(e),this.destChannelMediaInfos.set(e.channelName,e)}},{key:"removeDestChannelInfo",value:function(e){We(e),this.destChannelMediaInfos.delete(e)}},{key:"getSrcChannelMediaInfo",value:function(){return this.srcChannelMediaInfo}},{key:"getDestChannelMediaInfo",value:function(){return this.destChannelMediaInfos}}]),e}(),dp=function(e){l(n,e);var t=d(n);function n(e,r,i){var o;return f(this,n),(o=t.call(this)).requestId=1,o.onOpen=function(){o.emit("open"),o.startHeartBeatCheck()},o.onClose=function(e){o.emit("close"),o.dispose()},o.onMessage=function(e){if(!(e=JSON.parse(e.data))||"serverResponse"!==e.command||!e.requestId)return e&&"serverStatus"===e.command&&e.serverStatus&&e.serverStatus.command?(o.emit("status",e.serverStatus),void o.emit(e.serverStatus.command,e.serverStatus)):void 0;o.emit("req_".concat(e.requestId),e)},o.joinInfo=e,o.clientId=r,o.ws=new Gf("cross-channel-".concat(o.clientId),i),o.ws.on(Xl.RECONNECTING,(function(){o.ws.reconnectMode="retry",o.emit("reconnecting")})),o.ws.on(Xl.CONNECTED,o.onOpen),o.ws.on(Xl.ON_MESSAGE,o.onMessage),o.ws.on(Xl.CLOSED,o.onClose),o}return h(n,[{key:"isConnect",value:function(){return"connected"===this.ws.state}},{key:"sendMessage",value:function(e){var t=this.requestId++;return e.requestId=t,e.seq=t,this.ws.sendMessage(e),t}},{key:"waitStatus",value:function(e){var t=this;return new kc((function(n,r){var i=window.setTimeout((function(){r(new Al($u.TIMEOUT,"wait status timeout, status: ".concat(e)))}),5e3);t.once(e,(function(t){window.clearTimeout(i),t.state&&0!==t.state?r(new Al($u.CROSS_CHANNEL_WAIT_STATUS_ERROR,"wait status error, status: ".concat(e))):n(void 0)})),t.once("dispose",(function(){window.clearTimeout(i),r(new Al($u.WS_ABORT))}))}))}},{key:"request",value:function(){var e=m(v.mark((function e(t){var n,r,i=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("closed"!==this.ws.state){e.next=2;break}throw new Al($u.WS_DISCONNECT);case 2:if(n=function(){return new kc((function(e,t){i.ws.once(Xl.CLOSED,(function(){return t(new Al($u.WS_ABORT))})),i.ws.once(Xl.CONNECTED,e)}))},e.t0="connected"!==this.ws.state,!e.t0){e.next=7;break}return e.next=7,n();case 7:return r=this.sendMessage(t),e.next=10,new kc((function(e,t){var n=function(){t(new Al($u.WS_ABORT))};i.ws.once(Xl.RECONNECTING,n),i.ws.once(Xl.CLOSED,n),i.once("req_".concat(r),e),ht(3e3).then((function(){i.removeAllListeners("req_".concat(r)),i.ws.off(Xl.RECONNECTING,n),i.ws.off(Xl.CLOSED,n),t(new Al($u.TIMEOUT,"cross channel ws request timeout"))}))}));case 10:if((t=e.sent)&&200===t.code){e.next=13;break}throw new Al($u.CROSS_CHANNEL_SERVER_ERROR_RESPONSE,"response: ".concat(Yr(t)));case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"connect",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.ws.removeAllListeners(Xl.REQUEST_NEW_URLS),this.ws.on(Xl.REQUEST_NEW_URLS,(function(e){e(t)})),e.next=4,this.ws.init(t);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"dispose",value:function(){this.clearHeartBeatCheck(),this.emit("dispose"),this.removeAllListeners(),this.ws.close()}},{key:"sendPing",value:function(e){var t=this.requestId++;return e.requestId=t,this.ws.sendMessage(e),t}},{key:"startHeartBeatCheck",value:function(){var e=this;this.heartBeatTimer=window.setInterval((function(){e.sendPing({command:"ping",appId:e.joinInfo.appId,cname:e.joinInfo.cname,uid:e.joinInfo.uid.toString(),sid:e.joinInfo.sid,ts:+new Date,requestId:0})}),3e3)}},{key:"clearHeartBeatCheck",value:function(){window.clearInterval(this.heartBeatTimer),this.heartBeatTimer=void 0}}]),n}(yf),fp=function(e){l(n,e);var t=d(n);function n(e,r,i,o){var a;return f(this,n),(a=t.call(this)).cancelToken=Tl.CancelToken.source(),a.requestId=0,a._state="RELAY_STATE_IDLE",a.errorCode="RELAY_OK",a.onStatus=function(e){var t;Rl.debug(cs(t="[".concat(a.clientId,"] ChannelMediaStatus: ")).call(t,Yr(e))),e&&e.command&&("onAudioPacketReceived"===e.command&&a.emit("event","PACKET_RECEIVED_AUDIO_FROM_SRC"),"onVideoPacketReceived"===e.command&&a.emit("event","PACKET_RECEIVED_VIDEO_FROM_SRC"),"onSrcTokenPrivilegeDidExpire"===e.command&&(a.errorCode="SRC_TOKEN_EXPIRED",a.state="RELAY_STATE_FAILURE"),"onDestTokenPrivilegeDidExpire"===e.command&&(a.errorCode="DEST_TOKEN_EXPIRED",a.state="RELAY_STATE_FAILURE"))},a.onReconnect=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:Rl.debug("[".concat(a.clientId,"] ChannelMediaSocket disconnect, reconnecting")),a.emit("event","NETWORK_DISCONNECTED"),a.state="RELAY_STATE_IDLE",a.prevChannelMediaConfig&&a.sendStartRelayMessage(a.prevChannelMediaConfig).catch((function(e){"RELAY_STATE_IDLE"!==a.state&&(Rl.error("auto restart channel media relay failed",e.toString()),a.errorCode="SERVER_CONNECTION_LOST",a.state="RELAY_STATE_FAILURE")}));case 4:case"end":return e.stop()}}),e)}))),a.joinInfo=e,a.clientId=r,a.signal=new dp(a.joinInfo,a.clientId,i),a.httpRetryConfig=o,a}return h(n,[{key:"state",get:function(){return this._state},set:function(e){e!==this._state&&("RELAY_STATE_FAILURE"!==e&&(this.errorCode="RELAY_OK"),this.emit("state",e,this.errorCode),this._state=e)}},{key:"startChannelMediaRelay",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("RELAY_STATE_IDLE"===this.state){e.next=2;break}throw new Al($u.INVALID_OPERATION);case 2:return this.state="RELAY_STATE_CONNECTING",e.next=5,this.connect();case 5:return Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: connect success")),e.prev=6,e.next=9,this.sendStartRelayMessage(t);case 9:e.next=20;break;case 11:if(e.prev=11,e.t0=e.catch(6),!e.t0.data||!e.t0.data.serverResponse||"SetSourceChannel"!==e.t0.data.serverResponse.command){e.next=15;break}throw new Al($u.CROSS_CHANNEL_FAILED_JOIN_SRC);case 15:if(!e.t0.data||!e.t0.data.serverResponse||"SetDestChannelStatus"!==e.t0.serverResponse.command){e.next=17;break}throw new Al($u.CROSS_CHANNEL_FAILED_JOIN_DEST);case 17:if(!e.t0.data||!e.t0.data.serverResponse||"StartPacketTransfer"!==e.t0.serverResponse.command){e.next=19;break}throw new Al($u.CROSS_CHANNEL_FAILED_PACKET_SENT_TO_DEST);case 19:throw e.t0;case 20:this.prevChannelMediaConfig=t;case 21:case"end":return e.stop()}}),e,this,[[6,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateChannelMediaRelay",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("RELAY_STATE_RUNNING"===this.state){e.next=2;break}throw new Al($u.INVALID_OPERATION);case 2:return e.next=4,this.sendUpdateMessage(t);case 4:this.prevChannelMediaConfig=t;case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"stopChannelMediaRelay",value:function(){var e=m(v.mark((function e(){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sendStopRelayMessage();case 2:Rl.debug("[".concat(this.clientId,"] stopChannelMediaRelay: send stop message success")),this.state="RELAY_STATE_IDLE",this.dispose();case 5:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"dispose",value:function(){Rl.debug("[".concat(this.clientId,"] disposeChannelMediaRelay")),this.cancelToken.cancel(),this.cancelToken=Tl.CancelToken.source(),this.state="RELAY_STATE_IDLE",this.emit("dispose"),this.signal.dispose(),this.prevChannelMediaConfig=void 0}},{key:"connect",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,_n(this.joinInfo,this.cancelToken.token,this.httpRetryConfig);case 2:return t=e.sent,this.workerToken=t.workerToken,e.next=6,this.signal.connect(t.addressList);case 6:this.emit("event","NETWORK_CONNECTED"),this.signal.on("status",this.onStatus),this.signal.on("reconnecting",this.onReconnect);case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendStartRelayMessage",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.genMessage(sd.StopPacketTransfer),e.next=3,this.signal.request(n);case 3:return e.next=5,this.signal.waitStatus("Normal Quit");case 5:return Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: StopPacketTransfer success")),n=this.genMessage(sd.SetSdkProfile,t),e.next=9,this.signal.request(n);case 9:return Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSdkProfile success")),n=this.genMessage(sd.SetSourceChannel,t),e.next=13,this.signal.request(n);case 13:return e.next=15,this.signal.waitStatus("SetSourceChannelStatus");case 15:return this.emit("event","PACKET_JOINED_SRC_CHANNEL"),Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceChannel success")),n=this.genMessage(sd.SetSourceUserId,t),e.next=20,this.signal.request(n);case 20:return Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetSourceUserId success")),n=this.genMessage(sd.SetDestChannel,t),e.next=24,this.signal.request(n);case 24:return e.next=26,this.signal.waitStatus("SetDestChannelStatus");case 26:return this.emit("event","PACKET_JOINED_DEST_CHANNEL"),Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: SetDestChannel success")),t=this.genMessage(sd.StartPacketTransfer,t),e.next=31,this.signal.request(t);case 31:this.emit("event","PACKET_SENT_TO_DEST_CHANNEL"),this.state="RELAY_STATE_RUNNING",Rl.debug("[".concat(this.clientId,"] startChannelMediaRelay: StartPacketTransfer success"));case 34:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sendUpdateMessage",value:function(){var e=m(v.mark((function e(t){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.genMessage(sd.UpdateDestChannel,t),e.next=3,this.signal.request(t);case 3:this.emit("event","PACKET_UPDATE_DEST_CHANNEL"),Rl.debug("[".concat(this.clientId,"] sendUpdateMessage: UpdateDestChannel success"));case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"sendStopRelayMessage",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.genMessage(sd.StopPacketTransfer),e.next=3,this.signal.request(t);case 3:Rl.debug("[".concat(this.clientId,"] sendStopRelayMessage: StopPacketTransfer success"));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"genMessage",value:function(e,t){var n=this,r=[],i=[],o=[];this.requestId+=1;var a={appId:this.joinInfo.appId,cname:this.joinInfo.cname,uid:this.joinInfo.uid.toString(),sdkVersion:Du,sid:this.joinInfo.sid,ts:gf(),requestId:this.requestId,seq:this.requestId,allocate:!0,clientRequest:{}};"4.4.0"===a.sdkVersion&&(a.sdkVersion="0.0.1");var s=null,c=null;switch(e){case sd.SetSdkProfile:return a.clientRequest={command:"SetSdkProfile",type:"multi_channel"},a;case sd.SetSourceChannel:if(!(c=t&&t.getSrcChannelMediaInfo()))throw new Al($u.UNEXPECTED_ERROR,"can not find source config");return a.clientRequest={command:"SetSourceChannel",uid:"0",channelName:c.channelName,token:c.token||this.joinInfo.appId},a;case sd.SetSourceUserId:if(!(c=t&&t.getSrcChannelMediaInfo()))throw new Al($u.UNEXPECTED_ERROR,"can not find source config");return a.clientRequest={command:"SetSourceUserId",uid:c.uid+""},a;case sd.SetDestChannel:if(!(s=t&&t.getDestChannelMediaInfo()))throw new Al($u.UNEXPECTED_ERROR,"can not find dest config");return ba(s).call(s,(function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.joinInfo.appId)})),a.clientRequest={command:"SetDestChannel",channelName:r,uid:i,token:o},a;case sd.StartPacketTransfer:return a.clientRequest={command:"StartPacketTransfer"},a;case sd.Reconnect:return a.clientRequest={command:"Reconnect"},a;case sd.StopPacketTransfer:return a.clientRequest={command:"StopPacketTransfer"},a;case sd.UpdateDestChannel:if(!(s=t&&t.getDestChannelMediaInfo()))throw new Al($u.UNEXPECTED_ERROR,"can not find dest config");return ba(s).call(s,(function(e){r.push(e.channelName),i.push(e.uid+""),o.push(e.token||n.joinInfo.appId)})),a.clientRequest={command:"UpdateDestChannel",channelName:r,uid:i,token:o},a}return a}}]),n}(yf),hp=function(){function e(t,n){f(this,e),this._trust_stream_added_state_=this._trust_video_mute_state_=this._trust_audio_mute_state_=this._trust_video_enabled_state_=this._trust_audio_enabled_state_=this._trust_in_room_=!0,this._video_muted_=this._audio_muted_=!1,this._video_enabled_=this._audio_enabled_=!0,this._video_added_=this._audio_added_=!1,this.uid=t,this._uintid=n}return h(e,[{key:"hasVideo",get:function(){return this._video_enabled_&&!this._video_muted_&&this._video_added_}},{key:"hasAudio",get:function(){return this._audio_enabled_&&!this._audio_muted_&&this._audio_added_}},{key:"audioTrack",get:function(){if(this.hasAudio)return this._audioTrack}},{key:"videoTrack",get:function(){if(this.hasVideo)return this._videoTrack}}]),e}(),pp=function(e,t,n,r){var i,o=arguments.length,a=3>o?t:null===r?r=Ya(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(3>o?i(a):3<o?i(t,n,a):i(t,n))||a);return 3<o&&a&&Da(t,n,a),a},vp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mp=function(e){l(n,e);var t=d(n);function n(e){var r,i,a,s,u,l;if(f(this,n),(r=t.call(this))._users=[],r._sessionId=null,r._bindEnabledTracks=[],r._leaveMutex=new kf("client-leave"),r._publishMutex=new kf("client-publish"),r._subscribeMutex=new ra,r._remoteStream=new ra,r._encryptionMode="none",r._encryptionSecret=null,r._turnServer={servers:[],mode:"auto"},r._cloudProxyServerMode="disabled",r._isDualStreamEnabled=!1,r._streamFallbackTypeCacheMap=new ra,r._remoteStreamTypeCacheMap=new ra,r._axiosCancelSource=Tl.CancelToken.source(),r._networkQualitySensitivity="normal",r._handleLocalTrackEnable=function(e,t,n){r.publish(e,!1).then(t).catch(n)},r._handleLocalTrackDisable=function(e,t,n){r.unpublish(e,!1).then(t).catch(n)},r._handleUserOnline=function(e){var t;r.isStringUID&&"string"!=typeof e.uid&&Rl.error("[".concat(r._clientId,"] StringUID is Mixed with UintUID"));var n=Zc(t=r._users).call(t,(function(t){return t.uid===e.uid}));n?n._trust_in_room_=!0:(t=new hp(e.uid,e.uint_id||e.uid),r._users.push(t),Rl.debug("[".concat(r._clientId,"] user online"),e.uid),r.emit(Vl.USER_JOINED,t))},r._handleUserOffline=function(e){var t,n=Zc(t=r._users).call(t,(function(t){return t.uid===e.uid}));n&&(r._handleRemoveStream(e),wt(r._users,n),r._remoteStreamTypeCacheMap.delete(n.uid),r._streamFallbackTypeCacheMap.delete(n.uid),Rl.debug("[".concat(r._clientId,"] user offline"),e.uid,"reason:",e.reason),r.emit(Vl.USER_LEAVED,n,e.reason))},r._handleAddAudioOrVideoStream=function(e,t,n){var i,o,a,s,c,u=Zc(i=r._users).call(i,(function(e){return e.uid===t}));u?(Rl.debug(cs(o=cs(a="[".concat(r._clientId,"] stream added with uid ")).call(a,t,", type ")).call(o,e)),i="audio"===e?u.hasAudio:u.hasVideo,u._uintid||(u._uintid=n||t),u._trust_stream_added_state_=!0,"audio"===e?u._audio_added_=!0:u._video_added_=!0,("audio"===e?u.hasAudio:u.hasVideo)&&!i&&(Rl.info(cs(s=cs(c="[".concat(r._clientId,"] remote user ")).call(c,u.uid," published ")).call(s,e)),r.emit(Vl.USER_PUBLISHED,u,e)),"video"===e?Ff.onGatewayStream(r._sessionId,Cl.ON_ADD_VIDEO_STREAM,kl.ON_ADD_VIDEO_STREAM,{peer:n||t}):Ff.onGatewayStream(r._sessionId,Cl.ON_ADD_AUDIO_STREAM,kl.ON_ADD_AUDIO_STREAM,{peer:n||t}),(e=r._remoteStream.get(t))&&e.readyToReconnect&&"connecting"===e.connectionState&&e.reconnectPC().catch((function(e){Rl.error("[".concat(r._clientId,"] resubscribe error"),e.toString())}))):Rl.error("[".concat(r._clientId,"] can not find target user!(on_add_stream)"))},r._handleRemoveStream=function(e){var t,n,i=Zc(t=r._users).call(t,(function(t){return t.uid===e.uid}));i?(Rl.debug(cs(n="[".concat(r._clientId,"] stream removed with uid ")).call(n,e.uid)),t=function(){},i.hasAudio&&i.hasVideo?t=function(){var e,t;Rl.info(cs(e="[".concat(r._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),r.emit(Vl.USER_UNPUBLISHED,i,"audio"),Rl.info(cs(t="[".concat(r._clientId,"] remote user ")).call(t,i.uid," unpublished video track")),r.emit(Vl.USER_UNPUBLISHED,i,"video")}:i.hasVideo?t=function(){var e;Rl.info(cs(e="[".concat(r._clientId,"] remote user ")).call(e,i.uid," unpublished video track")),r.emit(Vl.USER_UNPUBLISHED,i,"video")}:i.hasAudio&&(t=function(){var e;Rl.info(cs(e="[".concat(r._clientId,"] remote user ")).call(e,i.uid," unpublished audio track")),r.emit(Vl.USER_UNPUBLISHED,i,"audio")}),i._trust_stream_added_state_=!0,i._audio_added_=!1,i._video_added_=!1,(n=r._remoteStream.get(i.uid))&&(n.closeP2PConnection(),r._remoteStream.delete(i.uid)),Ff.onGatewayStream(r._sessionId,Cl.ON_REMOVE_STREAM,kl.ON_REMOVE_STREAM,{peer:e.uint_id||e.uid}),t()):Rl.warning("[".concat(r._clientId,"] can not find target user!(on_remove_stream)"))},r._handleSetStreamLocalEnable=function(e,t,n){var i,o,a,s,c,u,l=Zc(i=r._users).call(i,(function(e){return e.uid===t}));if(l){if(Rl.debug(cs(o=cs(a=cs(s="[".concat(r._clientId,"] local ")).call(s,e," ")).call(a,n?"enabled":"disabled"," with uid ")).call(o,t)),i="audio"===e?l.hasAudio:l.hasVideo,"audio"===e){l._trust_audio_enabled_state_=!0;var d,f,h=l._audio_enabled_;if(l._audio_enabled_=n,l._audio_enabled_===h)return;n=l._audio_enabled_?"enable-local-audio":"disable-local-audio",Rl.debug(cs(d=cs(f="[".concat(r._clientId,"] user-info-updated, uid: ")).call(f,t,", msg: ")).call(d,n)),r.emit(Vl.USER_INFO_UPDATED,t,n)}else{if(l._trust_video_enabled_state_=!0,d=l._video_enabled_,l._video_enabled_=n,l._video_enabled_===d)return;var p;n=l._video_enabled_?"enable-local-video":"disable-local-video",Rl.debug(cs(h=cs(p="[".concat(r._clientId,"] user-info-update, uid: ")).call(p,t,", msg: ")).call(h,n)),r.emit(Vl.USER_INFO_UPDATED,t,n)}if(i!==(n="audio"===e?l.hasAudio:l.hasVideo)){var v,m;if(!i&&n)return Rl.info(cs(v=cs(m="[".concat(r._clientId,"] remote user ")).call(m,t," published ")).call(v,e)),void r.emit(Vl.USER_PUBLISHED,l,e);(v=r._remoteStream.get(t))&&((m=Yn({},v.subscribeOptions)).audio=!!l.hasAudio&&m.audio,m.video=!!l.hasVideo&&m.video,m.audio||m.video?v.setSubscribeOptions(m):(v.closeP2PConnection().catch((function(e){Rl.warning("close sub pc error",e)})),r._remoteStream.delete(l.uid))),Rl.info(cs(c=cs(u="[".concat(r._clientId,"] remote user ")).call(u,l.uid," unpublished ")).call(c,e)),r.emit(Vl.USER_UNPUBLISHED,l,e)}}else Rl.error("[".concat(r._clientId,"] can not find target user!(disable_local)"))},r._handleMuteStream=function(e,t,n){var i,o,a;Rl.debug("[".concat(r._clientId,"] receive mute message"),e,t,n);var s,c=Zc(i=r._users).call(i,(function(t){return t.uid===e}));if(c){if(i="audio"===t?c.hasAudio:c.hasVideo,"audio"===t){c._trust_audio_mute_state_=!0;var u,l,d=c._audio_muted_;if(c._audio_muted_=n,c._audio_muted_===d)return;n=c._audio_muted_?"mute-audio":"unmute-audio",Rl.debug(cs(u=cs(l="[".concat(r._clientId,"] user-info-update, uid: ")).call(l,e,", msg: ")).call(u,n)),r.emit(Vl.USER_INFO_UPDATED,e,n)}else{if(c._trust_video_mute_state_=!0,u=c._video_muted_,c._video_muted_=n,c._video_muted_===u)return;var f;n=c._video_muted_?"mute-video":"unmute-video",Rl.debug(cs(d=cs(f="[".concat(r._clientId,"] user-info-update, uid: ")).call(f,e,", msg: ")).call(d,n)),r.emit(Vl.USER_INFO_UPDATED,e,n)}if(i!==(n="audio"===t?c.hasAudio:c.hasVideo)){var h,p;if(!i&&n)return Rl.info(cs(h=cs(p="[".concat(r._clientId,"] remote user ")).call(p,e," published ")).call(h,t)),void r.emit(Vl.USER_PUBLISHED,c,t);(h=r._remoteStream.get(e))&&((p=Yn({},h.subscribeOptions)).audio=!!c.hasAudio&&p.audio,p.video=!!c.hasVideo&&p.video,"video"===t&&h.pc._statsFilter.setVideoIsReady(!1),p.audio||p.video?h.setSubscribeOptions(p):(h.closeP2PConnection().catch((function(e){Rl.warning("close sub pc error",e)})),r._remoteStream.delete(c.uid))),Rl.info(cs(o=cs(a="[".concat(r._clientId,"] remote user ")).call(a,e," unpublished ")).call(o,t)),r.emit(Vl.USER_UNPUBLISHED,c,t)}}else Rl.warning(cs(s="[".concat(r._clientId,"] can not find remote user, ignore mute event, uid: ")).call(s,e))},r._handleP2PLost=function(e){Rl.debug("[".concat(r._clientId,"] receive p2p lost"),e);var t=null;if(r._highStream&&r._highStream.pc.ID===e.p2pid)t=r._highStream;else if(r._lowStream&&r._lowStream.pc.ID===e.p2pid)t=r._lowStream;else{var n;ba(n=r._remoteStream).call(n,(function(n){n.pc.ID===e.p2pid&&(t=n)}))}t?t.emit(zl.GATEWAY_P2P_LOST,e.p2pid):Rl.warning("P2PLost stream not found",e)},r._handleTokenWillExpire=function(){Rl.debug("[".concat(r._clientId,"] received message onTokenPrivilegeWillExpire")),r.emit(Vl.ON_TOKEN_PRIVILEGE_WILL_EXPIRE)},r._handleBeforeUnload=function(e){void 0!==e.returnValue&&""!==e.returnValue||(r.leave(),Rl.info("[".concat(r._clientId,"] auto leave onbeforeunload")))},r._handleUpdateNetworkQuality=function(){var e;if("normal"!==r._networkQualitySensitivity){if(navigator&&void 0!==navigator.onLine&&!navigator.onLine)return void r.emit(Vl.NETWORK_QUALITY,{downlinkNetworkQuality:6,uplinkNetworkQuality:6});var t={downlinkNetworkQuality:0,uplinkNetworkQuality:0};r._highStream&&!r._highStream.detecting&&(t.uplinkNetworkQuality=r._highStream.getNetworkQuality());var n=0;ba(e=r._remoteStream).call(e,(function(e){return n+=e.getNetworkQuality()})),0<r._remoteStream.size&&(t.downlinkNetworkQuality=Math.round(n/r._remoteStream.size)),r.emit(Vl.NETWORK_QUALITY,t)}},r._codec=e.codec,r._mode=e.mode,e.proxyServer&&(r._proxyServer=e.proxyServer,Ff.setProxyServer(r._proxyServer),Rl.setProxyServer(r._proxyServer)),e.turnServer&&(r._turnServer=Yn({},r._turnServer,{mode:"manual"},e.turnServer)),r._clientId=vt(5,"client-"),Rl.info(cs(i=cs(a=cs(s=cs(u="[".concat(r._clientId,"] Initializing AgoraRTC client v")).call(u,Du," build: ")).call(s,"v4.4.0-0-g48538343(4/2/2021, 5:44:00 PM)",", mode: ")).call(a,r._mode,", codec: ")).call(i,r._codec)),e.clientRoleOptions)try{Qe(e.clientRoleOptions),l=Sa({},e.clientRoleOptions)}catch(h){var d;Rl.warning(cs(d="[".concat(r._clientId,"] ")).call(d,h.toString()))}return r._statsCollector=new Ef(r._clientId),r._statsCollector.onStatsException=function(e,t,n){var i,o,a;Rl.debug(cs(i=cs(o=cs(a="[".concat(r._clientId,"] receive exception msg, code: ")).call(a,e,", msg: ")).call(o,t,", uid: ")).call(i,n)),r.emit(Vl.EXCEPTION,{code:e,msg:t,uid:n})},r._statsCollector.onUploadPublishDuration=function(e,t,n,i){var o,a=Zc(o=r._users).call(o,(function(t){return t.uid===e}));a&&Ff.peerPublishStatus(r._sessionId,{subscribeElapse:i,audioPublishDuration:t,videoPublishDuration:n,peer:a._uintid})},r._gateway=new sh({clientId:r._clientId,mode:r._mode,codec:r._codec,websocketRetryConfig:e.websocketRetryConfig||Wf,httpRetryConfig:e.httpRetryConfig||Wf,forceWaitGatewayResponse:void 0===e.forceWaitGatewayResponse||e.forceWaitGatewayResponse,statsCollector:r._statsCollector,role:e.role,clientRoleOptions:l}),r._config=e,r._configDistribute=dh,r._handleGatewayEvents(),Gu.push(c(r)),o(r)}return h(n,[{key:"connectionState",get:function(){return this._gateway.state}},{key:"remoteUsers",get:function(){return this._users}},{key:"localTracks",get:function(){return this._highStream?this._highStream.getAllTracks():[]}},{key:"uid",get:function(){return this._uid}},{key:"channelName",get:function(){return this._channelName}},{key:"isStringUID",get:function(){return!!this._joinInfo&&!!this._joinInfo.stringUid}},{key:"join",value:function(){var e=m(v.mark((function e(t,n,r,i,o){var a,s,c,u,l,d,f,h=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=Ff.reportApiInvoke(this._sessionId,{name:Nl.JOIN,options:[t,n,r,i],tag:Pl.TRACER}),e.prev=1,r||null===r){e.next=4;break}throw new Al($u.INVALID_PARAMS,"Invalid token: ".concat(r,". If you don not use token, set it to null"));case 4:r&&Ve(r,"token",1,2047),We(n),i&&Ge(i),o&&Ve(o,"optionalInfo",1,2047),e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),s.onError(e.t0),e.t0;case 13:if(Rl.info(cs(a="[".concat(this._clientId,"] start join channel ")).call(a,n)),!this._leaveMutex.isLocked){e.next=20;break}return Rl.debug("[".concat(this._clientId,"] join: waiting leave operation")),e.next=17,this._leaveMutex.lock();case 17:e.t1=e.sent,(0,e.t1)(),Rl.debug("[".concat(this._clientId,"] join: continue"));case 20:if("DISCONNECTED"===this.connectionState){e.next=22;break}throw t=new Al($u.INVALID_OPERATION,"[".concat(this._clientId,"] Client already in connecting/connected state")),s.onError(t),t;case 22:return this._sessionId||(this._sessionId=vt(32,"").toUpperCase()),this._gateway.state="CONNECTING",o={clientId:this._clientId,appId:t,sid:this._sessionId,cname:n,uid:"string"!=typeof i?i:null,turnServer:this._turnServer,proxyServer:this._proxyServer,token:r||t,cloudProxyServer:this._cloudProxyServerMode,optionalInfo:o},"string"==typeof i&&(o.stringUid=i,this._uintUid?(o.uid=this._uintUid,this._uintUid=void 0):o.uid=0),"none"!==this._encryptionMode&&this._encryptionSecret&&(o.aesmode=this._encryptionMode,o.aespassword=this._encryptionSecret),this._startSession(this._sessionId,{channel:n,appId:t}),jf((function(){"CONNECTING"===h.connectionState&&Ff.joinChannelTimeout(h._sessionId,5)}),5e3),e.prev=29,e.next=32,dn(o,this._axiosCancelSource.token,this._config.httpRetryConfig||Wf);case 32:if(!o.stringUid||o.uid){e.next=38;break}return e.next=35,hn(o.stringUid,o,this._axiosCancelSource.token,this._config.httpRetryConfig||Wf);case 35:l=e.sent,Rl.debug(cs(u="getUserAccount Success ".concat(o.stringUid," => ")).call(u,l)),o.uid=l;case 38:return this._configDistribute.startGetConfigDistribute(o,this._axiosCancelSource.token),this._configDistribute.on(_d.UPDATE_BITRATE_LIMIT,(function(e){h._highStream&&h._highStream.handleUpdateBitrateLimit(e.uplink),e.low_stream_uplink&&h._lowStream&&h._lowStream.handleUpdateBitrateLimit({max_bitrate:e.low_stream_uplink.bitrate,min_bitrate:e.low_stream_uplink.bitrate||0})})),e.next=42,un(o,this._axiosCancelSource.token,this._config.httpRetryConfig||Wf);case 42:return d=e.sent,this._key=r||t,this._joinInfo=Yn({},o,{cid:d.gatewayInfo.cid,uid:o.uid?o.uid:d.gatewayInfo.uid,vid:d.gatewayInfo.vid,apResponse:d.gatewayInfo.res,uni_lbs_ip:d.gatewayInfo.uni_lbs_ip,gatewayAddrs:d.gatewayInfo.gatewayAddrs}),e.next=47,this._gateway.join(this._joinInfo,this._key);case 47:return f=e.sent,e.abrupt("return",(s.onSuccess(f),this._appId=t,this._channelName=o.cname,this._uid=f,this._networkQualityInterval&&window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=window.setInterval(this._handleUpdateNetworkQuality,2e3),window.addEventListener("beforeunload",this._handleBeforeUnload),Rl.info(cs(c="[".concat(this._clientId,"] Joining channel success: ")).call(c,n)),f));case 51:throw e.prev=51,e.t2=e.catch(29),Rl.error("[".concat(this._clientId,"] Joining channel failed, rollback"),e.t2),e.t2.code!==$u.OPERATION_ABORTED&&(this._gateway.state="DISCONNECTED",this._reset()),s.onError(e.t2),e.t2;case 54:case"end":return e.stop()}}),e,this,[[1,10],[29,51]])})));function t(t,n,r,i,o){return e.apply(this,arguments)}return t}()},{key:"leave",value:function(){var e=m(v.mark((function e(){var t,n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ff.reportApiInvoke(this._sessionId,{name:Nl.LEAVE,options:[],tag:Pl.TRACER}),Rl.info("[".concat(this._clientId,"] Leaving channel")),window.removeEventListener("beforeunload",this._handleBeforeUnload),this._reset(),e.next=6,this._leaveMutex.lock();case 6:if(n=e.sent,"DISCONNECTED"!==this.connectionState){e.next=9;break}return e.abrupt("return",(Rl.info("[".concat(this._clientId,"] Leaving channel repeated, success")),n(),t.onSuccess()));case 9:return e.next=11,this._gateway.leave("CONNECTED"!==this.connectionState);case 11:Rl.info("[".concat(this._clientId,"] Leaving channel success")),n(),t.onSuccess();case 14:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"publish",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c,u,l,d=this,f=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(f.length>1&&void 0!==f[1])||f[1],Zu(t)||(t=[t]),o=Ff.reportApiInvoke(this._sessionId,{name:Nl.PUBLISH,options:Pc(t).call(t,(function(e){return e?Object(e).toString():"null"})),tag:Pl.TRACER}),0!==t.length){e.next=5;break}return e.abrupt("return",(t=new Al($u.INVALID_PARAMS,"track list is empty"),o.onError(t),t.throw()));case 5:if("live"!==this._mode||"audience"!==this._gateway.role){e.next=7;break}return e.abrupt("return",(t=new Al($u.INVALID_OPERATION,"audience can not publish stream"),o.onError(t),t.throw()));case 7:a=p(t),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=18;break}if((c=s.value)instanceof zf){e.next=14;break}return e.abrupt("return",(t=new Al($u.INVALID_PARAMS,"pamameter is not local track"),o.onError(t),t.throw()));case 14:if(c._enabled||!n){e.next=16;break}return e.abrupt("return",(t=new Al($u.TRACK_IS_DISABLED,"can not publish a disabled track: ".concat(c.getTrackId())),o.onError(t),t.throw()));case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),a.e(e.t0);case 23:return e.prev=23,a.f(),e.finish(23);case 26:return Rl.info(cs(r="[".concat(this._clientId,"] Publishing tracks, id ")).call(r,Pc(t).call(t,(function(e){return"".concat(e.getTrackId()," ")})))),e.next=29,this._configDistribute.awaitConfigDistributeComplete();case 29:return n&&ba(t).call(t,(function(e){var t,n=d._configDistribute.getBitrateLimit();e instanceof Jh&&n&&e.setBitrateLimit(n.uplink),-1===Gc(t=d._bindEnabledTracks).call(t,e)&&(e.addListener(ud.NEED_ADD_TRACK,d._handleLocalTrackEnable),e.addListener(ud.NEED_REMOVE_TRACK,d._handleLocalTrackDisable),d._bindEnabledTracks.push(e))})),e.next=32,this._publishMutex.lock();case 32:return r=e.sent,e.prev=33,e.next=36,this._publishHighStream(t);case 36:if((u=e.sent).audioTrack,l=u.videoTrack,e.t1=this._isDualStreamEnabled&&l&&!this._lowStream,!e.t1){e.next=42;break}return e.next=42,this._publishLowStream(l);case 42:r(),o.onSuccess(),e.next=49;break;case 46:throw e.prev=46,e.t2=e.catch(33),r(),n&&ba(t).call(t,(function(e){var t,n,r=Gc(t=d._bindEnabledTracks).call(t,e);-1!==r&&(e.off(ud.NEED_ADD_TRACK,d._handleLocalTrackEnable),e.off(ud.NEED_REMOVE_TRACK,d._handleLocalTrackDisable),Uc(n=d._bindEnabledTracks).call(n,r,1))})),o.onError(e.t2),Rl.error("[".concat(this._clientId,"] publish error"),e.t2.toString()),e.t2;case 49:Rl.info(cs(i="[".concat(this._clientId,"] Publish success, id ")).call(i,Pc(t).call(t,(function(e){return"".concat(e.getTrackId()," ")}))));case 50:case"end":return e.stop()}}),e,this,[[8,20,23,26],[33,46]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"unpublish",value:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c=this,u=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(u.length>1&&void 0!==u[1])||u[1],this._highStream){e.next=3;break}return e.abrupt("return",void Rl.warning("[".concat(this._clientId,"] Could not find tracks to unpublish")));case 3:if(a=this._highStream.getAllTracks(),t?Zu(t)||(t=[t]):t=this._highStream.getAllTracks(),a=function(e,t){if(e.length!==t.length)return!1;for(var n=function(n){var r=e[n];if(ds(e).call(e,(function(e){return e===r})).length!==ds(t).call(t,(function(e){return e===r})).length)return{v:!1}},r=0;r<e.length;r+=1){var i=n(r);if("object"===typeof i)return i.v}return!0}(a,t),s=Ff.reportApiInvoke(this._sessionId,{name:Nl.UNPUBLISH,options:Pc(t).call(t,(function(e){return e.getTrackId()})),tag:Pl.TRACER}),Rl.info(cs(r=cs(i="[".concat(this._clientId,"] Unpublish tracks, tracks ")).call(i,Pc(t).call(t,(function(e){return"".concat(e.getTrackId()," ")})),", isClosePC: ")).call(r,a)),!a){e.next=12;break}e.t0=void 0,e.next=15;break;case 12:return e.next=14,this._publishMutex.lock();case 14:e.t0=e.sent;case 15:if(r=e.t0,this._highStream){e.next=18;break}return e.abrupt("return",(Rl.warning("[".concat(this._clientId,"] Could not find tracks to unpublish")),void(r&&r())));case 18:if(e.prev=18,e.t1=this._lowStream&&0<ds(t).call(t,(function(e){return"video"===e.trackMediaType})).length,!e.t1){e.next=24;break}return e.next=23,this._lowStream.closeP2PConnection();case 23:this._lowStream=void 0;case 24:if(!a){e.next=29;break}return e.next=27,this._highStream.closeP2PConnection();case 27:e.next=31;break;case 29:return e.next=31,this._highStream.removeTracks(t,n);case 31:r&&r(),e.next=40;break;case 34:if(e.prev=34,e.t2=e.catch(18),e.t2.code===$u.OPERATION_ABORTED){e.next=38;break}throw s.onError(e.t2),Rl.error("[".concat(this._clientId,"] unpublish error"),e.t2.toString()),r&&r(),e.t2;case 38:Rl.debug("[".concat(this._clientId,"] ignore unpub operation abort")),r&&r();case 40:this._highStream&&"disconnected"===this._highStream.connectionState&&(this._highStream=void 0,this._lowStream=void 0),n&&ba(t).call(t,(function(e){var t,n,r=Gc(t=c._bindEnabledTracks).call(t,e);-1!==r&&(e.off(ud.NEED_ADD_TRACK,c._handleLocalTrackEnable),e.off(ud.NEED_REMOVE_TRACK,c._handleLocalTrackDisable),Uc(n=c._bindEnabledTracks).call(n,r,1))})),Rl.info(cs(o="[".concat(this._clientId,"] Unpublish success,tracks ")).call(o,Pc(t).call(t,(function(e){return"".concat(e.getTrackId())})))),s.onSuccess();case 44:case"end":return e.stop()}}),e,this,[[18,34]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"subscribe",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s,c,u,l,d,f,h,p=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(je(n,"mediaType",["audio","video"]),s=Ff.reportApiInvoke(this._sessionId,{name:Nl.SUBSCRIBE,options:[t.uid,n],tag:Pl.TRACER}),this._joinInfo){e.next=4;break}throw n=new Al($u.INVALID_OPERATION,"Can't subscribe stream, not joined"),s.onError(n),n;case 4:if("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState){e.next=6;break}throw n=new Al($u.INVALID_OPERATION,"Can't subscribe stream in ".concat(this.connectionState," state")),s.onError(n),n;case 6:if(Zc(r=this._users).call(r,(function(e){return e===t}))){e.next=9;break}throw n=new Al($u.INVALID_REMOTE_USER,"user is not in the channel"),Rl.error(cs(c="[".concat(this._clientId,"] can not subscribe ")).call(c,t.uid,", this user is not in the channel")),s.onError(n),n;case 9:if(t.hasAudio||t.hasVideo){e.next=12;break}throw n=new Al($u.INVALID_REMOTE_USER,"user is not published"),Rl.error(cs(u="[".concat(this._clientId,"] can not subscribe ")).call(u,t.uid,", user is not published")),s.onError(n),n;case 12:if(c={audio:"audio"===n,video:"video"===n},!(!t.hasAudio&&c.audio||!t.hasVideo&&c.video)){e.next=16;break}throw f=new Al($u.REMOTE_USER_IS_NOT_PUBLISHED),Rl.error(cs(l=cs(d="[".concat(this._clientId,"] can not subscribe ")).call(d,t.uid," with mediaType ")).call(l,n,", remote track is not published")),s.onError(f),f;case 16:return(l=this._subscribeMutex.get(t.uid))||(l=new kf("sub-".concat(t.uid)),this._subscribeMutex.set(t.uid,l)),Rl.info(cs(i=cs(o="[".concat(this._clientId,"] subscribe user ")).call(o,t.uid,", mediaType: ")).call(i,n)),e.next=20,l.lock();case 20:if(i=e.sent,o=this._remoteStream.get(t.uid),e.prev=22,!o){e.next=30;break}return c.audio=c.audio||o.subscribeOptions.audio,c.video=c.video||o.subscribeOptions.video,e.next=28,this._gateway.subscribeChange(o,c);case 28:e.next=41;break;case 30:return o=new sp(t,this._statsCollector,this._joinInfo,c),this._remoteStream.set(t.uid,o),e.prev=32,e.next=35,this._gateway.subscribe(o);case 35:e.next=40;break;case 37:throw e.prev=37,e.t0=e.catch(32),this._remoteStream.delete(t.uid),e.t0;case 40:o.on(zl.CONNECTION_STATE_CHANGE,(function(e,n){"connecting"===e?p.emit(Vl.MEDIA_RECONNECT_START,t.uid):"connected"===e&&p.emit(Vl.MEDIA_RECONNECT_END,t.uid)}));case 41:i(),e.next=47;break;case 44:throw e.prev=44,e.t1=e.catch(22),s.onError(e.t1),i(),Rl.error(cs(h="[".concat(this._clientId,"] subscribe user ")).call(h,t.uid," error"),e.t1),e.t1;case 47:return Rl.info(cs(f=cs(a="[".concat(this._clientId,"] subscribe success user ")).call(a,t.uid,", mediaType: ")).call(f,n)),this._defaultStreamFallbackType&&this.setStreamFallbackOption(t.uid,this._defaultStreamFallbackType).catch((function(e){Rl.warning("[".concat(p._clientId,"] auto set fallback failed"),e)})),n="audio"===n?t.audioTrack:t.videoTrack,e.abrupt("return",n?(s.onSuccess(n.getTrackId()),n):(n=new Al($u.UNEXPECTED_ERROR,"can not find remote track in user object"),s.onError(n),n.throw()));case 51:case"end":return e.stop()}}),e,this,[[22,44],[32,37]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"unsubscribe",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a,s,c,u,l,d;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&je(n,"mediaType",["audio","video"]),c=Ff.reportApiInvoke(this._sessionId,{name:Nl.UNSUBSCRIBE,options:[t.uid,n],tag:Pl.TRACER}),Zc(r=this._users).call(r,(function(e){return e===t}))){e.next=5;break}throw n=new Al($u.INVALID_REMOTE_USER,"user is not in the channel"),Rl.error(cs(u="[".concat(this._clientId,"] can not subscribe ")).call(u,t.uid,", user is not in the channel")),c.onError(n),n;case 5:return Rl.info(cs(i=cs(o="[".concat(this._clientId,"] unsubscribe uid: ")).call(o,t.uid,", mediaType: ")).call(i,n)),(u=this._subscribeMutex.get(t.uid))||(u=new kf("sub-".concat(t.uid)),this._subscribeMutex.set(t.uid,u)),e.next=9,u.lock();case 9:if(u=e.sent,r=this._remoteStream.get(t.uid)){e.next=13;break}return e.abrupt("return",(Rl.warning(cs(l="[".concat(this._clientId,"]: you have not subscribe the remote user ")).call(l,t.uid)),c.onSuccess(),void u()));case 13:if(l=Yn({},r.subscribeOptions),"audio"===n?l.audio=!1:"video"===n?(l.video=!1,r.pc._statsFilter.setVideoIsReady(!1)):(l.audio=!1,l.video=!1),e.prev=15,!l.audio&&!l.video){e.next=21;break}return e.next=19,this._gateway.subscribeChange(r,l);case 19:e.next=24;break;case 21:return e.next=23,r.closeP2PConnection();case 23:this._remoteStream.delete(t.uid);case 24:u(),e.next=33;break;case 27:if(e.prev=27,e.t0=e.catch(15),e.t0.code===$u.OPERATION_ABORTED){e.next=31;break}throw c.onError(e.t0),u(),Rl.error(cs(d="[".concat(this._clientId,"] unsubscribe user ")).call(d,t.uid," error"),e.t0.toString()),e.t0;case 31:u(),Rl.debug("[".concat(this._clientId,"] ignore unsub operation abort"));case 33:Rl.info(cs(a=cs(s="[".concat(this._clientId,"] unsubscribe success uid: ")).call(s,t.uid,", mediaType: ")).call(a,n)),c.onSuccess();case 35:case"end":return e.stop()}}),e,this,[[15,27]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setLowStreamParameter",value:function(e){if(!e)throw new Al($u.INVALID_PARAMS);null==e.width||Fe(e.width,"streamParameter.width"),null==e.height||Fe(e.height,"streamParameter.height"),null==e.framerate||Fe(e.framerate,"streamParameter.framerate"),null==e.bitrate||Fe(e.bitrate,"streamParameter.bitrate");var t=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_LOW_STREAM_PARAMETER,options:[e],tag:Pl.TRACER});(!e.width&&e.height||e.width&&!e.height)&&Rl.warning("[".concat(this._clientId,"] The width and height parameters take effect only when both are set")),Rl.info("[".concat(this._clientId,"] set low stream parameter to"),Yr(e));var n=this._configDistribute.getLowStreamConfigDistribute();n&&n.bitrate&&e.bitrate&&n.bitrate<e.bitrate&&(e.bitrate=n.bitrate),this._lowStreamParameter=e,t.onSuccess()}},{key:"enableDualStream",value:function(){var e=m(v.mark((function e(){var t,n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ff.reportApiInvoke(this._sessionId,{name:Nl.ENABLE_DUAL_STREAM,options:[],tag:Pl.TRACER}),Ed.supportDualStream){e.next=5;break}throw Ff.streamSwitch(this._sessionId,{lts:gf(),isdual:!0,succ:!1}),n=new Al($u.NOT_SUPPORTED,"Your browser is not support dual stream"),t.onError(n),n;case 5:if(!this._isDualStreamEnabled){e.next=7;break}throw n=new Al($u.INVALID_OPERATION,"Dual stream is already enabled"),t.onError(n),n;case 7:if(!this._highStream||"connected"!==this._highStream.connectionState||!this._highStream.videoTrack){e.next=16;break}return e.prev=8,e.next=11,this._publishLowStream(this._highStream.videoTrack);case 11:e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(8),Ff.streamSwitch(this._sessionId,{lts:gf(),isdual:!0,succ:!1}),t.onError(e.t0),e.t0;case 16:this._isDualStreamEnabled=!0,Ff.streamSwitch(this._sessionId,{lts:gf(),isdual:!0,succ:!0}),Rl.info("[".concat(this._clientId,"] enable dual stream")),t.onSuccess();case 20:case"end":return e.stop()}}),e,this,[[8,13]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"disableDualStream",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ff.reportApiInvoke(this._sessionId,{name:Nl.DISABLE_DUAL_STREAM,options:[],tag:Pl.TRACER}),!this._lowStream){e.next=10;break}return e.prev=2,e.next=5,this._lowStream.closeP2PConnection();case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),Ff.streamSwitch(this._sessionId,{lts:gf(),isdual:!1,succ:!1}),t.onError(e.t0),e.t0;case 10:this._lowStream=void 0,this._isDualStreamEnabled=!1,this._highStream&&(this._highStream.lowStreamConnection=void 0),Ff.streamSwitch(this._sessionId,{lts:gf(),isdual:!1,succ:!0}),Rl.info("[".concat(this._clientId,"] disable dual stream")),t.onSuccess();case 16:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"setClientRole",value:function(){var e=m(v.mark((function e(t,n){var r,i,o,a;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(je(t,"role",["audience","host"]),n&&Qe(n),r=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_CLIENT_ROLE,options:[t,n],tag:Pl.TRACER}),"rtc"!==this._mode){e.next=6;break}return e.abrupt("return",(Rl.warning("[".concat(this._clientId,"]rtc mode can not use setClientRole")),t=new Al($u.INVALID_OPERATION,"rtc mode can not use setClientRole"),r.onError(t),t.throw()));case 6:if(!n||!n.level||"host"!==t){e.next=8;break}return e.abrupt("return",(t=new Al($u.INVALID_OPERATION,"host mode can not set audience latency level"),r.onError(t),t.throw()));case 8:if(e.prev=8,"audience"!==t||!this._highStream){e.next=12;break}return a=new Al($u.INVALID_OPERATION,"can not set client role to audience when publishing stream"),e.abrupt("return",(r.onError(a),a.throw()));case 12:return e.next=14,this._gateway.setClientRole(t,n);case 14:Rl.info(cs(i=cs(o="[".concat(this._clientId,"] set client role to ")).call(o,t,", level: ")).call(i,n&&n.level)),r.onSuccess(),e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(8),r.onError(e.t0),e.t0;case 21:case"end":return e.stop()}}),e,this,[[8,18]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setProxyServer",value:function(e){Ve(e,"proxyServer");var t=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_PROXY_SERVER,options:[e],tag:Pl.TRACER});if("DISCONNECTED"!==this.connectionState)throw new Al($u.INVALID_OPERATION,"Set proxy server before join channel");if("disabled"!==this._cloudProxyServerMode)throw new Al($u.INVALID_OPERATION,"You have already set the proxy");this._proxyServer=e,Ff.setProxyServer(this._proxyServer),Rl.setProxyServer(this._proxyServer),t.onSuccess()}},{key:"setTurnServer",value:function(e){if(Zu(e)||(e=[e]),"DISCONNECTED"!==this.connectionState)throw new Al($u.INVALID_OPERATION,"Set turn server before join channel");if("disabled"!==this._cloudProxyServerMode)throw new Al($u.INVALID_OPERATION,"You have already set the proxy");var t;if(ze(e))return this._turnServer={servers:e,mode:"original-manual"},void Rl.info(cs(t="[".concat(this._clientId,"] Set original turnserver success: ")).call(t,Pc(e).call(e,(function(e){return e.urls})).join(","),"."));ba(e).call(e,(function(e){return Ye(e)})),this._turnServer={servers:e,mode:"manual"},Rl.info("[".concat(this._clientId,"] Set turnserver success."))}},{key:"startProxyServer",value:function(e){var t=Ff.reportApiInvoke(this._sessionId,{name:Nl.START_PROXY_SERVER,options:[],tag:Pl.TRACER});if("DISCONNECTED"!==this.connectionState)throw e=new Al($u.INVALID_OPERATION,"Start proxy server before join channel"),t.onError(e),e;if(this._proxyServer||"manual"===this._turnServer.mode)throw e=new Al($u.INVALID_OPERATION,"You have already set the proxy"),t.onError(e),e;var n=[1,2,3,4,5];switch(void 0===e&&(e=1),e){case 1:this._cloudProxyServerMode="normal";break;case 2:this._cloudProxyServerMode="443only";break;case 3:this._cloudProxyServerMode="proxy3";break;case 4:this._cloudProxyServerMode="proxy4";break;case 5:this._cloudProxyServerMode="proxy5";break;default:throw e=new Al($u.INVALID_PARAMS,"proxy server mode must be ".concat(n.join("|"))),t.onError(e),e}Rl.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),t.onSuccess()}},{key:"stopProxyServer",value:function(){var e=Ff.reportApiInvoke(this._sessionId,{name:Nl.STOP_PROXY_SERVER,options:[],tag:Pl.TRACER});if("DISCONNECTED"!==this.connectionState)throw new Al($u.INVALID_OPERATION,"Stop proxy server after leave channel");Ff.setProxyServer(),Rl.setProxyServer(),this._cloudProxyServerMode="disabled",Rl.info("[".concat(this._clientId,"] set cloud proxy server mode to"),this._cloudProxyServerMode),this._proxyServer=void 0,this._turnServer={mode:"auto",servers:[]},e.onSuccess()}},{key:"setRemoteVideoStreamType",value:function(){var e=m(v.mark((function e(t,n){var r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je(n,"streamType",[0,1]),o=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_REMOTE_VIDEO_STREAM_TYPE,options:[t,n],tag:Pl.TRACER}),e.prev=2,e.next=5,this._gateway.setRemoteVideoStreamType(t,n);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),o.onError(e.t0),Rl.error("[".concat(this._clientId,"] set remote video stream type error"),e.t0.toString()),e.t0;case 10:Rl.info(cs(r=cs(i="[".concat(this._clientId,"] set remote ")).call(i,t," video stream type to ")).call(r,n)),this._remoteStreamTypeCacheMap.set(t,n),o.onSuccess();case 13:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setStreamFallbackOption",value:function(){var e=m(v.mark((function e(t,n){var r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je(n,"fallbackType",[0,1,2]),o=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_STREAM_FALLBACK_OPTION,options:["too long to show",n],tag:Pl.TRACER}),e.prev=2,e.next=5,this._gateway.setStreamFallbackOption(t,n);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),o.onError(e.t0),Rl.error("[".concat(this._clientId,"] set stream fallback option"),e.t0.toString()),e.t0;case 10:Rl.info(cs(r=cs(i="[".concat(this._clientId,"] set remote ")).call(i,t," stream fallback type to ")).call(r,n)),this._streamFallbackTypeCacheMap.set(t,n),o.onSuccess();case 13:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"setEncryptionConfig",value:function(e,t){je(e,"encryptionMode","aes-128-xts aes-256-xts aes-128-ecb sm4-128-ecb aes-128-gcm aes-256-gcm none".split(" ")),Ve(t,"secret"),/^(?=.*[a-z])(?=.*[A-Z])(?=.*[0-9])(?=.*[!@#$%^&*,.<>?/:;'"|{}\[\]])(?=.{8,})/.test(t)||Rl.warning("The secret is not strong:\n      The secret must contain at least 1 lowercase alphabetical character,\n      The secret must contain at least 1 uppercase alphabetical character,\n      The secret must contain at least 1 numeric character,\n      The secret must contain at least one special character,\n      The secret must be eight characters or longer.\n      ");var n=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_ENCRYPTION_CONFIG,options:[e],tag:Pl.TRACER});this._encryptionMode=e,this._encryptionSecret=t,n.onSuccess()}},{key:"renewToken",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Ve(t,"token",1,2047),n=Ff.reportApiInvoke(this._sessionId,{name:Nl.RENEW_TOKEN,options:[t],tag:Pl.TRACER}),this._key){e.next=4;break}return e.abrupt("return",(t=new Al($u.INVALID_OPERATION,"renewToken should not be called before user join"),n.onError(t),t.throw()));case 4:return this._key=t,e.prev=5,e.next=8,this._gateway.renewToken(t);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(5),n.onError(e.t0),Rl.error("[".concat(this._clientId,"] renewToken failed"),e.t0.toString()),e.t0;case 13:Rl.debug("[".concat(this._clientId,"] renewToken success")),n.onSuccess();case 15:case"end":return e.stop()}}),e,this,[[5,10]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"enableAudioVolumeIndicator",value:function(){var e=this,t=Ff.reportApiInvoke(this._sessionId,{name:Nl.ENABLE_AUDIO_VOLUME_INDICATOR,options:[],tag:Pl.TRACER});if(this._audioVolumeIndicationInterval)return Rl.warning("you have already enabled audio volume indicator!"),t.onSuccess();this._audioVolumeIndicationInterval=window.setInterval((function(){var t,n,r,i=Ju(t=Pc(n=vf(hf(r=e._remoteStream).call(r))).call(n,(function(e){return{level:e.user.audioTrack?100*e.user.audioTrack._source.getAudioAvgLevel():0,uid:e.getUserId()}}))).call(t,(function(e,t){return e.level-t.level}));e._highStream&&e._highStream.audioTrack&&(i.push({level:100*e._highStream.audioTrack._source.getAudioAvgLevel(),uid:e._highStream._userId}),i=Ju(i).call(i,(function(e,t){return e.level-t.level}))),e.emit(Vl.VOLUME_INDICATOR,i)}),Bu.AUDIO_VOLUME_INDICATION_INTERVAL||2e3),t.onSuccess()}},{key:"getRTCStats",value:function(){var e=this._statsCollector.getRTCStats(),t=this._gateway.getInChannelInfo();return e.Duration=Math.round(t.duration/1e3),e}},{key:"startLiveStreaming",value:function(e,t){var n=Ff.reportApiInvoke(this._sessionId,{name:Nl.START_LIVE_STREAMING,options:[e,t],tag:Pl.TRACER});if(!t){if("h264"!==this._codec)return e=new Al($u.LIVE_STREAMING_INVALID_RAW_STREAM,"raw streaming is only support h264"),n.onError(e),kc.reject(e);if(!this._highStream)return e=new Al($u.LIVE_STREAMING_INVALID_RAW_STREAM,"can not find stream to raw streaming"),n.onError(e),kc.reject(e)}return this._liveRawStreamingClient&&this._liveRawStreamingClient.hasUrl(e)||this._liveTranscodeStreamingClient&&this._liveTranscodeStreamingClient.hasUrl(e)?(e=new Al($u.LIVE_STREAMING_TASK_CONFLICT),n.onError(e),kc.reject(e)):(t=t?Jl.TRANSCODE:Jl.RAW,this._createLiveStreamingClient(t).startLiveStreamingTask(e,t).then((function(){return n.onSuccess()})).catch((function(e){throw n.onError(e),e})))}},{key:"setLiveTranscoding",value:function(e){var t=Ff.reportApiInvoke(this._sessionId,{name:Nl.SET_LIVE_TRANSCODING,options:[e],tag:Pl.TRACER});return this._createLiveStreamingClient(Jl.TRANSCODE).setTranscodingConfig(e).then((function(){return t.onSuccess()})).catch((function(e){throw t.onError(e),e}))}},{key:"stopLiveStreaming",value:function(e){var t,n=Ff.reportApiInvoke(this._sessionId,{name:Nl.STOP_LIVE_STREAMING,options:[e],tag:Pl.TRACER}),r=ds(t=[this._liveRawStreamingClient,this._liveTranscodeStreamingClient]).call(t,(function(t){return t&&t.hasUrl(e)}));return r.length?kc.all(Pc(r).call(r,(function(t){return t&&t.stopLiveStreamingTask(e)}))).then((function(){return n.onSuccess()})).catch((function(e){throw n.onError(e),e})):(t=new Al($u.INVALID_PARAMS,"can not find live streaming url to stop"),n.onError(t),kc.reject(t))}},{key:"addInjectStreamUrl",value:function(){var e=m(v.mark((function e(t,n){var r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=Ff.reportApiInvoke(this._sessionId,{name:Nl.ADD_INJECT_STREAM_URL,options:[t,n],tag:Pl.TRACER}),e.prev=1,this._joinInfo){e.next=4;break}throw new Al($u.INVALID_OPERATION,"can not addInjectStreamUrl, no joininfo");case 4:return(i=this._createLiveStreamingClient(Jl.INJECT)).setInjectStreamConfig(n,0),e.next=8,i.startLiveStreamingTask(t,Jl.INJECT);case 8:e.next=13;break;case 10:throw e.prev=10,e.t0=e.catch(1),r.onError(e.t0),e.t0;case 13:r.onSuccess();case 14:case"end":return e.stop()}}),e,this,[[1,10]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"removeInjectStreamUrl",value:function(){var e=m(v.mark((function e(){var t,n,r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=Ff.reportApiInvoke(this._sessionId,{name:Nl.REMOVE_INJECT_STREAM_URL,options:[],tag:Pl.TRACER}),e.prev=1,i=this._createLiveStreamingClient(Jl.INJECT),o=Zc(n=vf(hf(r=i.streamingTasks).call(r))).call(n,(function(e){return e.mode===Jl.INJECT})),this._joinInfo&&o){e.next=5;break}throw new Al($u.INVALID_OPERATION,"can remove addInjectStreamUrl, no joininfo or inject task");case 5:return e.next=7,i.stopLiveStreamingTask(o.url);case 7:e.next=12;break;case 9:throw e.prev=9,e.t0=e.catch(1),t.onError(e.t0),e.t0;case 12:t.onSuccess();case 13:case"end":return e.stop()}}),e,this,[[1,9]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"startChannelMediaRelay",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ff.reportApiInvoke(this._sessionId,{name:Nl.START_CHANNEL_MEDIA_RELAY,options:[t],tag:Pl.TRACER}),e.prev=1,Hn(t),e.next=5,this._createChannelMediaRelayClient().startChannelMediaRelay(t);case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",(n.onError(e.t0),e.t0.throw()));case 10:n.onSuccess();case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"updateChannelMediaRelay",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Ff.reportApiInvoke(this._sessionId,{name:Nl.UPDATE_CHANNEL_MEDIA_RELAY,options:[t],tag:Pl.TRACER}),e.prev=1,Hn(t),e.next=5,this._createChannelMediaRelayClient().updateChannelMediaRelay(t);case 5:e.next=10;break;case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",(n.onError(e.t0),e.t0.throw()));case 10:n.onSuccess();case 11:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"stopChannelMediaRelay",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=Ff.reportApiInvoke(this._sessionId,{name:Nl.STOP_CHANNEL_MEDIA_RELAY,options:[],tag:Pl.TRACER}),e.prev=1,e.next=4,this._createChannelMediaRelayClient().stopChannelMediaRelay();case 4:e.next=9;break;case 6:return e.prev=6,e.t0=e.catch(1),e.abrupt("return",(t.onError(e.t0),e.t0.throw()));case 9:t.onSuccess();case 10:case"end":return e.stop()}}),e,this,[[1,6]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"sendStreamMessage",value:function(e){if(!this._joinInfo)throw new Al($u.INVALID_OPERATION,"can not send data stream, not joined");if("string"==typeof e&&(e=(new TextEncoder).encode(e)),1024<new Blob([e]).size)throw new Al($u.INVALID_PARAMS,"stream message out of range.");return this._gateway.signal.request(ql.DATA_STREAM,{payload:At(e)})}},{key:"sendMetadata",value:function(e){if(!this._joinInfo)throw new Al($u.INVALID_OPERATION,"can not send metadata, not joined");if(1024<new Blob([e]).size)throw new Al($u.METADATA_OUT_OF_RANGE);return this._gateway.signal.request(ql.SEND_METADATA,{session_id:this._joinInfo.sid,metadata:At(e)})}},{key:"sendCustomReportMessage",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Zu(t)||(t=[t]),ba(t).call(t,Ke),n=Ff.reportApiInvoke(this._sessionId,{name:Nl.SEND_CUSTOM_REPORT_MESSAGE,options:[],tag:Pl.TRACER}),this._joinInfo){e.next=5;break}return e.abrupt("return",(t=new Al($u.INVALID_OPERATION,"can not send custom report, not joined"),n.onError(t),t.throw()));case 5:return e.next=7,Ff.sendCustomReportMessage(this._joinInfo.sid,t);case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getLocalAudioStats",value:function(){return this._highStream?this._statsCollector.getLocalAudioTrackStats(this._highStream.connectionId):$l}},{key:"getRemoteAudioStats",value:function(){var e,t=this,n={};return ba(e=this._remoteStream).call(e,(function(e,r){n[r]=t._statsCollector.getRemoteAudioTrackStats(e.connectionId)})),n}},{key:"getLocalVideoStats",value:function(){return this._highStream?this._statsCollector.getLocalVideoTrackStats(this._highStream.connectionId):Zl}},{key:"getRemoteVideoStats",value:function(){var e,t=this,n={};return ba(e=this._remoteStream).call(e,(function(e,r){n[r]=t._statsCollector.getRemoteVideoTrackStats(e.connectionId)})),n}},{key:"getRemoteNetworkQuality",value:function(){var e,t=this,n={};return ba(e=this._remoteStream).call(e,(function(e,r){n[r]=t._statsCollector.getRemoteNetworkQualityStats(e.connectionId)})),n}},{key:"pickSVCLayer",value:function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return je(n.spatialLayer,"spatialLayer",[1,2,3]),je(n.temporalLayer,"temporalLayer",[1,2,3]),e.prev=2,e.next=5,this._gateway.pickSVCLayer(t,n);case 5:e.next=10;break;case 7:throw e.prev=7,e.t0=e.catch(2),Rl.error("[".concat(this._clientId,"] pick SVC layer failed"),e.t0.toString()),e.t0;case 10:case"end":return e.stop()}}),e,this,[[2,7]])})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"_reset",value:function(){var e,t,n,r=this;Rl.debug("[".concat(this._clientId,"] reset client")),this._axiosCancelSource.cancel(),this._axiosCancelSource=Tl.CancelToken.source(),this._streamFallbackTypeCacheMap=new ra,this._remoteStreamTypeCacheMap=new ra,this._configDistribute.stopGetConfigDistribute(),this._defaultStreamFallbackType=this._proxyServer=this._joinInfo=void 0,this._sessionId=null,this._statsCollector.reset(),this._channelName=this._uid=this._appId=this._key=void 0,ba(e=this._users).call(e,(function(e){e.audioTrack&&(e.audioTrack.stop(),e.audioTrack._isDestroyed=!0),e.videoTrack&&(e.videoTrack.stop(),e.videoTrack._isDestroyed=!0)})),this._users=[],this._audioVolumeIndicationInterval&&(window.clearInterval(this._audioVolumeIndicationInterval),this._audioVolumeIndicationInterval=void 0),this._highStream&&(this._highStream.closeP2PConnection(!0),this._highStream=void 0),ba(t=this._bindEnabledTracks).call(t,(function(e){e.off(ud.NEED_ADD_TRACK,r._handleLocalTrackEnable),e.off(ud.NEED_REMOVE_TRACK,r._handleLocalTrackDisable)})),this._bindEnabledTracks=[],this._lowStream&&(this._lowStream.closeP2PConnection(!0),this._lowStream=void 0),ba(n=this._remoteStream).call(n,(function(e){e.closeP2PConnection(!0)})),this._remoteStream=new ra,this._publishMutex=new kf("client-publish"),this._subscribeMutex=new ra,this._networkQualityInterval&&(window.clearInterval(this._networkQualityInterval),this._networkQualityInterval=void 0),this._injectStreamingClient&&(this._injectStreamingClient.terminate(),this._injectStreamingClient.removeAllListeners(),this._injectStreamingClient=void 0),this._liveRawStreamingClient&&(this._liveRawStreamingClient.terminate(),this._liveRawStreamingClient.removeAllListeners(),this._liveRawStreamingClient=void 0),this._liveTranscodeStreamingClient&&(this._liveTranscodeStreamingClient.terminate(),this._liveTranscodeStreamingClient.removeAllListeners(),this._liveTranscodeStreamingClient=void 0),this._channelMediaRelayClient&&(this._channelMediaRelayClient.dispose(),this._channelMediaRelayClient=void 0)}},{key:"_startSession",value:function(e,t){var n,r,i,o=e||vt(32,"").toUpperCase();e?Rl.debug(cs(n="[".concat(this._clientId,"] new Session ")).call(n,o)):Rl.debug(cs(r=cs(i="[".concat(this._clientId,"] renewSession ")).call(i,this._sessionId," => ")).call(r,o)),this._sessionId=o,t?Ff.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:t.channel,appid:t.appId,mode:this._mode}):this._joinInfo?Ff.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._joinInfo.cname,appid:this._joinInfo.appId,mode:this._mode}):this._gateway.joinInfo&&Ff.sessionInit(this._sessionId,{lts:(new Date).getTime(),cname:this._gateway.joinInfo.cname,appid:this._gateway.joinInfo.appId,mode:this._mode}),this._joinInfo&&(this._joinInfo.sid=o),this._gateway.joinInfo&&(this._gateway.joinInfo.sid=o)}},{key:"_publishHighStream",value:function(){var e=m(v.mark((function e(t){var n=this;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._joinInfo){e.next=2;break}throw new Al($u.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");case 2:if("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState){e.next=4;break}throw new Al($u.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));case 4:if("auto"!==this._turnServer.mode||!Bu.FORCE_TURN||Bu.TURN_ENABLE_TCP||Bu.TURN_ENABLE_UDP){e.next=6;break}throw new Al($u.UNEXPECTED_ERROR,"force TURN With No TURN Configuration");case 6:if(Rl.debug("[".concat(this._clientId,"] publish high stream")),!this._highStream){e.next=10;break}return e.next=9,this._highStream.addTracks(t);case 9:return e.abrupt("return",this._highStream);case 10:return this._highStream=new rp(this._statsCollector,this._joinInfo,this._codec),e.next=13,this._highStream.addTracks(t);case 13:return e.prev=13,e.next=16,this._gateway.publish(this._highStream,"high");case 16:e.next=21;break;case 18:throw e.prev=18,e.t0=e.catch(13),this._highStream=void 0,e.t0;case 21:return e.abrupt("return",(this._highStream.on(zl.CONNECTION_STATE_CHANGE,(function(e,t){n._highStream&&("connected"===e?n.emit(Vl.MEDIA_RECONNECT_END,n._highStream.getUserId()):"connecting"===e&&n.emit(Vl.MEDIA_RECONNECT_START,n._highStream.getUserId()))})),this._highStream));case 22:case"end":return e.stop()}}),e,this,[[13,18]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_publishLowStream",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._joinInfo){e.next=2;break}throw new Al($u.INVALID_OPERATION,"Can't publish stream, haven't joined yet!");case 2:if("CONNECTED"===this.connectionState||"RECONNECTING"===this.connectionState){e.next=4;break}throw new Al($u.INVALID_OPERATION,"can not publish stream in ".concat(this.connectionState," state"));case 4:if(this._highStream&&"connected"===this._highStream.connectionState){e.next=6;break}throw new Al($u.UNEXPECTED_ERROR,"Could not find high stream");case 6:if(!this._lowStream){e.next=8;break}return e.abrupt("return",new Al($u.UNEXPECTED_ERROR,"[".concat(this._clientId,"] Can't publish low stream when stream already publish")).throw());case 8:return Rl.debug("[".concat(this._clientId,"] publish low stream")),this._lowStream=new rp(this._statsCollector,this._joinInfo,this._codec,!0),(n=this._configDistribute.getLowStreamConfigDistribute())&&n.bitrate&&(this._lowStreamParameter||(this._lowStreamParameter={width:160,height:120,framerate:15,bitrate:50}),this._lowStreamParameter&&this._lowStreamParameter.bitrate&&n.bitrate<this._lowStreamParameter.bitrate&&(this._lowStreamParameter.bitrate=n.bitrate)),this._lowStream.lowStreamParameter=this._lowStreamParameter,e.next=15,this._lowStream.addTracks([t]);case 15:return e.prev=15,e.next=18,this._gateway.publish(this._lowStream,"low");case 18:e.next=23;break;case 20:throw e.prev=20,e.t0=e.catch(15),this._lowStream=void 0,e.t0;case 23:this._highStream.lowStreamConnection=this._lowStream;case 24:case"end":return e.stop()}}),e,this,[[15,20]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"_createLiveStreamingClient",value:function(e){var t=this;if(!this._joinInfo||!this._appId)return new Al($u.INVALID_OPERATION,"can not create live streaming client, please join channel first").throw();var n=function(){return new up(t._joinInfo,t._config.websocketRetryConfig||Wf,t._config.httpRetryConfig||Wf)},r=function(e){e.onLiveStreamError=function(e,n){Ff.reportApiInvoke(t._sessionId,{name:Nl.ON_LIVE_STREAM_ERROR,options:[e,n],tag:Pl.TRACER}).onSuccess(),t.emit(Vl.LIVE_STREAMING_ERROR,e,n)},e.onLiveStreamWarning=function(e,n){Ff.reportApiInvoke(t._sessionId,{name:Nl.ON_LIVE_STREAM_WARNING,options:[e,n],tag:Pl.TRACER}).onSuccess(),t.emit(Vl.LIVE_STREAMING_WARNING,e,n)},e.on(id.REQUEST_WORKER_MANAGER_LIST,(function(e,n,r){if(!t._joinInfo)return r(new Al($u.INVALID_OPERATION,"can not find join info to get worker manager"));gn(e,t._joinInfo,t._axiosCancelSource.token,Wf).then(n).catch(r)}))};switch(e){case Jl.RAW:return this._liveRawStreamingClient||(this._liveRawStreamingClient=n(),r(this._liveRawStreamingClient)),this._liveRawStreamingClient;case Jl.TRANSCODE:return this._liveTranscodeStreamingClient||(this._liveTranscodeStreamingClient=n(),r(this._liveTranscodeStreamingClient)),this._liveTranscodeStreamingClient;case Jl.INJECT:return this._injectStreamingClient||(this._injectStreamingClient=n(),this._injectStreamingClient.on(id.REQUEST_WORKER_MANAGER_LIST,(function(e,n,r){if(!t._joinInfo)return r(new Al($u.INVALID_OPERATION,"can not find join info to get worker manager"));gn(e,t._joinInfo,t._axiosCancelSource.token,Wf).then(n).catch(r)})),this._injectStreamingClient.onInjectStatusChange=function(e,n,r){t.emit(Vl.INJECT_STREAM_STATUS,e,n,r)}),this._injectStreamingClient}}},{key:"_createChannelMediaRelayClient",value:function(){var e=this;return this._joinInfo?(this._channelMediaRelayClient||(this._channelMediaRelayClient=new fp(this._joinInfo,this._clientId,this._config.websocketRetryConfig||Wf,this._config.httpRetryConfig||Wf),this._channelMediaRelayClient.on("state",(function(t){"RELAY_STATE_FAILURE"===t&&e._channelMediaRelayClient&&e._channelMediaRelayClient.dispose(),e.emit(Vl.CHANNEL_MEDIA_RELAY_STATE,t)})),this._channelMediaRelayClient.on("event",(function(t){e.emit(Vl.CHANNEL_MEDIA_RELAY_EVENT,t)}))),this._channelMediaRelayClient):new Al($u.INVALID_OPERATION,"can not create channel media relay client, please join channel first").throw()}},{key:"_handleGatewayEvents",value:function(){var e=this;this._gateway.on(cd.DISCONNECT_P2P,(function(){var t;Rl.debug("[".concat(e._clientId,"] start full reconnect")),e._highStream&&"disconnected"!==e._highStream.connectionState&&(Rl.debug("[".concat(e._clientId,"] ready to reconnect high stream")),e._highStream.readyToReconnectPC()),e._lowStream&&"disconnected"!==e._lowStream.connectionState&&(Rl.debug("[".concat(e._clientId,"] ready to reconnect low stream")),e._lowStream.readyToReconnectPC()),ba(t=e._remoteStream).call(t,(function(t,n){var r;Rl.debug(cs(r="[".concat(e._clientId,"] ready to reconnect remote stream ")).call(r,n)),t.readyToReconnectPC()}))})),this._gateway.on(cd.CONNECTION_STATE_CHANGE,(function(t,n,r){var i,o,a,s,c=function(){e.emit(Vl.CONNECTION_STATE_CHANGE,t,n,r)};if(Rl.info(cs(i=cs(o="[".concat(e._clientId,"] connection state change: ")).call(o,n," -> ")).call(i,t)),"DISCONNECTED"===t)return e._reset(),void c();if("RECONNECTING"===t)e._highStream&&"connecting"===e._highStream.connectionState&&(Rl.debug("[".concat(e._clientId,"] ready to reconnect high stream")),e._highStream.readyToReconnectPC()),e._lowStream&&"connecting"===e._lowStream.connectionState&&(Rl.debug("[".concat(e._clientId,"] ready to reconnect low stream")),e._lowStream.readyToReconnectPC()),ba(a=e._remoteStream).call(a,(function(t,n){var r;"connecting"===t.connectionState&&(Rl.debug(cs(r="[".concat(e._clientId,"] ready to reconnect remote stream ")).call(r,n)),t.readyToReconnectPC())})),ba(s=e._users).call(s,(function(e){e._trust_in_room_=!1,e._trust_audio_enabled_state_=!1,e._trust_video_enabled_state_=!1,e._trust_audio_mute_state_=!1,e._trust_video_mute_state_=!1,e._trust_stream_added_state_=!1})),e._userOfflineTimeout&&window.clearTimeout(e._userOfflineTimeout),e._streamRemovedTimeout&&window.clearTimeout(e._streamRemovedTimeout),e._streamRemovedTimeout=e._userOfflineTimeout=void 0;else if("CONNECTED"===t){var u,l;ba(u=e._streamFallbackTypeCacheMap).call(u,(function(t,n){e._gateway.setStreamFallbackOption(n,t).catch((function(t){return Rl.warning("[".concat(e._clientId,"] auto set stream fallback option failed"),t)}))})),ba(l=e._remoteStreamTypeCacheMap).call(l,(function(t,n){e._gateway.setRemoteVideoStreamType(n,t).catch((function(t){return Rl.warning("[".concat(e._clientId,"] auto set remote stream type failed"),t)}))})),e._highStream&&"connecting"===e._highStream.connectionState?e._highStream.reconnectPC().then((function(){e._lowStream&&"connecting"===e._lowStream.connectionState&&e._lowStream.reconnectPC().catch((function(t){Rl.error("[".concat(e._clientId,"] republish low stream error"),t.toString()),e.emit(Vl.ERROR,{reason:t})}))})).catch((function(t){Rl.error("[".concat(e._clientId,"] republish high stream error"),t.toString()),e.emit(Vl.ERROR,{reason:t})})):e._lowStream&&"connecting"===e._lowStream.connectionState&&e._lowStream.reconnectPC().catch((function(t){Rl.error("[".concat(e._clientId,"] republish low stream error"),t.toString()),e.emit(Vl.ERROR,{reason:t})})),e._userOfflineTimeout=window.setTimeout((function(){var t;if("CONNECTED"===e.connectionState){e._userOfflineTimeout=void 0;var n=ds(t=e._users).call(t,(function(e){return!e._trust_in_room_}));ba(n).call(n,(function(t){var n;Rl.debug(cs(n="[".concat(e._clientId,"] user offline timeout, emit user offline ")).call(n,t.uid)),e._handleUserOffline({uid:t.uid})}))}}),3e3),e._streamRemovedTimeout=window.setTimeout((function(){var t;"CONNECTED"===e.connectionState&&(e._streamRemovedTimeout=void 0,ba(t=e._users).call(t,(function(t){var n,r,i,o,a;t._trust_audio_mute_state_||(Rl.debug(cs(n="[".concat(e._clientId,"] auto dispatch audio unmute event ")).call(n,t.uid)),e._handleMuteStream(t.uid,"audio",!1)),t._trust_video_mute_state_||(Rl.debug(cs(r="[".concat(e._clientId,"] auto dispatch video unmute event ")).call(r,t.uid)),e._handleMuteStream(t.uid,"video",!1)),t._trust_audio_enabled_state_||(Rl.debug(cs(i="[".concat(e._clientId,"] auto dispatch enable local audio ")).call(i,t.uid)),e._handleSetStreamLocalEnable("audio",t.uid,!0)),!t._trust_video_enabled_state_&&t._video_enabled_&&(Rl.debug(cs(o="[".concat(e._clientId,"] auto dispatch enable local video ")).call(o,t.uid)),e._handleSetStreamLocalEnable("video",t.uid,!0)),t._trust_stream_added_state_||(Rl.debug(cs(a="[".concat(e._clientId,"] auto dispatch stream remove ")).call(a,t.uid)),e._handleRemoveStream({uid:t.uid,uint_id:t._uintid}))})))}),1e3)}c()})),this._gateway.on(cd.REQUEST_NEW_GATEWAY_LIST,(function(t,n){if(!e._joinInfo)return n(new Al($u.UNEXPECTED_ERROR,"can not recover, no join info"));un(e._joinInfo,e._axiosCancelSource.token,e._config.httpRetryConfig||Wf).then((function(n){var r;e._joinInfo&&(e._joinInfo.apResponse=n.gatewayInfo.res),t(Pc(r=n.gatewayInfo.gatewayAddrs).call(r,(function(t){var n,r;return e._joinInfo&&e._joinInfo.proxyServer?(t=t.split(":"),cs(n=cs(r="wss://".concat(e._joinInfo.proxyServer,"/ws/?h=")).call(r,t[0],"&p=")).call(n,t[1])):"wss://".concat(t)})))})).catch(n)})),this._gateway.on(cd.NETWORK_QUALITY,(function(t){"normal"===e._networkQualitySensitivity&&e.emit(Vl.NETWORK_QUALITY,t)})),this._gateway.on(cd.STREAM_TYPE_CHANGE,(function(t,n){e.emit(Vl.STREAM_TYPE_CHANGED,t,n),Ff.reportApiInvoke(e._sessionId,{name:Nl.STREAM_TYPE_CHANGE,options:[t,n],tag:Pl.TRACER}).onSuccess(Yr({uid:t,streamType:n}))})),this._gateway.on(cd.IS_P2P_DISCONNECTED,(function(t){var n,r,i,o=[];return e._highStream&&o.push(e._highStream),ba(n=e._remoteStream).call(n,(function(e){return o.push(e)})),0===o.length||0===ds(o).call(o,(function(e){return"connected"===e.connectionState})).length?t(!0):(Rl.debug(cs(r="[".concat(e._clientId,"] ")).call(r,Pc(i=ds(o).call(o,(function(e){return"connected"===e.connectionState}))).call(i,(function(e){return e.connectionId}))," is connected")),void t(!1))})),this._gateway.on(cd.NEED_RENEW_SESSION,(function(){e._startSession()})),this._gateway.signal.on(Hl.ON_USER_ONLINE,this._handleUserOnline),this._gateway.signal.on(Hl.ON_USER_OFFLINE,this._handleUserOffline),this._gateway.signal.on(Hl.ON_ADD_AUDIO_STREAM,(function(t){return e._handleAddAudioOrVideoStream("audio",t.uid,t.uint_id)})),this._gateway.signal.on(Hl.ON_ADD_VIDEO_STREAM,(function(t){return e._handleAddAudioOrVideoStream("video",t.uid,t.uint_id)})),this._gateway.signal.on(Hl.ON_REMOVE_STREAM,this._handleRemoveStream),this._gateway.signal.on(Hl.ON_P2P_LOST,this._handleP2PLost),this._gateway.signal.on(Hl.MUTE_AUDIO,(function(t){return e._handleMuteStream(t.uid,"audio",!0)})),this._gateway.signal.on(Hl.UNMUTE_AUDIO,(function(t){return e._handleMuteStream(t.uid,"audio",!1)})),this._gateway.signal.on(Hl.MUTE_VIDEO,(function(t){return e._handleMuteStream(t.uid,"video",!0)})),this._gateway.signal.on(Hl.UNMUTE_VIDEO,(function(t){return e._handleMuteStream(t.uid,"video",!1)})),this._gateway.signal.on(Hl.RECEIVE_METADATA,(function(t){var n=Rt(t.metadata);e.emit(Vl.RECEIVE_METADATA,t.uid,n)})),this._gateway.signal.on(Hl.ON_DATA_STREAM,(function(t){t.seq&&delete t.seq,t.payload=Rt(t.payload),e.emit(Vl.STREAM_MESSAGE,t.uid,t.payload),e.onStreamMessage&&e.onStreamMessage(t)})),this._gateway.signal.on(Hl.ON_CRYPT_ERROR,(function(){It((function(){Rl.warning("[".concat(e._clientId,"] on crypt error")),e.emit(Vl.CRYPT_ERROR)}),e._sessionId)})),this._gateway.signal.on(Hl.ON_TOKEN_PRIVILEGE_WILL_EXPIRE,this._handleTokenWillExpire),this._gateway.signal.on(Hl.ON_TOKEN_PRIVILEGE_DID_EXPIRE,(function(){Rl.warning("[".concat(e._clientId,"] received message onTokenPrivilegeDidExpire, please get new token and join again")),e._reset(),e._gateway.leave(!0),e.emit(Vl.ON_TOKEN_PRIVILEGE_DID_EXPIRE)})),this._gateway.signal.on(Hl.ON_STREAM_FALLBACK_UPDATE,(function(t){var n,r;Rl.debug(cs(n=cs(r="[".concat(e._clientId,"] stream fallback peerId: ")).call(r,t.stream_id,", attr: ")).call(n,t.stream_type)),e.emit(Vl.STREAM_FALLBACK,t.stream_id,1===t.stream_type?"fallback":"recover")})),this._gateway.signal.on(Hl.ON_PUBLISH_STREAM,(function(t){var n;e.uid===e._uid&&(e._highStream&&e._highStream._waitingSuccessResponse&&"connected"===e._highStream.connectionState?(e._highStream.reportPublishEvent(!0,null,Yr({proxy:t.proxy})),Rl.info(cs(n="[".concat(e._clientId,"] on publish stream, ")).call(n,Yr(t))),void 0!==t.proxy&&e.emit(Vl.IS_USING_CLOUD_PROXY,!!t.proxy)):e._lowStream?e._lowStream.reportPublishEvent(!0,null,Yr({proxy:t.proxy})):Rl.warning("get on_publish_stream message but cannot handle"))})),this._gateway.signal.on(Hl.ENABLE_LOCAL_VIDEO,(function(t){e._handleSetStreamLocalEnable("video",t.uid,!0)})),this._gateway.signal.on(Hl.DISABLE_LOCAL_VIDEO,(function(t){e._handleSetStreamLocalEnable("video",t.uid,!1)})),this._gateway.signal.on(Gl.REQUEST_TIMEOUT,(function(t,n){if(e._joinInfo)switch(t){case ql.PUBLISH:var r;if(!n)break;if(!(t="high"===n.stream_type?e._highStream:e._lowStream))break;"offer"===n.state&&Ff.publish(e._joinInfo.sid,{lts:t.startTime,succ:!1,ec:$u.TIMEOUT,audio:n.audio,video:n.video,p2pid:n.p2p_id,publishRequestid:t.ID,screenshare:!(!t.videoTrack||-1===Gc(r=t.videoTrack._hints).call(r,ld.SCREEN_TRACK)),audioName:t.audioTrack&&t.audioTrack.getTrackLabel(),videoName:t.videoTrack&&t.videoTrack.getTrackLabel()});break;case ql.SUBSCRIBE:(r=e._remoteStream.get(n.stream_id))&&n&&Ff.subscribe(e._joinInfo.sid,{lts:r.startTime,succ:!1,ec:$u.TIMEOUT,audio:!!n.audio,video:!!n.video,peerid:n.stream_id,subscribeRequestid:r.ID,p2pid:r.pc.ID})}}))}}]),n}(yf);pp([zt(),vp("design:type",Function),vp("design:paramtypes",[Object]),vp("design:returntype",void 0)],mp.prototype,"setTurnServer",null),pp([function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{report:Ff};return function(t,n,r){var i=t[n];if("function"==typeof i){var o="AgoraRTCClient"===t.constructor.name?"Client":t.constructor.name;r.value=m(v.mark((function t(){var r,a,s,c,u,l,d=arguments;return v.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(a=d.length,s=new Array(a),c=0;c<a;c++)s[c]=d[c];return u=e.report.reportApiInvoke(this._sessionId||null,{name:cs(r="".concat(o,".")).call(r,n),options:s,tag:Pl.TRACER}),t.prev=2,t.next=5,i.apply(this,s);case 5:return l=t.sent,t.abrupt("return",(u.onSuccess(),l));case 9:throw t.prev=9,t.t0=t.catch(2),u.onError(t.t0),t.t0;case 12:case"end":return t.stop()}}),t,this,[[2,9]])})))}return r}}({report:Ff}),vp("design:type",Function),vp("design:paramtypes",[Object,Object]),vp("design:returntype",kc)],mp.prototype,"pickSVCLayer",null);var gp=function(e){l(n,e);var t=d(n);function n(e){var r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return f(this,n),(r=t.call(this)).currentLoopCount=r.pausePlayTime=r.startPlayOffset=r.startPlayTime=0,r._currentState="stopped",r.audioBuffer=e,r.options=i,r.startPlayOffset=r.options.startPlayTime||0,r}return h(n,[{key:"currentState",get:function(){return this._currentState},set:function(e){e!==this._currentState&&(this._currentState=e,this.emit(Yl.AUDIO_SOURCE_STATE_CHANGE,this._currentState))}},{key:"createWebAudioDiagram",value:function(){return this.context.createGain()}},{key:"duration",get:function(){return this.audioBuffer.duration}},{key:"currentTime",get:function(){return"stopped"===this.currentState?0:"paused"===this.currentState?this.pausePlayTime:(this.context.currentTime-this.startPlayTime+this.startPlayOffset)%this.audioBuffer.duration}},{key:"updateOptions",value:function(e){"stopped"===this.currentState?(this.options=e,this.startPlayOffset=this.options.startPlayTime||0):Rl.warning("can not set audio source options")}},{key:"startProcessAudioBuffer",value:function(){this.sourceNode&&this.stopProcessAudioBuffer(),this.sourceNode=this.createSourceNode(),this.startSourceNode(),this.currentState="playing"}},{key:"pauseProcessAudioBuffer",value:function(){this.sourceNode&&"playing"===this.currentState&&(this.pausePlayTime=this.currentTime,this.sourceNode.onended=null,this.sourceNode.stop(),this.sourceNode.buffer=null,this.sourceNode=this.createSourceNode(),this.currentState="paused")}},{key:"seekAudioBuffer",value:function(e){this.sourceNode&&(this.sourceNode.onended=null,"playing"===this.currentState&&this.sourceNode.stop(),this.sourceNode=this.createSourceNode(),"playing"===this.currentState?(this.startPlayOffset=e,this.startSourceNode()):"paused"===this.currentState&&(this.pausePlayTime=e))}},{key:"resumeProcessAudioBuffer",value:function(){"paused"===this.currentState&&this.sourceNode&&(this.startPlayOffset=this.pausePlayTime,this.pausePlayTime=0,this.startSourceNode(),this.currentState="playing")}},{key:"stopProcessAudioBuffer",value:function(){if(this.sourceNode){this.sourceNode.onended=null;try{this.sourceNode.stop()}catch(wl){}this.reset()}}},{key:"startSourceNode",value:function(){var e;this.sourceNode&&this.sourceNode.buffer&&(this.sourceNode.start(0,this.startPlayOffset),this.startPlayTime=this.context.currentTime,this.sourceNode.onended=iu(e=this.handleSourceNodeEnded).call(e,this))}},{key:"createSourceNode",value:function(){var e=this.context.createBufferSource();return e.buffer=this.audioBuffer,e.loop=!!this.options.loop,e.connect(this.outputNode),e}},{key:"handleSourceNodeEnded",value:function(){if(this.currentLoopCount+=1,this.options.cycle&&this.options.cycle>this.currentLoopCount)return this.startPlayOffset=0,this.sourceNode=void 0,void this.startProcessAudioBuffer();this.reset()}},{key:"reset",value:function(){this.startPlayOffset=this.options.startPlayTime||0,this.currentState="stopped",this.sourceNode&&(this.sourceNode.disconnect(),this.sourceNode=void 0),this.currentLoopCount=0}}]),n}($f),yp=new ra,_p=Or.setInterval,bp=Ze().name,Ep=function(){function e(t,n){f(this,e),this.id=0,e.count+=1,this.id=e.count,this.element=t,this.context=n}return h(e,[{key:"initPeers",value:function(){var e=this;this.peerPair=[new RTCPeerConnection,new RTCPeerConnection],this.peerPair[1].ontrack=function(t){var n=document.createElement("audio");n.srcObject=new MediaStream([t.track]),n.play(),e.audioPlayerElement=n}}},{key:"switchSdp",value:function(){var e=m(v.mark((function e(){var t,n,r,i;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.peerPair){e.next=18;break}return t=function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("offer"!==n){e.next=6;break}return e.next=3,t.createOffer();case 3:e.t0=e.sent,e.next=9;break;case 6:return e.next=8,t.createAnswer();case 8:e.t0=e.sent;case 9:return n=e.t0,e.next=12,t.setLocalDescription(n);case 12:return e.abrupt("return","complete"===t.iceGatheringState?t.localDescription:new kc((function(e){t.onicegatheringstatechange=function(){"complete"===t.iceGatheringState&&e(t.localDescription)}})));case 13:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),n=function(){var e=m(v.mark((function e(t,n){return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setRemoteDescription(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),e.prev=2,e.next=5,t(this.peerPair[0],"offer");case 5:return r=e.sent,e.next=8,n(this.peerPair[1],r);case 8:return e.next=10,t(this.peerPair[1],"answer");case 10:return i=e.sent,e.next=13,n(this.peerPair[0],i);case 13:e.next=18;break;case 15:throw e.prev=15,e.t0=e.catch(2),new Al($u.LOCAL_AEC_ERROR,e.t0.toString()).print();case 18:case"end":return e.stop()}}),e,this,[[2,15]])})));function t(){return e.apply(this,arguments)}return t}()},{key:"getTracksFromMediaElement",value:function(){var e=m(v.mark((function e(t){var n;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.audioTrack){e.next=2;break}return e.abrupt("return",this.audioTrack);case 2:e.prev=2,t instanceof HTMLVideoElement&&(t.captureStream?t.captureStream():t.mozCaptureStream()),n=this.context.createMediaStreamDestination(),this.context.createMediaElementSource(t).connect(n),e.next=9;break;case 6:throw e.prev=6,e.t0=e.catch(2),new Al($u.LOCAL_AEC_ERROR,e.t0.toString()).print();case 9:if(n){e.next=11;break}throw new Al($u.LOCAL_AEC_ERROR,"no dest node when local aec").print();case 11:return t=n.stream.getAudioTracks()[0],e.abrupt("return",(this.audioTrack=t,t));case 13:case"end":return e.stop()}}),e,this,[[2,6]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getElement",value:function(){return this.element}},{key:"startEchoCancellation",value:function(){var e=m(v.mark((function e(){var t;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.context.resume(),this.peerPair&&this.close(),this.initPeers(),e.next=5,this.getTracksFromMediaElement(this.element);case 5:return t=e.sent,this.peerPair&&this.peerPair[0].addTrack(t),e.next=9,this.switchSdp();case 9:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"close",value:function(){var e;Rl.debug("close echo cancellation unit, id is",this.id),this.audioPlayerElement&&this.audioPlayerElement.pause(),this.peerPair&&ba(e=this.peerPair).call(e,(function(e){e.close()})),this.audioPlayerElement=this.peerPair=void 0}}]),e}();Ep.count=0;var wp=function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Tp=window.AudioContext||window.webkitAudioContext,Sp=function(){function e(){f(this,e),this.units=[],this._doesEnvironmentNeedAEC()&&(this.context=new Tp)}return h(e,[{key:"startProcessingLocalAEC",value:function(e){var t;if(!this.context||!this._doesEnvironmentNeedAEC())return Rl.debug("the system does not need to process local aec"),-1;var n=Zc(t=this.units).call(t,(function(t){return t&&t.getElement()===e}));return n||(n=new Ep(e,this.context),this.units.push(n)),n.startEchoCancellation(),Rl.debug("start processing local audio echo cancellation, id is",n.id),n.id}},{key:"_doesEnvironmentNeedAEC",value:function(){return Ze().name!==wu.SAFARI}}]),e}();!function(e,t,n,r){var i,o=arguments.length,a=3>o?t:null===r?r=Ya(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(a=(3>o?i(a):3<o?i(t,n,a):i(t,n))||a);3<o&&a&&Da(t,n,a)}([zt({report:Ff}),wp("design:type",Function),wp("design:paramtypes",[HTMLAudioElement]),wp("design:returntype",Number)],Sp.prototype,"startProcessingLocalAEC",null);var Ip,Rp,Ap,Cp,kp=new Sp;be("PROCESS_ID",cs(Ip=cs(Rp=cs(Ap=cs(Cp="process-".concat(vt(8,""),"-")).call(Cp,vt(4,""),"-")).call(Ap,vt(4,""),"-")).call(Rp,vt(4,""),"-")).call(Ip,vt(12,""))),function(){var e=Ze(),t=!(!navigator.mediaDevices||!navigator.mediaDevices.getDisplayMedia);Ed.getDisplayMedia=t,Ed.getStreamFromExtension=e.name===wu.CHROME&&34<Number(e.version),Ed.supportUnifiedPlan=function(){if(!window.RTCRtpTransceiver||!("currentDirection"in RTCRtpTransceiver.prototype))return!1;var e=new RTCPeerConnection,t=!1;try{e.addTransceiver("audio"),t=!0}catch(n){}return e.close(),t}(),Ed.supportMinBitrate=e.name===wu.CHROME||e.name===wu.EDGE,Ed.supportSetRtpSenderParameters=function(){var e=Ze();return!!(window.RTCRtpSender&&window.RTCRtpSender.prototype.setParameters&&window.RTCRtpSender.prototype.getParameters)&&(!!nt()||e.name===wu.SAFARI||e.name===wu.FIREFOX&&64<=Number(e.version))}(),e.name!==wu.SAFARI&&Ze().name!==wu.WECHAT||(Ed.supportDualStream=!1),Ed.webAudioMediaStreamDest=function(){var e=Ze();return!(e.name===wu.SAFARI&&12>Number(e.version))}(),Ed.supportReplaceTrack=!!window.RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.replaceTrack,Ed.supportWebGL="undefined"!=typeof WebGLRenderingContext,Ed.supportRequestFrame=!!window.CanvasCaptureMediaStreamTrack,nt()||(Ed.webAudioWithAEC=!0),Ed.supportShareAudio=function(){var e=Ze();return(e.os===Eu.WIN_10||e.os===Eu.WIN_81||e.os===Eu.WIN_7||e.os===Eu.LINUX||e.os===Eu.MAC_OS||e.os===Eu.MAC_OS_X)&&e.name===wu.CHROME&&74<=Number(e.version)}(),Ed.supportDualStreamEncoding=function(){var e=Ze();return e.name===wu.CHROME&&87===Number(e.version)}(),Rl.info("browser compatibility",Yr(Ed),Yr(e))}();var Op={VERSION:Du,BUILD:"v4.4.0-0-g48538343(4/2/2021, 5:44:00 PM)",setParameter:be,getParameter:function(e){return Bu[e]},getSupportedCodec:function(){var e=m(v.mark((function e(t){var n,r;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,t?(n=new Rh({})).addStream(t):n=new Ah({}),e.next=4,n.createOfferSDP();case 4:return t=e.sent,r={video:[],audio:[]},t.match(/ VP8/i)&&r.video.push("VP8"),t.match(/ VP9/i)&&r.video.push("VP9"),t.match(/ AV1X/i)&&r.video.push("AV1"),t.match(/ H264/i)&&r.video.push("H264"),t.match(/ opus/i)&&r.audio.push("OPUS"),t=r,e.abrupt("return",(n.close(),t));case 8:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),checkSystemRequirements:function(){var e=Ff.reportApiInvoke(null,{name:Nl.CHECK_SYSTEM_REQUIREMENTS,options:[],tag:Pl.TRACER}),t=!1;try{var n=navigator.mediaDevices&&navigator.mediaDevices.getUserMedia,r=window.WebSocket;t=!!(window.RTCPeerConnection&&n&&r)}catch(i){return Rl.error("check system requirement failed: ",i),!1}return n=!1,(r=Ze()).name===wu.CHROME&&58<=Number(r.version)&&r.os!==Eu.IOS&&(n=!0),r.name===wu.FIREFOX&&56<=Number(r.version)&&(n=!0),r.name===wu.OPERA&&45<=Number(r.version)&&(n=!0),r.name===wu.SAFARI&&11<=Number(r.version)&&(n=!0),Ze().name!==wu.WECHAT&&Ze().name!==wu.QQ||r.os===Eu.IOS||(n=!0),Rl.debug("checkSystemRequirements, api:",t,"browser",n),t=t&&n,e.onSuccess(t),t},getDevices:function(e){return Df.enumerateDevices(!0,!0,e)},getMicrophones:function(e){return Df.getRecordingDevices(e)},getCameras:function(e){return Df.getCamerasDevices(e)},getElectronScreenSources:Pt,getPlaybackDevices:function(e){return Df.getSpeakers(e)},createClient:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{codec:"vp8",mode:"rtc"},t=Ff.reportApiInvoke(null,{name:Nl.CREATE_CLIENT,options:[e],tag:Pl.TRACER});try{je(e.codec,"config.codec",["vp8","vp9","av1","h264"]),je(e.mode,"config.mode",["rtc","live"]),void 0!==e.proxyServer&&Ve(e.proxyServer,"config.proxyServer",1,1e4),void 0!==e.turnServer&&Ye(e.turnServer),void 0!==e.httpRetryConfig&&He(e.httpRetryConfig),void 0!==e.websocketRetryConfig&&He(e.websocketRetryConfig)}catch(n){throw t.onError(n),n}return t.onSuccess(),new mp(Yn({forceWaitGatewayResponse:!0},e,{role:"rtc"===e.mode?"host":e.role}))},createCameraVideoTrack:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{encoderConfig:"480p_1"},n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_CAM_VIDEO_TRACK,options:[$n({},t)]}),r=On(t),i=vt(8,"track-"),o=null,Rl.info("start create camera video track with config",Yr(t),"trackId",i),e.prev=5,e.next=8,Lt({video:r},i);case 8:if(e.t0=e.sent.getVideoTracks()[0],e.t0){e.next=11;break}e.t0=null;case 11:o=e.t0,e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(5),n.onError(e.t1),e.t1;case 17:if(o){e.next=19;break}return e.abrupt("return",(i=new Al($u.UNEXPECTED_ERROR,"can not find track in media stream"),n.onError(i),i.throw()));case 19:return t.optimizationMode&&Zn(i,o,t,t.encoderConfig&&me(t.encoderConfig)),t=new $h(o,t,r,t.scalabiltyMode?ye(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,i),e.abrupt("return",(n.onSuccess(t.getTrackId()),Rl.info("create camera video success, trackId:",i),t));case 22:case"end":return e.stop()}}),e,null,[[5,14]])})));function t(){return e.apply(this,arguments)}return t}(),createCustomVideoTrack:function(e){var t=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_CUSTOM_VIDEO_TRACK,options:[e]}),n=new Jh(e.mediaStreamTrack,{bitrateMax:e.bitrateMax,bitrateMin:e.bitrateMin},e.scalabiltyMode?ye(e.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},e.optimizationMode);return t.onSuccess(n.getTrackId()),Rl.info("create custom video track success with config",e,"trackId",n.getTrackId()),n},createScreenVideoTrack:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a,s,c,u,l=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},n=l.length>1&&void 0!==l[1]?l[1]:"disable",r=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_SCREEN_VIDEO_TRACK,options:[$n({},t),n]}),t.encoderConfig?"string"==typeof t.encoderConfig||t.encoderConfig.width&&t.encoderConfig.height||(t.encoderConfig.width={max:1920},t.encoderConfig.height={max:1080}):t.encoderConfig="1080p_2",i={},t.screenSourceType&&(i.mediaSource=t.screenSourceType),t.extensionId&&et()&&(i.extensionId=t.extensionId),t.electronScreenSourceId&&(i.sourceId=t.electronScreenSourceId),o=t.encoderConfig?ge(t.encoderConfig):null,i.mandatory={chromeMediaSource:"desktop",maxWidth:o?o.width:void 0,maxHeight:o?o.height:void 0},o&&o.frameRate&&("number"==typeof o.frameRate?(i.mandatory.maxFrameRate=o.frameRate,i.mandatory.minFrameRate=o.frameRate):(i.mandatory.maxFrameRate=o.frameRate.max||o.frameRate.ideal||o.frameRate.exact||void 0,i.mandatory.minFrameRate=o.frameRate.min||o.frameRate.ideal||o.frameRate.exact||void 0),i.frameRate=o.frameRate),o&&o.width&&(i.width=o.width),o&&o.height&&(i.height=o.height),o=i,a=vt(8,"track-"),s=null,i=null,(c=Ed).supportShareAudio||"enable"!==n){e.next=16;break}return e.abrupt("return",(t=new Al($u.NOT_SUPPORTED,"your browser or platform is not support share-screen with audio"),r.onError(t),t.throw()));case 16:return Rl.info("start create screen video track with config",t,"withAudio",n,"trackId",a),e.prev=17,e.next=20,Lt({screen:o,screenAudio:"auto"===n?c.supportShareAudio:"enable"===n},a);case 20:u=e.sent,s=u.getVideoTracks()[0]||null,i=u.getAudioTracks()[0]||null,e.next=28;break;case 25:throw e.prev=25,e.t0=e.catch(17),r.onError(e.t0),e.t0;case 28:if(s){e.next=30;break}return e.abrupt("return",(t=new Al($u.UNEXPECTED_ERROR,"can not find track in media stream"),r.onError(t),t.throw()));case 30:if(i||"enable"!==n){e.next=32;break}return e.abrupt("return",(s&&s.stop(),t=new Al($u.SHARE_AUDIO_NOT_ALLOWED),r.onError(t),t.throw()));case 32:if(t.optimizationMode||(t.optimizationMode="detail"),t.optimizationMode&&(Zn(a,s,t,t.encoderConfig&&ge(t.encoderConfig)),t.encoderConfig&&"string"!=typeof t.encoderConfig&&(t.encoderConfig.bitrateMin=t.encoderConfig.bitrateMax)),(t=new Jh(s,t.encoderConfig?ge(t.encoderConfig):{},t.scalabiltyMode?ye(t.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},t.optimizationMode,a))._hints.push(ld.SCREEN_TRACK),i){e.next=37;break}return e.abrupt("return",(r.onSuccess(t.getTrackId()),Rl.info("create screen video track success","video:",t.getTrackId()),t));case 37:return n=new th(i),e.abrupt("return",(r.onSuccess([t.getTrackId(),n.getTrackId()]),Rl.info("create screen video track success","video:",t.getTrackId(),"audio:",n.getTrackId()),[t,n]));case 39:case"end":return e.stop()}}),e,null,[[17,25]])})));function t(){return e.apply(this,arguments)}return t}(),createMicrophoneAndCameraTracks:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a,s,c,u,l,d,f,h,p,m,g=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=g.length>0&&void 0!==g[0]?g[0]:{},n=g.length>1&&void 0!==g[1]?g[1]:{encoderConfig:"480p_1"},a=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_MIC_AND_CAM_TRACKS,options:[t,n]}),s=On(n),c=Nn(t),u=vt(8,"track-"),l=vt(8,"track-"),d=null,f=null,Rl.info(cs(r=cs(i=cs(o="start create camera video track(".concat(l,") and microphone audio track(")).call(o,u,") with config, audio: ")).call(i,Yr(t),", video: ")).call(r,Yr(n))),e.prev=5,e.next=8,Lt({audio:c,video:s},cs(h="".concat(u,"-")).call(h,l));case 8:p=e.sent,d=p.getAudioTracks()[0],f=p.getVideoTracks()[0],e.next=16;break;case 13:throw e.prev=13,e.t0=e.catch(5),a.onError(e.t0),e.t0;case 16:if(d&&f){e.next=19;break}return m=new Al($u.UNEXPECTED_ERROR,"can not find tracks in media stream"),e.abrupt("return",(a.onError(m),m.throw()));case 19:return n.optimizationMode&&Zn(l,f,n,n.encoderConfig&&me(n.encoderConfig)),t=new nh(d,t,c,u),n=new $h(f,n,s,n.scalabiltyMode?ye(n.scalabiltyMode):{numSpatialLayers:1,numTemporalLayers:1},n.optimizationMode,l),e.abrupt("return",(a.onSuccess([t.getTrackId(),n.getTrackId()]),Rl.info(cs(m="create camera video track(".concat(l,") and microphone audio track(")).call(m,u,") success")),[t,n]));case 23:case"end":return e.stop()}}),e,null,[[5,13]])})));function t(){return e.apply(this,arguments)}return t}(),createMicrophoneAudioTrack:function(){var e=m(v.mark((function e(){var t,n,r,i,o,a=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.length>0&&void 0!==a[0]?a[0]:{},n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_MIC_AUDIO_TRACK,options:[t]}),r=Nn(t),i=vt(8,"track-"),o=null,Rl.info("start create microphone audio track with config",Yr(t),"trackId",i),e.prev=5,e.next=8,Lt({audio:r},i);case 8:if(e.t0=e.sent.getAudioTracks()[0],e.t0){e.next=11;break}e.t0=null;case 11:o=e.t0,e.next=17;break;case 14:throw e.prev=14,e.t1=e.catch(5),n.onError(e.t1),e.t1;case 17:if(o){e.next=19;break}return e.abrupt("return",(i=new Al($u.UNEXPECTED_ERROR,"can not find track in media stream"),n.onError(i),i.throw()));case 19:return t=new nh(o,t,r,i),e.abrupt("return",(n.onSuccess(t.getTrackId()),Rl.info("create microphone audio track success, trackId:",i),t));case 21:case"end":return e.stop()}}),e,null,[[5,14]])})));function t(){return e.apply(this,arguments)}return t}(),createCustomAudioTrack:function(e){var t=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_CUSTOM_AUDIO_TRACK,options:[e]}),n=new th(e.mediaStreamTrack,e.encoderConfig?_e(e.encoderConfig):{});return Rl.info("create custom audio track success with config",e,"trackId",n.getTrackId()),t.onSuccess(n.getTrackId()),n},createBufferSourceAudioTrack:function(){var e=m(v.mark((function e(t){var n,r,i,o;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CREATE_BUFFER_AUDIO_TRACK,options:[t]}),r=vt(8,"track-"),Rl.info("start create buffer source audio track with config",Yr(t),"trackId",r),i=t.source,t.source instanceof AudioBuffer){e.next=13;break}return e.prev=4,e.next=7,Qn(t.source,t.cacheOnlineFile);case 7:t.source=e.sent,e.next=13;break;case 10:return e.prev=10,e.t0=e.catch(4),e.abrupt("return",(n.onError(e.t0),e.t0.throw()));case 13:return o=new gp(t.source),t=new rh(i,o,t.encoderConfig?_e(t.encoderConfig):{},r),e.abrupt("return",(Rl.info("create buffer source audio track success, trackId:",r),n.onSuccess(t.getTrackId()),t));case 16:case"end":return e.stop()}}),e,null,[[4,10]])})));function t(t){return e.apply(this,arguments)}return t}(),setLogLevel:function(e){Rl.setLogLevel(e)},enableLogUpload:function(){Rl.enableLogUpload()},disableLogUpload:function(){Rl.disableLogUpload()},createChannelMediaRelayConfiguration:function(){return new lp},checkAudioTrackIsActive:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c,u=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=u.length>1&&void 0!==u[1]?u[1]:5e3,r=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CHECK_AUDIO_TRACK_IS_ACTIVE,options:[n]}),t instanceof th||t instanceof ap){e.next=5;break}return i=new Al($u.INVALID_TRACK,"the parameter is not a audio track"),e.abrupt("return",(r.onError(i),i.throw()));case 5:return n&&1e3>n&&(n=1e3),o=t instanceof th?t.getTrackLabel():"remote_track",a=i=t.getVolumeLevel(),s=i,c=gf(),e.abrupt("return",new kc((function(e){var i=_p((function(){var u=t.getVolumeLevel();u=1e-4<(a=u>a?u:a)-(s=u<s?u:s);var l,d=gf()-c;(u||d>n)&&(clearInterval(i),d={duration:d,deviceLabel:o,maxVolumeLevel:a,result:u},Rl.info(cs(l="[track-".concat(t.getTrackId(),"] check audio track active completed. ")).call(l,Yr(d))),r.onSuccess(d),e(u))}),200)})));case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}(),checkVideoTrackIsActive:function(){var e=m(v.mark((function e(t){var n,r,i,o,a,s,c,u,l,d=arguments;return v.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:5e3,i=Ff.reportApiInvoke(null,{tag:Pl.TRACER,name:Nl.CHECK_VIDEO_TRACK_IS_ACTIVE,options:[n]}),t instanceof Jh||t instanceof op){e.next=4;break}return e.abrupt("return",(t=new Al($u.INVALID_TRACK,"the parameter is not a video track"),i.onError(t),t.throw()));case 4:return n&&1e3>n&&(n=1e3),o=t instanceof Jh?t.getTrackLabel():"remote_track",a=t.getMediaStreamTrack(),(s=document.createElement("video")).style.width="1px",s.style.height="1px",s.setAttribute("muted",""),s.muted=!0,s.setAttribute("playsinline",""),s.controls=!1,bp===wu.SAFARI&&(s.style.opacity="0.01",s.style.position="fixed",s.style.left="0",s.style.top="0",document.body.appendChild(s)),s.srcObject=new MediaStream([a]),s.play(),(c=document.createElement("canvas")).width=160,c.height=120,u=a=0,e.prev=20,l=gf(),e.next=24,function(e,t,n,r){var i,o=0,a=null;return new kc((function(s,c){jf((function(){i&&(i(),s(o))}),t),i=en((function(){e:{o>r&&i&&(i(),s(o));var t=n.getContext("2d");if(t){t.drawImage(e,0,0,160,120),t=t.getImageData(0,0,n.width,n.height);var u=Math.floor(t.data.length/3);if(a)for(var l=0;l<u;l+=3)if(t.data[l]!==a[l]){o+=1,a=t.data;break e}a=t.data}else t=new Al($u.UNEXPECTED_ERROR,"can not get canvas 2d context."),Rl.error(t.toString()),c(t)}}),30)}))}(s,n,c,4);case 24:a=e.sent,u=gf()-l,e.next=31;break;case 28:throw e.prev=28,e.t0=e.catch(20),i.onError(e.t0),e.t0;case 31:return bp===wu.SAFARI&&(s.pause(),s.remove()),s.srcObject=null,o={duration:u,changedPicNum:a,deviceLabel:o,result:n=4<a},e.abrupt("return",(Rl.info(cs(r="[track-".concat(t.getTrackId(),"] check video track active completed. ")).call(r,Yr(o))),i.onSuccess(o),n));case 36:case"end":return e.stop()}}),e,null,[[20,28]])})));function t(t){return e.apply(this,arguments)}return t}(),setArea:function(e){var t;"string"==typeof e&&(e=[e]),ba(e).call(e,(function(e){if(!uu(yd).call(yd,e))throw new Al($u.INVALID_PARAMS,"invalid area code")})),be("AREAS",e);var n=function(e){var t={CODE:"",WEBCS_DOMAIN:[],WEBCS_DOMAIN_BACKUP_LIST:[],PROXY_CS:[],CDS_AP:[],ACCOUNT_REGISTER:[],UAP_AP:[],EVENT_REPORT_DOMAIN:[],EVENT_REPORT_BACKUP_DOMAIN:[],LOG_UPLOAD_SERVER:[],PROXY_SERVER_TYPE3:[]};return Pc(e).call(e,(function(e){var n=bd[e];(e=Ra(n))&&Pc(e).call(e,(function(e){var r;"CODE"!==e&&(t[e]=cs(r=t[e]).call(r,n[e]))}))})),t}(e);Pc(t=Ra(n)).call(t,(function(e){be(e,"LOG_UPLOAD_SERVER"===e||"EVENT_REPORT_DOMAIN"===e||"EVENT_REPORT_BACKUP_DOMAIN"===e||"PROXY_SERVER_TYPE3"===e?n[e][0]:n[e])})),Rl.debug("set area success:",e.join(","))},startProcessingLocalAEC:function(e){kp.startProcessingLocalAEC(e)}};return Df.on(xl.CAMERA_DEVICE_CHANGED,(function(e){Rl.info("camera device changed",Yr(e)),Op.onCameraChanged&&Op.onCameraChanged(e)})),Df.on(xl.RECORDING_DEVICE_CHANGED,(function(e){Rl.info("microphone device changed",Yr(e)),Op.onMicrophoneChanged&&Op.onMicrophoneChanged(e)})),Df.on(xl.PLAYOUT_DEVICE_CHANGED,(function(e){Rl.debug("playout device changed",Yr(e)),Op.onPlaybackDeviceChanged&&Op.onPlaybackDeviceChanged(e)})),eh.onAutoplayFailed=function(){Rl.info("detect audio element autoplay failed"),Op.onAudioAutoplayFailed&&Op.onAudioAutoplayFailed()},Xf.on("autoplay-failed",(function(){Rl.info("detect webaudio autoplay failed"),Op.onAudioAutoplayFailed&&Op.onAudioAutoplayFailed()})),Op}()}).call(this,n(33),n(38))},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(36);var i=n(41);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var c,u=[],l=!1,d=-1;function f(){l&&c&&(l=!1,c.length?u=c.concat(u):d=-1,u.length&&h())}function h(){if(!l){var e=s(f);l=!0;for(var t=u.length;t;){for(c=u,u=[];++d<t;)c&&c[d].run();d=-1,t=u.length}c=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function v(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new p(e,t)),1!==u.length||l||s(h)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=v,i.addListener=v,i.once=v,i.off=v,i.removeListener=v,i.removeAllListeners=v,i.emit=v,i.prependListener=v,i.prependOnceListener=v,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(62)},function(e,t,n){"use strict";var r=n(11);t.a=function(e,t){var n;void 0===t&&(t=!0);var i=new Promise((function(r){n=setTimeout(r,e,t)}));return i[r.a]=function(){clearTimeout(n)},i}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(36);function i(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},,function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var n,s,c=a(e),u=1;u<arguments.length;u++){for(var l in n=Object(arguments[u]))i.call(n,l)&&(c[l]=n[l]);if(r){s=r(n);for(var d=0;d<s.length;d++)o.call(n,s[d])&&(c[s[d]]=n[s[d]])}}return c}},function(e,t,n){var r=n(51);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t,n){"use strict";(function(e,r){var i,o=n(57);i="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:r;var a=Object(o.a)(i);t.a=a}).call(this,n(33),n(50)(e))},function(e,t,n){"use strict";(function(e){var r=n(2),i=n.n(r),o=n(24),a=n(34),s=n.n(a),c=1073741823,u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof e?e:{};function l(e){var t=[];return{on:function(e){t.push(e)},off:function(e){t=t.filter((function(t){return t!==e}))},get:function(){return e},set:function(n,r){e=n,t.forEach((function(t){return t(e,r)}))}}}var d=i.a.createContext||function(e,t){var n,i,a="__create-react-context-"+function(){var e="__global_unique_id__";return u[e]=(u[e]||0)+1}()+"__",d=function(e){function n(){var t;return(t=e.apply(this,arguments)||this).emitter=l(t.props.value),t}Object(o.a)(n,e);var r=n.prototype;return r.getChildContext=function(){var e;return(e={})[a]=this.emitter,e},r.componentWillReceiveProps=function(e){if(this.props.value!==e.value){var n,r=this.props.value,i=e.value;((o=r)===(a=i)?0!==o||1/o===1/a:o!==o&&a!==a)?n=0:(n="function"===typeof t?t(r,i):c,0!==(n|=0)&&this.emitter.set(e.value,n))}var o,a},r.render=function(){return this.props.children},n}(r.Component);d.childContextTypes=((n={})[a]=s.a.object.isRequired,n);var f=function(t){function n(){var e;return(e=t.apply(this,arguments)||this).state={value:e.getValue()},e.onUpdate=function(t,n){0!==((0|e.observedBits)&n)&&e.setState({value:e.getValue()})},e}Object(o.a)(n,t);var r=n.prototype;return r.componentWillReceiveProps=function(e){var t=e.observedBits;this.observedBits=void 0===t||null===t?c:t},r.componentDidMount=function(){this.context[a]&&this.context[a].on(this.onUpdate);var e=this.props.observedBits;this.observedBits=void 0===e||null===e?c:e},r.componentWillUnmount=function(){this.context[a]&&this.context[a].off(this.onUpdate)},r.getValue=function(){return this.context[a]?this.context[a].get():e},r.render=function(){return(e=this.props.children,Array.isArray(e)?e[0]:e)(this.state.value);var e},n}(r.Component);return f.contextTypes=((i={})[a]=s.a.object,i),{Provider:d,Consumer:f}};t.a=d}).call(this,n(33))},function(e,t,n){var r=n(72);e.exports=h,e.exports.parse=o,e.exports.compile=function(e,t){return s(o(e,t),t)},e.exports.tokensToFunction=s,e.exports.tokensToRegExp=f;var i=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function o(e,t){for(var n,r=[],o=0,a=0,s="",l=t&&t.delimiter||"/";null!=(n=i.exec(e));){var d=n[0],f=n[1],h=n.index;if(s+=e.slice(a,h),a=h+d.length,f)s+=f[1];else{var p=e[a],v=n[2],m=n[3],g=n[4],y=n[5],_=n[6],b=n[7];s&&(r.push(s),s="");var E=null!=v&&null!=p&&p!==v,w="+"===_||"*"===_,T="?"===_||"*"===_,S=n[2]||l,I=g||y;r.push({name:m||o++,prefix:v||"",delimiter:S,optional:T,repeat:w,partial:E,asterisk:!!b,pattern:I?u(I):b?".*":"[^"+c(S)+"]+?"})}}return a<e.length&&(s+=e.substr(a)),s&&r.push(s),r}function a(e){return encodeURI(e).replace(/[\/?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()}))}function s(e,t){for(var n=new Array(e.length),i=0;i<e.length;i++)"object"===typeof e[i]&&(n[i]=new RegExp("^(?:"+e[i].pattern+")$",d(t)));return function(t,i){for(var o="",s=t||{},c=(i||{}).pretty?a:encodeURIComponent,u=0;u<e.length;u++){var l=e[u];if("string"!==typeof l){var d,f=s[l.name];if(null==f){if(l.optional){l.partial&&(o+=l.prefix);continue}throw new TypeError('Expected "'+l.name+'" to be defined')}if(r(f)){if(!l.repeat)throw new TypeError('Expected "'+l.name+'" to not repeat, but received `'+JSON.stringify(f)+"`");if(0===f.length){if(l.optional)continue;throw new TypeError('Expected "'+l.name+'" to not be empty')}for(var h=0;h<f.length;h++){if(d=c(f[h]),!n[u].test(d))throw new TypeError('Expected all "'+l.name+'" to match "'+l.pattern+'", but received `'+JSON.stringify(d)+"`");o+=(0===h?l.prefix:l.delimiter)+d}}else{if(d=l.asterisk?encodeURI(f).replace(/[?#]/g,(function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()})):c(f),!n[u].test(d))throw new TypeError('Expected "'+l.name+'" to match "'+l.pattern+'", but received "'+d+'"');o+=l.prefix+d}}else o+=l}return o}}function c(e){return e.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function u(e){return e.replace(/([=!:$\/()])/g,"\\$1")}function l(e,t){return e.keys=t,e}function d(e){return e&&e.sensitive?"":"i"}function f(e,t,n){r(t)||(n=t||n,t=[]);for(var i=(n=n||{}).strict,o=!1!==n.end,a="",s=0;s<e.length;s++){var u=e[s];if("string"===typeof u)a+=c(u);else{var f=c(u.prefix),h="(?:"+u.pattern+")";t.push(u),u.repeat&&(h+="(?:"+f+h+")*"),a+=h=u.optional?u.partial?f+"("+h+")?":"(?:"+f+"("+h+"))?":f+"("+h+")"}}var p=c(n.delimiter||"/"),v=a.slice(-p.length)===p;return i||(a=(v?a.slice(0,-p.length):a)+"(?:"+p+"(?=$))?"),a+=o?"$":i&&v?"":"(?="+p+"|$)",l(new RegExp("^"+a,d(n)),t)}function h(e,t,n){return r(t)||(n=t||n,t=[]),n=n||{},e instanceof RegExp?function(e,t){var n=e.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)t.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return l(e,t)}(e,t):r(e)?function(e,t,n){for(var r=[],i=0;i<e.length;i++)r.push(h(e[i],t,n).source);return l(new RegExp("(?:"+r.join("|")+")",d(n)),t)}(e,t,n):function(e,t,n){return f(o(e,n),t,n)}(e,t,n)}},function(e,t,n){"use strict";var r=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|download|draggable|encType|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|inert|itemProp|itemScope|itemType|itemID|itemRef|on|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,i=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){return r.test(e)||111===e.charCodeAt(0)&&110===e.charCodeAt(1)&&e.charCodeAt(2)<91}));t.a=i},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){var r=n(78),i=n(53);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!==typeof t?i(e):t}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t,n,r){var i=n?n.call(r,e,t):void 0;if(void 0!==i)return!!i;if(e===t)return!0;if("object"!==typeof e||!e||"object"!==typeof t||!t)return!1;var o=Object.keys(e),a=Object.keys(t);if(o.length!==a.length)return!1;for(var s=Object.prototype.hasOwnProperty.bind(t),c=0;c<o.length;c++){var u=o[c];if(!s(u))return!1;var l=e[u],d=t[u];if(!1===(i=n?n.call(r,l,d,u):void 0)||void 0===i&&l!==d)return!1}return!0}},function(e,t,n){"use strict";t.a=function(e){function t(e,r,c,u,f){for(var h,p,v,m,b,w=0,T=0,S=0,I=0,R=0,P=0,x=v=h=0,M=0,U=0,j=0,F=0,V=c.length,B=V-1,W="",G="",q="",K="";M<V;){if(p=c.charCodeAt(M),M===B&&0!==T+I+S+w&&(0!==T&&(p=47===T?10:47),I=S=w=0,V++,B++),0===T+I+S+w){if(M===B&&(0<U&&(W=W.replace(d,"")),0<W.trim().length)){switch(p){case 32:case 9:case 59:case 13:case 10:break;default:W+=c.charAt(M)}p=59}switch(p){case 123:for(h=(W=W.trim()).charCodeAt(0),v=1,F=++M;M<V;){switch(p=c.charCodeAt(M)){case 123:v++;break;case 125:v--;break;case 47:switch(p=c.charCodeAt(M+1)){case 42:case 47:e:{for(x=M+1;x<B;++x)switch(c.charCodeAt(x)){case 47:if(42===p&&42===c.charCodeAt(x-1)&&M+2!==x){M=x+1;break e}break;case 10:if(47===p){M=x+1;break e}}M=x}}break;case 91:p++;case 40:p++;case 34:case 39:for(;M++<B&&c.charCodeAt(M)!==p;);}if(0===v)break;M++}switch(v=c.substring(F,M),0===h&&(h=(W=W.replace(l,"").trim()).charCodeAt(0)),h){case 64:switch(0<U&&(W=W.replace(d,"")),p=W.charCodeAt(1)){case 100:case 109:case 115:case 45:U=r;break;default:U=N}if(F=(v=t(r,U,v,p,f+1)).length,0<D&&(b=s(3,v,U=n(N,W,j),r,C,A,F,p,f,u),W=U.join(""),void 0!==b&&0===(F=(v=b.trim()).length)&&(p=0,v="")),0<F)switch(p){case 115:W=W.replace(E,a);case 100:case 109:case 45:v=W+"{"+v+"}";break;case 107:v=(W=W.replace(g,"$1 $2"))+"{"+v+"}",v=1===O||2===O&&o("@"+v,3)?"@-webkit-"+v+"@"+v:"@"+v;break;default:v=W+v,112===u&&(G+=v,v="")}else v="";break;default:v=t(r,n(r,W,j),v,u,f+1)}q+=v,v=j=U=x=h=0,W="",p=c.charCodeAt(++M);break;case 125:case 59:if(1<(F=(W=(0<U?W.replace(d,""):W).trim()).length))switch(0===x&&(h=W.charCodeAt(0),45===h||96<h&&123>h)&&(F=(W=W.replace(" ",":")).length),0<D&&void 0!==(b=s(1,W,r,e,C,A,G.length,u,f,u))&&0===(F=(W=b.trim()).length)&&(W="\0\0"),h=W.charCodeAt(0),p=W.charCodeAt(1),h){case 0:break;case 64:if(105===p||99===p){K+=W+c.charAt(M);break}default:58!==W.charCodeAt(F-1)&&(G+=i(W,h,p,W.charCodeAt(2)))}j=U=x=h=0,W="",p=c.charCodeAt(++M)}}switch(p){case 13:case 10:47===T?T=0:0===1+h&&107!==u&&0<W.length&&(U=1,W+="\0"),0<D*L&&s(0,W,r,e,C,A,G.length,u,f,u),A=1,C++;break;case 59:case 125:if(0===T+I+S+w){A++;break}default:switch(A++,m=c.charAt(M),p){case 9:case 32:if(0===I+w+T)switch(R){case 44:case 58:case 9:case 32:m="";break;default:32!==p&&(m=" ")}break;case 0:m="\\0";break;case 12:m="\\f";break;case 11:m="\\v";break;case 38:0===I+T+w&&(U=j=1,m="\f"+m);break;case 108:if(0===I+T+w+k&&0<x)switch(M-x){case 2:112===R&&58===c.charCodeAt(M-3)&&(k=R);case 8:111===P&&(k=P)}break;case 58:0===I+T+w&&(x=M);break;case 44:0===T+S+I+w&&(U=1,m+="\r");break;case 34:case 39:0===T&&(I=I===p?0:0===I?p:I);break;case 91:0===I+T+S&&w++;break;case 93:0===I+T+S&&w--;break;case 41:0===I+T+w&&S--;break;case 40:if(0===I+T+w){if(0===h)switch(2*R+3*P){case 533:break;default:h=1}S++}break;case 64:0===T+S+I+w+x+v&&(v=1);break;case 42:case 47:if(!(0<I+w+S))switch(T){case 0:switch(2*p+3*c.charCodeAt(M+1)){case 235:T=47;break;case 220:F=M,T=42}break;case 42:47===p&&42===R&&F+2!==M&&(33===c.charCodeAt(F+2)&&(G+=c.substring(F,M+1)),m="",T=0)}}0===T&&(W+=m)}P=R,R=p,M++}if(0<(F=G.length)){if(U=r,0<D&&(void 0!==(b=s(2,G,U,e,C,A,F,u,f,u))&&0===(G=b).length))return K+G+q;if(G=U.join(",")+"{"+G+"}",0!==O*k){switch(2!==O||o(G,2)||(k=0),k){case 111:G=G.replace(_,":-moz-$1")+G;break;case 112:G=G.replace(y,"::-webkit-input-$1")+G.replace(y,"::-moz-$1")+G.replace(y,":-ms-input-$1")+G}k=0}}return K+G+q}function n(e,t,n){var i=t.trim().split(v);t=i;var o=i.length,a=e.length;switch(a){case 0:case 1:var s=0;for(e=0===a?"":e[0]+" ";s<o;++s)t[s]=r(e,t[s],n).trim();break;default:var c=s=0;for(t=[];s<o;++s)for(var u=0;u<a;++u)t[c++]=r(e[u]+" ",i[s],n).trim()}return t}function r(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(m,"$1"+e.trim());case 58:return e.trim()+t.replace(m,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(m,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function i(e,t,n,r){var a=e+";",s=2*t+3*n+4*r;if(944===s){e=a.indexOf(":",9)+1;var c=a.substring(e,a.length-1).trim();return c=a.substring(0,e).trim()+c+";",1===O||2===O&&o(c,1)?"-webkit-"+c+c:c}if(0===O||2===O&&!o(a,1))return a;switch(s){case 1015:return 97===a.charCodeAt(10)?"-webkit-"+a+a:a;case 951:return 116===a.charCodeAt(3)?"-webkit-"+a+a:a;case 963:return 110===a.charCodeAt(5)?"-webkit-"+a+a:a;case 1009:if(100!==a.charCodeAt(4))break;case 969:case 942:return"-webkit-"+a+a;case 978:return"-webkit-"+a+"-moz-"+a+a;case 1019:case 983:return"-webkit-"+a+"-moz-"+a+"-ms-"+a+a;case 883:if(45===a.charCodeAt(8))return"-webkit-"+a+a;if(0<a.indexOf("image-set(",11))return a.replace(R,"$1-webkit-$2")+a;break;case 932:if(45===a.charCodeAt(4))switch(a.charCodeAt(5)){case 103:return"-webkit-box-"+a.replace("-grow","")+"-webkit-"+a+"-ms-"+a.replace("grow","positive")+a;case 115:return"-webkit-"+a+"-ms-"+a.replace("shrink","negative")+a;case 98:return"-webkit-"+a+"-ms-"+a.replace("basis","preferred-size")+a}return"-webkit-"+a+"-ms-"+a+a;case 964:return"-webkit-"+a+"-ms-flex-"+a+a;case 1023:if(99!==a.charCodeAt(8))break;return"-webkit-box-pack"+(c=a.substring(a.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+a+"-ms-flex-pack"+c+a;case 1005:return h.test(a)?a.replace(f,":-webkit-")+a.replace(f,":-moz-")+a:a;case 1e3:switch(t=(c=a.substring(13).trim()).indexOf("-")+1,c.charCodeAt(0)+c.charCodeAt(t)){case 226:c=a.replace(b,"tb");break;case 232:c=a.replace(b,"tb-rl");break;case 220:c=a.replace(b,"lr");break;default:return a}return"-webkit-"+a+"-ms-"+c+a;case 1017:if(-1===a.indexOf("sticky",9))break;case 975:switch(t=(a=e).length-10,s=(c=(33===a.charCodeAt(t)?a.substring(0,t):a).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|c.charCodeAt(7))){case 203:if(111>c.charCodeAt(8))break;case 115:a=a.replace(c,"-webkit-"+c)+";"+a;break;case 207:case 102:a=a.replace(c,"-webkit-"+(102<s?"inline-":"")+"box")+";"+a.replace(c,"-webkit-"+c)+";"+a.replace(c,"-ms-"+c+"box")+";"+a}return a+";";case 938:if(45===a.charCodeAt(5))switch(a.charCodeAt(6)){case 105:return c=a.replace("-items",""),"-webkit-"+a+"-webkit-box-"+c+"-ms-flex-"+c+a;case 115:return"-webkit-"+a+"-ms-flex-item-"+a.replace(T,"")+a;default:return"-webkit-"+a+"-ms-flex-line-pack"+a.replace("align-content","").replace(T,"")+a}break;case 973:case 989:if(45!==a.charCodeAt(3)||122===a.charCodeAt(4))break;case 931:case 953:if(!0===I.test(e))return 115===(c=e.substring(e.indexOf(":")+1)).charCodeAt(0)?i(e.replace("stretch","fill-available"),t,n,r).replace(":fill-available",":stretch"):a.replace(c,"-webkit-"+c)+a.replace(c,"-moz-"+c.replace("fill-",""))+a;break;case 962:if(a="-webkit-"+a+(102===a.charCodeAt(5)?"-ms-"+a:"")+a,211===n+r&&105===a.charCodeAt(13)&&0<a.indexOf("transform",10))return a.substring(0,a.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+a}return a}function o(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),x(2!==t?r:r.replace(S,"$1"),n,t)}function a(e,t){var n=i(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(w," or ($1)").substring(4):"("+t+")"}function s(e,t,n,r,i,o,a,s,c,l){for(var d,f=0,h=t;f<D;++f)switch(d=P[f].call(u,e,h,n,r,i,o,a,s,c,l)){case void 0:case!1:case!0:case null:break;default:h=d}if(h!==t)return h}function c(e){return void 0!==(e=e.prefix)&&(x=null,e?"function"!==typeof e?O=1:(O=2,x=e):O=0),c}function u(e,n){var r=e;if(33>r.charCodeAt(0)&&(r=r.trim()),r=[r],0<D){var i=s(-1,n,r,r,C,A,0,0,0,0);void 0!==i&&"string"===typeof i&&(n=i)}var o=t(N,r,n,0,0);return 0<D&&(void 0!==(i=s(-2,o,r,r,C,A,o.length,0,0,0))&&(o=i)),"",k=0,A=C=1,o}var l=/^\0+/g,d=/[\0\r\f]/g,f=/: */g,h=/zoo|gra/,p=/([,: ])(transform)/g,v=/,\r+?/g,m=/([\t\r\n ])*\f?&/g,g=/@(k\w+)\s*(\S*)\s*/,y=/::(place)/g,_=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,E=/\(\s*(.*)\s*\)/g,w=/([\s\S]*?);/g,T=/-self|flex-/g,S=/[^]*?(:[rp][el]a[\w-]+)[^]*/,I=/stretch|:\s*\w+\-(?:conte|avail)/,R=/([^-])(image-set\()/,A=1,C=1,k=0,O=1,N=[],P=[],D=0,x=null,L=0;return u.use=function e(t){switch(t){case void 0:case null:D=P.length=0;break;default:if("function"===typeof t)P[D++]=t;else if("object"===typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else L=0|!!t}return e},u.set=c,void 0!==e&&c(e),u}},function(e,t,n){"use strict";t.a={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1}},function(e,t,n){"use strict";function r(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function i(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}Object.create;Object.create},function(e,t,n){"use strict";n.d(t,"a",(function(){return o.a}));var r,i,o=n(5),a=(n(70),n(71),n(0)),s=n(14),c=(n(20),n(18)),u=n(16),l={Firestore:c.a,GeoPoint:c.r,Timestamp:c.l,Blob:c.s,Transaction:c.b,WriteBatch:c.o,DocumentReference:c.g,DocumentSnapshot:c.c,Query:c.d,QueryDocumentSnapshot:c.t,QuerySnapshot:c.i,CollectionReference:c.h,FieldPath:c.q,FieldValue:c.k,setLogLevel:c.e,CACHE_SIZE_UNLIMITED:c.j};(function(e,t){e.INTERNAL.registerComponent(new u.a("firestore",(function(e){return function(e,t){return new c.a(e,new c.m(e,t),new c.f)}(e.getProvider("app").getImmediate(),e.getProvider("auth-internal"))}),"PUBLIC").setServiceProps(Object.assign({},l)))})(r=o.a),r.registerVersion("@firebase/firestore","2.2.4"),(i=c.a).prototype.loadBundle=c.n,i.prototype.namedQuery=c.p;var d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function f(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function h(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;Object.create;var p={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},v=function(e){function t(n,r,i){var o=e.call(this,r)||this;return Object.setPrototypeOf(o,t.prototype),o.code=n,o.details=i,o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(Error);var m=function(){function e(e,t){var n=this;this.auth=null,this.messaging=null,this.auth=e.getImmediate({optional:!0}),this.messaging=t.getImmediate({optional:!0}),this.auth||e.get().then((function(e){return n.auth=e}),(function(){})),this.messaging||t.get().then((function(e){return n.messaging=e}),(function(){}))}return e.prototype.getAuthToken=function(){return f(this,void 0,void 0,(function(){var e;return h(this,(function(t){switch(t.label){case 0:if(!this.auth)return[2,void 0];t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.auth.getToken()];case 2:return(e=t.sent())?[2,e.accessToken]:[2,void 0];case 3:return t.sent(),[2,void 0];case 4:return[2]}}))}))},e.prototype.getInstanceIdToken=function(){return f(this,void 0,void 0,(function(){return h(this,(function(e){if(!this.messaging||!("Notification"in self)||"granted"!==Notification.permission)return[2,void 0];try{return[2,this.messaging.getToken()]}catch(r){return[2,void 0]}return[2]}))}))},e.prototype.getContext=function(){return f(this,void 0,void 0,(function(){var e,t;return h(this,(function(n){switch(n.label){case 0:return[4,this.getAuthToken()];case 1:return e=n.sent(),[4,this.getInstanceIdToken()];case 2:return t=n.sent(),[2,{authToken:e,instanceIdToken:t}]}}))}))},e}();function g(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=t(e[r]));return n}var y=function(){function e(){}return e.prototype.encode=function(e){var t=this;if(null==e)return null;if(e instanceof Number&&(e=e.valueOf()),"number"===typeof e&&isFinite(e))return e;if(!0===e||!1===e)return e;if("[object String]"===Object.prototype.toString.call(e))return e;if(Array.isArray(e))return e.map((function(e){return t.encode(e)}));if("function"===typeof e||"object"===typeof e)return g(e,(function(e){return t.encode(e)}));throw new Error("Data cannot be encoded in JSON: "+e)},e.prototype.decode=function(e){var t=this;if(null==e)return e;if(e["@type"])switch(e["@type"]){case"type.googleapis.com/google.protobuf.Int64Value":case"type.googleapis.com/google.protobuf.UInt64Value":var n=Number(e.value);if(isNaN(n))throw new Error("Data cannot be decoded from JSON: "+e);return n;default:throw new Error("Data cannot be decoded from JSON: "+e)}return Array.isArray(e)?e.map((function(e){return t.decode(e)})):"function"===typeof e||"object"===typeof e?g(e,(function(e){return t.decode(e)})):e},e}();var _=function(){function e(e,t,n,i,o){var a=this;void 0===i&&(i="us-central1"),this.app_=e,this.fetchImpl=o,this.serializer=new y,this.emulatorOrigin=null,this.INTERNAL={delete:function(){return Promise.resolve(a.deleteService())}},this.contextProvider=new m(t,n),this.cancelAllRequests=new Promise((function(e){a.deleteService=function(){return e()}}));try{var s=new URL(i);this.customDomain=s.origin,this.region="us-central1"}catch(r){this.customDomain=null,this.region=i}}return Object.defineProperty(e.prototype,"app",{get:function(){return this.app_},enumerable:!1,configurable:!0}),e.prototype._url=function(e){var t=this.app_.options.projectId;return null!==this.emulatorOrigin?this.emulatorOrigin+"/"+t+"/"+this.region+"/"+e:null!==this.customDomain?this.customDomain+"/"+e:"https://"+this.region+"-"+t+".cloudfunctions.net/"+e},e.prototype.useEmulator=function(e,t){this.emulatorOrigin="http://"+e+":"+t},e.prototype.useFunctionsEmulator=function(e){this.emulatorOrigin=e},e.prototype.httpsCallable=function(e,t){var n=this;return function(r){return n.call(e,r,t||{})}},e.prototype.postJSON=function(e,t,n){return f(this,void 0,void 0,(function(){var r,i;return h(this,(function(o){switch(o.label){case 0:n["Content-Type"]="application/json",o.label=1;case 1:return o.trys.push([1,3,,4]),[4,this.fetchImpl(e,{method:"POST",body:JSON.stringify(t),headers:n})];case 2:return r=o.sent(),[3,4];case 3:return o.sent(),[2,{status:0,json:null}];case 4:i=null,o.label=5;case 5:return o.trys.push([5,7,,8]),[4,r.json()];case 6:return i=o.sent(),[3,8];case 7:return o.sent(),[3,8];case 8:return[2,{status:r.status,json:i}]}}))}))},e.prototype.call=function(e,t,n){return f(this,void 0,void 0,(function(){var i,o,a,s,c,u,l,d,f,m,g;return h(this,(function(h){switch(h.label){case 0:return i=this._url(e),t=this.serializer.encode(t),o={data:t},a={},[4,this.contextProvider.getContext()];case 1:return(s=h.sent()).authToken&&(a.Authorization="Bearer "+s.authToken),s.instanceIdToken&&(a["Firebase-Instance-ID-Token"]=s.instanceIdToken),c=n.timeout||7e4,u=function(e){var t,n=new Promise((function(n,r){t=setTimeout((function(){r(new v("deadline-exceeded","deadline-exceeded"))}),e)}));return{timer:t,promise:n}}(c),l=u.timer,d=u.promise,[4,Promise.race([b(l,this.postJSON(i,o,a)),d,b(l,this.cancelAllRequests)])];case 2:if(!(f=h.sent()))throw new v("cancelled","Firebase Functions instance was deleted.");if(m=function(e,t,n){var i=function(e){if(e>=200&&e<300)return"ok";switch(e){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}(e),o=i,a=void 0;try{var s=t&&t.error;if(s){var c=s.status;if("string"===typeof c){if(!p[c])return new v("internal","internal");i=p[c],o=c}var u=s.message;"string"===typeof u&&(o=u),void 0!==(a=s.details)&&(a=n.decode(a))}}catch(r){}return"ok"===i?null:new v(i,o,a)}(f.status,f.json,this.serializer))throw m;if(!f.json)throw new v("internal","Response is not valid JSON object.");if("undefined"===typeof(g=f.json.data)&&(g=f.json.result),"undefined"===typeof g)throw new v("internal","Response is missing data field.");return[2,{data:this.serializer.decode(g)}]}}))}))},e}();function b(e,t){return f(this,void 0,void 0,(function(){var n;return h(this,(function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),clearTimeout(e),[2,n]}}))}))}!function(e,t){var n={Functions:_};e.INTERNAL.registerComponent(new u.a("functions",(function(e,n){var r=n.instanceIdentifier,i=e.getProvider("app").getImmediate(),o=e.getProvider("auth-internal"),a=e.getProvider("messaging");return new _(i,o,a,r,t)}),"PUBLIC").setServiceProps(n).setMultipleInstances(!0))}(o.a,fetch.bind(self)),o.a.registerVersion("@firebase/functions","0.6.7");var E=function(){return(E=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function w(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function T(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function S(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function I(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}Object.create;var R,A=n(30),C="0.4.25",k=1e4,O="w:0.4.25",N="FIS_v2",P=36e5,D=((R={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',R["not-registered"]="Firebase Installation is not registered.",R["installation-not-found"]="Firebase Installation not found.",R["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',R["app-offline"]="Could not process request. Application offline.",R["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",R),x=new a.b("installations","Installations",D);function L(e){return e instanceof a.c&&e.code.includes("request-failed")}function M(e){return"https://firebaseinstallations.googleapis.com/v1/projects/"+e.projectId+"/installations"}function U(e){return{token:e.token,requestStatus:2,expiresIn:(t=e.expiresIn,Number(t.replace("s","000"))),creationTime:Date.now()};var t}function j(e,t){return w(this,void 0,void 0,(function(){var n,r;return T(this,(function(i){switch(i.label){case 0:return[4,t.json()];case 1:return n=i.sent(),r=n.error,[2,x.create("request-failed",{requestName:e,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}}))}))}function F(e){var t=e.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function V(e,t){var n=t.refreshToken,r=F(e);return r.append("Authorization",function(e){return"FIS_v2 "+e}(n)),r}function B(e){return w(this,void 0,void 0,(function(){var t;return T(this,(function(n){switch(n.label){case 0:return[4,e()];case 1:return(t=n.sent()).status>=500&&t.status<600?[2,e()]:[2,t]}}))}))}function W(e,t){var n=t.fid;return w(this,void 0,void 0,(function(){var t,r,i,o,a,s;return T(this,(function(c){switch(c.label){case 0:return t=M(e),r=F(e),i={fid:n,authVersion:N,appId:e.appId,sdkVersion:O},o={method:"POST",headers:r,body:JSON.stringify(i)},[4,B((function(){return fetch(t,o)}))];case 1:return(a=c.sent()).ok?[4,a.json()]:[3,3];case 2:return s=c.sent(),[2,{fid:s.fid||n,registrationStatus:2,refreshToken:s.refreshToken,authToken:U(s.authToken)}];case 3:return[4,j("Create Installation",a)];case 4:throw c.sent()}}))}))}function G(e){return new Promise((function(t){setTimeout(t,e)}))}var q=/^[cdef][\w-]{21}$/;function K(){try{var e=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(e),e[0]=112+e[0]%16;var t=function(e){return(t=e,btoa(String.fromCharCode.apply(String,function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}([],I(t)))).replace(/\+/g,"-").replace(/\//g,"_")).substr(0,22);var t}(e);return q.test(t)?t:""}catch(n){return""}}function H(e){return e.appName+"!"+e.appId}var z=new Map;function Y(e,t){var n=H(e);Q(n,t),function(e,t){var n=J();n&&n.postMessage({key:e,fid:t});$()}(n,t)}function Q(e,t){var n,r,i=z.get(e);if(i)try{for(var o=S(i),a=o.next();!a.done;a=o.next()){(0,a.value)(t)}}catch(s){n={error:s}}finally{try{a&&!a.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}var X=null;function J(){return!X&&"BroadcastChannel"in self&&((X=new BroadcastChannel("[Firebase] FID Change")).onmessage=function(e){Q(e.data.key,e.data.fid)}),X}function $(){0===z.size&&X&&(X.close(),X=null)}var Z,ee="firebase-installations-store",te=null;function ne(){return te||(te=Object(A.openDb)("firebase-installations-database",1,(function(e){switch(e.oldVersion){case 0:e.createObjectStore(ee)}}))),te}function re(e,t){return w(this,void 0,void 0,(function(){var n,r,i,o,a;return T(this,(function(s){switch(s.label){case 0:return n=H(e),[4,ne()];case 1:return r=s.sent(),i=r.transaction(ee,"readwrite"),[4,(o=i.objectStore(ee)).get(n)];case 2:return a=s.sent(),[4,o.put(t,n)];case 3:return s.sent(),[4,i.complete];case 4:return s.sent(),a&&a.fid===t.fid||Y(e,t.fid),[2,t]}}))}))}function ie(e){return w(this,void 0,void 0,(function(){var t,n,r;return T(this,(function(i){switch(i.label){case 0:return t=H(e),[4,ne()];case 1:return n=i.sent(),[4,(r=n.transaction(ee,"readwrite")).objectStore(ee).delete(t)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function oe(e,t){return w(this,void 0,void 0,(function(){var n,r,i,o,a,s;return T(this,(function(c){switch(c.label){case 0:return n=H(e),[4,ne()];case 1:return r=c.sent(),i=r.transaction(ee,"readwrite"),[4,(o=i.objectStore(ee)).get(n)];case 2:return a=c.sent(),void 0!==(s=t(a))?[3,4]:[4,o.delete(n)];case 3:return c.sent(),[3,6];case 4:return[4,o.put(s,n)];case 5:c.sent(),c.label=6;case 6:return[4,i.complete];case 7:return c.sent(),!s||a&&a.fid===s.fid||Y(e,s.fid),[2,s]}}))}))}function ae(e){return w(this,void 0,void 0,(function(){var t,n,r;return T(this,(function(i){switch(i.label){case 0:return[4,oe(e,(function(n){var r=function(e){return ue(e||{fid:K(),registrationStatus:0})}(n),i=function(e,t){if(0===t.registrationStatus){if(!navigator.onLine)return{installationEntry:t,registrationPromise:Promise.reject(x.create("app-offline"))};var n={fid:t.fid,registrationStatus:1,registrationTime:Date.now()};return{installationEntry:n,registrationPromise:function(e,t){return w(this,void 0,void 0,(function(){var n,r;return T(this,(function(i){switch(i.label){case 0:return i.trys.push([0,2,,7]),[4,W(e,t)];case 1:return n=i.sent(),[2,re(e,n)];case 2:return L(r=i.sent())&&409===r.customData.serverCode?[4,ie(e)]:[3,4];case 3:return i.sent(),[3,6];case 4:return[4,re(e,{fid:t.fid,registrationStatus:0})];case 5:i.sent(),i.label=6;case 6:throw r;case 7:return[2]}}))}))}(e,n)}}return 1===t.registrationStatus?{installationEntry:t,registrationPromise:se(e)}:{installationEntry:t}}(e,r);return t=i.registrationPromise,i.installationEntry}))];case 1:return""!==(n=i.sent()).fid?[3,3]:(r={},[4,t]);case 2:return[2,(r.installationEntry=i.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:t}]}}))}))}function se(e){return w(this,void 0,void 0,(function(){var t,n,r,i;return T(this,(function(o){switch(o.label){case 0:return[4,ce(e)];case 1:t=o.sent(),o.label=2;case 2:return 1!==t.registrationStatus?[3,5]:[4,G(100)];case 3:return o.sent(),[4,ce(e)];case 4:return t=o.sent(),[3,2];case 5:return 0!==t.registrationStatus?[3,7]:[4,ae(e)];case 6:return n=o.sent(),r=n.installationEntry,(i=n.registrationPromise)?[2,i]:[2,r];case 7:return[2,t]}}))}))}function ce(e){return oe(e,(function(e){if(!e)throw x.create("installation-not-found");return ue(e)}))}function ue(e){return 1===(t=e).registrationStatus&&t.registrationTime+k<Date.now()?{fid:e.fid,registrationStatus:0}:e;var t}function le(e,t){var n=e.appConfig,r=e.platformLoggerProvider;return w(this,void 0,void 0,(function(){var e,i,o,a,s,c,u;return T(this,(function(l){switch(l.label){case 0:return e=function(e,t){var n=t.fid;return M(e)+"/"+n+"/authTokens:generate"}(n,t),i=V(n,t),(o=r.getImmediate({optional:!0}))&&i.append("x-firebase-client",o.getPlatformInfoString()),a={installation:{sdkVersion:O}},s={method:"POST",headers:i,body:JSON.stringify(a)},[4,B((function(){return fetch(e,s)}))];case 1:return(c=l.sent()).ok?[4,c.json()]:[3,3];case 2:return u=l.sent(),[2,U(u)];case 3:return[4,j("Generate Auth Token",c)];case 4:throw l.sent()}}))}))}function de(e,t){return void 0===t&&(t=!1),w(this,void 0,void 0,(function(){var n,r,i;return T(this,(function(o){switch(o.label){case 0:return[4,oe(e.appConfig,(function(r){if(!he(r))throw x.create("not-registered");var i=r.authToken;if(!t&&function(e){return 2===e.requestStatus&&!function(e){var t=Date.now();return t<e.creationTime||e.creationTime+e.expiresIn<t+P}(e)}(i))return r;if(1===i.requestStatus)return n=function(e,t){return w(this,void 0,void 0,(function(){var n,r;return T(this,(function(i){switch(i.label){case 0:return[4,fe(e.appConfig)];case 1:n=i.sent(),i.label=2;case 2:return 1!==n.authToken.requestStatus?[3,5]:[4,G(100)];case 3:return i.sent(),[4,fe(e.appConfig)];case 4:return n=i.sent(),[3,2];case 5:return 0===(r=n.authToken).requestStatus?[2,de(e,t)]:[2,r]}}))}))}(e,t),r;if(!navigator.onLine)throw x.create("app-offline");var o=function(e){var t={requestStatus:1,requestTime:Date.now()};return E(E({},e),{authToken:t})}(r);return n=function(e,t){return w(this,void 0,void 0,(function(){var n,r,i;return T(this,(function(o){switch(o.label){case 0:return o.trys.push([0,3,,8]),[4,le(e,t)];case 1:return n=o.sent(),i=E(E({},t),{authToken:n}),[4,re(e.appConfig,i)];case 2:return o.sent(),[2,n];case 3:return!L(r=o.sent())||401!==r.customData.serverCode&&404!==r.customData.serverCode?[3,5]:[4,ie(e.appConfig)];case 4:return o.sent(),[3,7];case 5:return i=E(E({},t),{authToken:{requestStatus:0}}),[4,re(e.appConfig,i)];case 6:o.sent(),o.label=7;case 7:throw r;case 8:return[2]}}))}))}(e,o),o}))];case 1:return r=o.sent(),n?[4,n]:[3,3];case 2:return i=o.sent(),[3,4];case 3:i=r.authToken,o.label=4;case 4:return[2,i]}}))}))}function fe(e){return oe(e,(function(e){if(!he(e))throw x.create("not-registered");var t,n=e.authToken;return 1===(t=n).requestStatus&&t.requestTime+k<Date.now()?E(E({},e),{authToken:{requestStatus:0}}):e}))}function he(e){return void 0!==e&&2===e.registrationStatus}function pe(e){return w(this,void 0,void 0,(function(){var t;return T(this,(function(n){switch(n.label){case 0:return[4,ae(e)];case 1:return(t=n.sent().registrationPromise)?[4,t]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}}))}))}function ve(e,t){return w(this,void 0,void 0,(function(){var n,r,i,o;return T(this,(function(a){switch(a.label){case 0:return n=function(e,t){var n=t.fid;return M(e)+"/"+n}(e,t),r=V(e,t),i={method:"DELETE",headers:r},[4,B((function(){return fetch(n,i)}))];case 1:return(o=a.sent()).ok?[3,3]:[4,j("Delete Installation",o)];case 2:throw a.sent();case 3:return[2]}}))}))}function me(e,t){var n=e.appConfig;return function(e,t){J();var n=H(e),r=z.get(n);r||(r=new Set,z.set(n,r)),r.add(t)}(n,t),function(){!function(e,t){var n=H(e),r=z.get(n);r&&(r.delete(t),0===r.size&&z.delete(n),$())}(n,t)}}function ge(e){return x.create("missing-app-config-values",{valueName:e})}(Z=o.a).INTERNAL.registerComponent(new u.a("installations",(function(e){var t=e.getProvider("app").getImmediate(),n={appConfig:function(e){var t,n;if(!e||!e.options)throw ge("App Configuration");if(!e.name)throw ge("App Name");try{for(var r=S(["projectId","apiKey","appId"]),i=r.next();!i.done;i=r.next()){var o=i.value;if(!e.options[o])throw ge(o)}}catch(a){t={error:a}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return{appName:e.name,projectId:e.options.projectId,apiKey:e.options.apiKey,appId:e.options.appId}}(t),platformLoggerProvider:e.getProvider("platform-logger")};return{app:t,getId:function(){return function(e){return w(this,void 0,void 0,(function(){var t,n,r;return T(this,(function(i){switch(i.label){case 0:return[4,ae(e.appConfig)];case 1:return t=i.sent(),n=t.installationEntry,(r=t.registrationPromise)?r.catch(console.error):de(e).catch(console.error),[2,n.fid]}}))}))}(n)},getToken:function(e){return function(e,t){return void 0===t&&(t=!1),w(this,void 0,void 0,(function(){return T(this,(function(n){switch(n.label){case 0:return[4,pe(e.appConfig)];case 1:return n.sent(),[4,de(e,t)];case 2:return[2,n.sent().token]}}))}))}(n,e)},delete:function(){return function(e){return w(this,void 0,void 0,(function(){var t,n;return T(this,(function(r){switch(r.label){case 0:return[4,oe(t=e.appConfig,(function(e){if(!e||0!==e.registrationStatus)return e}))];case 1:if(!(n=r.sent()))return[3,6];if(1!==n.registrationStatus)return[3,2];throw x.create("delete-pending-registration");case 2:if(2!==n.registrationStatus)return[3,6];if(navigator.onLine)return[3,3];throw x.create("app-offline");case 3:return[4,ve(t,n)];case 4:return r.sent(),[4,ie(t)];case 5:r.sent(),r.label=6;case 6:return[2]}}))}))}(n)},onIdChange:function(e){return me(n,e)}}}),"PUBLIC")),Z.registerVersion("@firebase/installations",C);var ye=function(){return(ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function _e(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function be(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function Ee(e){var t="function"===typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"===typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function we(e,t){var n="function"===typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(s){i={error:s}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}var Te;Object.create;var Se,Ie=((Te={})["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Te["only-available-in-window"]="This method is available in a Window context.",Te["only-available-in-sw"]="This method is available in a service worker context.",Te["permission-default"]="The notification permission was not granted and dismissed instead.",Te["permission-blocked"]="The notification permission was not granted and blocked instead.",Te["unsupported-browser"]="This browser doesn't support the API's required to use the firebase SDK.",Te["failed-service-worker-registration"]="We are unable to register the default service worker. {$browserErrorMessage}",Te["token-subscribe-failed"]="A problem occurred while subscribing the user to FCM: {$errorInfo}",Te["token-subscribe-no-token"]="FCM returned no token when subscribing the user to push.",Te["token-unsubscribe-failed"]="A problem occurred while unsubscribing the user from FCM: {$errorInfo}",Te["token-update-failed"]="A problem occurred while updating the user from FCM: {$errorInfo}",Te["token-update-no-token"]="FCM returned no token when updating the user to push.",Te["use-sw-after-get-token"]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",Te["invalid-sw-registration"]="The input to useServiceWorker() must be a ServiceWorkerRegistration.",Te["invalid-bg-handler"]="The input to setBackgroundMessageHandler() must be a function.",Te["invalid-vapid-key"]="The public VAPID key must be a string.",Te["use-vapid-key-after-get-token"]="The usePublicVapidKey() method may only be called once and must be called before calling getToken() to ensure your VAPID key is used.",Te),Re=new a.b("messaging","Messaging",Ie),Ae="BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",Ce="google.c.a.c_id";function ke(e){var t=new Uint8Array(e);return btoa(String.fromCharCode.apply(String,function(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}([],we(t)))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Oe(e){for(var t=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),n=atob(t),r=new Uint8Array(n.length),i=0;i<n.length;++i)r[i]=n.charCodeAt(i);return r}!function(e){e.PUSH_RECEIVED="push-received",e.NOTIFICATION_CLICKED="notification-clicked"}(Se||(Se={}));var Ne="fcm_token_details_db",Pe="fcm_token_object_Store";function De(e){return _e(this,void 0,void 0,(function(){var t,n,r=this;return be(this,(function(i){switch(i.label){case 0:return"databases"in indexedDB?[4,indexedDB.databases()]:[3,2];case 1:if(t=i.sent(),!t.map((function(e){return e.name})).includes(Ne))return[2,null];i.label=2;case 2:return n=null,[4,Object(A.openDb)(Ne,5,(function(t){return _e(r,void 0,void 0,(function(){var r,i,o,a;return be(this,(function(s){switch(s.label){case 0:return t.oldVersion<2?[2]:t.objectStoreNames.contains(Pe)?[4,(r=t.transaction.objectStore(Pe)).index("fcmSenderId").get(e)]:[2];case 1:return i=s.sent(),[4,r.clear()];case 2:if(s.sent(),!i)return[2];if(2===t.oldVersion){if(!(o=i).auth||!o.p256dh||!o.endpoint)return[2];n={token:o.fcmToken,createTime:null!==(a=o.createTime)&&void 0!==a?a:Date.now(),subscriptionOptions:{auth:o.auth,p256dh:o.p256dh,endpoint:o.endpoint,swScope:o.swScope,vapidKey:"string"===typeof o.vapidKey?o.vapidKey:ke(o.vapidKey)}}}else(3===t.oldVersion||4===t.oldVersion)&&(n={token:(o=i).fcmToken,createTime:o.createTime,subscriptionOptions:{auth:ke(o.auth),p256dh:ke(o.p256dh),endpoint:o.endpoint,swScope:o.swScope,vapidKey:ke(o.vapidKey)}});return[2]}}))}))}))];case 3:return i.sent().close(),[4,Object(A.deleteDb)(Ne)];case 4:return i.sent(),[4,Object(A.deleteDb)("fcm_vapid_details_db")];case 5:return i.sent(),[4,Object(A.deleteDb)("undefined")];case 6:return i.sent(),[2,xe(n)?n:null]}}))}))}function xe(e){if(!e||!e.subscriptionOptions)return!1;var t=e.subscriptionOptions;return"number"===typeof e.createTime&&e.createTime>0&&"string"===typeof e.token&&e.token.length>0&&"string"===typeof t.auth&&t.auth.length>0&&"string"===typeof t.p256dh&&t.p256dh.length>0&&"string"===typeof t.endpoint&&t.endpoint.length>0&&"string"===typeof t.swScope&&t.swScope.length>0&&"string"===typeof t.vapidKey&&t.vapidKey.length>0}var Le="firebase-messaging-store",Me=null;function Ue(){return Me||(Me=Object(A.openDb)("firebase-messaging-database",1,(function(e){switch(e.oldVersion){case 0:e.createObjectStore(Le)}}))),Me}function je(e){return _e(this,void 0,void 0,(function(){var t,n,r;return be(this,(function(i){switch(i.label){case 0:return t=Be(e),[4,Ue()];case 1:return[4,i.sent().transaction(Le).objectStore(Le).get(t)];case 2:return(n=i.sent())?[2,n]:[3,3];case 3:return[4,De(e.appConfig.senderId)];case 4:return(r=i.sent())?[4,Fe(e,r)]:[3,6];case 5:return i.sent(),[2,r];case 6:return[2]}}))}))}function Fe(e,t){return _e(this,void 0,void 0,(function(){var n,r,i;return be(this,(function(o){switch(o.label){case 0:return n=Be(e),[4,Ue()];case 1:return r=o.sent(),[4,(i=r.transaction(Le,"readwrite")).objectStore(Le).put(t,n)];case 2:return o.sent(),[4,i.complete];case 3:return o.sent(),[2,t]}}))}))}function Ve(e){return _e(this,void 0,void 0,(function(){var t,n,r;return be(this,(function(i){switch(i.label){case 0:return t=Be(e),[4,Ue()];case 1:return n=i.sent(),[4,(r=n.transaction(Le,"readwrite")).objectStore(Le).delete(t)];case 2:return i.sent(),[4,r.complete];case 3:return i.sent(),[2]}}))}))}function Be(e){return e.appConfig.appId}function We(e,t){return _e(this,void 0,void 0,(function(){var n,r,i,o,a,s;return be(this,(function(c){switch(c.label){case 0:return[4,He(e)];case 1:n=c.sent(),r=ze(t),i={method:"POST",headers:n,body:JSON.stringify(r)},c.label=2;case 2:return c.trys.push([2,5,,6]),[4,fetch(Ke(e.appConfig),i)];case 3:return[4,c.sent().json()];case 4:return o=c.sent(),[3,6];case 5:throw a=c.sent(),Re.create("token-subscribe-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Re.create("token-subscribe-failed",{errorInfo:s});if(!o.token)throw Re.create("token-subscribe-no-token");return[2,o.token]}}))}))}function Ge(e,t){return _e(this,void 0,void 0,(function(){var n,r,i,o,a,s;return be(this,(function(c){switch(c.label){case 0:return[4,He(e)];case 1:n=c.sent(),r=ze(t.subscriptionOptions),i={method:"PATCH",headers:n,body:JSON.stringify(r)},c.label=2;case 2:return c.trys.push([2,5,,6]),[4,fetch(Ke(e.appConfig)+"/"+t.token,i)];case 3:return[4,c.sent().json()];case 4:return o=c.sent(),[3,6];case 5:throw a=c.sent(),Re.create("token-update-failed",{errorInfo:a});case 6:if(o.error)throw s=o.error.message,Re.create("token-update-failed",{errorInfo:s});if(!o.token)throw Re.create("token-update-no-token");return[2,o.token]}}))}))}function qe(e,t){return _e(this,void 0,void 0,(function(){var n,r,i,o,a;return be(this,(function(s){switch(s.label){case 0:return[4,He(e)];case 1:n=s.sent(),r={method:"DELETE",headers:n},s.label=2;case 2:return s.trys.push([2,5,,6]),[4,fetch(Ke(e.appConfig)+"/"+t,r)];case 3:return[4,s.sent().json()];case 4:if((i=s.sent()).error)throw o=i.error.message,Re.create("token-unsubscribe-failed",{errorInfo:o});return[3,6];case 5:throw a=s.sent(),Re.create("token-unsubscribe-failed",{errorInfo:a});case 6:return[2]}}))}))}function Ke(e){return"https://fcmregistrations.googleapis.com/v1/projects/"+e.projectId+"/registrations"}function He(e){var t=e.appConfig,n=e.installations;return _e(this,void 0,void 0,(function(){var e;return be(this,(function(r){switch(r.label){case 0:return[4,n.getToken()];case 1:return e=r.sent(),[2,new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t.apiKey,"x-goog-firebase-installations-auth":"FIS "+e})]}}))}))}function ze(e){var t=e.p256dh,n=e.auth,r=e.endpoint,i=e.vapidKey,o={web:{endpoint:r,auth:n,p256dh:t}};return i!==Ae&&(o.web.applicationPubKey=i),o}function Ye(e,t,n){return _e(this,void 0,void 0,(function(){var r,i,o,a;return be(this,(function(s){switch(s.label){case 0:if("granted"!==Notification.permission)throw Re.create("permission-blocked");return[4,$e(t,n)];case 1:return r=s.sent(),[4,je(e)];case 2:return i=s.sent(),o={vapidKey:n,swScope:t.scope,endpoint:r.endpoint,auth:ke(r.getKey("auth")),p256dh:ke(r.getKey("p256dh"))},i?[3,3]:[2,Je(e,o)];case 3:if(function(e,t){var n=t.vapidKey===e.vapidKey,r=t.endpoint===e.endpoint,i=t.auth===e.auth,o=t.p256dh===e.p256dh;return n&&r&&i&&o}(i.subscriptionOptions,o))return[3,8];s.label=4;case 4:return s.trys.push([4,6,,7]),[4,qe(e,i.token)];case 5:return s.sent(),[3,7];case 6:return a=s.sent(),console.warn(a),[3,7];case 7:return[2,Je(e,o)];case 8:return Date.now()>=i.createTime+6048e5?[2,Xe({token:i.token,createTime:Date.now(),subscriptionOptions:o},e,t)]:[2,i.token];case 9:return[2]}}))}))}function Qe(e,t){return _e(this,void 0,void 0,(function(){var n,r;return be(this,(function(i){switch(i.label){case 0:return[4,je(e)];case 1:return(n=i.sent())?[4,qe(e,n.token)]:[3,4];case 2:return i.sent(),[4,Ve(e)];case 3:i.sent(),i.label=4;case 4:return[4,t.pushManager.getSubscription()];case 5:return(r=i.sent())?[2,r.unsubscribe()]:[2,!0]}}))}))}function Xe(e,t,n){return _e(this,void 0,void 0,(function(){var r,i,o;return be(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,5]),[4,Ge(t,e)];case 1:return r=a.sent(),i=ye(ye({},e),{token:r,createTime:Date.now()}),[4,Fe(t,i)];case 2:return a.sent(),[2,r];case 3:return o=a.sent(),[4,Qe(t,n)];case 4:throw a.sent(),o;case 5:return[2]}}))}))}function Je(e,t){return _e(this,void 0,void 0,(function(){var n,r;return be(this,(function(i){switch(i.label){case 0:return[4,We(e,t)];case 1:return n=i.sent(),r={token:n,createTime:Date.now(),subscriptionOptions:t},[4,Fe(e,r)];case 2:return i.sent(),[2,r.token]}}))}))}function $e(e,t){return _e(this,void 0,void 0,(function(){var n;return be(this,(function(r){switch(r.label){case 0:return[4,e.pushManager.getSubscription()];case 1:return(n=r.sent())?[2,n]:[2,e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Oe(t)})]}}))}))}function Ze(e){return"object"===typeof e&&!!e&&Ce in e}function et(e){return new Promise((function(t){setTimeout(t,e)}))}var tt=function(){function e(e){var t=this;this.firebaseDependencies=e,this.isOnBackgroundMessageUsed=null,this.vapidKey=null,this.bgMessageHandler=null,self.addEventListener("push",(function(e){e.waitUntil(t.onPush(e))})),self.addEventListener("pushsubscriptionchange",(function(e){e.waitUntil(t.onSubChange(e))})),self.addEventListener("notificationclick",(function(e){e.waitUntil(t.onNotificationClick(e))}))}return Object.defineProperty(e.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),e.prototype.setBackgroundMessageHandler=function(e){if(this.isOnBackgroundMessageUsed=!1,!e||"function"!==typeof e)throw Re.create("invalid-bg-handler");this.bgMessageHandler=e},e.prototype.onBackgroundMessage=function(e){var t=this;return this.isOnBackgroundMessageUsed=!0,this.bgMessageHandler=e,function(){t.bgMessageHandler=null}},e.prototype.getToken=function(){var e,t;return _e(this,void 0,void 0,(function(){var n;return be(this,(function(r){switch(r.label){case 0:return this.vapidKey?[3,2]:[4,je(this.firebaseDependencies)];case 1:n=r.sent(),this.vapidKey=null!==(t=null===(e=null===n||void 0===n?void 0:n.subscriptionOptions)||void 0===e?void 0:e.vapidKey)&&void 0!==t?t:Ae,r.label=2;case 2:return[2,Ye(this.firebaseDependencies,self.registration,this.vapidKey)]}}))}))},e.prototype.deleteToken=function(){return Qe(this.firebaseDependencies,self.registration)},e.prototype.requestPermission=function(){throw Re.create("only-available-in-window")},e.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw Re.create("use-vapid-key-after-get-token");if("string"!==typeof e||0===e.length)throw Re.create("invalid-vapid-key");this.vapidKey=e},e.prototype.useServiceWorker=function(){throw Re.create("only-available-in-window")},e.prototype.onMessage=function(){throw Re.create("only-available-in-window")},e.prototype.onTokenRefresh=function(){throw Re.create("only-available-in-window")},e.prototype.onPush=function(e){return _e(this,void 0,void 0,(function(){var t,n,r,i;return be(this,(function(o){switch(o.label){case 0:return(t=function(e){var t=e.data;if(!t)return null;try{return t.json()}catch(n){return null}}(e))?[4,ot()]:(console.debug("FirebaseMessaging: failed to get parsed MessagePayload from the PushEvent. Skip handling the push."),[2]);case 1:return function(e){return e.some((function(e){return"visible"===e.visibilityState&&!e.url.startsWith("chrome-extension://")}))}(n=o.sent())?[2,it(n,t)]:(r=!1,t.notification?[4,at(nt(t))]:[3,3]);case 2:o.sent(),r=!0,o.label=3;case 3:return!0===r&&!1===this.isOnBackgroundMessageUsed?[2]:(this.bgMessageHandler&&(i=function(e){var t={from:e.from,collapseKey:e.collapse_key};return function(e,t){if(t.notification){e.notification={};var n=t.notification.title;n&&(e.notification.title=n);var r=t.notification.body;r&&(e.notification.body=r);var i=t.notification.image;i&&(e.notification.image=i)}}(t,e),function(e,t){t.data&&(e.data=t.data)}(t,e),function(e,t){if(t.fcmOptions){e.fcmOptions={};var n=t.fcmOptions.link;n&&(e.fcmOptions.link=n);var r=t.fcmOptions.analytics_label;r&&(e.fcmOptions.analyticsLabel=r)}}(t,e),t}(t),"function"===typeof this.bgMessageHandler?this.bgMessageHandler(i):this.bgMessageHandler.next(i)),[4,et(1e3)]);case 4:return o.sent(),[2]}}))}))},e.prototype.onSubChange=function(e){var t,n;return _e(this,void 0,void 0,(function(){var r;return be(this,(function(i){switch(i.label){case 0:return e.newSubscription?[3,2]:[4,Qe(this.firebaseDependencies,self.registration)];case 1:return i.sent(),[2];case 2:return[4,je(this.firebaseDependencies)];case 3:return r=i.sent(),[4,Qe(this.firebaseDependencies,self.registration)];case 4:return i.sent(),[4,Ye(this.firebaseDependencies,self.registration,null!==(n=null===(t=null===r||void 0===r?void 0:r.subscriptionOptions)||void 0===t?void 0:t.vapidKey)&&void 0!==n?n:Ae)];case 5:return i.sent(),[2]}}))}))},e.prototype.onNotificationClick=function(e){var t,n;return _e(this,void 0,void 0,(function(){var r,i,o,a,s;return be(this,(function(c){switch(c.label){case 0:return(r=null===(n=null===(t=e.notification)||void 0===t?void 0:t.data)||void 0===n?void 0:n.FCM_MSG)?e.action?[2]:(e.stopImmediatePropagation(),e.notification.close(),(i=function(e){var t,n,r,i=null!==(n=null===(t=e.fcmOptions)||void 0===t?void 0:t.link)&&void 0!==n?n:null===(r=e.notification)||void 0===r?void 0:r.click_action;if(i)return i;return Ze(e.data)?self.location.origin:null}(r))?(o=new URL(i,self.location.href),a=new URL(self.location.origin),o.host!==a.host?[2]:[4,rt(o)]):[2]):[2];case 1:return(s=c.sent())?[3,4]:[4,self.clients.openWindow(i)];case 2:return s=c.sent(),[4,et(3e3)];case 3:return c.sent(),[3,6];case 4:return[4,s.focus()];case 5:s=c.sent(),c.label=6;case 6:return s?(r.messageType=Se.NOTIFICATION_CLICKED,r.isFirebaseMessaging=!0,[2,s.postMessage(r)]):[2]}}))}))},e}();function nt(e){var t,n=ye({},e.notification);return n.data=((t={}).FCM_MSG=e,t),n}function rt(e){return _e(this,void 0,void 0,(function(){var t,n,r,i,o,a,s;return be(this,(function(c){switch(c.label){case 0:return[4,ot()];case 1:t=c.sent();try{for(n=Ee(t),r=n.next();!r.done;r=n.next())if(i=r.value,o=new URL(i.url,self.location.href),e.host===o.host)return[2,i]}catch(u){a={error:u}}finally{try{r&&!r.done&&(s=n.return)&&s.call(n)}finally{if(a)throw a.error}}return[2,null]}}))}))}function it(e,t){var n,r;t.isFirebaseMessaging=!0,t.messageType=Se.PUSH_RECEIVED;try{for(var i=Ee(e),o=i.next();!o.done;o=i.next()){o.value.postMessage(t)}}catch(a){n={error:a}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}function ot(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function at(e){var t,n=e.actions,r=Notification.maxActions;return n&&r&&n.length>r&&console.warn("This browser only supports "+r+" actions. The remaining actions will not be displayed."),self.registration.showNotification(null!==(t=e.title)&&void 0!==t?t:"",e)}var st=function(){function e(e){var t=this;this.firebaseDependencies=e,this.vapidKey=null,this.onMessageCallback=null,navigator.serviceWorker.addEventListener("message",(function(e){return t.messageEventListener(e)}))}return Object.defineProperty(e.prototype,"app",{get:function(){return this.firebaseDependencies.app},enumerable:!1,configurable:!0}),e.prototype.messageEventListener=function(e){return _e(this,void 0,void 0,(function(){var t,n;return be(this,(function(r){switch(r.label){case 0:return(t=e.data).isFirebaseMessaging?(this.onMessageCallback&&t.messageType===Se.PUSH_RECEIVED&&("function"===typeof this.onMessageCallback?this.onMessageCallback(function(e){return delete e.messageType,delete e.isFirebaseMessaging,e}(Object.assign({},t))):this.onMessageCallback.next(Object.assign({},t))),Ze(n=t.data)&&"1"===n["google.c.a.e"]?[4,this.logEvent(t.messageType,n)]:[3,2]):[2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.getVapidKey=function(){return this.vapidKey},e.prototype.getSwReg=function(){return this.swRegistration},e.prototype.getToken=function(e){return _e(this,void 0,void 0,(function(){return be(this,(function(t){switch(t.label){case 0:return"default"!==Notification.permission?[3,2]:[4,Notification.requestPermission()];case 1:t.sent(),t.label=2;case 2:if("granted"!==Notification.permission)throw Re.create("permission-blocked");return[4,this.updateVapidKey(null===e||void 0===e?void 0:e.vapidKey)];case 3:return t.sent(),[4,this.updateSwReg(null===e||void 0===e?void 0:e.serviceWorkerRegistration)];case 4:return t.sent(),[2,Ye(this.firebaseDependencies,this.swRegistration,this.vapidKey)]}}))}))},e.prototype.updateVapidKey=function(e){return _e(this,void 0,void 0,(function(){return be(this,(function(t){return e?this.vapidKey=e:this.vapidKey||(this.vapidKey=Ae),[2]}))}))},e.prototype.updateSwReg=function(e){return _e(this,void 0,void 0,(function(){return be(this,(function(t){switch(t.label){case 0:return e||this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:t.sent(),t.label=2;case 2:if(!e&&this.swRegistration)return[2];if(!(e instanceof ServiceWorkerRegistration))throw Re.create("invalid-sw-registration");return this.swRegistration=e,[2]}}))}))},e.prototype.registerDefaultSw=function(){return _e(this,void 0,void 0,(function(){var e,t;return be(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),e=this,[4,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"})];case 1:return e.swRegistration=n.sent(),this.swRegistration.update().catch((function(){})),[3,3];case 2:throw t=n.sent(),Re.create("failed-service-worker-registration",{browserErrorMessage:t.message});case 3:return[2]}}))}))},e.prototype.deleteToken=function(){return _e(this,void 0,void 0,(function(){return be(this,(function(e){switch(e.label){case 0:return this.swRegistration?[3,2]:[4,this.registerDefaultSw()];case 1:e.sent(),e.label=2;case 2:return[2,Qe(this.firebaseDependencies,this.swRegistration)]}}))}))},e.prototype.requestPermission=function(){return _e(this,void 0,void 0,(function(){var e;return be(this,(function(t){switch(t.label){case 0:return"granted"===Notification.permission?[2]:[4,Notification.requestPermission()];case 1:if("granted"===(e=t.sent()))return[2];throw"denied"===e?Re.create("permission-blocked"):Re.create("permission-default")}}))}))},e.prototype.usePublicVapidKey=function(e){if(null!==this.vapidKey)throw Re.create("use-vapid-key-after-get-token");if("string"!==typeof e||0===e.length)throw Re.create("invalid-vapid-key");this.vapidKey=e},e.prototype.useServiceWorker=function(e){if(!(e instanceof ServiceWorkerRegistration))throw Re.create("invalid-sw-registration");if(this.swRegistration)throw Re.create("use-sw-after-get-token");this.swRegistration=e},e.prototype.onMessage=function(e){var t=this;return this.onMessageCallback=e,function(){t.onMessageCallback=null}},e.prototype.setBackgroundMessageHandler=function(){throw Re.create("only-available-in-sw")},e.prototype.onBackgroundMessage=function(){throw Re.create("only-available-in-sw")},e.prototype.onTokenRefresh=function(){return function(){}},e.prototype.logEvent=function(e,t){return _e(this,void 0,void 0,(function(){var n;return be(this,(function(r){switch(r.label){case 0:return n=function(e){switch(e){case Se.NOTIFICATION_CLICKED:return"notification_open";case Se.PUSH_RECEIVED:return"notification_foreground";default:throw new Error}}(e),[4,this.firebaseDependencies.analyticsProvider.get()];case 1:return r.sent().logEvent(n,{message_id:t["google.c.a.c_id"],message_name:t["google.c.a.c_l"],message_time:t["google.c.a.ts"],message_device_time:Math.floor(Date.now()/1e3)}),[2]}}))}))},e}();function ct(e){return Re.create("missing-app-config-values",{valueName:e})}var ut={isSupported:lt};function lt(){return self&&"ServiceWorkerGlobalScope"in self?"indexedDB"in self&&null!==indexedDB&&"PushManager"in self&&"Notification"in self&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey"):"indexedDB"in window&&null!==indexedDB&&navigator.cookieEnabled&&"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")}o.a.INTERNAL.registerComponent(new u.a("messaging",(function(e){var t=e.getProvider("app").getImmediate(),n={app:t,appConfig:function(e){var t,n;if(!e||!e.options)throw ct("App Configuration Object");if(!e.name)throw ct("App Name");var r=e.options;try{for(var i=Ee(["projectId","apiKey","appId","messagingSenderId"]),o=i.next();!o.done;o=i.next()){var a=o.value;if(!r[a])throw ct(a)}}catch(s){t={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return{appName:e.name,projectId:r.projectId,apiKey:r.apiKey,appId:r.appId,senderId:r.messagingSenderId}}(t),installations:e.getProvider("installations").getImmediate(),analyticsProvider:e.getProvider("analytics-internal")};if(!lt())throw Re.create("unsupported-browser");return self&&"ServiceWorkerGlobalScope"in self?new tt(n):new st(n)}),"PUBLIC").setServiceProps(ut));var dt=function(e,t){return(dt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var ft=function(){return(ft=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function ht(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function pt(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;function vt(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}Object.create;var mt="firebasestorage.googleapis.com",gt=function(e){function t(n,r){var i=e.call(this,yt(n),"Firebase Storage: "+r+" ("+yt(n)+")")||this;return i.customData={serverResponse:null},Object.setPrototypeOf(i,t.prototype),i}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}dt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t.prototype._codeEquals=function(e){return yt(e)===this.code},Object.defineProperty(t.prototype,"message",{get:function(){return this.customData.serverResponse?this.message+"\n"+this.customData.serverResponse:this.message},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(e){this.customData.serverResponse=e},enumerable:!1,configurable:!0}),t}(a.c);function yt(e){return"storage/"+e}function _t(){return new gt("unknown","An unknown error occurred, please check the error payload for server response.")}function bt(){return new gt("canceled","User canceled the upload/download.")}function Et(){return new gt("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function wt(e){return new gt("invalid-argument",e)}function Tt(){return new gt("app-deleted","The Firebase app was deleted.")}function St(e){return new gt("invalid-root-operation","The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function It(e,t){return new gt("invalid-format","String does not match format '"+e+"': "+t)}function Rt(e){throw new gt("internal-error","Internal error: "+e)}var At={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},Ct=function(e,t){this.data=e,this.contentType=t||null};function kt(e,t){switch(e){case At.RAW:return new Ct(Ot(t));case At.BASE64:case At.BASE64URL:return new Ct(Nt(e,t));case At.DATA_URL:return new Ct(function(e){var t=new Pt(e);return t.base64?Nt(At.BASE64,t.rest):function(e){var t;try{t=decodeURIComponent(e)}catch(r){throw It(At.DATA_URL,"Malformed data URL.")}return Ot(t)}(t.rest)}(t),new Pt(t).contentType)}throw _t()}function Ot(e){for(var t=[],n=0;n<e.length;n++){var r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r))if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1)))r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r);else t.push(239,191,189);else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function Nt(e,t){switch(e){case At.BASE64:var n=-1!==t.indexOf("-"),i=-1!==t.indexOf("_");if(n||i)throw It(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break;case At.BASE64URL:var o=-1!==t.indexOf("+"),a=-1!==t.indexOf("/");if(o||a)throw It(e,"Invalid character '"+(o?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(t)}catch(r){throw It(e,"Invalid character found")}for(var c=new Uint8Array(s.length),u=0;u<s.length;u++)c[u]=s.charCodeAt(u);return c}var Pt=function(e){this.base64=!1,this.contentType=null;var t=e.match(/^data:([^,]+)?,/);if(null===t)throw It(At.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=t[1]||null;null!=n&&(this.base64=(r=n,i=";base64",r.length>=i.length&&r.substring(r.length-i.length)===i),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=e.substring(e.indexOf(",")+1);var r,i};var Dt,xt={STATE_CHANGED:"state_changed"},Lt={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function Mt(e){switch(e){case"running":case"pausing":case"canceling":return Lt.RUNNING;case"paused":return Lt.PAUSED;case"success":return Lt.SUCCESS;case"canceled":return Lt.CANCELED;case"error":default:return Lt.ERROR}}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(Dt||(Dt={}));var Ut=function(){function e(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Dt.NO_ERROR,this.sendPromise_=new Promise((function(t){e.xhr_.addEventListener("abort",(function(){e.errorCode_=Dt.ABORT,t(e)})),e.xhr_.addEventListener("error",(function(){e.errorCode_=Dt.NETWORK_ERROR,t(e)})),e.xhr_.addEventListener("load",(function(){t(e)}))}))}return e.prototype.send=function(e,t,n,r){if(this.sent_)throw Rt("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(var i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},e.prototype.getErrorCode=function(){if(!this.sent_)throw Rt("cannot .getErrorCode() before sending");return this.errorCode_},e.prototype.getStatus=function(){if(!this.sent_)throw Rt("cannot .getStatus() before sending");try{return this.xhr_.status}catch(r){return-1}},e.prototype.getResponseText=function(){if(!this.sent_)throw Rt("cannot .getResponseText() before sending");return this.xhr_.responseText},e.prototype.abort=function(){this.xhr_.abort()},e.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},e.prototype.addUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)},e.prototype.removeUploadProgressListener=function(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)},e}(),jt=function(){function e(){}return e.prototype.createXhrIo=function(){return new Ut},e}(),Ft=function(){function e(e,t){this.bucket=e,this.path_=t}return Object.defineProperty(e.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRoot",{get:function(){return 0===this.path.length},enumerable:!1,configurable:!0}),e.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},e.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},e.makeFromBucketSpec=function(t,n){var i;try{i=e.makeFromUrl(t,n)}catch(r){return new e(t,"")}if(""===i.path)return i;throw new gt("invalid-default-bucket","Invalid default bucket '"+t+"'.")},e.makeFromUrl=function(t,n){var r=null,i="([A-Za-z0-9.\\-_]+)";var o=new RegExp("^gs://"+i+"(/(.*))?$","i");function a(e){e.path_=decodeURIComponent(e.path)}for(var s=n.replace(/[.]/g,"\\."),c=[{regex:o,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp("^https?://"+s+"/v[A-Za-z0-9_]+/b/"+i+"/o(/([^?#]*).*)?$","i"),indices:{bucket:1,path:3},postModify:a},{regex:new RegExp("^https?://"+(n===mt?"(?:storage.googleapis.com|storage.cloud.google.com)":n)+"/"+i+"/([^?#]*)","i"),indices:{bucket:1,path:2},postModify:a}],u=0;u<c.length;u++){var l=c[u],d=l.regex.exec(t);if(d){var f=d[l.indices.bucket],h=d[l.indices.path];h||(h=""),r=new e(f,h),l.postModify(r);break}}if(null==r)throw function(e){return new gt("invalid-url","Invalid URL '"+e+"'.")}(t);return r},e}(),Vt=function(){function e(e){this.promise_=Promise.reject(e)}return e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){},e}();function Bt(e){return"string"===typeof e||e instanceof String}function Wt(e){return Gt()&&e instanceof Blob}function Gt(){return"undefined"!==typeof Blob}function qt(e,t,n,r){if(r<t)throw wt("Invalid value for '"+e+"'. Expected "+t+" or greater.");if(r>n)throw wt("Invalid value for '"+e+"'. Expected "+n+" or less.")}function Kt(e,t){var n=t.match(/^(\w+):\/\/.+/),r=t;return null==(null===n||void 0===n?void 0:n[1])&&(r="https://"+t),r+"/v0"+e}function Ht(e){var t=encodeURIComponent,n="?";for(var r in e){if(e.hasOwnProperty(r))n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1)}var zt=function(){function e(e,t,n,r,i,o,a,s,c,u,l){var d=this;this.pendingXhr_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=u,this.timeout_=c,this.pool_=l,this.promise_=new Promise((function(e,t){d.resolve_=e,d.reject_=t,d.start_()}))}return e.prototype.start_=function(){var e=this;function t(t,n){var i,o=e.resolve_,a=e.reject_,s=n.xhr;if(n.wasSuccessCode)try{var c=e.callback_(s,s.getResponseText());void 0!==c?o(c):o()}catch(r){a(r)}else null!==s?((i=_t()).serverResponse=s.getResponseText(),e.errorCallback_?a(e.errorCallback_(s,i)):a(i)):n.canceled?a(i=e.appDelete_?Tt():bt()):a(i=new gt("retry-limit-exceeded","Max retry time for operation exceeded, please try again."))}this.canceled_?t(0,new Yt(!1,null,!0)):this.backoffId_=function(e,t,n){var r=1,i=null,o=!1,a=0;function s(){return 2===a}var c=!1;function u(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];c||(c=!0,t.apply(null,e))}function l(t){i=setTimeout((function(){i=null,e(d,s())}),t)}function d(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(!c)if(e)u.call.apply(u,vt([null,e],t));else{var i;s()||o?u.call.apply(u,vt([null,e],t)):(r<64&&(r*=2),1===a?(a=2,i=0):i=1e3*(r+Math.random()),l(i))}}var f=!1;function h(e){f||(f=!0,c||(null!==i?(e||(a=2),clearTimeout(i),l(0)):e||(a=1)))}return l(0),setTimeout((function(){o=!0,h(!0)}),n),h}((function(t,n){if(n)t(!1,new Yt(!1,null,!0));else{var r=e.pool_.createXhrIo();e.pendingXhr_=r,null!==e.progressCallback_&&r.addUploadProgressListener(i),r.send(e.url_,e.method_,e.body_,e.headers_).then((function(n){null!==e.progressCallback_&&n.removeUploadProgressListener(i),e.pendingXhr_=null;var r=(n=n).getErrorCode()===Dt.NO_ERROR,o=n.getStatus();if(r&&!e.isRetryStatusCode_(o)){var a=-1!==e.successCodes_.indexOf(o);t(!0,new Yt(a,n))}else{var s=n.getErrorCode()===Dt.ABORT;t(!1,new Yt(!1,null,s))}}))}function i(t){var n=t.loaded,r=t.lengthComputable?t.total:-1;null!==e.progressCallback_&&e.progressCallback_(n,r)}}),t,this.timeout_)},e.prototype.getPromise=function(){return this.promise_},e.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingXhr_&&this.pendingXhr_.abort()},e.prototype.isRetryStatusCode_=function(e){var t=e>=500&&e<600,n=-1!==[408,429].indexOf(e),r=-1!==this.additionalRetryCodes_.indexOf(e);return t||n||r},e}(),Yt=function(e,t,n){this.wasSuccessCode=e,this.xhr=t,this.canceled=!!n};function Qt(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function Xt(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=Qt();if(void 0!==n){for(var r=new n,i=0;i<e.length;i++)r.append(e[i]);return r.getBlob()}if(Gt())return new Blob(e);throw new gt("unsupported-environment","This browser doesn't seem to support creating Blobs")}var Jt=function(){function e(e,t){var n=0,r="";Wt(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}return e.prototype.size=function(){return this.size_},e.prototype.type=function(){return this.type_},e.prototype.slice=function(t,n){if(Wt(this.data_)){var r=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,t,n);return null===r?null:new e(r)}return new e(new Uint8Array(this.data_.buffer,t,n-t),!0)},e.getBlob=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(Gt()){var r=t.map((function(t){return t instanceof e?t.data_:t}));return new e(Xt.apply(null,r))}var i=t.map((function(e){return Bt(e)?kt(At.RAW,e).data:e.data_})),o=0;i.forEach((function(e){o+=e.byteLength}));var a=new Uint8Array(o),s=0;return i.forEach((function(e){for(var t=0;t<e.length;t++)a[s++]=e[t]})),new e(a,!0)},e.prototype.uploadData=function(){return this.data_},e}();function $t(e){var t,n;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t}function Zt(e){var t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function en(e,t){return t}var tn=function(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||en},nn=null;function rn(){if(nn)return nn;var e=[];e.push(new tn("bucket")),e.push(new tn("generation")),e.push(new tn("metageneration")),e.push(new tn("name","fullPath",!0));var t=new tn("name");t.xform=function(e,t){return function(e){return!Bt(e)||e.length<2?e:Zt(e)}(t)},e.push(t);var n=new tn("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new tn("timeCreated")),e.push(new tn("updated")),e.push(new tn("md5Hash",null,!0)),e.push(new tn("cacheControl",null,!0)),e.push(new tn("contentDisposition",null,!0)),e.push(new tn("contentEncoding",null,!0)),e.push(new tn("contentLanguage",null,!0)),e.push(new tn("contentType",null,!0)),e.push(new tn("metadata","customMetadata",!0)),nn=e}function on(e,t,n){for(var r={type:"file"},i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,t[a.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){var n=e.bucket,r=e.fullPath,i=new Ft(n,r);return t._makeStorageReference(i)}})}(r,e),r}function an(e,t,n){var r=$t(t);return null===r?null:on(e,r,n)}function sn(e,t){for(var n={},r=t.length,i=0;i<r;i++){var o=t[i];o.writable&&(n[o.server]=e[o.local])}return JSON.stringify(n)}function cn(e,t,n){var r=$t(n);return null===r?null:function(e,t,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n.prefixes)for(var i=0,o=n.prefixes;i<o.length;i++){var a=o[i].replace(/\/$/,""),s=e._makeStorageReference(new Ft(t,a));r.prefixes.push(s)}if(n.items)for(var c=0,u=n.items;c<u.length;c++){var l=u[c];s=e._makeStorageReference(new Ft(t,l.name)),r.items.push(s)}return r}(e,t,r)}var un=function(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]};function ln(e){if(!e)throw _t()}function dn(e,t){return function(n,r){var i=an(e,r,t);return ln(null!==i),i}}function fn(e,t){return function(n,r){var i=an(e,r,t);return ln(null!==i),function(e,t,n){var r=$t(t);if(null===r)return null;if(!Bt(r.downloadTokens))return null;var i=r.downloadTokens;if(0===i.length)return null;var o=encodeURIComponent;return i.split(",").map((function(t){var r=e.bucket,i=e.fullPath;return Kt("/b/"+o(r)+"/o/"+o(i),n)+Ht({alt:"media",token:t})}))[0]}(i,r,e.host)}}function hn(e){return function(t,n){var r,i,o;return 401===t.getStatus()?r=new gt("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(o=e.bucket,r=new gt("quota-exceeded","Quota for bucket '"+o+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new gt("unauthorized","User does not have permission to access '"+i+"'.")):r=n,r.serverResponse=n.serverResponse,r}}function pn(e){var t=hn(e);return function(n,r){var i,o=t(n,r);return 404===n.getStatus()&&(i=e.path,o=new gt("object-not-found","Object '"+i+"' does not exist.")),o.serverResponse=r.serverResponse,o}}function vn(e,t,n){var r=Kt(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,o=new un(r,"GET",dn(e,n),i);return o.errorHandler=pn(t),o}function mn(e,t,n,r,i){var o={};t.isRoot?o.prefix="":o.prefix=t.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);var a=Kt(t.bucketOnlyServerUrl(),e.host),s=e.maxOperationRetryTime,c=new un(a,"GET",function(e,t){return function(n,r){var i=cn(e,t,r);return ln(null!==i),i}}(e,t.bucket),s);return c.urlParams=o,c.errorHandler=hn(t),c}function gn(e,t,n){var r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}var yn=function(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null};function _n(e,t){var n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(r){ln(!1)}return ln(!!n&&-1!==(t||["active"]).indexOf(n)),n}var bn=262144;function En(e,t,n,r,i,o,a,s){var c=new yn(0,0);if(a?(c.current=a.current,c.total=a.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw new gt("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");var u=c.total-c.current,l=u;i>0&&(l=Math.min(l,i));var d=c.current,f=d+l,h={"X-Goog-Upload-Command":l===u?"upload, finalize":"upload","X-Goog-Upload-Offset":c.current},p=r.slice(d,f);if(null===p)throw Et();var v=t.maxUploadRetryTime,m=new un(n,"POST",(function(e,n){var i,a=_n(e,["active","final"]),s=c.current+l,u=r.size();return i="final"===a?dn(t,o)(e,n):null,new yn(s,u,"final"===a,i)}),v);return m.headers=h,m.body=p.uploadData(),m.progressCallback=s||null,m.errorHandler=hn(e),m}var wn=function(e,t,n){if("function"===typeof e||null!=t||null!=n)this.next=e,this.error=t,this.complete=n;else{var r=e;this.next=r.next,this.error=r.error,this.complete=r.complete}};function Tn(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Promise.resolve().then((function(){return e.apply(void 0,t)}))}}var Sn=function(){function e(e,t,n){var r=this;void 0===n&&(n=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=rn(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(e){r._request=void 0,r._chunkMultiplier=1,e._codeEquals("canceled")?(r._needToFetchStatus=!0,r.completeTransitions_()):(r._error=e,r._transition("error"))},this._metadataErrorHandler=function(e){r._request=void 0,e._codeEquals("canceled")?r.completeTransitions_():(r._error=e,r._transition("error"))},this._promise=new Promise((function(e,t){r._resolve=e,r._reject=t,r._start()})),this._promise.then(null,(function(){}))}return e.prototype._makeProgressCallback=function(){var e=this,t=this._transferred;return function(n){return e._updateProgress(t+n)}},e.prototype._shouldDoResumable=function(e){return e.size()>262144},e.prototype._start=function(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},e.prototype._resolveToken=function(e){var t=this;this._ref.storage._getAuthToken().then((function(n){switch(t._state){case"running":e(n);break;case"canceling":t._transition("canceled");break;case"pausing":t._transition("paused")}}))},e.prototype._createResumable=function(){var e=this;this._resolveToken((function(t){var n=function(e,t,n,i,o){var a=t.bucketOnlyServerUrl(),s=gn(t,i,o),c={name:s.fullPath},u=Kt(a,e.host),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":i.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},d=sn(s,n),f=e.maxUploadRetryTime,h=new un(u,"POST",(function(e){var t;_n(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(r){ln(!1)}return ln(Bt(t)),t}),f);return h.urlParams=c,h.headers=l,h.body=d,h.errorHandler=hn(t),h}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),i=e._ref.storage._makeRequest(n,t);e._request=i,i.getPromise().then((function(t){e._request=void 0,e._uploadUrl=t,e._needToFetchStatus=!1,e.completeTransitions_()}),e._errorHandler)}))},e.prototype._fetchStatus=function(){var e=this,t=this._uploadUrl;this._resolveToken((function(n){var i=function(e,t,n,i){var o=e.maxUploadRetryTime,a=new un(n,"POST",(function(e){var t=_n(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(r){ln(!1)}n||ln(!1);var o=Number(n);return ln(!isNaN(o)),new yn(o,i.size(),"final"===t)}),o);return a.headers={"X-Goog-Upload-Command":"query"},a.errorHandler=hn(t),a}(e._ref.storage,e._ref._location,t,e._blob),o=e._ref.storage._makeRequest(i,n);e._request=o,o.getPromise().then((function(t){t=t,e._request=void 0,e._updateProgress(t.current),e._needToFetchStatus=!1,t.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()}),e._errorHandler)}))},e.prototype._continueUpload=function(){var e=this,t=bn*this._chunkMultiplier,n=new yn(this._transferred,this._blob.size()),i=this._uploadUrl;this._resolveToken((function(o){var a;try{a=En(e._ref._location,e._ref.storage,i,e._blob,t,e._mappings,n,e._makeProgressCallback())}catch(r){return e._error=r,void e._transition("error")}var s=e._ref.storage._makeRequest(a,o);e._request=s,s.getPromise().then((function(t){e._increaseMultiplier(),e._request=void 0,e._updateProgress(t.current),t.finalized?(e._metadata=t.metadata,e._transition("success")):e.completeTransitions_()}),e._errorHandler)}))},e.prototype._increaseMultiplier=function(){bn*this._chunkMultiplier<33554432&&(this._chunkMultiplier*=2)},e.prototype._fetchMetadata=function(){var e=this;this._resolveToken((function(t){var n=vn(e._ref.storage,e._ref._location,e._mappings),r=e._ref.storage._makeRequest(n,t);e._request=r,r.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._transition("success")}),e._metadataErrorHandler)}))},e.prototype._oneShotUpload=function(){var e=this;this._resolveToken((function(t){var n=function(e,t,n,r,i){var o=t.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var e="",t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();a["Content-Type"]="multipart/related; boundary="+s;var c=gn(t,r,i),u="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+sn(c,n)+"\r\n--"+s+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+s+"--",d=Jt.getBlob(u,r,l);if(null===d)throw Et();var f={name:c.fullPath},h=Kt(o,e.host),p=e.maxUploadRetryTime,v=new un(h,"POST",dn(e,n),p);return v.urlParams=f,v.headers=a,v.body=d.uploadData(),v.errorHandler=hn(t),v}(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),r=e._ref.storage._makeRequest(n,t);e._request=r,r.getPromise().then((function(t){e._request=void 0,e._metadata=t,e._updateProgress(e._blob.size()),e._transition("success")}),e._errorHandler)}))},e.prototype._updateProgress=function(e){var t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()},e.prototype._transition=function(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request&&this._request.cancel();break;case"running":var t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=bt(),this._state=e,this._notifyObservers();break;case"error":case"success":this._state=e,this._notifyObservers()}},e.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}},Object.defineProperty(e.prototype,"snapshot",{get:function(){var e=Mt(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),e.prototype.on=function(e,t,n,r){var i=this,o=new wn(t,n,r);return this._addObserver(o),function(){i._removeObserver(o)}},e.prototype.then=function(e,t){return this._promise.then(e,t)},e.prototype.catch=function(e){return this.then(null,e)},e.prototype._addObserver=function(e){this._observers.push(e),this._notifyObserver(e)},e.prototype._removeObserver=function(e){var t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)},e.prototype._notifyObservers=function(){var e=this;this._finishPromise(),this._observers.slice().forEach((function(t){e._notifyObserver(t)}))},e.prototype._finishPromise=function(){if(void 0!==this._resolve){var e=!0;switch(Mt(this._state)){case Lt.SUCCESS:Tn(this._resolve.bind(null,this.snapshot))();break;case Lt.CANCELED:case Lt.ERROR:Tn(this._reject.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}},e.prototype._notifyObserver=function(e){switch(Mt(this._state)){case Lt.RUNNING:case Lt.PAUSED:e.next&&Tn(e.next.bind(e,this.snapshot))();break;case Lt.SUCCESS:e.complete&&Tn(e.complete.bind(e))();break;case Lt.CANCELED:case Lt.ERROR:e.error&&Tn(e.error.bind(e,this._error))();break;default:e.error&&Tn(e.error.bind(e,this._error))()}},e.prototype.resume=function(){var e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e},e.prototype.pause=function(){var e="running"===this._state;return e&&this._transition("pausing"),e},e.prototype.cancel=function(){var e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e},e}(),In=function(){function e(e,t){this._service=e,this._location=t instanceof Ft?t:Ft.makeFromUrl(t,e.host)}return e.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},e.prototype._newRef=function(t,n){return new e(t,n)},Object.defineProperty(e.prototype,"root",{get:function(){var e=new Ft(this._location.bucket,"");return this._newRef(this._service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return Zt(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=function(e){if(0===e.length)return null;var t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===t)return null;var n=new Ft(this._location.bucket,t);return new e(this._service,n)},enumerable:!1,configurable:!0}),e.prototype._throwIfRoot=function(e){if(""===this._location.path)throw St(e)},e}();function Rn(e){var t={prefixes:[],items:[]};return An(e,t).then((function(){return t}))}function An(e,t,n){return ht(this,void 0,void 0,(function(){var r,i,o;return pt(this,(function(a){switch(a.label){case 0:return[4,Cn(e,{pageToken:n})];case 1:return r=a.sent(),(i=t.prefixes).push.apply(i,r.prefixes),(o=t.items).push.apply(o,r.items),null==r.nextPageToken?[3,3]:[4,An(e,t,r.nextPageToken)];case 2:a.sent(),a.label=3;case 3:return[2]}}))}))}function Cn(e,t){return ht(this,void 0,void 0,(function(){var n,r,i;return pt(this,(function(o){switch(o.label){case 0:return null!=t&&"number"===typeof t.maxResults&&qt("options.maxResults",1,1e3,t.maxResults),[4,e.storage._getAuthToken()];case 1:return n=o.sent(),r=t||{},i=mn(e.storage,e._location,"/",r.pageToken,r.maxResults),[2,e.storage._makeRequest(i,n).getPromise()]}}))}))}function kn(e,t){return ht(this,void 0,void 0,(function(){var n,r;return pt(this,(function(i){switch(i.label){case 0:return e._throwIfRoot("updateMetadata"),[4,e.storage._getAuthToken()];case 1:return n=i.sent(),r=function(e,t,n,r){var i=Kt(t.fullServerUrl(),e.host),o=sn(n,r),a=e.maxOperationRetryTime,s=new un(i,"PATCH",dn(e,r),a);return s.headers={"Content-Type":"application/json; charset=utf-8"},s.body=o,s.errorHandler=pn(t),s}(e.storage,e._location,t,rn()),[2,e.storage._makeRequest(r,n).getPromise()]}}))}))}function On(e){return ht(this,void 0,void 0,(function(){var t,n;return pt(this,(function(r){switch(r.label){case 0:return e._throwIfRoot("getDownloadURL"),[4,e.storage._getAuthToken()];case 1:return t=r.sent(),n=function(e,t,n){var r=Kt(t.fullServerUrl(),e.host),i=e.maxOperationRetryTime,o=new un(r,"GET",fn(e,n),i);return o.errorHandler=pn(t),o}(e.storage,e._location,rn()),[2,e.storage._makeRequest(n,t).getPromise().then((function(e){if(null===e)throw new gt("no-download-url","The given file does not have any download URLs.");return e}))]}}))}))}function Nn(e){return ht(this,void 0,void 0,(function(){var t,n;return pt(this,(function(r){switch(r.label){case 0:return e._throwIfRoot("deleteObject"),[4,e.storage._getAuthToken()];case 1:return t=r.sent(),n=function(e,t){var n=Kt(t.fullServerUrl(),e.host),r=e.maxOperationRetryTime,i=new un(n,"DELETE",(function(e,t){}),r);return i.successCodes=[200,204],i.errorHandler=pn(t),i}(e.storage,e._location),[2,e.storage._makeRequest(n,t).getPromise()]}}))}))}function Pn(e,t){var n=function(e,t){var n=t.split("/").filter((function(e){return e.length>0})).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new Ft(e._location.bucket,n);return new In(e.storage,r)}function Dn(e){return/^[A-Za-z]+:\/\//.test(e)}function xn(e,t){if(e instanceof Un){var n=e;if(null==n._bucket)throw new gt("no-default-bucket","No default bucket found. Did you set the 'storageBucket' property when initializing the app?");var r=new In(n,n._bucket);return null!=t?xn(r,t):r}if(void 0!==t){if(t.includes(".."))throw wt('`path` param cannot contain ".."');return Pn(e,t)}return e}function Ln(e,t){if(t&&Dn(t)){if(e instanceof Un)return new In(e,t);throw wt("To use ref(service, url), the first argument must be a Storage instance.")}return xn(e,t)}function Mn(e,t){var n=null===t||void 0===t?void 0:t.storageBucket;return null==n?null:Ft.makeFromBucketSpec(n,e)}var Un=function(){function e(e,t,n,r,i){this.app=e,this._authProvider=t,this._pool=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=mt,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?Ft.makeFromBucketSpec(r,this._host):Mn(this._host,this.app.options)}return Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){this._host=e,null!=this._url?this._bucket=Ft.makeFromBucketSpec(this._url,e):this._bucket=Mn(e,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(e){qt("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(e){qt("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e},enumerable:!1,configurable:!0}),e.prototype._getAuthToken=function(){return ht(this,void 0,void 0,(function(){var e,t;return pt(this,(function(n){switch(n.label){case 0:return(e=this._authProvider.getImmediate({optional:!0}))?[4,e.getToken()]:[3,2];case 1:if(null!==(t=n.sent()))return[2,t.accessToken];n.label=2;case 2:return[2,null]}}))}))},e.prototype._delete=function(){return this._deleted=!0,this._requests.forEach((function(e){return e.cancel()})),this._requests.clear(),Promise.resolve()},e.prototype._makeStorageReference=function(e){return new In(this,e)},e.prototype._makeRequest=function(e,t){var n=this;if(this._deleted)return new Vt(Tt());var r=function(e,t,n,r,i){var o=Ht(e.urlParams),a=e.url+o,s=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(s,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(s,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(s,i),new zt(a,e.method,s,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,r)}(e,this._appId,t,this._pool,this._firebaseVersion);return this._requests.add(r),r.getPromise().then((function(){return n._requests.delete(r)}),(function(){return n._requests.delete(r)})),r},e}();function jn(e,t,n){return function(e,t,n){return e._throwIfRoot("uploadBytesResumable"),new Sn(e,new Jt(t),n)}(e=Object(a.p)(e),t,n)}function Fn(e){return function(e){return ht(this,void 0,void 0,(function(){var t,n;return pt(this,(function(r){switch(r.label){case 0:return e._throwIfRoot("getMetadata"),[4,e.storage._getAuthToken()];case 1:return t=r.sent(),n=vn(e.storage,e._location,rn()),[2,e.storage._makeRequest(n,t).getPromise()]}}))}))}(e=Object(a.p)(e))}function Vn(e,t){return Ln(e=Object(a.p)(e),t)}var Bn=function(){function e(e,t,n){this._delegate=e,this.task=t,this.ref=n}return Object.defineProperty(e.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),e}(),Wn=function(){function e(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(e.prototype,"snapshot",{get:function(){return new Bn(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),e.prototype.then=function(e,t){var n=this;return this._delegate.then((function(t){if(e)return e(new Bn(t,n,n._ref))}),t)},e.prototype.on=function(e,t,n,r){var i=this,o=void 0;return t&&(o="function"===typeof t?function(e){return t(new Bn(e,i,i._ref))}:{next:t.next?function(e){return t.next(new Bn(e,i,i._ref))}:void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,o,n||void 0,r||void 0)},e}(),Gn=function(){function e(e,t){this._delegate=e,this._service=t}return Object.defineProperty(e.prototype,"prefixes",{get:function(){var e=this;return this._delegate.prefixes.map((function(t){return new qn(t,e._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this;return this._delegate.items.map((function(t){return new qn(t,e._service)}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),e}(),qn=function(){function e(e,t){this._delegate=e,this.storage=t}return Object.defineProperty(e.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),e.prototype.toString=function(){return this._delegate.toString()},e.prototype.child=function(t){return new e(function(e,t){return Pn(e,t)}(this._delegate,t),this.storage)},Object.defineProperty(e.prototype,"root",{get:function(){return new e(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._delegate.parent;return null==t?null:new e(t,this.storage)},enumerable:!1,configurable:!0}),e.prototype.put=function(e,t){return this._throwIfRoot("put"),new Wn(jn(this._delegate,e,t),this)},e.prototype.putString=function(e,t,n){void 0===t&&(t=At.RAW),this._throwIfRoot("putString");var r=kt(t,e),i=ft({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new Wn(new Sn(this._delegate,new Jt(r.data,!0),i),this)},e.prototype.listAll=function(){var e,t=this;return(e=this._delegate,Rn(e=Object(a.p)(e))).then((function(e){return new Gn(e,t.storage)}))},e.prototype.list=function(e){var t=this;return function(e,t){return Cn(e=Object(a.p)(e),t)}(this._delegate,e||void 0).then((function(e){return new Gn(e,t.storage)}))},e.prototype.getMetadata=function(){return Fn(this._delegate)},e.prototype.updateMetadata=function(e){return function(e,t){return kn(e=Object(a.p)(e),t)}(this._delegate,e)},e.prototype.getDownloadURL=function(){return e=this._delegate,On(e=Object(a.p)(e));var e},e.prototype.delete=function(){return this._throwIfRoot("delete"),e=this._delegate,Nn(e=Object(a.p)(e));var e},e.prototype._throwIfRoot=function(e){if(""===this._delegate._location.path)throw St(e)},e}(),Kn=function(){function e(e,t){var n=this;this.app=e,this._delegate=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return Object.defineProperty(e.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),e.prototype.ref=function(e){if(Dn(e))throw wt("ref() expected a child path but got a URL, use refFromURL instead.");return new qn(Vn(this._delegate,e),this)},e.prototype.refFromURL=function(e){if(!Dn(e))throw wt("refFromURL() expected a full URL but got a child path, use ref() instead.");try{Ft.makeFromUrl(e,this._delegate.host)}catch(r){throw wt("refFromUrl() expected a valid full URL but got an invalid one.")}return new qn(Vn(this._delegate,e),this)},e.prototype.setMaxUploadRetryTime=function(e){this._delegate.maxUploadRetryTime=e},e.prototype.setMaxOperationRetryTime=function(e){this._delegate.maxOperationRetryTime=e},e.prototype.useEmulator=function(e,t){!function(e,t,n){e.host="http://"+t+":"+n}(this._delegate,e,t)},e}();function Hn(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal");return new Kn(r,new Un(r,i,new jt,n,o.a.SDK_VERSION))}!function(e){var t={TaskState:Lt,TaskEvent:xt,StringFormat:At,Storage:Un,Reference:qn};e.INTERNAL.registerComponent(new u.a("storage",Hn,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage","0.5.0")}(o.a);var zn=function(){return(zn=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};Object.create;function Yn(e,t){for(var n=0,r=t.length,i=e.length;n<r;n++,i++)e[i]=t[n];return e}Object.create;var Qn,Xn,Jn,$n="0.4.11",Zn=$n,er="FB-PERF-TRACE-MEASURE",tr="_wt_",nr="_fcp",rr="_fid",ir="@firebase/performance/config",or="@firebase/performance/configexpire",ar="Performance",sr=((Qn={})["trace started"]="Trace {$traceName} was started before.",Qn["trace stopped"]="Trace {$traceName} is not running.",Qn["nonpositive trace startTime"]="Trace {$traceName} startTime should be positive.",Qn["nonpositive trace duration"]="Trace {$traceName} duration should be positive.",Qn["no window"]="Window is not available.",Qn["no app id"]="App id is not available.",Qn["no project id"]="Project id is not available.",Qn["no api key"]="Api key is not available.",Qn["invalid cc log"]="Attempted to queue invalid cc event",Qn["FB not default"]="Performance can only start when Firebase app instance is the default one.",Qn["RC response not ok"]="RC response is not ok",Qn["invalid attribute name"]="Attribute name {$attributeName} is invalid.",Qn["invalid attribute value"]="Attribute value {$attributeValue} is invalid.",Qn["invalid custom metric name"]="Custom metric name {$customMetricName} is invalid",Qn["invalid String merger input"]="Input for String merger is invalid, contact support team to resolve.",Qn),cr=new a.b("performance",ar,sr),ur=new s.b(ar);ur.logLevel=s.a.INFO;var lr,dr=function(){function e(e){if(this.window=e,!e)throw cr.create("no window");this.performance=e.performance,this.PerformanceObserver=e.PerformanceObserver,this.windowLocation=e.location,this.navigator=e.navigator,this.document=e.document,this.navigator&&this.navigator.cookieEnabled&&(this.localStorage=e.localStorage),e.perfMetrics&&e.perfMetrics.onFirstInputDelay&&(this.onFirstInputDelay=e.perfMetrics.onFirstInputDelay)}return e.prototype.getUrl=function(){return this.windowLocation.href.split("?")[0]},e.prototype.mark=function(e){this.performance&&this.performance.mark&&this.performance.mark(e)},e.prototype.measure=function(e,t,n){this.performance&&this.performance.measure&&this.performance.measure(e,t,n)},e.prototype.getEntriesByType=function(e){return this.performance&&this.performance.getEntriesByType?this.performance.getEntriesByType(e):[]},e.prototype.getEntriesByName=function(e){return this.performance&&this.performance.getEntriesByName?this.performance.getEntriesByName(e):[]},e.prototype.getTimeOrigin=function(){return this.performance&&(this.performance.timeOrigin||this.performance.timing.navigationStart)},e.prototype.requiredApisAvailable=function(){return fetch&&Promise&&this.navigator&&this.navigator.cookieEnabled?!!Object(a.x)()||(ur.info("IndexedDB is not supported by current browswer"),!1):(ur.info("Firebase Performance cannot start if browser does not support fetch and Promise or cookie is disabled."),!1)},e.prototype.setupObserver=function(e,t){this.PerformanceObserver&&new this.PerformanceObserver((function(e){for(var n=0,r=e.getEntries();n<r.length;n++){var i=r[n];t(i)}})).observe({entryTypes:[e]})},e.getInstance=function(){return void 0===Xn&&(Xn=new e(Jn)),Xn},e}();function fr(e,t){var n=e.length-t.length;if(n<0||n>1)throw cr.create("invalid String merger input");for(var r=[],i=0;i<e.length;i++)r.push(e.charAt(i)),t.length>i&&r.push(t.charAt(i));return r.join("")}var hr,pr,vr=function(){function e(){this.instrumentationEnabled=!0,this.dataCollectionEnabled=!0,this.loggingEnabled=!1,this.tracesSamplingRate=1,this.networkRequestsSamplingRate=1,this.logEndPointUrl="https://firebaselogging.googleapis.com/v0cc/log?format=json_proto",this.flTransportEndpointUrl=fr("hts/frbslgigp.ogepscmv/ieo/eaylg","tp:/ieaeogn-agolai.o/1frlglgc/o"),this.transportKey=fr("AzSC8r6ReiGqFMyfvgow","Iayx0u-XT3vksVM-pIV"),this.logSource=462,this.logTraceAfterSampling=!1,this.logNetworkAfterSampling=!1,this.configTimeToLive=12}return e.prototype.getAppId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.appId;if(!e)throw cr.create("no app id");return e},e.prototype.getProjectId=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.projectId;if(!e)throw cr.create("no project id");return e},e.prototype.getApiKey=function(){var e=this.firebaseAppInstance&&this.firebaseAppInstance.options&&this.firebaseAppInstance.options.apiKey;if(!e)throw cr.create("no api key");return e},e.prototype.getFlTransportFullUrl=function(){return this.flTransportEndpointUrl.concat("?key=",this.transportKey)},e.getInstance=function(){return void 0===lr&&(lr=new e),lr},e}();function mr(){return hr}!function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.VISIBLE=1]="VISIBLE",e[e.HIDDEN=2]="HIDDEN"}(pr||(pr={}));var gr=["firebase_","google_","ga_"],yr=new RegExp("^[a-zA-Z]\\w*$");function _r(){var e=dr.getInstance().navigator;return"serviceWorker"in e?e.serviceWorker.controller?2:3:1}function br(){switch(dr.getInstance().document.visibilityState){case"visible":return pr.VISIBLE;case"hidden":return pr.HIDDEN;default:return pr.UNKNOWN}}function Er(){var e=dr.getInstance().navigator.connection;switch(e&&e.effectiveType){case"slow-2g":return 1;case"2g":return 2;case"3g":return 3;case"4g":return 4;default:return 0}}var wr="0.0.1",Tr=!0,Sr="FIREBASE_INSTALLATIONS_AUTH";function Ir(e){var t=function(){var e=dr.getInstance().localStorage;if(!e)return;var t=e.getItem(or);if(!t||(n=t,!(Number(n)>Date.now())))return;var n;var r=e.getItem(ir);if(!r)return;try{return JSON.parse(r)}catch(i){return}}();return t?(Ar(t),Promise.resolve()):function(e){return function(){var e=vr.getInstance().installationsService.getToken();return e.then((function(e){})),e}().then((function(t){var n="https://firebaseremoteconfig.googleapis.com/v1/projects/"+vr.getInstance().getProjectId()+"/namespaces/fireperf:fetch?key="+vr.getInstance().getApiKey(),r=new Request(n,{method:"POST",headers:{Authorization:Sr+" "+t},body:JSON.stringify({app_instance_id:e,app_instance_id_token:t,app_id:vr.getInstance().getAppId(),app_version:Zn,sdk_version:wr})});return fetch(r).then((function(e){if(e.ok)return e.json();throw cr.create("RC response not ok")}))})).catch((function(){ur.info(Rr)}))}(e).then(Ar).then((function(e){return function(e){var t=dr.getInstance().localStorage;if(!e||!t)return;t.setItem(ir,JSON.stringify(e)),t.setItem(or,String(Date.now()+60*vr.getInstance().configTimeToLive*60*1e3))}(e)}),(function(){}))}var Rr="Could not fetch config, will use default configs";function Ar(e){if(!e)return e;var t=vr.getInstance(),n=e.entries||{};return void 0!==n.fpr_enabled?t.loggingEnabled="true"===String(n.fpr_enabled):t.loggingEnabled=Tr,n.fpr_log_source&&(t.logSource=Number(n.fpr_log_source)),n.fpr_log_endpoint_url&&(t.logEndPointUrl=n.fpr_log_endpoint_url),n.fpr_log_transport_key&&(t.transportKey=n.fpr_log_transport_key),void 0!==n.fpr_vc_network_request_sampling_rate&&(t.networkRequestsSamplingRate=Number(n.fpr_vc_network_request_sampling_rate)),void 0!==n.fpr_vc_trace_sampling_rate&&(t.tracesSamplingRate=Number(n.fpr_vc_trace_sampling_rate)),t.logTraceAfterSampling=Cr(t.tracesSamplingRate),t.logNetworkAfterSampling=Cr(t.networkRequestsSamplingRate),e}function Cr(e){return Math.random()<=e}var kr,Or=1;function Nr(){return Or=2,kr=kr||function(){var e=dr.getInstance().document;return new Promise((function(t){if(e&&"complete"!==e.readyState){var n=function n(){"complete"===e.readyState&&(e.removeEventListener("readystatechange",n),t())};e.addEventListener("readystatechange",n)}else t()}))}().then((function(){return function(){var e=vr.getInstance().installationsService.getId();return e.then((function(e){hr=e})),e}()})).then((function(e){return Ir(e)})).then((function(){return Pr()}),(function(){return Pr()}))}function Pr(){Or=3}var Dr,xr=1e4,Lr=3,Mr=[],Ur=!1;function jr(e){setTimeout((function(){if(0!==Lr)return Mr.length?void function(){var e=Mr.splice(0,1e3),t=e.map((function(e){return{source_extension_json_proto3:e.message,event_time_ms:String(e.eventTime)}}));(function(e,t){return function(e){var t=vr.getInstance().getFlTransportFullUrl();return fetch(t,{method:"POST",body:JSON.stringify(e)})}(e).then((function(e){return e.ok||ur.info("Call to Firebase backend failed."),e.json()})).then((function(e){var n=Number(e.nextRequestWaitMillis),r=xr;isNaN(n)||(r=Math.max(n,r));var i=e.logResponseDetails;Array.isArray(i)&&i.length>0&&"RETRY_REQUEST_LATER"===i[0].responseAction&&(Mr=Yn(Yn([],t),Mr),ur.info("Retry transport request later.")),Lr=3,jr(r)}))})({request_time_ms:String(Date.now()),client_info:{client_type:1,js_client_info:{}},log_source:vr.getInstance().logSource,log_event:t},e).catch((function(){Mr=Yn(Yn([],e),Mr),Lr--,ur.info("Tries left: "+Lr+"."),jr(xr)}))}():jr(xr)}),e)}function Fr(e){if(!e.eventTime||!e.message)throw cr.create("invalid cc log");Mr=Yn(Yn([],Mr),[e])}function Vr(e,t){Dr||(Dr=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];Fr({message:e.apply(void 0,t),eventTime:Date.now()})}}(Gr)),Dr(e,t)}function Br(e){var t=vr.getInstance();!t.instrumentationEnabled&&e.isAuto||(t.dataCollectionEnabled||e.isAuto)&&dr.getInstance().requiredApisAvailable()&&(e.isAuto&&br()!==pr.VISIBLE||(3===Or?Wr(e):Nr().then((function(){return Wr(e)}),(function(){return Wr(e)}))))}function Wr(e){if(mr()){var t=vr.getInstance();t.loggingEnabled&&t.logTraceAfterSampling&&setTimeout((function(){return Vr(e,1)}),0)}}function Gr(e,t){return 0===t?function(e){var t={url:e.url,http_method:e.httpMethod||0,http_response_code:200,response_payload_bytes:e.responsePayloadBytes,client_start_time_us:e.startTimeUs,time_to_response_initiated_us:e.timeToResponseInitiatedUs,time_to_response_completed_us:e.timeToResponseCompletedUs},n={application_info:qr(),network_request_metric:t};return JSON.stringify(n)}(e):function(e){var t={name:e.name,is_auto:e.isAuto,client_start_time_us:e.startTimeUs,duration_us:e.durationUs};0!==Object.keys(e.counters).length&&(t.counters=e.counters);var n=e.getAttributes();0!==Object.keys(n).length&&(t.custom_attributes=n);var r={application_info:qr(),trace_metric:t};return JSON.stringify(r)}(e)}function qr(){return{google_app_id:vr.getInstance().getAppId(),app_instance_id:mr(),web_app_info:{sdk_version:Zn,page_url:dr.getInstance().getUrl(),service_worker_status:_r(),visibility_state:br(),effective_connection_type:Er()},application_process_state:0}}var Kr=["_fp",nr,rr];var Hr=function(){function e(e,t,n){void 0===t&&(t=!1),this.name=e,this.isAuto=t,this.state=1,this.customAttributes={},this.counters={},this.api=dr.getInstance(),this.randomId=Math.floor(1e6*Math.random()),this.isAuto||(this.traceStartMark="FB-PERF-TRACE-START-"+this.randomId+"-"+this.name,this.traceStopMark="FB-PERF-TRACE-STOP-"+this.randomId+"-"+this.name,this.traceMeasure=n||"FB-PERF-TRACE-MEASURE-"+this.randomId+"-"+this.name,n&&this.calculateTraceMetrics())}return e.prototype.start=function(){if(1!==this.state)throw cr.create("trace started",{traceName:this.name});this.api.mark(this.traceStartMark),this.state=2},e.prototype.stop=function(){if(2!==this.state)throw cr.create("trace stopped",{traceName:this.name});this.state=3,this.api.mark(this.traceStopMark),this.api.measure(this.traceMeasure,this.traceStartMark,this.traceStopMark),this.calculateTraceMetrics(),Br(this)},e.prototype.record=function(e,t,n){if(e<=0)throw cr.create("nonpositive trace startTime",{traceName:this.name});if(t<=0)throw cr.create("nonpositive trace duration",{traceName:this.name});if(this.durationUs=Math.floor(1e3*t),this.startTimeUs=Math.floor(1e3*e),n&&n.attributes&&(this.customAttributes=zn({},n.attributes)),n&&n.metrics)for(var r=0,i=Object.keys(n.metrics);r<i.length;r++){var o=i[r];isNaN(Number(n.metrics[o]))||(this.counters[o]=Number(Math.floor(n.metrics[o])))}Br(this)},e.prototype.incrementMetric=function(e,t){void 0===t&&(t=1),void 0===this.counters[e]?this.putMetric(e,t):this.putMetric(e,this.counters[e]+t)},e.prototype.putMetric=function(e,t){if(n=e,r=this.name,0===n.length||n.length>100||!(r&&r.startsWith(tr)&&Kr.indexOf(n)>-1)&&n.startsWith("_"))throw cr.create("invalid custom metric name",{customMetricName:e});var n,r;this.counters[e]=function(e){var t=Math.floor(e);return t<e&&ur.info("Metric value should be an Integer, setting the value as : "+t+"."),t}(t)},e.prototype.getMetric=function(e){return this.counters[e]||0},e.prototype.putAttribute=function(e,t){var n,r=!(0===(n=e).length||n.length>40)&&!gr.some((function(e){return n.startsWith(e)}))&&!!n.match(yr),i=function(e){return 0!==e.length&&e.length<=100}(t);if(r&&i)this.customAttributes[e]=t;else{if(!r)throw cr.create("invalid attribute name",{attributeName:e});if(!i)throw cr.create("invalid attribute value",{attributeValue:t})}},e.prototype.getAttribute=function(e){return this.customAttributes[e]},e.prototype.removeAttribute=function(e){void 0!==this.customAttributes[e]&&delete this.customAttributes[e]},e.prototype.getAttributes=function(){return zn({},this.customAttributes)},e.prototype.setStartTime=function(e){this.startTimeUs=e},e.prototype.setDuration=function(e){this.durationUs=e},e.prototype.calculateTraceMetrics=function(){var e=this.api.getEntriesByName(this.traceMeasure),t=e&&e[0];t&&(this.durationUs=Math.floor(1e3*t.duration),this.startTimeUs=Math.floor(1e3*(t.startTime+this.api.getTimeOrigin())))},e.createOobTrace=function(t,n,r){var i=dr.getInstance().getUrl();if(i){var o=new e(tr+i,!0),a=Math.floor(1e3*dr.getInstance().getTimeOrigin());o.setStartTime(a),t&&t[0]&&(o.setDuration(Math.floor(1e3*t[0].duration)),o.putMetric("domInteractive",Math.floor(1e3*t[0].domInteractive)),o.putMetric("domContentLoadedEventEnd",Math.floor(1e3*t[0].domContentLoadedEventEnd)),o.putMetric("loadEventEnd",Math.floor(1e3*t[0].loadEventEnd)));if(n){var s=n.find((function(e){return"first-paint"===e.name}));s&&s.startTime&&o.putMetric("_fp",Math.floor(1e3*s.startTime));var c=n.find((function(e){return"first-contentful-paint"===e.name}));c&&c.startTime&&o.putMetric(nr,Math.floor(1e3*c.startTime)),r&&o.putMetric(rr,Math.floor(1e3*r))}Br(o)}},e.createUserTimingTrace=function(t){Br(new e(t,!1,t))},e}();function zr(e){var t=e;if(t&&void 0!==t.responseStart){var n=dr.getInstance().getTimeOrigin(),r=Math.floor(1e3*(t.startTime+n)),i=t.responseStart?Math.floor(1e3*(t.responseStart-t.startTime)):void 0,o=Math.floor(1e3*(t.responseEnd-t.startTime));!function(e){var t=vr.getInstance();if(t.instrumentationEnabled){var n=e.url,r=t.logEndPointUrl.split("?")[0],i=t.flTransportEndpointUrl.split("?")[0];n!==r&&n!==i&&t.loggingEnabled&&t.logNetworkAfterSampling&&setTimeout((function(){return Vr(e,0)}),0)}}({url:t.name&&t.name.split("?")[0],responsePayloadBytes:t.transferSize,startTimeUs:r,timeToResponseInitiatedUs:i,timeToResponseCompletedUs:o})}}function Yr(){mr()&&(setTimeout((function(){return function(){var e=dr.getInstance(),t=e.getEntriesByType("navigation"),n=e.getEntriesByType("paint");if(e.onFirstInputDelay){var r=setTimeout((function(){Hr.createOobTrace(t,n),r=void 0}),5e3);e.onFirstInputDelay((function(e){r&&(clearTimeout(r),Hr.createOobTrace(t,n,e))}))}else Hr.createOobTrace(t,n)}()}),0),setTimeout((function(){return function(){for(var e=dr.getInstance(),t=e.getEntriesByType("resource"),n=0,r=t;n<r.length;n++){zr(r[n])}e.setupObserver("resource",zr)}()}),0),setTimeout((function(){return function(){for(var e=dr.getInstance(),t=e.getEntriesByType("measure"),n=0,r=t;n<r.length;n++){Qr(r[n])}e.setupObserver("measure",Qr)}()}),0))}function Qr(e){var t=e.name;t.substring(0,er.length)!==er&&Hr.createUserTimingTrace(t)}var Xr=function(){function e(e){this.app=e,dr.getInstance().requiredApisAvailable()&&Object(a.O)().then((function(e){e&&(Ur||(jr(5500),Ur=!0),Nr().then(Yr,Yr))})).catch((function(e){ur.info("Environment doesn't support IndexedDB: "+e)}))}return e.prototype.trace=function(e){return new Hr(e)},Object.defineProperty(e.prototype,"instrumentationEnabled",{get:function(){return vr.getInstance().instrumentationEnabled},set:function(e){vr.getInstance().instrumentationEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dataCollectionEnabled",{get:function(){return vr.getInstance().dataCollectionEnabled},set:function(e){vr.getInstance().dataCollectionEnabled=e},enumerable:!1,configurable:!0}),e}();!function(e){var t=function(e,t){if("[DEFAULT]"!==e.name)throw cr.create("FB not default");if("undefined"===typeof window)throw cr.create("no window");return function(e){Jn=e}(window),vr.getInstance().firebaseAppInstance=e,vr.getInstance().installationsService=t,new Xr(e)};e.INTERNAL.registerComponent(new u.a("performance",(function(e){var n=e.getProvider("app").getImmediate(),r=e.getProvider("installations").getImmediate();return t(n,r)}),"PUBLIC")),e.registerVersion("@firebase/performance",$n)}(o.a);var Jr=function(){return(Jr=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function $r(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function Zr(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;Object.create;var ei,ti,ni="https://www.googletagmanager.com/gtag/js";!function(e){e.EVENT="event",e.SET="set",e.CONFIG="config"}(ei||(ei={})),function(e){e.ADD_SHIPPING_INFO="add_shipping_info",e.ADD_PAYMENT_INFO="add_payment_info",e.ADD_TO_CART="add_to_cart",e.ADD_TO_WISHLIST="add_to_wishlist",e.BEGIN_CHECKOUT="begin_checkout",e.CHECKOUT_PROGRESS="checkout_progress",e.EXCEPTION="exception",e.GENERATE_LEAD="generate_lead",e.LOGIN="login",e.PAGE_VIEW="page_view",e.PURCHASE="purchase",e.REFUND="refund",e.REMOVE_FROM_CART="remove_from_cart",e.SCREEN_VIEW="screen_view",e.SEARCH="search",e.SELECT_CONTENT="select_content",e.SELECT_ITEM="select_item",e.SELECT_PROMOTION="select_promotion",e.SET_CHECKOUT_OPTION="set_checkout_option",e.SHARE="share",e.SIGN_UP="sign_up",e.TIMING_COMPLETE="timing_complete",e.VIEW_CART="view_cart",e.VIEW_ITEM="view_item",e.VIEW_ITEM_LIST="view_item_list",e.VIEW_PROMOTION="view_promotion",e.VIEW_SEARCH_RESULTS="view_search_results"}(ti||(ti={}));var ri,ii=new s.b("@firebase/analytics");function oi(e,t,n,r,i,o){return $r(this,void 0,void 0,(function(){var a,s,c,u;return Zr(this,(function(l){switch(l.label){case 0:a=r[i],l.label=1;case 1:return l.trys.push([1,7,,8]),a?[4,t[a]]:[3,3];case 2:return l.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return s=l.sent(),(c=s.find((function(e){return e.measurementId===i})))?[4,t[c.appId]]:[3,6];case 5:l.sent(),l.label=6;case 6:return[3,8];case 7:return u=l.sent(),ii.error(u),[3,8];case 8:return e(ei.CONFIG,i,o),[2]}}))}))}function ai(e,t,n,r,i){return $r(this,void 0,void 0,(function(){var o,a,s,c,u,l,d,f;return Zr(this,(function(h){switch(h.label){case 0:return h.trys.push([0,4,,5]),o=[],i&&i.send_to?(a=i.send_to,Array.isArray(a)||(a=[a]),[4,Promise.all(n)]):[3,2];case 1:for(s=h.sent(),c=function(e){var n=s.find((function(t){return t.measurementId===e})),r=n&&t[n.appId];if(!r)return o=[],"break";o.push(r)},u=0,l=a;u<l.length&&(d=l[u],"break"!==c(d));u++);h.label=2;case 2:return 0===o.length&&(o=Object.values(t)),[4,Promise.all(o)];case 3:return h.sent(),e(ei.EVENT,r,i||{}),[3,5];case 4:return f=h.sent(),ii.error(f),[3,5];case 5:return[2]}}))}))}function si(e,t,n,r,i){var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];window[r].push(arguments)};return window[i]&&"function"===typeof window[i]&&(o=window[i]),window[i]=function(e,t,n,r){return function(i,o,a){return $r(this,void 0,void 0,(function(){var s;return Zr(this,(function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),i!==ei.EVENT?[3,2]:[4,ai(e,t,n,o,a)];case 1:return c.sent(),[3,5];case 2:return i!==ei.CONFIG?[3,4]:[4,oi(e,t,n,r,o,a)];case 3:return c.sent(),[3,5];case 4:e(ei.SET,o),c.label=5;case 5:return[3,7];case 6:return s=c.sent(),ii.error(s),[3,7];case 7:return[2]}}))}))}}(o,e,t,n),{gtagCore:o,wrappedGtag:window[i]}}var ci=((ri={})["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",ri["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",ri["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",ri["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ri["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",ri["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",ri["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",ri["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',ri["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',ri),ui=new a.b("analytics","Analytics",ci),li=new(function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t=1e3),this.throttleMetadata=e,this.intervalMillis=t}return e.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},e.prototype.setThrottleMetadata=function(e,t){this.throttleMetadata[e]=t},e.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},e}());function di(e){return new Headers({Accept:"application/json","x-goog-api-key":e})}function fi(e){var t;return $r(this,void 0,void 0,(function(){var n,r,i,o,a,s,c;return Zr(this,(function(u){switch(u.label){case 0:return n=e.appId,r=e.apiKey,i={method:"GET",headers:di(r)},o="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig".replace("{app-id}",n),[4,fetch(o,i)];case 1:if(200===(a=u.sent()).status||304===a.status)return[3,6];s="",u.label=2;case 2:return u.trys.push([2,4,,5]),[4,a.json()];case 3:return c=u.sent(),(null===(t=c.error)||void 0===t?void 0:t.message)&&(s=c.error.message),[3,5];case 4:return u.sent(),[3,5];case 5:throw ui.create("config-fetch-failed",{httpStatus:a.status,responseMessage:s});case 6:return[2,a.json()]}}))}))}function hi(e,t,n,r){var i=t.throttleEndTimeMillis,o=t.backoffCount;return void 0===r&&(r=li),$r(this,void 0,void 0,(function(){var t,s,c,u,l,d,f;return Zr(this,(function(h){switch(h.label){case 0:t=e.appId,s=e.measurementId,h.label=1;case 1:return h.trys.push([1,3,,4]),[4,pi(n,i)];case 2:return h.sent(),[3,4];case 3:if(c=h.sent(),s)return ii.warn("Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+c.message+"]"),[2,{appId:t,measurementId:s}];throw c;case 4:return h.trys.push([4,6,,7]),[4,fi(e)];case 5:return u=h.sent(),r.deleteThrottleMetadata(t),[2,u];case 6:if(!function(e){if(!(e instanceof a.c)||!e.customData)return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(l=h.sent())){if(r.deleteThrottleMetadata(t),s)return ii.warn("Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID "+s+' provided in the "measurementId" field in the local Firebase config. ['+l.message+"]"),[2,{appId:t,measurementId:s}];throw l}return d=503===Number(l.customData.httpStatus)?Object(a.j)(o,r.intervalMillis,30):Object(a.j)(o,r.intervalMillis),f={throttleEndTimeMillis:Date.now()+d,backoffCount:o+1},r.setThrottleMetadata(t,f),ii.debug("Calling attemptFetch again in "+d+" millis"),[2,hi(e,f,n,r)];case 7:return[2]}}))}))}function pi(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener((function(){clearTimeout(o),r(ui.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}var vi=function(){function e(){this.listeners=[]}return e.prototype.addEventListener=function(e){this.listeners.push(e)},e.prototype.abort=function(){this.listeners.forEach((function(e){return e()}))},e}();function mi(e,t,n,r,i,o){return $r(this,void 0,void 0,(function(){var s,c,u,l,d,f,h;return Zr(this,(function(p){switch(p.label){case 0:return(s=function(e,t,n){return void 0===t&&(t=li),$r(this,void 0,void 0,(function(){var r,i,o,a,s,c,u=this;return Zr(this,(function(l){if(r=e.options,i=r.appId,o=r.apiKey,a=r.measurementId,!i)throw ui.create("no-app-id");if(!o){if(a)return[2,{measurementId:a,appId:i}];throw ui.create("no-api-key")}return s=t.getThrottleMetadata(i)||{backoffCount:0,throttleEndTimeMillis:Date.now()},c=new vi,setTimeout((function(){return $r(u,void 0,void 0,(function(){return Zr(this,(function(e){return c.abort(),[2]}))}))}),void 0!==n?n:6e4),[2,hi({appId:i,apiKey:o,measurementId:a},s,c,t)]}))}))}(e)).then((function(t){n[t.measurementId]=t.appId,e.options.measurementId&&t.measurementId!==e.options.measurementId&&ii.warn("The measurement ID in the local Firebase config ("+e.options.measurementId+") does not match the measurement ID fetched from the server ("+t.measurementId+"). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")})).catch((function(e){return ii.error(e)})),t.push(s),c=function(){return $r(this,void 0,void 0,(function(){var e;return Zr(this,(function(t){switch(t.label){case 0:return Object(a.x)()?[3,1]:(ii.warn(ui.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return t.trys.push([1,3,,4]),[4,Object(a.O)()];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),ii.warn(ui.create("indexeddb-unavailable",{errorInfo:e}).message),[2,!1];case 4:return[2,!0]}}))}))}().then((function(e){return e?r.getId():void 0})),[4,Promise.all([s,c])];case 1:return u=p.sent(),l=u[0],d=u[1],function(){for(var e=window.document.getElementsByTagName("script"),t=0,n=Object.values(e);t<n.length;t++){var r=n[t];if(r.src&&r.src.includes(ni))return r}return null}()||function(e,t){var n=document.createElement("script");n.src=ni+"?l="+e+"&id="+t,n.async=!0,document.head.appendChild(n)}(o,l.measurementId),i("js",new Date),(h={}).origin="firebase",h.update=!0,f=h,null!=d&&(f.firebase_id=d),i(ei.CONFIG,l.measurementId,f),[2,l.measurementId]}}))}))}var gi,yi,_i={},bi=[],Ei={},wi="dataLayer",Ti="gtag",Si=!1;function Ii(e){if(Si)throw ui.create("already-initialized");e.dataLayerName&&(wi=e.dataLayerName),e.gtagName&&(Ti=e.gtagName)}function Ri(e,t){!function(){var e=[];if(Object(a.t)()&&e.push("This is a browser extension environment."),Object(a.e)()||e.push("Cookies are not available."),e.length>0){var t=e.map((function(e,t){return"("+(t+1)+") "+e})).join(" "),n=ui.create("invalid-analytics-context",{errorInfo:t});ii.warn(n.message)}}();var n=e.options.appId;if(!n)throw ui.create("no-app-id");if(!e.options.apiKey){if(!e.options.measurementId)throw ui.create("no-api-key");ii.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID '+e.options.measurementId+' provided in the "measurementId" field in the local Firebase config.')}if(null!=_i[n])throw ui.create("already-exists",{id:n});if(!Si){!function(e){var t=[];Array.isArray(window[e])?t=window[e]:window[e]=t}(wi);var r=si(_i,bi,Ei,wi,Ti),i=r.wrappedGtag,o=r.gtagCore;yi=i,gi=o,Si=!0}return _i[n]=mi(e,bi,Ei,t,gi,wi),{app:e,logEvent:function(e,t,r){(function(e,t,n,r,i){return $r(this,void 0,void 0,(function(){var o,a;return Zr(this,(function(s){switch(s.label){case 0:return i&&i.global?(e(ei.EVENT,n,r),[2]):[3,1];case 1:return[4,t];case 2:o=s.sent(),a=Jr(Jr({},r),{send_to:o}),e(ei.EVENT,n,a),s.label=3;case 3:return[2]}}))}))})(yi,_i[n],e,t,r).catch((function(e){return ii.error(e)}))},setCurrentScreen:function(e,t){(function(e,t,n,r){return $r(this,void 0,void 0,(function(){var i;return Zr(this,(function(o){switch(o.label){case 0:return r&&r.global?(e(ei.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,t];case 2:i=o.sent(),e(ei.CONFIG,i,{update:!0,screen_name:n}),o.label=3;case 3:return[2]}}))}))})(yi,_i[n],e,t).catch((function(e){return ii.error(e)}))},setUserId:function(e,t){(function(e,t,n,r){return $r(this,void 0,void 0,(function(){var i;return Zr(this,(function(o){switch(o.label){case 0:return r&&r.global?(e(ei.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,t];case 2:i=o.sent(),e(ei.CONFIG,i,{update:!0,user_id:n}),o.label=3;case 3:return[2]}}))}))})(yi,_i[n],e,t).catch((function(e){return ii.error(e)}))},setUserProperties:function(e,t){(function(e,t,n,r){return $r(this,void 0,void 0,(function(){var i,o,a,s,c;return Zr(this,(function(u){switch(u.label){case 0:if(!r||!r.global)return[3,1];for(i={},o=0,a=Object.keys(n);o<a.length;o++)s=a[o],i["user_properties."+s]=n[s];return e(ei.SET,i),[2,Promise.resolve()];case 1:return[4,t];case 2:c=u.sent(),e(ei.CONFIG,c,{update:!0,user_properties:n}),u.label=3;case 3:return[2]}}))}))})(yi,_i[n],e,t).catch((function(e){return ii.error(e)}))},setAnalyticsCollectionEnabled:function(e){(function(e,t){return $r(this,void 0,void 0,(function(){var n;return Zr(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return n=r.sent(),window["ga-disable-"+n]=!t,[2]}}))}))})(_i[n],e).catch((function(e){return ii.error(e)}))},INTERNAL:{delete:function(){return delete _i[n],Promise.resolve()}}}}var Ai="analytics";function Ci(){return $r(this,void 0,void 0,(function(){return Zr(this,(function(e){switch(e.label){case 0:if(Object(a.t)())return[2,!1];if(!Object(a.e)())return[2,!1];if(!Object(a.x)())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Object(a.O)()];case 2:return[2,e.sent()];case 3:return e.sent(),[2,!1];case 4:return[2]}}))}))}!function(e){e.INTERNAL.registerComponent(new u.a(Ai,(function(e){return Ri(e.getProvider("app").getImmediate(),e.getProvider("installations").getImmediate())}),"PUBLIC").setServiceProps({settings:Ii,EventName:ti,isSupported:Ci})),e.INTERNAL.registerComponent(new u.a("analytics-internal",(function(e){try{return{logEvent:e.getProvider(Ai).getImmediate().logEvent}}catch(r){throw ui.create("interop-component-reg-failed",{reason:r})}}),"PRIVATE")),e.registerVersion("@firebase/analytics","0.6.9")}(o.a);var ki=function(){return(ki=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function Oi(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{u(i.next(e))}catch(r){a(r)}}function c(e){try{u(i.throw(e))}catch(r){a(r)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,c)}u((i=i.apply(e,t||[])).next())}))}function Ni(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"===typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(r){a=[6,r],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}Object.create;Object.create;var Pi,Di=function(){function e(e,t,n,r){this.client=e,this.storage=t,this.storageCache=n,this.logger=r}return e.prototype.isCachedDataFresh=function(e,t){if(!t)return this.logger.debug("Config fetch cache check. Cache unpopulated."),!1;var n=Date.now()-t,r=n<=e;return this.logger.debug("Config fetch cache check. Cache age millis: "+n+". Cache max age millis (minimumFetchIntervalMillis setting): "+e+". Is cache hit: "+r+"."),r},e.prototype.fetch=function(e){return Oi(this,void 0,void 0,(function(){var t,n,r,i,o;return Ni(this,(function(a){switch(a.label){case 0:return[4,Promise.all([this.storage.getLastSuccessfulFetchTimestampMillis(),this.storage.getLastSuccessfulFetchResponse()])];case 1:return t=a.sent(),n=t[0],(r=t[1])&&this.isCachedDataFresh(e.cacheMaxAgeMillis,n)?[2,r]:(e.eTag=r&&r.eTag,[4,this.client.fetch(e)]);case 2:return i=a.sent(),o=[this.storageCache.setLastSuccessfulFetchTimestampMillis(Date.now())],200===i.status&&o.push(this.storage.setLastSuccessfulFetchResponse(i)),[4,Promise.all(o)];case 3:return a.sent(),[2,i]}}))}))},e}(),xi=((Pi={})["registration-window"]="Undefined window object. This SDK only supports usage in a browser environment.",Pi["registration-project-id"]="Undefined project identifier. Check Firebase app initialization.",Pi["registration-api-key"]="Undefined API key. Check Firebase app initialization.",Pi["registration-app-id"]="Undefined app identifier. Check Firebase app initialization.",Pi["storage-open"]="Error thrown when opening storage. Original error: {$originalErrorMessage}.",Pi["storage-get"]="Error thrown when reading from storage. Original error: {$originalErrorMessage}.",Pi["storage-set"]="Error thrown when writing to storage. Original error: {$originalErrorMessage}.",Pi["storage-delete"]="Error thrown when deleting from storage. Original error: {$originalErrorMessage}.",Pi["fetch-client-network"]="Fetch client failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.",Pi["fetch-timeout"]='The config fetch request timed out.  Configure timeout using "fetchTimeoutMillis" SDK setting.',Pi["fetch-throttle"]='The config fetch request timed out while in an exponential backoff state. Configure timeout using "fetchTimeoutMillis" SDK setting. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.',Pi["fetch-client-parse"]="Fetch client could not parse response. Original error: {$originalErrorMessage}.",Pi["fetch-status"]="Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.",Pi),Li=new a.b("remoteconfig","Remote Config",xi);var Mi=function(){function e(e,t,n,r,i,o){this.firebaseInstallations=e,this.sdkVersion=t,this.namespace=n,this.projectId=r,this.apiKey=i,this.appId=o}return e.prototype.fetch=function(e){return Oi(this,void 0,void 0,(function(){var t,n,r,i,o,a,s,c,u,l,d,f,h,p,v,m,g,y,_;return Ni(this,(function(b){switch(b.label){case 0:return[4,Promise.all([this.firebaseInstallations.getId(),this.firebaseInstallations.getToken()])];case 1:t=b.sent(),n=t[0],r=t[1],i=window.FIREBASE_REMOTE_CONFIG_URL_BASE||"https://firebaseremoteconfig.googleapis.com",o=i+"/v1/projects/"+this.projectId+"/namespaces/"+this.namespace+":fetch?key="+this.apiKey,a={"Content-Type":"application/json","Content-Encoding":"gzip","If-None-Match":e.eTag||"*"},s={sdk_version:this.sdkVersion,app_instance_id:n,app_instance_id_token:r,app_id:this.appId,language_code:(void 0===E&&(E=navigator),E.languages&&E.languages[0]||E.language)},c={method:"POST",headers:a,body:JSON.stringify(s)},u=fetch(o,c),l=new Promise((function(t,n){e.signal.addEventListener((function(){var e=new Error("The operation was aborted.");e.name="AbortError",n(e)}))})),b.label=2;case 2:return b.trys.push([2,5,,6]),[4,Promise.race([u,l])];case 3:return b.sent(),[4,u];case 4:return d=b.sent(),[3,6];case 5:throw f=b.sent(),h="fetch-client-network","AbortError"===f.name&&(h="fetch-timeout"),Li.create(h,{originalErrorMessage:f.message});case 6:if(p=d.status,v=d.headers.get("ETag")||void 0,200!==d.status)return[3,11];y=void 0,b.label=7;case 7:return b.trys.push([7,9,,10]),[4,d.json()];case 8:return y=b.sent(),[3,10];case 9:throw _=b.sent(),Li.create("fetch-client-parse",{originalErrorMessage:_.message});case 10:m=y.entries,g=y.state,b.label=11;case 11:if("INSTANCE_STATE_UNSPECIFIED"===g?p=500:"NO_CHANGE"===g?p=304:"NO_TEMPLATE"!==g&&"EMPTY_CONFIG"!==g||(m={}),304!==p&&200!==p)throw Li.create("fetch-status",{httpStatus:p});return[2,{status:p,eTag:v,config:m}]}var E}))}))},e}(),Ui=function(){function e(){this.listeners=[]}return e.prototype.addEventListener=function(e){this.listeners.push(e)},e.prototype.abort=function(){this.listeners.forEach((function(e){return e()}))},e}(),ji=["1","true","t","yes","y","on"],Fi=function(){function e(e,t){void 0===t&&(t=""),this._source=e,this._value=t}return e.prototype.asString=function(){return this._value},e.prototype.asBoolean=function(){return"static"!==this._source&&ji.indexOf(this._value.toLowerCase())>=0},e.prototype.asNumber=function(){if("static"===this._source)return 0;var e=Number(this._value);return isNaN(e)&&(e=0),e},e.prototype.getSource=function(){return this._source},e}(),Vi=function(){function e(e,t,n,r,i){this.app=e,this._client=t,this._storageCache=n,this._storage=r,this._logger=i,this._isInitializationComplete=!1,this.settings={fetchTimeoutMillis:6e4,minimumFetchIntervalMillis:432e5},this.defaultConfig={}}return e.prototype.setLogLevel=function(e){switch(e){case"debug":this._logger.logLevel=s.a.DEBUG;break;case"silent":this._logger.logLevel=s.a.SILENT;break;default:this._logger.logLevel=s.a.ERROR}},Object.defineProperty(e.prototype,"fetchTimeMillis",{get:function(){return this._storageCache.getLastSuccessfulFetchTimestampMillis()||-1},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lastFetchStatus",{get:function(){return this._storageCache.getLastFetchStatus()||"no-fetch-yet"},enumerable:!1,configurable:!0}),e.prototype.activate=function(){return Oi(this,void 0,void 0,(function(){var e,t,n;return Ni(this,(function(r){switch(r.label){case 0:return[4,Promise.all([this._storage.getLastSuccessfulFetchResponse(),this._storage.getActiveConfigEtag()])];case 1:return e=r.sent(),t=e[0],n=e[1],t&&t.config&&t.eTag&&t.eTag!==n?[4,Promise.all([this._storageCache.setActiveConfig(t.config),this._storage.setActiveConfigEtag(t.eTag)])]:[2,!1];case 2:return r.sent(),[2,!0]}}))}))},e.prototype.ensureInitialized=function(){var e=this;return this._initializePromise||(this._initializePromise=this._storageCache.loadFromStorage().then((function(){e._isInitializationComplete=!0}))),this._initializePromise},e.prototype.fetch=function(){return Oi(this,void 0,void 0,(function(){var e,t,n,r=this;return Ni(this,(function(i){switch(i.label){case 0:e=new Ui,setTimeout((function(){return Oi(r,void 0,void 0,(function(){return Ni(this,(function(t){return e.abort(),[2]}))}))}),this.settings.fetchTimeoutMillis),i.label=1;case 1:return i.trys.push([1,4,,6]),[4,this._client.fetch({cacheMaxAgeMillis:this.settings.minimumFetchIntervalMillis,signal:e})];case 2:return i.sent(),[4,this._storageCache.setLastFetchStatus("success")];case 3:return i.sent(),[3,6];case 4:return t=i.sent(),n=function(e,t){return e instanceof a.c&&-1!==e.code.indexOf(t)}(t,"fetch-throttle")?"throttle":"failure",[4,this._storageCache.setLastFetchStatus(n)];case 5:throw i.sent(),t;case 6:return[2]}}))}))},e.prototype.fetchAndActivate=function(){return Oi(this,void 0,void 0,(function(){return Ni(this,(function(e){switch(e.label){case 0:return[4,this.fetch()];case 1:return e.sent(),[2,this.activate()]}}))}))},e.prototype.getAll=function(){var e=this;return function(e,t){void 0===e&&(e={});void 0===t&&(t={});return Object.keys(ki(ki({},e),t))}(this._storageCache.getActiveConfig(),this.defaultConfig).reduce((function(t,n){return t[n]=e.getValue(n),t}),{})},e.prototype.getBoolean=function(e){return this.getValue(e).asBoolean()},e.prototype.getNumber=function(e){return this.getValue(e).asNumber()},e.prototype.getString=function(e){return this.getValue(e).asString()},e.prototype.getValue=function(e){this._isInitializationComplete||this._logger.debug('A value was requested for key "'+e+'" before SDK initialization completed. Await on ensureInitialized if the intent was to get a previously activated value.');var t=this._storageCache.getActiveConfig();return t&&void 0!==t[e]?new Fi("remote",t[e]):this.defaultConfig&&void 0!==this.defaultConfig[e]?new Fi("default",String(this.defaultConfig[e])):(this._logger.debug('Returning static value for key "'+e+'". Define a default or remote value if this is unintentional.'),new Fi("static"))},e}();function Bi(e,t){var n=e.target.error||void 0;return Li.create(t,{originalErrorMessage:n&&n.message})}var Wi="app_namespace_store";var Gi=function(){function e(e,t,n,r){void 0===r&&(r=new Promise((function(e,t){var n=indexedDB.open("firebase_remote_config",1);n.onerror=function(e){t(Bi(e,"storage-open"))},n.onsuccess=function(t){e(t.target.result)},n.onupgradeneeded=function(e){var t=e.target.result;switch(e.oldVersion){case 0:t.createObjectStore(Wi,{keyPath:"compositeKey"})}}}))),this.appId=e,this.appName=t,this.namespace=n,this.openDbPromise=r}return e.prototype.getLastFetchStatus=function(){return this.get("last_fetch_status")},e.prototype.setLastFetchStatus=function(e){return this.set("last_fetch_status",e)},e.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.get("last_successful_fetch_timestamp_millis")},e.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.set("last_successful_fetch_timestamp_millis",e)},e.prototype.getLastSuccessfulFetchResponse=function(){return this.get("last_successful_fetch_response")},e.prototype.setLastSuccessfulFetchResponse=function(e){return this.set("last_successful_fetch_response",e)},e.prototype.getActiveConfig=function(){return this.get("active_config")},e.prototype.setActiveConfig=function(e){return this.set("active_config",e)},e.prototype.getActiveConfigEtag=function(){return this.get("active_config_etag")},e.prototype.setActiveConfigEtag=function(e){return this.set("active_config_etag",e)},e.prototype.getThrottleMetadata=function(){return this.get("throttle_metadata")},e.prototype.setThrottleMetadata=function(e){return this.set("throttle_metadata",e)},e.prototype.deleteThrottleMetadata=function(){return this.delete("throttle_metadata")},e.prototype.get=function(e){return Oi(this,void 0,void 0,(function(){var t,n=this;return Ni(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return t=i.sent(),[2,new Promise((function(i,o){var a=t.transaction([Wi],"readonly").objectStore(Wi),s=n.createCompositeKey(e);try{var c=a.get(s);c.onerror=function(e){o(Bi(e,"storage-get"))},c.onsuccess=function(e){var t=e.target.result;i(t?t.value:void 0)}}catch(r){o(Li.create("storage-get",{originalErrorMessage:r&&r.message}))}}))]}}))}))},e.prototype.set=function(e,t){return Oi(this,void 0,void 0,(function(){var n,i=this;return Ni(this,(function(o){switch(o.label){case 0:return[4,this.openDbPromise];case 1:return n=o.sent(),[2,new Promise((function(o,a){var s=n.transaction([Wi],"readwrite").objectStore(Wi),c=i.createCompositeKey(e);try{var u=s.put({compositeKey:c,value:t});u.onerror=function(e){a(Bi(e,"storage-set"))},u.onsuccess=function(){o()}}catch(r){a(Li.create("storage-set",{originalErrorMessage:r&&r.message}))}}))]}}))}))},e.prototype.delete=function(e){return Oi(this,void 0,void 0,(function(){var t,n=this;return Ni(this,(function(i){switch(i.label){case 0:return[4,this.openDbPromise];case 1:return t=i.sent(),[2,new Promise((function(i,o){var a=t.transaction([Wi],"readwrite").objectStore(Wi),s=n.createCompositeKey(e);try{var c=a.delete(s);c.onerror=function(e){o(Bi(e,"storage-delete"))},c.onsuccess=function(){i()}}catch(r){o(Li.create("storage-delete",{originalErrorMessage:r&&r.message}))}}))]}}))}))},e.prototype.createCompositeKey=function(e){return[this.appId,this.appName,this.namespace,e].join()},e}(),qi=function(){function e(e){this.storage=e}return e.prototype.getLastFetchStatus=function(){return this.lastFetchStatus},e.prototype.getLastSuccessfulFetchTimestampMillis=function(){return this.lastSuccessfulFetchTimestampMillis},e.prototype.getActiveConfig=function(){return this.activeConfig},e.prototype.loadFromStorage=function(){return Oi(this,void 0,void 0,(function(){var e,t,n,r,i,o;return Ni(this,(function(a){switch(a.label){case 0:return e=this.storage.getLastFetchStatus(),t=this.storage.getLastSuccessfulFetchTimestampMillis(),n=this.storage.getActiveConfig(),[4,e];case 1:return(r=a.sent())&&(this.lastFetchStatus=r),[4,t];case 2:return(i=a.sent())&&(this.lastSuccessfulFetchTimestampMillis=i),[4,n];case 3:return(o=a.sent())&&(this.activeConfig=o),[2]}}))}))},e.prototype.setLastFetchStatus=function(e){return this.lastFetchStatus=e,this.storage.setLastFetchStatus(e)},e.prototype.setLastSuccessfulFetchTimestampMillis=function(e){return this.lastSuccessfulFetchTimestampMillis=e,this.storage.setLastSuccessfulFetchTimestampMillis(e)},e.prototype.setActiveConfig=function(e){return this.activeConfig=e,this.storage.setActiveConfig(e)},e}();function Ki(e,t){return new Promise((function(n,r){var i=Math.max(t-Date.now(),0),o=setTimeout(n,i);e.addEventListener((function(){clearTimeout(o),r(Li.create("fetch-throttle",{throttleEndTimeMillis:t}))}))}))}var Hi,zi=function(){function e(e,t){this.client=e,this.storage=t}return e.prototype.fetch=function(e){return Oi(this,void 0,void 0,(function(){var t;return Ni(this,(function(n){switch(n.label){case 0:return[4,this.storage.getThrottleMetadata()];case 1:return t=n.sent()||{backoffCount:0,throttleEndTimeMillis:Date.now()},[2,this.attemptFetch(e,t)]}}))}))},e.prototype.attemptFetch=function(e,t){var n=t.throttleEndTimeMillis,r=t.backoffCount;return Oi(this,void 0,void 0,(function(){var t,i,o;return Ni(this,(function(s){switch(s.label){case 0:return[4,Ki(e.signal,n)];case 1:s.sent(),s.label=2;case 2:return s.trys.push([2,5,,7]),[4,this.client.fetch(e)];case 3:return t=s.sent(),[4,this.storage.deleteThrottleMetadata()];case 4:return s.sent(),[2,t];case 5:if(!function(e){if(!(e instanceof a.c)||!e.customData)return!1;var t=Number(e.customData.httpStatus);return 429===t||500===t||503===t||504===t}(i=s.sent()))throw i;return o={throttleEndTimeMillis:Date.now()+Object(a.j)(r),backoffCount:r+1},[4,this.storage.setThrottleMetadata(o)];case 6:return s.sent(),[2,this.attemptFetch(e,o)];case 7:return[2]}}))}))},e}(),Yi="@firebase/remote-config";(Hi=o.a).INTERNAL.registerComponent(new u.a("remoteConfig",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("installations").getImmediate();if("undefined"===typeof window)throw Li.create("registration-window");var o=r.options,a=o.projectId,c=o.apiKey,u=o.appId;if(!a)throw Li.create("registration-project-id");if(!c)throw Li.create("registration-api-key");if(!u)throw Li.create("registration-app-id");n=n||"firebase";var l=new Gi(u,r.name,n),d=new qi(l),f=new s.b(Yi);f.logLevel=s.a.ERROR;var h=new Mi(i,Hi.SDK_VERSION,n,a,c,u),p=new zi(h,l),v=new Di(p,l,d,f),m=new Vi(r,v,d,l,f);return m.ensureInitialized(),m}),"PUBLIC").setMultipleInstances(!0)),Hi.registerVersion(Yi,"0.1.36");o.a.registerVersion("firebase","8.4.1","app");console.warn("\nIt looks like you're using the development build of the Firebase JS SDK.\nWhen deploying Firebase apps to production, it is advisable to only import\nthe individual SDK components you intend to use.\n\nFor the module builds, these are available in the following manner\n(replace <PACKAGE> with the name of a component - i.e. auth, database, etc):\n\nCommonJS Modules:\nconst firebase = require('firebase/app');\nrequire('firebase/<PACKAGE>');\n\nES Modules:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n\nTypescript:\nimport firebase from 'firebase/app';\nimport 'firebase/<PACKAGE>';\n"),o.a.registerVersion("firebase","8.4.1")},function(e,t,n){"use strict";var r=n(11),i=n(12),o=n(22),a=n(6),s=n(4),c=n(26);function u(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e}var l=u,d=(n(40),[]),f=0;function h(e){try{m(),e()}finally{g()}}function p(e){d.push(e),f||(m(),y())}function v(e){try{return m(),e()}finally{y()}}function m(){f++}function g(){f--}function y(){var e;for(g();!f&&void 0!==(e=d.shift());)h(e)}var _=function(e){return function(t){return e.some((function(e){return S(e)(t)}))}},b=function(e){return function(t){return e(t)}},E=function(e){return function(t){return t.type===String(e)}},w=function(e){return function(t){return t.type===e}},T=function(){return s.G};function S(e){var t="*"===e?T:Object(a.k)(e)?E:Object(a.a)(e)?_:Object(a.l)(e)?E:Object(a.d)(e)?b:Object(a.m)(e)?w:null;if(null===t)throw new Error("invalid pattern: "+e);return t(e)}var I={type:r.b},R=function(e){return e&&e.type===r.b};function A(e){void 0===e&&(e=Object(s.A)());var t=!1,n=[];return{take:function(r){t&&e.isEmpty()?r(I):e.isEmpty()?(n.push(r),r.cancel=function(){Object(s.N)(n,r)}):r(e.take())},put:function(r){if(!t){if(0===n.length)return e.put(r);n.shift()(r)}},flush:function(n){t&&e.isEmpty()?n(I):n(e.flush())},close:function(){if(!t){t=!0;var e=n;n=[];for(var r=0,i=e.length;r<i;r++){(0,e[r])(I)}}}}}function C(){var e=function(){var e,t=!1,n=[],i=n,o=function(){i===n&&(i=n.slice())},a=function(){t=!0;var e=n=i;i=[],e.forEach((function(e){e(I)}))};return(e={})[r.e]=!0,e.put=function(e){if(!t)if(R(e))a();else for(var o=n=i,s=0,c=o.length;s<c;s++){var u=o[s];u[r.d](e)&&(u.cancel(),u(e))}},e.take=function(e,n){void 0===n&&(n=T),t?e(I):(e[r.d]=n,o(),i.push(e),e.cancel=Object(s.K)((function(){o(),Object(s.N)(i,e)})))},e.close=a,e}(),t=e.put;return e.put=function(e){e[r.f]?t(e):p((function(){t(e)}))},e}function k(e,t){var n=e[r.a];Object(a.d)(n)&&(t.cancel=n),e.then(t,(function(e){t(e,!0)}))}var O,N=0,P=function(){return++N};function D(e){e.isRunning()&&e.cancel()}var x=((O={})[s.r]=function(e,t,n){var i=t.channel,o=void 0===i?e.channel:i,s=t.pattern,c=t.maybe,u=function(e){e instanceof Error?n(e,!0):!R(e)||c?n(e):n(r.k)};try{o.take(u,Object(a.g)(s)?S(s):null)}catch(l){return void n(l,!0)}n.cancel=u.cancel},O[s.n]=function(e,t,n){var r=t.channel,i=t.action,o=t.resolve;p((function(){var t;try{t=(r?r.put:e.dispatch)(i)}catch(s){return void n(s,!0)}o&&Object(a.j)(t)?k(t,n):n(t)}))},O[s.a]=function(e,t,n,r){var i=r.digestEffect,o=N,c=Object.keys(t);if(0!==c.length){var u=Object(s.H)(t,n);c.forEach((function(e){i(t[e],o,u[e],e)}))}else n(Object(a.a)(t)?[]:{})},O[s.p]=function(e,t,n,r){var i=r.digestEffect,o=N,c=Object.keys(t),u=Object(a.a)(t)?Object(s.I)(c.length):{},l={},d=!1;c.forEach((function(e){var t=function(t,r){d||(r||Object(s.O)(t)?(n.cancel(),n(t,r)):(n.cancel(),d=!0,u[e]=t,n(u)))};t.cancel=s.P,l[e]=t})),n.cancel=function(){d||(d=!0,c.forEach((function(e){return l[e].cancel()})))},c.forEach((function(e){d||i(t[e],o,l[e],e)}))},O[s.c]=function(e,t,n,r){var i=t.context,o=t.fn,c=t.args,u=r.task;try{var l=o.apply(i,c);if(Object(a.j)(l))return void k(l,n);if(Object(a.e)(l))return void G(e,l,u.context,N,Object(s.F)(o),!1,n);n(l)}catch(d){n(d,!0)}},O[s.w]=function(e,t,n){var r=t.context,i=t.fn,o=t.args;try{var s=function(e,t){Object(a.n)(e)?n(t):n(e,!0)};i.apply(r,o.concat(s)),s.cancel&&(n.cancel=s.cancel)}catch(c){n(c,!0)}},O[s.f]=function(e,t,n,r){var i=t.context,o=t.fn,c=t.args,u=t.detached,l=r.task,d=function(e){var t=e.context,n=e.fn,r=e.args;try{var i=n.apply(t,r);if(Object(a.e)(i))return i;var o=!1;return Object(s.M)((function(e){return o?{value:e,done:!0}:(o=!0,{value:i,done:!Object(a.j)(i)})}))}catch(c){return Object(s.M)((function(){throw c}))}}({context:i,fn:o,args:c}),f=function(e,t){return e.isSagaIterator?{name:e.meta.name}:Object(s.F)(t)}(d,o);v((function(){var t=G(e,d,l.context,N,f,u,void 0);u?n(t):t.isRunning()?(l.queue.addTask(t),n(t)):t.isAborted()?l.queue.abort(t.error()):n(t)}))},O[s.h]=function(e,t,n,r){var i=r.task,o=function(e,t){if(e.isRunning()){var n={task:i,cb:t};t.cancel=function(){e.isRunning()&&Object(s.N)(e.joiners,n)},e.joiners.push(n)}else e.isAborted()?t(e.error(),!0):t(e.result())};if(Object(a.a)(t)){if(0===t.length)return void n([]);var c=Object(s.H)(t,n);t.forEach((function(e,t){o(e,c[t])}))}else o(t,n)},O[s.x]=function(e,t,n,i){var o=i.task;t===r.h?D(o):Object(a.a)(t)?t.forEach(D):D(t),n()},O[s.q]=function(e,t,n){var r=t.selector,i=t.args;try{n(r.apply(void 0,[e.getState()].concat(i)))}catch(o){n(o,!0)}},O[s.z]=function(e,t,n){var r=t.pattern,i=A(t.buffer),o=S(r),a=function t(n){R(n)||e.channel.take(t,o),i.put(n)},s=i.close;i.close=function(){a.cancel(),s()},e.channel.take(a,o),n(i)},O[s.B]=function(e,t,n,r){n(r.task.isCancelled())},O[s.C]=function(e,t,n){t.flush(n)},O[s.g]=function(e,t,n,r){n(r.task.context[t])},O[s.D]=function(e,t,n,r){var i=r.task;Object(s.L)(i.context,t),n()},O);function L(e,t){return e+"?"+t}function M(e){var t=e.name,n=e.location;return n?t+"  "+L(n.fileName,n.lineNumber):t}function U(e){var t=Object(s.Q)((function(e){return e.cancelledTasks}),e);return t.length?["Tasks cancelled due to error:"].concat(t).join("\n"):""}var j=null,F=[],V=function(){j=null,F.length=0},B=function(){var e=F[0],t=F.slice(1),n=e.crashedEffect?function(e){var t=Object(s.R)(e);return t?t.code+"  "+L(t.fileName,t.lineNumber):""}(e.crashedEffect):null;return["The above error occurred in task "+M(e.meta)+(n?" \n when executing effect "+n:"")].concat(t.map((function(e){return"    created by "+M(e.meta)})),[U(F)]).join("\n")};function W(e,t,n,i,o,a,c){var u;void 0===c&&(c=s.P);var d,f,h=0,p=null,v=[],m=Object.create(n),g=function(e,t,n){var r,i=[],o=!1;function a(e){t(),u(),n(e,!0)}function c(t){i.push(t),t.cont=function(c,u){o||(Object(s.N)(i,t),t.cont=s.P,u?a(c):(t===e&&(r=c),i.length||(o=!0,n(r))))}}function u(){o||(o=!0,i.forEach((function(e){e.cont=s.P,e.cancel()})),i=[])}return c(e),{addTask:c,cancelAll:u,abort:a,getTasks:function(){return i}}}(t,(function(){v.push.apply(v,g.getTasks().map((function(e){return e.meta.name})))}),y);function y(t,n){if(n){if(h=2,(a={meta:o,cancelledTasks:v}).crashedEffect=j,F.push(a),_.isRoot){var i=B();V(),e.onError(t,{sagaStack:i})}f=t,p&&p.reject(t)}else t===r.j?h=1:1!==h&&(h=3),d=t,p&&p.resolve(t);var a;_.cont(t,n),_.joiners.forEach((function(e){e.cb(t,n)})),_.joiners=null}var _=((u={})[r.i]=!0,u.id=i,u.meta=o,u.isRoot=a,u.context=m,u.joiners=[],u.queue=g,u.cancel=function(){0===h&&(h=1,g.cancelAll(),y(r.j,!1))},u.cont=c,u.end=y,u.setContext=function(e){Object(s.L)(m,e)},u.toPromise=function(){return p||(p=l(),2===h?p.reject(f):0!==h&&p.resolve(d)),p.promise},u.isRunning=function(){return 0===h},u.isCancelled=function(){return 1===h||0===h&&1===t.status},u.isAborted=function(){return 2===h},u.result=function(){return d},u.error=function(){return f},u);return _}function G(e,t,n,i,o,c,u){var l=e.finalizeRunEffect((function(t,n,i){if(Object(a.j)(t))k(t,i);else if(Object(a.e)(t))G(e,t,f.context,n,o,!1,i);else if(t&&t[r.c]){(0,x[t.type])(e,t.payload,i,h)}else i(t)}));p.cancel=s.P;var d={meta:o,cancel:function(){0===d.status&&(d.status=1,p(r.j))},status:0},f=W(e,d,n,i,o,c,u),h={task:f,digestEffect:v};return u&&(u.cancel=f.cancel),p(),f;function p(e,n){try{var o;n?(o=t.throw(e),V()):Object(s.S)(e)?(d.status=1,p.cancel(),o=Object(a.d)(t.return)?t.return(r.j):{done:!0,value:r.j}):o=Object(s.T)(e)?Object(a.d)(t.return)?t.return():{done:!0}:t.next(e),o.done?(1!==d.status&&(d.status=3),d.cont(o.value)):v(o.value,i,p)}catch(c){if(1===d.status)throw c;d.status=2,d.cont(c,!0)}}function v(t,n,r,i){void 0===i&&(i="");var o,a=P();function c(n,i){o||(o=!0,r.cancel=s.P,e.sagaMonitor&&(i?e.sagaMonitor.effectRejected(a,n):e.sagaMonitor.effectResolved(a,n)),i&&function(e){j=e}(t),r(n,i))}e.sagaMonitor&&e.sagaMonitor.effectTriggered({effectId:a,parentEffectId:n,label:i,effect:t}),c.cancel=s.P,r.cancel=function(){o||(o=!0,c.cancel(),c.cancel=s.P,e.sagaMonitor&&e.sagaMonitor.effectCancelled(a))},l(t,a,c)}}function q(e,t){var n=e.channel,r=void 0===n?C():n,i=e.dispatch,o=e.getState,a=e.context,u=void 0===a?{}:a,l=e.sagaMonitor,d=e.effectMiddlewares,f=e.onError,h=void 0===f?s.b:f;for(var p=arguments.length,m=new Array(p>2?p-2:0),g=2;g<p;g++)m[g-2]=arguments[g];var y=t.apply(void 0,m);var _,b=P();if(l&&(l.rootSagaStarted=l.rootSagaStarted||s.P,l.effectTriggered=l.effectTriggered||s.P,l.effectResolved=l.effectResolved||s.P,l.effectRejected=l.effectRejected||s.P,l.effectCancelled=l.effectCancelled||s.P,l.actionDispatched=l.actionDispatched||s.P,l.rootSagaStarted({effectId:b,saga:t,args:m})),d){var E=c.d.apply(void 0,d);_=function(e){return function(t,n,r){return E((function(t){return e(t,n,r)}))(t)}}}else _=s.e;var w={channel:r,dispatch:Object(s.d)(i),getState:o,sagaMonitor:l,onError:h,finalizeRunEffect:_};return v((function(){var e=G(w,y,u,b,Object(s.F)(t),!0,void 0);return l&&l.effectResolved(b,e),e}))}var K=function(e){var t,n=void 0===e?{}:e,r=n.context,a=void 0===r?{}:r,c=n.channel,u=void 0===c?C():c,l=n.sagaMonitor,d=Object(o.a)(n,["context","channel","sagaMonitor"]);function f(e){var n=e.getState,r=e.dispatch;return t=q.bind(null,Object(i.a)({},d,{context:a,channel:u,dispatch:r,getState:n,sagaMonitor:l})),function(e){return function(t){l&&l.actionDispatched&&l.actionDispatched(t);var n=e(t);return u.put(t),n}}}return f.run=function(){return t.apply(void 0,arguments)},f.setContext=function(e){Object(s.L)(a,e)},f};t.a=K},function(e,t,n){"use strict";var r=n(43),i=60103,o=60106;t.Fragment=60107,t.StrictMode=60108,t.Profiler=60114;var a=60109,s=60110,c=60112;t.Suspense=60113;var u=60115,l=60116;if("function"===typeof Symbol&&Symbol.for){var d=Symbol.for;i=d("react.element"),o=d("react.portal"),t.Fragment=d("react.fragment"),t.StrictMode=d("react.strict_mode"),t.Profiler=d("react.profiler"),a=d("react.provider"),s=d("react.context"),c=d("react.forward_ref"),t.Suspense=d("react.suspense"),u=d("react.memo"),l=d("react.lazy")}var f="function"===typeof Symbol&&Symbol.iterator;function h(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},v={};function m(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}function g(){}function y(e,t,n){this.props=e,this.context=t,this.refs=v,this.updater=n||p}m.prototype.isReactComponent={},m.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(h(85));this.updater.enqueueSetState(this,e,t,"setState")},m.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},g.prototype=m.prototype;var _=y.prototype=new g;_.constructor=y,r(_,m.prototype),_.isPureReactComponent=!0;var b={current:null},E=Object.prototype.hasOwnProperty,w={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,n){var r,o={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)E.call(t,r)&&!w.hasOwnProperty(r)&&(o[r]=t[r]);var c=arguments.length-2;if(1===c)o.children=n;else if(1<c){for(var u=Array(c),l=0;l<c;l++)u[l]=arguments[l+2];o.children=u}if(e&&e.defaultProps)for(r in c=e.defaultProps)void 0===o[r]&&(o[r]=c[r]);return{$$typeof:i,type:e,key:a,ref:s,props:o,_owner:b.current}}function S(e){return"object"===typeof e&&null!==e&&e.$$typeof===i}var I=/\/+/g;function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function A(e,t,n,r,a){var s=typeof e;"undefined"!==s&&"boolean"!==s||(e=null);var c=!1;if(null===e)c=!0;else switch(s){case"string":case"number":c=!0;break;case"object":switch(e.$$typeof){case i:case o:c=!0}}if(c)return a=a(c=e),e=""===r?"."+R(c,0):r,Array.isArray(a)?(n="",null!=e&&(n=e.replace(I,"$&/")+"/"),A(a,t,n,"",(function(e){return e}))):null!=a&&(S(a)&&(a=function(e,t){return{$$typeof:i,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(a,n+(!a.key||c&&c.key===a.key?"":(""+a.key).replace(I,"$&/")+"/")+e)),t.push(a)),1;if(c=0,r=""===r?".":r+":",Array.isArray(e))for(var u=0;u<e.length;u++){var l=r+R(s=e[u],u);c+=A(s,t,n,l,a)}else if("function"===typeof(l=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e)))for(e=l.call(e),u=0;!(s=e.next()).done;)c+=A(s=s.value,t,n,l=r+R(s,u++),a);else if("object"===s)throw t=""+e,Error(h(31,"[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t));return c}function C(e,t,n){if(null==e)return e;var r=[],i=0;return A(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function k(e){if(-1===e._status){var t=e._result;t=t(),e._status=0,e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}if(1===e._status)return e._result;throw e._result}var O={current:null};function N(){var e=O.current;if(null===e)throw Error(h(321));return e}var P={ReactCurrentDispatcher:O,ReactCurrentBatchConfig:{transition:0},ReactCurrentOwner:b,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:C,forEach:function(e,t,n){C(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return C(e,(function(){t++})),t},toArray:function(e){return C(e,(function(e){return e}))||[]},only:function(e){if(!S(e))throw Error(h(143));return e}},t.Component=m,t.PureComponent=y,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(h(267,e));var o=r({},e.props),a=e.key,s=e.ref,c=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,c=b.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var u=e.type.defaultProps;for(l in t)E.call(t,l)&&!w.hasOwnProperty(l)&&(o[l]=void 0===t[l]&&void 0!==u?u[l]:t[l])}var l=arguments.length-2;if(1===l)o.children=n;else if(1<l){u=Array(l);for(var d=0;d<l;d++)u[d]=arguments[d+2];o.children=u}return{$$typeof:i,type:e.type,key:a,ref:s,props:o,_owner:c}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:s,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=S,t.lazy=function(e){return{$$typeof:l,_payload:{_status:-1,_result:e},_init:k}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return N().useCallback(e,t)},t.useContext=function(e,t){return N().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return N().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return N().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return N().useLayoutEffect(e,t)},t.useMemo=function(e,t){return N().useMemo(e,t)},t.useReducer=function(e,t,n){return N().useReducer(e,t,n)},t.useRef=function(e){return N().useRef(e)},t.useState=function(e){return N().useState(e)},t.version="17.0.2"},function(e,t,n){"use strict";var r=n(2),i=n(43),o=n(63);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));var s=new Set,c={};function u(e,t){l(e,t),l(e+"Capture",t)}function l(e,t){for(c[e]=t,e=0;e<t.length;e++)s.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h=Object.prototype.hasOwnProperty,p={},v={};function m(e,t,n,r,i,o,a){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o,this.removeEmptyString=a}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function _(e){return e[1].toUpperCase()}function b(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(v,e)||!h.call(p,e)&&(f.test(e)?v[e]=!0:(p[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,_);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var E=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,w=60103,T=60106,S=60107,I=60108,R=60114,A=60109,C=60110,k=60112,O=60113,N=60120,P=60115,D=60116,x=60121,L=60128,M=60129,U=60130,j=60131;if("function"===typeof Symbol&&Symbol.for){var F=Symbol.for;w=F("react.element"),T=F("react.portal"),S=F("react.fragment"),I=F("react.strict_mode"),R=F("react.profiler"),A=F("react.provider"),C=F("react.context"),k=F("react.forward_ref"),O=F("react.suspense"),N=F("react.suspense_list"),P=F("react.memo"),D=F("react.lazy"),x=F("react.block"),F("react.scope"),L=F("react.opaque.id"),M=F("react.debug_trace_mode"),U=F("react.offscreen"),j=F("react.legacy_hidden")}var V,B="function"===typeof Symbol&&Symbol.iterator;function W(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=B&&e[B]||e["@@iterator"])?e:null}function G(e){if(void 0===V)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);V=t&&t[1]||""}return"\n"+V+e}var q=!1;function K(e,t){if(!e||q)return"";q=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var r=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){r=c}e.call(t.prototype)}else{try{throw Error()}catch(c){r=c}e()}}catch(c){if(c&&r&&"string"===typeof c.stack){for(var i=c.stack.split("\n"),o=r.stack.split("\n"),a=i.length-1,s=o.length-1;1<=a&&0<=s&&i[a]!==o[s];)s--;for(;1<=a&&0<=s;a--,s--)if(i[a]!==o[s]){if(1!==a||1!==s)do{if(a--,0>--s||i[a]!==o[s])return"\n"+i[a].replace(" at new "," at ")}while(1<=a&&0<=s);break}}}finally{q=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?G(e):""}function H(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=K(e.type,!1);case 11:return e=K(e.type.render,!1);case 22:return e=K(e.type._render,!1);case 1:return e=K(e.type,!0);default:return""}}function z(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case T:return"Portal";case R:return"Profiler";case I:return"StrictMode";case O:return"Suspense";case N:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case P:return z(e.type);case x:return z(e._render);case D:t=e._payload,e=e._init;try{return z(e(t))}catch(n){}}return null}function Y(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Q(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=Q(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function J(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=Q(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function Z(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function ee(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=Y(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function te(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function ne(e,t){te(e,t);var n=Y(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ie(e,t.type,n):t.hasOwnProperty("defaultValue")&&ie(e,t.type,Y(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function re(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ie(e,t,n){"number"===t&&$(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function oe(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function ae(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Y(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:Y(n)}}function ue(e,t){var n=Y(t.value),r=Y(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var de="http://www.w3.org/1999/xhtml",fe="http://www.w3.org/2000/svg";function he(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?he(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ve,me,ge=(me=function(e,t){if(e.namespaceURI!==fe||"innerHTML"in e)e.innerHTML=t;else{for((ve=ve||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ve.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return me(e,t)}))}:me);function ye(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var _e={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},be=["Webkit","ms","Moz","O"];function Ee(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||_e.hasOwnProperty(e)&&_e[e]?(""+t).trim():t+"px"}function we(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=Ee(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(_e).forEach((function(e){be.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),_e[t]=_e[e]}))}));var Te=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Se(e,t){if(t){if(Te[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62))}}function Ie(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ae=null,Ce=null,ke=null;function Oe(e){if(e=ei(e)){if("function"!==typeof Ae)throw Error(a(280));var t=e.stateNode;t&&(t=ni(t),Ae(e.stateNode,e.type,t))}}function Ne(e){Ce?ke?ke.push(e):ke=[e]:Ce=e}function Pe(){if(Ce){var e=Ce,t=ke;if(ke=Ce=null,Oe(e),t)for(e=0;e<t.length;e++)Oe(t[e])}}function De(e,t){return e(t)}function xe(e,t,n,r,i){return e(t,n,r,i)}function Le(){}var Me=De,Ue=!1,je=!1;function Fe(){null===Ce&&null===ke||(Le(),Pe())}function Ve(e,t){var n=e.stateNode;if(null===n)return null;var r=ni(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}var Be=!1;if(d)try{var We={};Object.defineProperty(We,"passive",{get:function(){Be=!0}}),window.addEventListener("test",We,We),window.removeEventListener("test",We,We)}catch(me){Be=!1}function Ge(e,t,n,r,i,o,a,s,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(l){this.onError(l)}}var qe=!1,Ke=null,He=!1,ze=null,Ye={onError:function(e){qe=!0,Ke=e}};function Qe(e,t,n,r,i,o,a,s,c){qe=!1,Ke=null,Ge.apply(Ye,arguments)}function Xe(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function Je(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(Xe(e)!==e)throw Error(a(188))}function Ze(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return $e(i),e;if(o===r)return $e(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,c=i.child;c;){if(c===n){s=!0,n=i,r=o;break}if(c===r){s=!0,r=i,n=o;break}c=c.sibling}if(!s){for(c=o.child;c;){if(c===n){s=!0,n=o,r=i;break}if(c===r){s=!0,r=o,n=i;break}c=c.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function et(e,t){for(var n=e.alternate;null!==t;){if(t===e||t===n)return!0;t=t.return}return!1}var tt,nt,rt,it,ot=!1,at=[],st=null,ct=null,ut=null,lt=new Map,dt=new Map,ft=[],ht="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,n,r,i){return{blockedOn:e,domEventName:t,eventSystemFlags:16|n,nativeEvent:i,targetContainers:[r]}}function vt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":ut=null;break;case"pointerover":case"pointerout":lt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(t.pointerId)}}function mt(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=pt(t,n,r,i,o),null!==t&&(null!==(t=ei(t))&&nt(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function gt(e){var t=Zr(e.target);if(null!==t){var n=Xe(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=Je(n)))return e.blockedOn=t,void it(e.lanePriority,(function(){o.unstable_runWithPriority(e.priority,(function(){rt(n)}))}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=ei(n))&&nt(t),e.blockedOn=n,!1;t.shift()}return!0}function _t(e,t,n){yt(e)&&n.delete(t)}function bt(){for(ot=!1;0<at.length;){var e=at[0];if(null!==e.blockedOn){null!==(e=ei(e.blockedOn))&&tt(e);break}for(var t=e.targetContainers;0<t.length;){var n=Zt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n){e.blockedOn=n;break}t.shift()}null===e.blockedOn&&at.shift()}null!==st&&yt(st)&&(st=null),null!==ct&&yt(ct)&&(ct=null),null!==ut&&yt(ut)&&(ut=null),lt.forEach(_t),dt.forEach(_t)}function Et(e,t){e.blockedOn===t&&(e.blockedOn=null,ot||(ot=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,bt)))}function wt(e){function t(t){return Et(t,e)}if(0<at.length){Et(at[0],e);for(var n=1;n<at.length;n++){var r=at[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==st&&Et(st,e),null!==ct&&Et(ct,e),null!==ut&&Et(ut,e),lt.forEach(t),dt.forEach(t),n=0;n<ft.length;n++)(r=ft[n]).blockedOn===e&&(r.blockedOn=null);for(;0<ft.length&&null===(n=ft[0]).blockedOn;)gt(n),null===n.blockedOn&&ft.shift()}function Tt(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var St={animationend:Tt("Animation","AnimationEnd"),animationiteration:Tt("Animation","AnimationIteration"),animationstart:Tt("Animation","AnimationStart"),transitionend:Tt("Transition","TransitionEnd")},It={},Rt={};function At(e){if(It[e])return It[e];if(!St[e])return e;var t,n=St[e];for(t in n)if(n.hasOwnProperty(t)&&t in Rt)return It[e]=n[t];return e}d&&(Rt=document.createElement("div").style,"AnimationEvent"in window||(delete St.animationend.animation,delete St.animationiteration.animation,delete St.animationstart.animation),"TransitionEvent"in window||delete St.transitionend.transition);var Ct=At("animationend"),kt=At("animationiteration"),Ot=At("animationstart"),Nt=At("transitionend"),Pt=new Map,Dt=new Map,xt=["abort","abort",Ct,"animationEnd",kt,"animationIteration",Ot,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Nt,"transitionEnd","waiting","waiting"];function Lt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1];i="on"+(i[0].toUpperCase()+i.slice(1)),Dt.set(r,t),Pt.set(r,i),u(i,[r])}}(0,o.unstable_now)();var Mt=8;function Ut(e){if(0!==(1&e))return Mt=15,1;if(0!==(2&e))return Mt=14,2;if(0!==(4&e))return Mt=13,4;var t=24&e;return 0!==t?(Mt=12,t):0!==(32&e)?(Mt=11,32):0!==(t=192&e)?(Mt=10,t):0!==(256&e)?(Mt=9,256):0!==(t=3584&e)?(Mt=8,t):0!==(4096&e)?(Mt=7,4096):0!==(t=4186112&e)?(Mt=6,t):0!==(t=62914560&e)?(Mt=5,t):67108864&e?(Mt=4,67108864):0!==(134217728&e)?(Mt=3,134217728):0!==(t=805306368&e)?(Mt=2,t):0!==(1073741824&e)?(Mt=1,1073741824):(Mt=8,e)}function jt(e,t){var n=e.pendingLanes;if(0===n)return Mt=0;var r=0,i=0,o=e.expiredLanes,a=e.suspendedLanes,s=e.pingedLanes;if(0!==o)r=o,i=Mt=15;else if(0!==(o=134217727&n)){var c=o&~a;0!==c?(r=Ut(c),i=Mt):0!==(s&=o)&&(r=Ut(s),i=Mt)}else 0!==(o=n&~a)?(r=Ut(o),i=Mt):0!==s&&(r=Ut(s),i=Mt);if(0===r)return 0;if(r=n&((0>(r=31-qt(r))?0:1<<r)<<1)-1,0!==t&&t!==r&&0===(t&a)){if(Ut(t),i<=Mt)return t;Mt=i}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-qt(t)),r|=e[n],t&=~i;return r}function Ft(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Vt(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=Bt(24&~t))?Vt(10,t):e;case 10:return 0===(e=Bt(192&~t))?Vt(8,t):e;case 8:return 0===(e=Bt(3584&~t))&&(0===(e=Bt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=Bt(805306368&~t))&&(t=268435456),t}throw Error(a(358,e))}function Bt(e){return e&-e}function Wt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Gt(e,t,n){e.pendingLanes|=t;var r=t-1;e.suspendedLanes&=r,e.pingedLanes&=r,(e=e.eventTimes)[t=31-qt(t)]=n}var qt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(Kt(e)/Ht|0)|0},Kt=Math.log,Ht=Math.LN2;var zt=o.unstable_UserBlockingPriority,Yt=o.unstable_runWithPriority,Qt=!0;function Xt(e,t,n,r){Ue||Le();var i=$t,o=Ue;Ue=!0;try{xe(i,e,t,n,r)}finally{(Ue=o)||Fe()}}function Jt(e,t,n,r){Yt(zt,$t.bind(null,e,t,n,r))}function $t(e,t,n,r){var i;if(Qt)if((i=0===(4&t))&&0<at.length&&-1<ht.indexOf(e))e=pt(null,e,t,n,r),at.push(e);else{var o=Zt(e,t,n,r);if(null===o)i&&vt(e,r);else{if(i){if(-1<ht.indexOf(e))return e=pt(o,e,t,n,r),void at.push(e);if(function(e,t,n,r,i){switch(t){case"focusin":return st=mt(st,e,t,n,r,i),!0;case"dragenter":return ct=mt(ct,e,t,n,r,i),!0;case"mouseover":return ut=mt(ut,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return lt.set(o,mt(lt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,dt.set(o,mt(dt.get(o)||null,e,t,n,r,i)),!0}return!1}(o,e,t,n,r))return;vt(e,r)}Pr(e,t,r,null,n)}}}function Zt(e,t,n,r){var i=Re(r);if(null!==(i=Zr(i))){var o=Xe(i);if(null===o)i=null;else{var a=o.tag;if(13===a){if(null!==(i=Je(o)))return i;i=null}else if(3===a){if(o.stateNode.hydrate)return 3===o.tag?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null)}}return Pr(e,t,r,i,n),null}var en=null,tn=null,nn=null;function rn(){if(nn)return nn;var e,t,n=tn,r=n.length,i="value"in en?en.value:en.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return nn=i.slice(e,1<t?1-t:void 0)}function on(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function an(){return!0}function sn(){return!1}function cn(e){function t(t,n,r,i,o){for(var a in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=o,this.currentTarget=null,e)e.hasOwnProperty(a)&&(t=e[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?an:sn,this.isPropagationStopped=sn,this}return i(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=an)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=an)},persist:function(){},isPersistent:an}),t}var un,ln,dn,fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=cn(fn),pn=i({},fn,{view:0,detail:0}),vn=cn(pn),mn=i({},pn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:An,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==dn&&(dn&&"mousemove"===e.type?(un=e.screenX-dn.screenX,ln=e.screenY-dn.screenY):ln=un=0,dn=e),un)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),gn=cn(mn),yn=cn(i({},mn,{dataTransfer:0})),_n=cn(i({},pn,{relatedTarget:0})),bn=cn(i({},fn,{animationName:0,elapsedTime:0,pseudoElement:0})),En=cn(i({},fn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}})),wn=cn(i({},fn,{data:0})),Tn={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},In={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Rn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=In[e])&&!!t[e]}function An(){return Rn}var Cn=cn(i({},pn,{key:function(e){if(e.key){var t=Tn[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=on(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:An,charCode:function(e){return"keypress"===e.type?on(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?on(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}})),kn=cn(i({},mn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),On=cn(i({},pn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:An})),Nn=cn(i({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Pn=cn(i({},mn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0})),Dn=[9,13,27,32],xn=d&&"CompositionEvent"in window,Ln=null;d&&"documentMode"in document&&(Ln=document.documentMode);var Mn=d&&"TextEvent"in window&&!Ln,Un=d&&(!xn||Ln&&8<Ln&&11>=Ln),jn=String.fromCharCode(32),Fn=!1;function Vn(e,t){switch(e){case"keyup":return-1!==Dn.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Wn=!1;var Gn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function qn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Gn[e.type]:"textarea"===t}function Kn(e,t,n,r){Ne(r),0<(t=xr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,zn=null;function Yn(e){Rr(e,0)}function Qn(e){if(J(ti(e)))return e}function Xn(e,t){if("change"===e)return t}var Jn=!1;if(d){var $n;if(d){var Zn="oninput"in document;if(!Zn){var er=document.createElement("div");er.setAttribute("oninput","return;"),Zn="function"===typeof er.oninput}$n=Zn}else $n=!1;Jn=$n&&(!document.documentMode||9<document.documentMode)}function tr(){Hn&&(Hn.detachEvent("onpropertychange",nr),zn=Hn=null)}function nr(e){if("value"===e.propertyName&&Qn(zn)){var t=[];if(Kn(t,zn,e,Re(e)),e=Yn,Ue)e(t);else{Ue=!0;try{De(e,t)}finally{Ue=!1,Fe()}}}}function rr(e,t,n){"focusin"===e?(tr(),zn=n,(Hn=t).attachEvent("onpropertychange",nr)):"focusout"===e&&tr()}function ir(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Qn(zn)}function or(e,t){if("click"===e)return Qn(t)}function ar(e,t){if("input"===e||"change"===e)return Qn(t)}var sr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},cr=Object.prototype.hasOwnProperty;function ur(e,t){if(sr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!cr.call(t,n[r])||!sr(e[n[r]],t[n[r]]))return!1;return!0}function lr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=lr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=lr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function hr(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=$((e=t.contentWindow).document)}return t}function pr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var vr=d&&"documentMode"in document&&11>=document.documentMode,mr=null,gr=null,yr=null,_r=!1;function br(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;_r||null==mr||mr!==$(r)||("selectionStart"in(r=mr)&&pr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},yr&&ur(yr,r)||(yr=r,0<(r=xr(gr,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=mr)))}Lt("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Lt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Lt(xt,2);for(var Er="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),wr=0;wr<Er.length;wr++)Dt.set(Er[wr],0);l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),u("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),u("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),u("onBeforeInput",["compositionend","keypress","textInput","paste"]),u("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),u("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Tr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Sr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Tr));function Ir(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,s,c,u){if(Qe.apply(this,arguments),qe){if(!qe)throw Error(a(198));var l=Ke;qe=!1,Ke=null,He||(He=!0,ze=l)}}(r,t,void 0,e),e.currentTarget=null}function Rr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var o=void 0;if(t)for(var a=r.length-1;0<=a;a--){var s=r[a],c=s.instance,u=s.currentTarget;if(s=s.listener,c!==o&&i.isPropagationStopped())break e;Ir(i,s,u),o=c}else for(a=0;a<r.length;a++){if(c=(s=r[a]).instance,u=s.currentTarget,s=s.listener,c!==o&&i.isPropagationStopped())break e;Ir(i,s,u),o=c}}}if(He)throw e=ze,He=!1,ze=null,e}function Ar(e,t){var n=ri(t),r=e+"__bubble";n.has(r)||(Nr(t,e,2,!1),n.add(r))}var Cr="_reactListening"+Math.random().toString(36).slice(2);function kr(e){e[Cr]||(e[Cr]=!0,s.forEach((function(t){Sr.has(t)||Or(t,!1,e,null),Or(t,!0,e,null)})))}function Or(e,t,n,r){var i=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,o=n;if("selectionchange"===e&&9!==n.nodeType&&(o=n.ownerDocument),null!==r&&!t&&Sr.has(e)){if("scroll"!==e)return;i|=2,o=r}var a=ri(o),s=e+"__"+(t?"capture":"bubble");a.has(s)||(t&&(i|=4),Nr(o,e,i,t),a.add(s))}function Nr(e,t,n,r){var i=Dt.get(t);switch(void 0===i?2:i){case 0:i=Xt;break;case 1:i=Jt;break;default:i=$t}n=i.bind(null,t,n,e),i=void 0,!Be||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Pr(e,t,n,r,i){var o=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var a=r.tag;if(3===a||4===a){var s=r.stateNode.containerInfo;if(s===i||8===s.nodeType&&s.parentNode===i)break;if(4===a)for(a=r.return;null!==a;){var c=a.tag;if((3===c||4===c)&&((c=a.stateNode.containerInfo)===i||8===c.nodeType&&c.parentNode===i))return;a=a.return}for(;null!==s;){if(null===(a=Zr(s)))return;if(5===(c=a.tag)||6===c){r=o=a;continue e}s=s.parentNode}}r=r.return}!function(e,t,n){if(je)return e(t,n);je=!0;try{Me(e,t,n)}finally{je=!1,Fe()}}((function(){var r=o,i=Re(n),a=[];e:{var s=Pt.get(e);if(void 0!==s){var c=hn,u=e;switch(e){case"keypress":if(0===on(n))break e;case"keydown":case"keyup":c=Cn;break;case"focusin":u="focus",c=_n;break;case"focusout":u="blur",c=_n;break;case"beforeblur":case"afterblur":c=_n;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":c=gn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":c=yn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":c=On;break;case Ct:case kt:case Ot:c=bn;break;case Nt:c=Nn;break;case"scroll":c=vn;break;case"wheel":c=Pn;break;case"copy":case"cut":case"paste":c=En;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":c=kn}var l=0!==(4&t),d=!l&&"scroll"===e,f=l?null!==s?s+"Capture":null:s;l=[];for(var h,p=r;null!==p;){var v=(h=p).stateNode;if(5===h.tag&&null!==v&&(h=v,null!==f&&(null!=(v=Ve(p,f))&&l.push(Dr(p,v,h)))),d)break;p=p.return}0<l.length&&(s=new c(s,u,null,n,i),a.push({event:s,listeners:l}))}}if(0===(7&t)){if(c="mouseout"===e||"pointerout"===e,(!(s="mouseover"===e||"pointerover"===e)||0!==(16&t)||!(u=n.relatedTarget||n.fromElement)||!Zr(u)&&!u[Jr])&&(c||s)&&(s=i.window===i?i:(s=i.ownerDocument)?s.defaultView||s.parentWindow:window,c?(c=r,null!==(u=(u=n.relatedTarget||n.toElement)?Zr(u):null)&&(u!==(d=Xe(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(c=null,u=r),c!==u)){if(l=gn,v="onMouseLeave",f="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(l=kn,v="onPointerLeave",f="onPointerEnter",p="pointer"),d=null==c?s:ti(c),h=null==u?s:ti(u),(s=new l(v,p+"leave",c,n,i)).target=d,s.relatedTarget=h,v=null,Zr(i)===r&&((l=new l(f,p+"enter",u,n,i)).target=h,l.relatedTarget=d,v=l),d=v,c&&u)e:{for(f=u,p=0,h=l=c;h;h=Lr(h))p++;for(h=0,v=f;v;v=Lr(v))h++;for(;0<p-h;)l=Lr(l),p--;for(;0<h-p;)f=Lr(f),h--;for(;p--;){if(l===f||null!==f&&l===f.alternate)break e;l=Lr(l),f=Lr(f)}l=null}else l=null;null!==c&&Mr(a,s,c,l,!1),null!==u&&null!==d&&Mr(a,d,u,l,!0)}if("select"===(c=(s=r?ti(r):window).nodeName&&s.nodeName.toLowerCase())||"input"===c&&"file"===s.type)var m=Xn;else if(qn(s))if(Jn)m=ar;else{m=ir;var g=rr}else(c=s.nodeName)&&"input"===c.toLowerCase()&&("checkbox"===s.type||"radio"===s.type)&&(m=or);switch(m&&(m=m(e,r))?Kn(a,m,n,i):(g&&g(e,s,r),"focusout"===e&&(g=s._wrapperState)&&g.controlled&&"number"===s.type&&ie(s,"number",s.value)),g=r?ti(r):window,e){case"focusin":(qn(g)||"true"===g.contentEditable)&&(mr=g,gr=r,yr=null);break;case"focusout":yr=gr=mr=null;break;case"mousedown":_r=!0;break;case"contextmenu":case"mouseup":case"dragend":_r=!1,br(a,n,i);break;case"selectionchange":if(vr)break;case"keydown":case"keyup":br(a,n,i)}var y;if(xn)e:{switch(e){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Wn?Vn(e,n)&&(_="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(_="onCompositionStart");_&&(Un&&"ko"!==n.locale&&(Wn||"onCompositionStart"!==_?"onCompositionEnd"===_&&Wn&&(y=rn()):(tn="value"in(en=i)?en.value:en.textContent,Wn=!0)),0<(g=xr(r,_)).length&&(_=new wn(_,e,null,n,i),a.push({event:_,listeners:g}),y?_.data=y:null!==(y=Bn(n))&&(_.data=y))),(y=Mn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Fn=!0,jn);case"textInput":return(e=t.data)===jn&&Fn?null:e;default:return null}}(e,n):function(e,t){if(Wn)return"compositionend"===e||!xn&&Vn(e,t)?(e=rn(),nn=tn=en=null,Wn=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))&&(0<(r=xr(r,"onBeforeInput")).length&&(i=new wn("onBeforeInput","beforeinput",null,n,i),a.push({event:i,listeners:r}),i.data=y))}Rr(a,t)}))}function Dr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function xr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,o=i.stateNode;5===i.tag&&null!==o&&(i=o,null!=(o=Ve(e,n))&&r.unshift(Dr(e,o,i)),null!=(o=Ve(e,t))&&r.push(Dr(e,o,i))),e=e.return}return r}function Lr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Mr(e,t,n,r,i){for(var o=t._reactName,a=[];null!==n&&n!==r;){var s=n,c=s.alternate,u=s.stateNode;if(null!==c&&c===r)break;5===s.tag&&null!==u&&(s=u,i?null!=(c=Ve(n,o))&&a.unshift(Dr(n,c,s)):i||null!=(c=Ve(n,o))&&a.push(Dr(n,c,s))),n=n.return}0!==a.length&&e.push({event:t,listeners:a})}function Ur(){}var jr=null,Fr=null;function Vr(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Br(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var Wr="function"===typeof setTimeout?setTimeout:void 0,Gr="function"===typeof clearTimeout?clearTimeout:void 0;function qr(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Kr(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Hr(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var zr=0;var Yr=Math.random().toString(36).slice(2),Qr="__reactFiber$"+Yr,Xr="__reactProps$"+Yr,Jr="__reactContainer$"+Yr,$r="__reactEvents$"+Yr;function Zr(e){var t=e[Qr];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Jr]||n[Qr]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=Hr(e);null!==e;){if(n=e[Qr])return n;e=Hr(e)}return t}n=(e=n).parentNode}return null}function ei(e){return!(e=e[Qr]||e[Jr])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ti(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function ni(e){return e[Xr]||null}function ri(e){var t=e[$r];return void 0===t&&(t=e[$r]=new Set),t}var ii=[],oi=-1;function ai(e){return{current:e}}function si(e){0>oi||(e.current=ii[oi],ii[oi]=null,oi--)}function ci(e,t){oi++,ii[oi]=e.current,e.current=t}var ui={},li=ai(ui),di=ai(!1),fi=ui;function hi(e,t){var n=e.type.contextTypes;if(!n)return ui;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function pi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function vi(){si(di),si(li)}function mi(e,t,n){if(li.current!==ui)throw Error(a(168));ci(li,t),ci(di,n)}function gi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,z(t)||"Unknown",o));return i({},n,r)}function yi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ui,fi=li.current,ci(li,e),ci(di,di.current),!0}function _i(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=gi(e,t,fi),r.__reactInternalMemoizedMergedChildContext=e,si(di),si(li),ci(li,e)):si(di),ci(di,n)}var bi=null,Ei=null,wi=o.unstable_runWithPriority,Ti=o.unstable_scheduleCallback,Si=o.unstable_cancelCallback,Ii=o.unstable_shouldYield,Ri=o.unstable_requestPaint,Ai=o.unstable_now,Ci=o.unstable_getCurrentPriorityLevel,ki=o.unstable_ImmediatePriority,Oi=o.unstable_UserBlockingPriority,Ni=o.unstable_NormalPriority,Pi=o.unstable_LowPriority,Di=o.unstable_IdlePriority,xi={},Li=void 0!==Ri?Ri:function(){},Mi=null,Ui=null,ji=!1,Fi=Ai(),Vi=1e4>Fi?Ai:function(){return Ai()-Fi};function Bi(){switch(Ci()){case ki:return 99;case Oi:return 98;case Ni:return 97;case Pi:return 96;case Di:return 95;default:throw Error(a(332))}}function Wi(e){switch(e){case 99:return ki;case 98:return Oi;case 97:return Ni;case 96:return Pi;case 95:return Di;default:throw Error(a(332))}}function Gi(e,t){return e=Wi(e),wi(e,t)}function qi(e,t,n){return e=Wi(e),Ti(e,t,n)}function Ki(){if(null!==Ui){var e=Ui;Ui=null,Si(e)}Hi()}function Hi(){if(!ji&&null!==Mi){ji=!0;var e=0;try{var t=Mi;Gi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Mi=null}catch(n){throw null!==Mi&&(Mi=Mi.slice(e+1)),Ti(ki,Ki),n}finally{ji=!1}}}var zi=E.ReactCurrentBatchConfig;function Yi(e,t){if(e&&e.defaultProps){for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}var Qi=ai(null),Xi=null,Ji=null,$i=null;function Zi(){$i=Ji=Xi=null}function eo(e){var t=Qi.current;si(Qi),e.type._context._currentValue=t}function to(e,t){for(;null!==e;){var n=e.alternate;if((e.childLanes&t)===t){if(null===n||(n.childLanes&t)===t)break;n.childLanes|=t}else e.childLanes|=t,null!==n&&(n.childLanes|=t);e=e.return}}function no(e,t){Xi=e,$i=Ji=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(xa=!0),e.firstContext=null)}function ro(e,t){if($i!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||($i=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Ji){if(null===Xi)throw Error(a(308));Ji=t,Xi.dependencies={lanes:0,firstContext:t,responders:null}}else Ji=Ji.next=t;return e._currentValue}var io=!1;function oo(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ao(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function so(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function co(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function uo(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,o=null;if(null!==(n=n.firstBaseUpdate)){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===o?i=o=a:o=o.next=a,n=n.next}while(null!==n);null===o?i=o=t:o=o.next=t}else i=o=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function lo(e,t,n,r){var o=e.updateQueue;io=!1;var a=o.firstBaseUpdate,s=o.lastBaseUpdate,c=o.shared.pending;if(null!==c){o.shared.pending=null;var u=c,l=u.next;u.next=null,null===s?a=l:s.next=l,s=u;var d=e.alternate;if(null!==d){var f=(d=d.updateQueue).lastBaseUpdate;f!==s&&(null===f?d.firstBaseUpdate=l:f.next=l,d.lastBaseUpdate=u)}}if(null!==a){for(f=o.baseState,s=0,d=l=u=null;;){c=a.lane;var h=a.eventTime;if((r&c)===c){null!==d&&(d=d.next={eventTime:h,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,v=a;switch(c=t,h=n,v.tag){case 1:if("function"===typeof(p=v.payload)){f=p.call(h,f,c);break e}f=p;break e;case 3:p.flags=-4097&p.flags|64;case 0:if(null===(c="function"===typeof(p=v.payload)?p.call(h,f,c):p)||void 0===c)break e;f=i({},f,c);break e;case 2:io=!0}}null!==a.callback&&(e.flags|=32,null===(c=o.effects)?o.effects=[a]:c.push(a))}else h={eventTime:h,lane:c,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===d?(l=d=h,u=f):d=d.next=h,s|=c;if(null===(a=a.next)){if(null===(c=o.shared.pending))break;a=c.next,c.next=null,o.lastBaseUpdate=c,o.shared.pending=null}}null===d&&(u=f),o.baseState=u,o.firstBaseUpdate=l,o.lastBaseUpdate=d,js|=s,e.lanes=s,e.memoizedState=f}}function fo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(a(191,i));i.call(r)}}}var ho=(new r.Component).refs;function po(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var vo={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=uc(),i=lc(e),o=so(r,i);o.payload=t,void 0!==n&&null!==n&&(o.callback=n),co(e,o),dc(e,i,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=uc(),i=lc(e),o=so(r,i);o.tag=1,o.payload=t,void 0!==n&&null!==n&&(o.callback=n),co(e,o),dc(e,i,r)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=uc(),r=lc(e),i=so(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),co(e,i),dc(e,r,n)}};function mo(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!ur(n,r)||!ur(i,o))}function go(e,t,n){var r=!1,i=ui,o=t.contextType;return"object"===typeof o&&null!==o?o=ro(o):(i=pi(t)?fi:li.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?hi(e,i):ui),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=vo,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function yo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vo.enqueueReplaceState(t,t.state,null)}function _o(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ho,oo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=ro(o):(o=pi(t)?fi:li.current,i.context=hi(e,o)),lo(e,n,i,r),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(po(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&vo.enqueueReplaceState(i,i.state,null),lo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4)}var bo=Array.isArray;function Eo(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===ho&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function wo(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function To(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.flags=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Gc(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags=2,n):r:(t.flags=2,n):n}function s(t){return e&&null===t.alternate&&(t.flags=2),t}function c(e,t,n,r){return null===t||6!==t.tag?((t=zc(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=Eo(e,t,n),r.return=e,r):((r=qc(n.type,n.key,n.props,null,e.mode,r)).ref=Eo(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Yc(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Kc(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=zc(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case w:return(n=qc(t.type,t.key,t.props,null,e.mode,n)).ref=Eo(e,null,t),n.return=e,n;case T:return(t=Yc(t,e.mode,n)).return=e,t}if(bo(t)||W(t))return(t=Kc(t,e.mode,n,null)).return=e,t;wo(e,t)}return null}function h(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:c(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case w:return n.key===i?n.type===S?d(e,t,n.props.children,r,i):u(e,t,n,r):null;case T:return n.key===i?l(e,t,n,r):null}if(bo(n)||W(n))return null!==i?null:d(e,t,n,r,null);wo(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return c(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case w:return e=e.get(null===r.key?n:r.key)||null,r.type===S?d(t,e,r.props.children,i,r.key):u(t,e,r,i);case T:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(bo(r)||W(r))return d(t,e=e.get(n)||null,r,i,null);wo(t,r)}return null}function v(i,a,s,c){for(var u=null,l=null,d=a,v=a=0,m=null;null!==d&&v<s.length;v++){d.index>v?(m=d,d=null):m=d.sibling;var g=h(i,d,s[v],c);if(null===g){null===d&&(d=m);break}e&&d&&null===g.alternate&&t(i,d),a=o(g,a,v),null===l?u=g:l.sibling=g,l=g,d=m}if(v===s.length)return n(i,d),u;if(null===d){for(;v<s.length;v++)null!==(d=f(i,s[v],c))&&(a=o(d,a,v),null===l?u=d:l.sibling=d,l=d);return u}for(d=r(i,d);v<s.length;v++)null!==(m=p(d,i,v,s[v],c))&&(e&&null!==m.alternate&&d.delete(null===m.key?v:m.key),a=o(m,a,v),null===l?u=m:l.sibling=m,l=m);return e&&d.forEach((function(e){return t(i,e)})),u}function m(i,s,c,u){var l=W(c);if("function"!==typeof l)throw Error(a(150));if(null==(c=l.call(c)))throw Error(a(151));for(var d=l=null,v=s,m=s=0,g=null,y=c.next();null!==v&&!y.done;m++,y=c.next()){v.index>m?(g=v,v=null):g=v.sibling;var _=h(i,v,y.value,u);if(null===_){null===v&&(v=g);break}e&&v&&null===_.alternate&&t(i,v),s=o(_,s,m),null===d?l=_:d.sibling=_,d=_,v=g}if(y.done)return n(i,v),l;if(null===v){for(;!y.done;m++,y=c.next())null!==(y=f(i,y.value,u))&&(s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return l}for(v=r(i,v);!y.done;m++,y=c.next())null!==(y=p(v,i,m,y.value,u))&&(e&&null!==y.alternate&&v.delete(null===y.key?m:y.key),s=o(y,s,m),null===d?l=y:d.sibling=y,d=y);return e&&v.forEach((function(e){return t(i,e)})),l}return function(e,r,o,c){var u="object"===typeof o&&null!==o&&o.type===S&&null===o.key;u&&(o=o.props.children);var l="object"===typeof o&&null!==o;if(l)switch(o.$$typeof){case w:e:{for(l=o.key,u=r;null!==u;){if(u.key===l){switch(u.tag){case 7:if(o.type===S){n(e,u.sibling),(r=i(u,o.props.children)).return=e,e=r;break e}break;default:if(u.elementType===o.type){n(e,u.sibling),(r=i(u,o.props)).ref=Eo(e,u,o),r.return=e,e=r;break e}}n(e,u);break}t(e,u),u=u.sibling}o.type===S?((r=Kc(o.props.children,e.mode,c,o.key)).return=e,e=r):((c=qc(o.type,o.key,o.props,null,e.mode,c)).ref=Eo(e,r,o),c.return=e,e=c)}return s(e);case T:e:{for(u=o.key;null!==r;){if(r.key===u){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Yc(o,e.mode,c)).return=e,e=r}return s(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=zc(o,e.mode,c)).return=e,e=r),s(e);if(bo(o))return v(e,r,o,c);if(W(o))return m(e,r,o,c);if(l&&wo(e,o),"undefined"===typeof o&&!u)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(a(152,z(e.type)||"Component"))}return n(e,r)}}var So=To(!0),Io=To(!1),Ro={},Ao=ai(Ro),Co=ai(Ro),ko=ai(Ro);function Oo(e){if(e===Ro)throw Error(a(174));return e}function No(e,t){switch(ci(ko,t),ci(Co,e),ci(Ao,Ro),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}si(Ao),ci(Ao,t)}function Po(){si(Ao),si(Co),si(ko)}function Do(e){Oo(ko.current);var t=Oo(Ao.current),n=pe(t,e.type);t!==n&&(ci(Co,e),ci(Ao,n))}function xo(e){Co.current===e&&(si(Ao),si(Co))}var Lo=ai(0);function Mo(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Uo=null,jo=null,Fo=!1;function Vo(e,t){var n=Bc(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Bo(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Wo(e){if(Fo){var t=jo;if(t){var n=t;if(!Bo(e,t)){if(!(t=Kr(n.nextSibling))||!Bo(e,t))return e.flags=-1025&e.flags|2,Fo=!1,void(Uo=e);Vo(Uo,n)}Uo=e,jo=Kr(t.firstChild)}else e.flags=-1025&e.flags|2,Fo=!1,Uo=e}}function Go(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Uo=e}function qo(e){if(e!==Uo)return!1;if(!Fo)return Go(e),Fo=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Br(t,e.memoizedProps))for(t=jo;t;)Vo(e,t),t=Kr(t.nextSibling);if(Go(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){jo=Kr(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}jo=null}}else jo=Uo?Kr(e.stateNode.nextSibling):null;return!0}function Ko(){jo=Uo=null,Fo=!1}var Ho=[];function zo(){for(var e=0;e<Ho.length;e++)Ho[e]._workInProgressVersionPrimary=null;Ho.length=0}var Yo=E.ReactCurrentDispatcher,Qo=E.ReactCurrentBatchConfig,Xo=0,Jo=null,$o=null,Zo=null,ea=!1,ta=!1;function na(){throw Error(a(321))}function ra(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!sr(e[n],t[n]))return!1;return!0}function ia(e,t,n,r,i,o){if(Xo=o,Jo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Yo.current=null===e||null===e.memoizedState?Oa:Na,e=n(r,i),ta){o=0;do{if(ta=!1,!(25>o))throw Error(a(301));o+=1,Zo=$o=null,t.updateQueue=null,Yo.current=Pa,e=n(r,i)}while(ta)}if(Yo.current=ka,t=null!==$o&&null!==$o.next,Xo=0,Zo=$o=Jo=null,ea=!1,t)throw Error(a(300));return e}function oa(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===Zo?Jo.memoizedState=Zo=e:Zo=Zo.next=e,Zo}function aa(){if(null===$o){var e=Jo.alternate;e=null!==e?e.memoizedState:null}else e=$o.next;var t=null===Zo?Jo.memoizedState:Zo.next;if(null!==t)Zo=t,$o=e;else{if(null===e)throw Error(a(310));e={memoizedState:($o=e).memoizedState,baseState:$o.baseState,baseQueue:$o.baseQueue,queue:$o.queue,next:null},null===Zo?Jo.memoizedState=Zo=e:Zo=Zo.next=e}return Zo}function sa(e,t){return"function"===typeof t?t(e):t}function ca(e){var t=aa(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=$o,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var c=s=o=null,u=i;do{var l=u.lane;if((Xo&l)===l)null!==c&&(c=c.next={lane:0,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null}),r=u.eagerReducer===e?u.eagerState:e(r,u.action);else{var d={lane:l,action:u.action,eagerReducer:u.eagerReducer,eagerState:u.eagerState,next:null};null===c?(s=c=d,o=r):c=c.next=d,Jo.lanes|=l,js|=l}u=u.next}while(null!==u&&u!==i);null===c?o=r:c.next=s,sr(r,t.memoizedState)||(xa=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function ua(e){var t=aa(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);sr(o,t.memoizedState)||(xa=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function la(e,t,n){var r=t._getVersion;r=r(t._source);var i=t._workInProgressVersionPrimary;if(null!==i?e=i===r:(e=e.mutableReadLanes,(e=(Xo&e)===e)&&(t._workInProgressVersionPrimary=r,Ho.push(t))),e)return n(t._source);throw Ho.push(t),Error(a(350))}function da(e,t,n,r){var i=Os;if(null===i)throw Error(a(349));var o=t._getVersion,s=o(t._source),c=Yo.current,u=c.useState((function(){return la(i,t,n)})),l=u[1],d=u[0];u=Zo;var f=e.memoizedState,h=f.refs,p=h.getSnapshot,v=f.source;f=f.subscribe;var m=Jo;return e.memoizedState={refs:h,source:t,subscribe:r},c.useEffect((function(){h.getSnapshot=n,h.setSnapshot=l;var e=o(t._source);if(!sr(s,e)){e=n(t._source),sr(d,e)||(l(e),e=lc(m),i.mutableReadLanes|=e&i.pendingLanes),e=i.mutableReadLanes,i.entangledLanes|=e;for(var r=i.entanglements,a=e;0<a;){var c=31-qt(a),u=1<<c;r[c]|=e,a&=~u}}}),[n,t,r]),c.useEffect((function(){return r(t._source,(function(){var e=h.getSnapshot,n=h.setSnapshot;try{n(e(t._source));var r=lc(m);i.mutableReadLanes|=r&i.pendingLanes}catch(o){n((function(){throw o}))}}))}),[t,r]),sr(p,n)&&sr(v,t)&&sr(f,r)||((e={pending:null,dispatch:null,lastRenderedReducer:sa,lastRenderedState:d}).dispatch=l=Ca.bind(null,Jo,e),u.queue=e,u.baseQueue=null,d=la(i,t,n),u.memoizedState=u.baseState=d),d}function fa(e,t,n){return da(aa(),e,t,n)}function ha(e){var t=oa();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:sa,lastRenderedState:e}).dispatch=Ca.bind(null,Jo,e),[t.memoizedState,e]}function pa(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Jo.updateQueue)?(t={lastEffect:null},Jo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function va(e){return e={current:e},oa().memoizedState=e}function ma(){return aa().memoizedState}function ga(e,t,n,r){var i=oa();Jo.flags|=e,i.memoizedState=pa(1|t,n,void 0,void 0===r?null:r)}function ya(e,t,n,r){var i=aa();r=void 0===r?null:r;var o=void 0;if(null!==$o){var a=$o.memoizedState;if(o=a.destroy,null!==r&&ra(r,a.deps))return void pa(t,n,o,r)}Jo.flags|=e,i.memoizedState=pa(1|t,n,o,r)}function _a(e,t){return ga(516,4,e,t)}function ba(e,t){return ya(516,4,e,t)}function Ea(e,t){return ya(4,2,e,t)}function wa(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ta(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ya(4,2,wa.bind(null,t,e),n)}function Sa(){}function Ia(e,t){var n=aa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ra(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Ra(e,t){var n=aa();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&ra(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Aa(e,t){var n=Bi();Gi(98>n?98:n,(function(){e(!0)})),Gi(97<n?97:n,(function(){var n=Qo.transition;Qo.transition=1;try{e(!1),t()}finally{Qo.transition=n}}))}function Ca(e,t,n){var r=uc(),i=lc(e),o={lane:i,action:n,eagerReducer:null,eagerState:null,next:null},a=t.pending;if(null===a?o.next=o:(o.next=a.next,a.next=o),t.pending=o,a=e.alternate,e===Jo||null!==a&&a===Jo)ta=ea=!0;else{if(0===e.lanes&&(null===a||0===a.lanes)&&null!==(a=t.lastRenderedReducer))try{var s=t.lastRenderedState,c=a(s,n);if(o.eagerReducer=a,o.eagerState=c,sr(c,s))return}catch(u){}dc(e,i,r)}}var ka={readContext:ro,useCallback:na,useContext:na,useEffect:na,useImperativeHandle:na,useLayoutEffect:na,useMemo:na,useReducer:na,useRef:na,useState:na,useDebugValue:na,useDeferredValue:na,useTransition:na,useMutableSource:na,useOpaqueIdentifier:na,unstable_isNewReconciler:!1},Oa={readContext:ro,useCallback:function(e,t){return oa().memoizedState=[e,void 0===t?null:t],e},useContext:ro,useEffect:_a,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ga(4,2,wa.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ga(4,2,e,t)},useMemo:function(e,t){var n=oa();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=oa();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=Ca.bind(null,Jo,e),[r.memoizedState,e]},useRef:va,useState:ha,useDebugValue:Sa,useDeferredValue:function(e){var t=ha(e),n=t[0],r=t[1];return _a((function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}}),[e]),n},useTransition:function(){var e=ha(!1),t=e[0];return va(e=Aa.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,n){var r=oa();return r.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:n},da(r,e,t,n)},useOpaqueIdentifier:function(){if(Fo){var e=!1,t=function(e){return{$$typeof:L,toString:e,valueOf:e}}((function(){throw e||(e=!0,n("r:"+(zr++).toString(36))),Error(a(355))})),n=ha(t)[1];return 0===(2&Jo.mode)&&(Jo.flags|=516,pa(5,(function(){n("r:"+(zr++).toString(36))}),void 0,null)),t}return ha(t="r:"+(zr++).toString(36)),t},unstable_isNewReconciler:!1},Na={readContext:ro,useCallback:Ia,useContext:ro,useEffect:ba,useImperativeHandle:Ta,useLayoutEffect:Ea,useMemo:Ra,useReducer:ca,useRef:ma,useState:function(){return ca(sa)},useDebugValue:Sa,useDeferredValue:function(e){var t=ca(sa),n=t[0],r=t[1];return ba((function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}}),[e]),n},useTransition:function(){var e=ca(sa)[0];return[ma().current,e]},useMutableSource:fa,useOpaqueIdentifier:function(){return ca(sa)[0]},unstable_isNewReconciler:!1},Pa={readContext:ro,useCallback:Ia,useContext:ro,useEffect:ba,useImperativeHandle:Ta,useLayoutEffect:Ea,useMemo:Ra,useReducer:ua,useRef:ma,useState:function(){return ua(sa)},useDebugValue:Sa,useDeferredValue:function(e){var t=ua(sa),n=t[0],r=t[1];return ba((function(){var t=Qo.transition;Qo.transition=1;try{r(e)}finally{Qo.transition=t}}),[e]),n},useTransition:function(){var e=ua(sa)[0];return[ma().current,e]},useMutableSource:fa,useOpaqueIdentifier:function(){return ua(sa)[0]},unstable_isNewReconciler:!1},Da=E.ReactCurrentOwner,xa=!1;function La(e,t,n,r){t.child=null===e?Io(t,null,n,r):So(t,e.child,n,r)}function Ma(e,t,n,r,i){n=n.render;var o=t.ref;return no(t,i),r=ia(e,t,n,r,o,i),null===e||xa?(t.flags|=1,La(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,ns(e,t,i))}function Ua(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!==typeof a||Wc(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=qc(n.type,null,r,t,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,ja(e,t,a,r,i,o))}return a=e.child,0===(i&o)&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:ur)(i,r)&&e.ref===t.ref)?ns(e,t,o):(t.flags|=1,(e=Gc(a,r)).ref=t.ref,e.return=t,t.child=e)}function ja(e,t,n,r,i,o){if(null!==e&&ur(e.memoizedProps,r)&&e.ref===t.ref){if(xa=!1,0===(o&i))return t.lanes=e.lanes,ns(e,t,o);0!==(16384&e.flags)&&(xa=!0)}return Ba(e,t,n,r,o)}function Fa(e,t,n){var r=t.pendingProps,i=r.children,o=null!==e?e.memoizedState:null;if("hidden"===r.mode||"unstable-defer-without-hiding"===r.mode)if(0===(4&t.mode))t.memoizedState={baseLanes:0},_c(t,n);else{if(0===(1073741824&n))return e=null!==o?o.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},_c(t,e),null;t.memoizedState={baseLanes:0},_c(t,null!==o?o.baseLanes:n)}else null!==o?(r=o.baseLanes|n,t.memoizedState=null):r=n,_c(t,r);return La(e,t,i,n),t.child}function Va(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=128)}function Ba(e,t,n,r,i){var o=pi(n)?fi:li.current;return o=hi(t,o),no(t,i),n=ia(e,t,n,r,o,i),null===e||xa?(t.flags|=1,La(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~i,ns(e,t,i))}function Wa(e,t,n,r,i){if(pi(n)){var o=!0;yi(t)}else o=!1;if(no(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),go(t,n,r),_o(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var c=a.context,u=n.contextType;"object"===typeof u&&null!==u?u=ro(u):u=hi(t,u=pi(n)?fi:li.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||c!==u)&&yo(t,a,r,u),io=!1;var f=t.memoizedState;a.state=f,lo(t,r,a,i),c=t.memoizedState,s!==r||f!==c||di.current||io?("function"===typeof l&&(po(t,n,l,r),c=t.memoizedState),(s=io||mo(t,n,s,r,f,c,u))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.flags|=4)):("function"===typeof a.componentDidMount&&(t.flags|=4),t.memoizedProps=r,t.memoizedState=c),a.props=r,a.state=c,a.context=u,r=s):("function"===typeof a.componentDidMount&&(t.flags|=4),r=!1)}else{a=t.stateNode,ao(e,t),s=t.memoizedProps,u=t.type===t.elementType?s:Yi(t.type,s),a.props=u,d=t.pendingProps,f=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=ro(c):c=hi(t,c=pi(n)?fi:li.current);var h=n.getDerivedStateFromProps;(l="function"===typeof h||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==d||f!==c)&&yo(t,a,r,c),io=!1,f=t.memoizedState,a.state=f,lo(t,r,a,i);var p=t.memoizedState;s!==d||f!==p||di.current||io?("function"===typeof h&&(po(t,n,h,r),p=t.memoizedState),(u=io||mo(t,n,u,r,f,p,c))?(l||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,p,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,p,c)),"function"===typeof a.componentDidUpdate&&(t.flags|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),t.memoizedProps=r,t.memoizedState=p),a.props=r,a.state=p,a.context=c,r=u):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&f===e.memoizedState||(t.flags|=256),r=!1)}return Ga(e,t,n,r,o,i)}function Ga(e,t,n,r,i,o){Va(e,t);var a=0!==(64&t.flags);if(!r&&!a)return i&&_i(t,n,!1),ns(e,t,o);r=t.stateNode,Da.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&a?(t.child=So(t,e.child,null,o),t.child=So(t,null,s,o)):La(e,t,s,o),t.memoizedState=r.state,i&&_i(t,n,!0),t.child}function qa(e){var t=e.stateNode;t.pendingContext?mi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&mi(0,t.context,!1),No(e,t.containerInfo)}var Ka,Ha,za,Ya={dehydrated:null,retryLane:0};function Qa(e,t,n){var r,i=t.pendingProps,o=Lo.current,a=!1;return(r=0!==(64&t.flags))||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===i.fallback||!0===i.unstable_avoidThisFallback||(o|=1),ci(Lo,1&o),null===e?(void 0!==i.fallback&&Wo(t),e=i.children,o=i.fallback,a?(e=Xa(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ya,e):"number"===typeof i.unstable_expectedLoadTime?(e=Xa(t,e,o,n),t.child.memoizedState={baseLanes:n},t.memoizedState=Ya,t.lanes=33554432,e):((n=Hc({mode:"visible",children:e},t.mode,n,null)).return=t,t.child=n)):(e.memoizedState,a?(i=$a(e,t,i.children,i.fallback,n),a=t.child,o=e.child.memoizedState,a.memoizedState=null===o?{baseLanes:n}:{baseLanes:o.baseLanes|n},a.childLanes=e.childLanes&~n,t.memoizedState=Ya,i):(n=Ja(e,t,i.children,n),t.memoizedState=null,n))}function Xa(e,t,n,r){var i=e.mode,o=e.child;return t={mode:"hidden",children:t},0===(2&i)&&null!==o?(o.childLanes=0,o.pendingProps=t):o=Hc(t,i,0,null),n=Kc(n,i,r,null),o.return=e,n.return=e,o.sibling=n,e.child=o,n}function Ja(e,t,n,r){var i=e.child;return e=i.sibling,n=Gc(i,{mode:"visible",children:n}),0===(2&t.mode)&&(n.lanes=r),n.return=t,n.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=n}function $a(e,t,n,r,i){var o=t.mode,a=e.child;e=a.sibling;var s={mode:"hidden",children:n};return 0===(2&o)&&t.child!==a?((n=t.child).childLanes=0,n.pendingProps=s,null!==(a=n.lastEffect)?(t.firstEffect=n.firstEffect,t.lastEffect=a,a.nextEffect=null):t.firstEffect=t.lastEffect=null):n=Gc(a,s),null!==e?r=Gc(e,r):(r=Kc(r,o,i,null)).flags|=2,r.return=t,n.return=t,n.sibling=r,t.child=n,r}function Za(e,t){e.lanes|=t;var n=e.alternate;null!==n&&(n.lanes|=t),to(e.return,t)}function es(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailMode=i,a.lastEffect=o)}function ts(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(La(e,t,r.children,n),0!==(2&(r=Lo.current)))r=1&r|2,t.flags|=64;else{if(null!==e&&0!==(64&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&Za(e,n);else if(19===e.tag)Za(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ci(Lo,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Mo(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),es(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Mo(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}es(t,!0,n,null,o,t.lastEffect);break;case"together":es(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function ns(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),js|=t.lanes,0!==(n&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Gc(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Gc(e,e.pendingProps)).return=t;n.sibling=null}return t.child}return null}function rs(e,t){if(!Fo)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function is(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return pi(t.type)&&vi(),null;case 3:return Po(),si(di),si(li),zo(),(r=t.stateNode).pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(qo(t)?t.flags|=4:r.hydrate||(t.flags|=256)),null;case 5:xo(t);var o=Oo(ko.current);if(n=t.type,null!==e&&null!=t.stateNode)Ha(e,t,n,r),e.ref!==t.ref&&(t.flags|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=Oo(Ao.current),qo(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[Qr]=t,r[Xr]=s,n){case"dialog":Ar("cancel",r),Ar("close",r);break;case"iframe":case"object":case"embed":Ar("load",r);break;case"video":case"audio":for(e=0;e<Tr.length;e++)Ar(Tr[e],r);break;case"source":Ar("error",r);break;case"img":case"image":case"link":Ar("error",r),Ar("load",r);break;case"details":Ar("toggle",r);break;case"input":ee(r,s),Ar("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Ar("invalid",r);break;case"textarea":ce(r,s),Ar("invalid",r)}for(var u in Se(n,s),e=null,s)s.hasOwnProperty(u)&&(o=s[u],"children"===u?"string"===typeof o?r.textContent!==o&&(e=["children",o]):"number"===typeof o&&r.textContent!==""+o&&(e=["children",""+o]):c.hasOwnProperty(u)&&null!=o&&"onScroll"===u&&Ar("scroll",r));switch(n){case"input":X(r),re(r,s,!0);break;case"textarea":X(r),le(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=Ur)}r=e,t.updateQueue=r,null!==r&&(t.flags|=4)}else{switch(u=9===o.nodeType?o:o.ownerDocument,e===de&&(e=he(n)),e===de?"script"===n?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(n,{is:r.is}):(e=u.createElement(n),"select"===n&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,n),e[Qr]=t,e[Xr]=r,Ka(e,t),t.stateNode=e,u=Ie(n,r),n){case"dialog":Ar("cancel",e),Ar("close",e),o=r;break;case"iframe":case"object":case"embed":Ar("load",e),o=r;break;case"video":case"audio":for(o=0;o<Tr.length;o++)Ar(Tr[o],e);o=r;break;case"source":Ar("error",e),o=r;break;case"img":case"image":case"link":Ar("error",e),Ar("load",e),o=r;break;case"details":Ar("toggle",e),o=r;break;case"input":ee(e,r),o=Z(e,r),Ar("invalid",e);break;case"option":o=oe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},o=i({},r,{value:void 0}),Ar("invalid",e);break;case"textarea":ce(e,r),o=se(e,r),Ar("invalid",e);break;default:o=r}Se(n,o);var l=o;for(s in l)if(l.hasOwnProperty(s)){var d=l[s];"style"===s?we(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&ge(e,d):"children"===s?"string"===typeof d?("textarea"!==n||""!==d)&&ye(e,d):"number"===typeof d&&ye(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(c.hasOwnProperty(s)?null!=d&&"onScroll"===s&&Ar("scroll",e):null!=d&&b(e,s,d,u))}switch(n){case"input":X(e),re(e,r,!1);break;case"textarea":X(e),le(e);break;case"option":null!=r.value&&e.setAttribute("value",""+Y(r.value));break;case"select":e.multiple=!!r.multiple,null!=(s=r.value)?ae(e,!!r.multiple,s,!1):null!=r.defaultValue&&ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof o.onClick&&(e.onclick=Ur)}Vr(n,r)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)za(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));n=Oo(ko.current),Oo(Ao.current),qo(t)?(r=t.stateNode,n=t.memoizedProps,r[Qr]=t,r.nodeValue!==n&&(t.flags|=4)):((r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Qr]=t,t.stateNode=r)}return null;case 13:return si(Lo),r=t.memoizedState,0!==(64&t.flags)?(t.lanes=n,t):(r=null!==r,n=!1,null===e?void 0!==t.memoizedProps.fallback&&qo(t):n=null!==e.memoizedState,r&&!n&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Lo.current)?0===Ls&&(Ls=3):(0!==Ls&&3!==Ls||(Ls=4),null===Os||0===(134217727&js)&&0===(134217727&Fs)||vc(Os,Ps))),(r||n)&&(t.flags|=4),null);case 4:return Po(),null===e&&kr(t.stateNode.containerInfo),null;case 10:return eo(t),null;case 17:return pi(t.type)&&vi(),null;case 19:if(si(Lo),null===(r=t.memoizedState))return null;if(s=0!==(64&t.flags),null===(u=r.rendering))if(s)rs(r,!1);else{if(0!==Ls||null!==e&&0!==(64&e.flags))for(e=t.child;null!==e;){if(null!==(u=Mo(e))){for(t.flags|=64,rs(r,!1),null!==(s=u.updateQueue)&&(t.updateQueue=s,t.flags|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=n,n=t.child;null!==n;)e=r,(s=n).flags&=2,s.nextEffect=null,s.firstEffect=null,s.lastEffect=null,null===(u=s.alternate)?(s.childLanes=0,s.lanes=e,s.child=null,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,e=u.dependencies,s.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return ci(Lo,1&Lo.current|2),t.child}e=e.sibling}null!==r.tail&&Vi()>Gs&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432)}else{if(!s)if(null!==(e=Mo(u))){if(t.flags|=64,s=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),rs(r,!0),null===r.tail&&"hidden"===r.tailMode&&!u.alternate&&!Fo)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Vi()-r.renderingStartTime>Gs&&1073741824!==n&&(t.flags|=64,s=!0,rs(r,!1),t.lanes=33554432);r.isBackwards?(u.sibling=t.child,t.child=u):(null!==(n=r.last)?n.sibling=u:t.child=u,r.last=u)}return null!==r.tail?(n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Vi(),n.sibling=null,t=Lo.current,ci(Lo,s?1&t|2:1&t),n):null;case 23:case 24:return bc(),null!==e&&null!==e.memoizedState!==(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==r.mode&&(t.flags|=4),null}throw Error(a(156,t.tag))}function os(e){switch(e.tag){case 1:pi(e.type)&&vi();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Po(),si(di),si(li),zo(),0!==(64&(t=e.flags)))throw Error(a(285));return e.flags=-4097&t|64,e;case 5:return xo(e),null;case 13:return si(Lo),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return si(Lo),null;case 4:return Po(),null;case 10:return eo(e),null;case 23:case 24:return bc(),null;default:return null}}function as(e,t){try{var n="",r=t;do{n+=H(r),r=r.return}while(r);var i=n}catch(o){i="\nError generating stack: "+o.message+"\n"+o.stack}return{value:e,source:t,stack:i}}function ss(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}Ka=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ha=function(e,t,n,r){var o=e.memoizedProps;if(o!==r){e=t.stateNode,Oo(Ao.current);var a,s=null;switch(n){case"input":o=Z(e,o),r=Z(e,r),s=[];break;case"option":o=oe(e,o),r=oe(e,r),s=[];break;case"select":o=i({},o,{value:void 0}),r=i({},r,{value:void 0}),s=[];break;case"textarea":o=se(e,o),r=se(e,r),s=[];break;default:"function"!==typeof o.onClick&&"function"===typeof r.onClick&&(e.onclick=Ur)}for(d in Se(n,r),n=null,o)if(!r.hasOwnProperty(d)&&o.hasOwnProperty(d)&&null!=o[d])if("style"===d){var u=o[d];for(a in u)u.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(c.hasOwnProperty(d)?s||(s=[]):(s=s||[]).push(d,null));for(d in r){var l=r[d];if(u=null!=o?o[d]:void 0,r.hasOwnProperty(d)&&l!==u&&(null!=l||null!=u))if("style"===d)if(u){for(a in u)!u.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&u[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(d,n)),n=l;else"dangerouslySetInnerHTML"===d?(l=l?l.__html:void 0,u=u?u.__html:void 0,null!=l&&u!==l&&(s=s||[]).push(d,l)):"children"===d?"string"!==typeof l&&"number"!==typeof l||(s=s||[]).push(d,""+l):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(c.hasOwnProperty(d)?(null!=l&&"onScroll"===d&&Ar("scroll",e),s||u===l||(s=[])):"object"===typeof l&&null!==l&&l.$$typeof===L?l.toString():(s=s||[]).push(d,l))}n&&(s=s||[]).push("style",n);var d=s;(t.updateQueue=d)&&(t.flags|=4)}},za=function(e,t,n,r){n!==r&&(t.flags|=4)};var cs="function"===typeof WeakMap?WeakMap:Map;function us(e,t,n){(n=so(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){zs||(zs=!0,Ys=r),ss(0,t)},n}function ls(e,t,n){(n=so(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return ss(0,t),r(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Qs?Qs=new Set([this]):Qs.add(this),ss(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}var ds="function"===typeof WeakSet?WeakSet:Set;function fs(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){Uc(e,n)}else t.current=null}function hs(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.flags&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Yi(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&qr(t.stateNode.containerInfo));case 5:case 6:case 4:case 17:return}throw Error(a(163))}function ps(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(3===(3&e.tag)){var r=e.create;e.destroy=r()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=n.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var i=e;r=i.next,0!==(4&(i=i.tag))&&0!==(1&i)&&(xc(n,e),Dc(n,e)),e=r}while(e!==t)}return;case 1:return e=n.stateNode,4&n.flags&&(null===t?e.componentDidMount():(r=n.elementType===n.type?t.memoizedProps:Yi(n.type,t.memoizedProps),e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=n.updateQueue)&&fo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}fo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.flags&&Vr(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&wt(n)))));case 19:case 17:case 20:case 21:case 23:case 24:return}throw Error(a(163))}function vs(e,t){for(var n=e;;){if(5===n.tag){var r=n.stateNode;if(t)"function"===typeof(r=r.style).setProperty?r.setProperty("display","none","important"):r.display="none";else{r=n.stateNode;var i=n.memoizedProps.style;i=void 0!==i&&null!==i&&i.hasOwnProperty("display")?i.display:null,r.style.display=Ee("display",i)}}else if(6===n.tag)n.stateNode.nodeValue=t?"":n.memoizedProps;else if((23!==n.tag&&24!==n.tag||null===n.memoizedState||n===e)&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===e)break;for(;null===n.sibling;){if(null===n.return||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}}function ms(e,t){if(Ei&&"function"===typeof Ei.onCommitFiberUnmount)try{Ei.onCommitFiberUnmount(bi,t)}catch(o){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var n=e=e.next;do{var r=n,i=r.destroy;if(r=r.tag,void 0!==i)if(0!==(4&r))xc(t,n);else{r=t;try{i()}catch(o){Uc(r,o)}}n=n.next}while(n!==e)}break;case 1:if(fs(t),"function"===typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(o){Uc(t,o)}break;case 5:fs(t);break;case 4:ws(e,t)}}function gs(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function ys(e){return 5===e.tag||3===e.tag||4===e.tag}function _s(e){e:{for(var t=e.return;null!==t;){if(ys(t))break e;t=t.return}throw Error(a(160))}var n=t;switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.flags&&(ye(t,""),n.flags&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||ys(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.flags)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.flags)){n=n.stateNode;break e}}r?bs(e,n,t):Es(e,n,t)}function bs(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=Ur));else if(4!==r&&null!==(e=e.child))for(bs(e,t,n),e=e.sibling;null!==e;)bs(e,t,n),e=e.sibling}function Es(e,t,n){var r=e.tag,i=5===r||6===r;if(i)e=i?e.stateNode:e.stateNode.instance,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(Es(e,t,n),e=e.sibling;null!==e;)Es(e,t,n),e=e.sibling}function ws(e,t){for(var n,r,i=t,o=!1;;){if(!o){o=i.return;e:for(;;){if(null===o)throw Error(a(160));switch(n=o.stateNode,o.tag){case 5:r=!1;break e;case 3:case 4:n=n.containerInfo,r=!0;break e}o=o.return}o=!0}if(5===i.tag||6===i.tag){e:for(var s=e,c=i,u=c;;)if(ms(s,u),null!==u.child&&4!==u.tag)u.child.return=u,u=u.child;else{if(u===c)break e;for(;null===u.sibling;){if(null===u.return||u.return===c)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}r?(s=n,c=i.stateNode,8===s.nodeType?s.parentNode.removeChild(c):s.removeChild(c)):n.removeChild(i.stateNode)}else if(4===i.tag){if(null!==i.child){n=i.stateNode.containerInfo,r=!0,i.child.return=i,i=i.child;continue}}else if(ms(e,i),null!==i.child){i.child.return=i,i=i.child;continue}if(i===t)break;for(;null===i.sibling;){if(null===i.return||i.return===t)return;4===(i=i.return).tag&&(o=!1)}i.sibling.return=i.return,i=i.sibling}}function Ts(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var n=t.updateQueue;if(null!==(n=null!==n?n.lastEffect:null)){var r=n=n.next;do{3===(3&r.tag)&&(e=r.destroy,r.destroy=void 0,void 0!==e&&e()),r=r.next}while(r!==n)}return;case 1:return;case 5:if(null!=(n=t.stateNode)){r=t.memoizedProps;var i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[Xr]=r,"input"===e&&"radio"===r.type&&null!=r.name&&te(n,r),Ie(e,i),t=Ie(e,r),i=0;i<o.length;i+=2){var s=o[i],c=o[i+1];"style"===s?we(n,c):"dangerouslySetInnerHTML"===s?ge(n,c):"children"===s?ye(n,c):b(n,s,c,t)}switch(e){case"input":ne(n,r);break;case"textarea":ue(n,r);break;case"select":e=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(o=r.value)?ae(n,!!r.multiple,o,!1):e!==!!r.multiple&&(null!=r.defaultValue?ae(n,!!r.multiple,r.defaultValue,!0):ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((n=t.stateNode).hydrate&&(n.hydrate=!1,wt(n.containerInfo)));case 12:return;case 13:return null!==t.memoizedState&&(Ws=Vi(),vs(t.child,!0)),void Ss(t);case 19:return void Ss(t);case 17:return;case 23:case 24:return void vs(t,null!==t.memoizedState)}throw Error(a(163))}function Ss(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new ds),t.forEach((function(t){var r=Fc.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function Is(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Rs=Math.ceil,As=E.ReactCurrentDispatcher,Cs=E.ReactCurrentOwner,ks=0,Os=null,Ns=null,Ps=0,Ds=0,xs=ai(0),Ls=0,Ms=null,Us=0,js=0,Fs=0,Vs=0,Bs=null,Ws=0,Gs=1/0;function qs(){Gs=Vi()+500}var Ks,Hs=null,zs=!1,Ys=null,Qs=null,Xs=!1,Js=null,$s=90,Zs=[],ec=[],tc=null,nc=0,rc=null,ic=-1,oc=0,ac=0,sc=null,cc=!1;function uc(){return 0!==(48&ks)?Vi():-1!==ic?ic:ic=Vi()}function lc(e){if(0===(2&(e=e.mode)))return 1;if(0===(4&e))return 99===Bi()?1:2;if(0===oc&&(oc=Us),0!==zi.transition){0!==ac&&(ac=null!==Bs?Bs.pendingLanes:0),e=oc;var t=4186112&~ac;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=Bi(),0!==(4&ks)&&98===e?e=Vt(12,oc):e=Vt(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),oc),e}function dc(e,t,n){if(50<nc)throw nc=0,rc=null,Error(a(185));if(null===(e=fc(e,t)))return null;Gt(e,t,n),e===Os&&(Fs|=t,4===Ls&&vc(e,Ps));var r=Bi();1===t?0!==(8&ks)&&0===(48&ks)?mc(e):(hc(e,n),0===ks&&(qs(),Ki())):(0===(4&ks)||98!==r&&99!==r||(null===tc?tc=new Set([e]):tc.add(e)),hc(e,n)),Bs=e}function fc(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}function hc(e,t){for(var n=e.callbackNode,r=e.suspendedLanes,i=e.pingedLanes,o=e.expirationTimes,s=e.pendingLanes;0<s;){var c=31-qt(s),u=1<<c,l=o[c];if(-1===l){if(0===(u&r)||0!==(u&i)){l=t,Ut(u);var d=Mt;o[c]=10<=d?l+250:6<=d?l+5e3:-1}}else l<=t&&(e.expiredLanes|=u);s&=~u}if(r=jt(e,e===Os?Ps:0),t=Mt,0===r)null!==n&&(n!==xi&&Si(n),e.callbackNode=null,e.callbackPriority=0);else{if(null!==n){if(e.callbackPriority===t)return;n!==xi&&Si(n)}15===t?(n=mc.bind(null,e),null===Mi?(Mi=[n],Ui=Ti(ki,Hi)):Mi.push(n),n=xi):14===t?n=qi(99,mc.bind(null,e)):n=qi(n=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(a(358,e))}}(t),pc.bind(null,e)),e.callbackPriority=t,e.callbackNode=n}}function pc(e){if(ic=-1,ac=oc=0,0!==(48&ks))throw Error(a(327));var t=e.callbackNode;if(Pc()&&e.callbackNode!==t)return null;var n=jt(e,e===Os?Ps:0);if(0===n)return null;var r=n,i=ks;ks|=16;var o=Tc();for(Os===e&&Ps===r||(qs(),Ec(e,r));;)try{Rc();break}catch(c){wc(e,c)}if(Zi(),As.current=o,ks=i,null!==Ns?r=0:(Os=null,Ps=0,r=Ls),0!==(Us&Fs))Ec(e,0);else if(0!==r){if(2===r&&(ks|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(n=Ft(e))&&(r=Sc(e,n))),1===r)throw t=Ms,Ec(e,0),vc(e,n),hc(e,Vi()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=n,r){case 0:case 1:throw Error(a(345));case 2:kc(e);break;case 3:if(vc(e,n),(62914560&n)===n&&10<(r=Ws+500-Vi())){if(0!==jt(e,0))break;if(((i=e.suspendedLanes)&n)!==n){uc(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Wr(kc.bind(null,e),r);break}kc(e);break;case 4:if(vc(e,n),(4186112&n)===n)break;for(r=e.eventTimes,i=-1;0<n;){var s=31-qt(n);o=1<<s,(s=r[s])>i&&(i=s),n&=~o}if(n=i,10<(n=(120>(n=Vi()-n)?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*Rs(n/1960))-n)){e.timeoutHandle=Wr(kc.bind(null,e),n);break}kc(e);break;case 5:kc(e);break;default:throw Error(a(329))}}return hc(e,Vi()),e.callbackNode===t?pc.bind(null,e):null}function vc(e,t){for(t&=~Vs,t&=~Fs,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-qt(t),r=1<<n;e[n]=-1,t&=~r}}function mc(e){if(0!==(48&ks))throw Error(a(327));if(Pc(),e===Os&&0!==(e.expiredLanes&Ps)){var t=Ps,n=Sc(e,t);0!==(Us&Fs)&&(n=Sc(e,t=jt(e,t)))}else n=Sc(e,t=jt(e,0));if(0!==e.tag&&2===n&&(ks|=64,e.hydrate&&(e.hydrate=!1,qr(e.containerInfo)),0!==(t=Ft(e))&&(n=Sc(e,t))),1===n)throw n=Ms,Ec(e,0),vc(e,t),hc(e,Vi()),n;return e.finishedWork=e.current.alternate,e.finishedLanes=t,kc(e),hc(e,Vi()),null}function gc(e,t){var n=ks;ks|=1;try{return e(t)}finally{0===(ks=n)&&(qs(),Ki())}}function yc(e,t){var n=ks;ks&=-2,ks|=8;try{return e(t)}finally{0===(ks=n)&&(qs(),Ki())}}function _c(e,t){ci(xs,Ds),Ds|=t,Us|=t}function bc(){Ds=xs.current,si(xs)}function Ec(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,Gr(n)),null!==Ns)for(n=Ns.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&vi();break;case 3:Po(),si(di),si(li),zo();break;case 5:xo(r);break;case 4:Po();break;case 13:case 19:si(Lo);break;case 10:eo(r);break;case 23:case 24:bc()}n=n.return}Os=e,Ns=Gc(e.current,null),Ps=Ds=Us=t,Ls=0,Ms=null,Vs=Fs=js=0}function wc(e,t){for(;;){var n=Ns;try{if(Zi(),Yo.current=ka,ea){for(var r=Jo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}ea=!1}if(Xo=0,Zo=$o=Jo=null,ta=!1,Cs.current=null,null===n||null===n.return){Ls=1,Ms=t,Ns=null;break}e:{var o=e,a=n.return,s=n,c=t;if(t=Ps,s.flags|=2048,s.firstEffect=s.lastEffect=null,null!==c&&"object"===typeof c&&"function"===typeof c.then){var u=c;if(0===(2&s.mode)){var l=s.alternate;l?(s.updateQueue=l.updateQueue,s.memoizedState=l.memoizedState,s.lanes=l.lanes):(s.updateQueue=null,s.memoizedState=null)}var d=0!==(1&Lo.current),f=a;do{var h;if(h=13===f.tag){var p=f.memoizedState;if(null!==p)h=null!==p.dehydrated;else{var v=f.memoizedProps;h=void 0!==v.fallback&&(!0!==v.unstable_avoidThisFallback||!d)}}if(h){var m=f.updateQueue;if(null===m){var g=new Set;g.add(u),f.updateQueue=g}else m.add(u);if(0===(2&f.mode)){if(f.flags|=64,s.flags|=16384,s.flags&=-2981,1===s.tag)if(null===s.alternate)s.tag=17;else{var y=so(-1,1);y.tag=2,co(s,y)}s.lanes|=1;break e}c=void 0,s=t;var _=o.pingCache;if(null===_?(_=o.pingCache=new cs,c=new Set,_.set(u,c)):void 0===(c=_.get(u))&&(c=new Set,_.set(u,c)),!c.has(s)){c.add(s);var b=jc.bind(null,o,u,s);u.then(b,b)}f.flags|=4096,f.lanes=t;break e}f=f.return}while(null!==f);c=Error((z(s.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Ls&&(Ls=2),c=as(c,s),f=a;do{switch(f.tag){case 3:o=c,f.flags|=4096,t&=-t,f.lanes|=t,uo(f,us(0,o,t));break e;case 1:o=c;var E=f.type,w=f.stateNode;if(0===(64&f.flags)&&("function"===typeof E.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Qs||!Qs.has(w)))){f.flags|=4096,t&=-t,f.lanes|=t,uo(f,ls(f,o,t));break e}}f=f.return}while(null!==f)}Cc(n)}catch(T){t=T,Ns===n&&null!==n&&(Ns=n=n.return);continue}break}}function Tc(){var e=As.current;return As.current=ka,null===e?ka:e}function Sc(e,t){var n=ks;ks|=16;var r=Tc();for(Os===e&&Ps===t||Ec(e,t);;)try{Ic();break}catch(i){wc(e,i)}if(Zi(),ks=n,As.current=r,null!==Ns)throw Error(a(261));return Os=null,Ps=0,Ls}function Ic(){for(;null!==Ns;)Ac(Ns)}function Rc(){for(;null!==Ns&&!Ii();)Ac(Ns)}function Ac(e){var t=Ks(e.alternate,e,Ds);e.memoizedProps=e.pendingProps,null===t?Cc(e):Ns=t,Cs.current=null}function Cc(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(2048&t.flags)){if(null!==(n=is(n,t,Ds)))return void(Ns=n);if(24!==(n=t).tag&&23!==n.tag||null===n.memoizedState||0!==(1073741824&Ds)||0===(4&n.mode)){for(var r=0,i=n.child;null!==i;)r|=i.lanes|i.childLanes,i=i.sibling;n.childLanes=r}null!==e&&0===(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}else{if(null!==(n=os(t)))return n.flags&=2047,void(Ns=n);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}if(null!==(t=t.sibling))return void(Ns=t);Ns=t=e}while(null!==t);0===Ls&&(Ls=5)}function kc(e){var t=Bi();return Gi(99,Oc.bind(null,e,t)),null}function Oc(e,t){do{Pc()}while(null!==Js);if(0!==(48&ks))throw Error(a(327));var n=e.finishedWork;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(a(177));e.callbackNode=null;var r=n.lanes|n.childLanes,i=r,o=e.pendingLanes&~i;e.pendingLanes=i,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=i,e.mutableReadLanes&=i,e.entangledLanes&=i,i=e.entanglements;for(var s=e.eventTimes,c=e.expirationTimes;0<o;){var u=31-qt(o),l=1<<u;i[u]=0,s[u]=-1,c[u]=-1,o&=~l}if(null!==tc&&0===(24&r)&&tc.has(e)&&tc.delete(e),e===Os&&(Ns=Os=null,Ps=0),1<n.flags?null!==n.lastEffect?(n.lastEffect.nextEffect=n,r=n.firstEffect):r=n:r=n.firstEffect,null!==r){if(i=ks,ks|=32,Cs.current=null,jr=Qt,pr(s=hr())){if("selectionStart"in s)c={start:s.selectionStart,end:s.selectionEnd};else e:if(c=(c=s.ownerDocument)&&c.defaultView||window,(l=c.getSelection&&c.getSelection())&&0!==l.rangeCount){c=l.anchorNode,o=l.anchorOffset,u=l.focusNode,l=l.focusOffset;try{c.nodeType,u.nodeType}catch(R){c=null;break e}var d=0,f=-1,h=-1,p=0,v=0,m=s,g=null;t:for(;;){for(var y;m!==c||0!==o&&3!==m.nodeType||(f=d+o),m!==u||0!==l&&3!==m.nodeType||(h=d+l),3===m.nodeType&&(d+=m.nodeValue.length),null!==(y=m.firstChild);)g=m,m=y;for(;;){if(m===s)break t;if(g===c&&++p===o&&(f=d),g===u&&++v===l&&(h=d),null!==(y=m.nextSibling))break;g=(m=g).parentNode}m=y}c=-1===f||-1===h?null:{start:f,end:h}}else c=null;c=c||{start:0,end:0}}else c=null;Fr={focusedElem:s,selectionRange:c},Qt=!1,sc=null,cc=!1,Hs=r;do{try{Nc()}catch(R){if(null===Hs)throw Error(a(330));Uc(Hs,R),Hs=Hs.nextEffect}}while(null!==Hs);sc=null,Hs=r;do{try{for(s=e;null!==Hs;){var _=Hs.flags;if(16&_&&ye(Hs.stateNode,""),128&_){var b=Hs.alternate;if(null!==b){var E=b.ref;null!==E&&("function"===typeof E?E(null):E.current=null)}}switch(1038&_){case 2:_s(Hs),Hs.flags&=-3;break;case 6:_s(Hs),Hs.flags&=-3,Ts(Hs.alternate,Hs);break;case 1024:Hs.flags&=-1025;break;case 1028:Hs.flags&=-1025,Ts(Hs.alternate,Hs);break;case 4:Ts(Hs.alternate,Hs);break;case 8:ws(s,c=Hs);var w=c.alternate;gs(c),null!==w&&gs(w)}Hs=Hs.nextEffect}}catch(R){if(null===Hs)throw Error(a(330));Uc(Hs,R),Hs=Hs.nextEffect}}while(null!==Hs);if(E=Fr,b=hr(),_=E.focusedElem,s=E.selectionRange,b!==_&&_&&_.ownerDocument&&fr(_.ownerDocument.documentElement,_)){null!==s&&pr(_)&&(b=s.start,void 0===(E=s.end)&&(E=b),"selectionStart"in _?(_.selectionStart=b,_.selectionEnd=Math.min(E,_.value.length)):(E=(b=_.ownerDocument||document)&&b.defaultView||window).getSelection&&(E=E.getSelection(),c=_.textContent.length,w=Math.min(s.start,c),s=void 0===s.end?w:Math.min(s.end,c),!E.extend&&w>s&&(c=s,s=w,w=c),c=dr(_,w),o=dr(_,s),c&&o&&(1!==E.rangeCount||E.anchorNode!==c.node||E.anchorOffset!==c.offset||E.focusNode!==o.node||E.focusOffset!==o.offset)&&((b=b.createRange()).setStart(c.node,c.offset),E.removeAllRanges(),w>s?(E.addRange(b),E.extend(o.node,o.offset)):(b.setEnd(o.node,o.offset),E.addRange(b))))),b=[];for(E=_;E=E.parentNode;)1===E.nodeType&&b.push({element:E,left:E.scrollLeft,top:E.scrollTop});for("function"===typeof _.focus&&_.focus(),_=0;_<b.length;_++)(E=b[_]).element.scrollLeft=E.left,E.element.scrollTop=E.top}Qt=!!jr,Fr=jr=null,e.current=n,Hs=r;do{try{for(_=e;null!==Hs;){var T=Hs.flags;if(36&T&&ps(_,Hs.alternate,Hs),128&T){b=void 0;var S=Hs.ref;if(null!==S){var I=Hs.stateNode;switch(Hs.tag){case 5:b=I;break;default:b=I}"function"===typeof S?S(b):S.current=b}}Hs=Hs.nextEffect}}catch(R){if(null===Hs)throw Error(a(330));Uc(Hs,R),Hs=Hs.nextEffect}}while(null!==Hs);Hs=null,Li(),ks=i}else e.current=n;if(Xs)Xs=!1,Js=e,$s=t;else for(Hs=r;null!==Hs;)t=Hs.nextEffect,Hs.nextEffect=null,8&Hs.flags&&((T=Hs).sibling=null,T.stateNode=null),Hs=t;if(0===(r=e.pendingLanes)&&(Qs=null),1===r?e===rc?nc++:(nc=0,rc=e):nc=0,n=n.stateNode,Ei&&"function"===typeof Ei.onCommitFiberRoot)try{Ei.onCommitFiberRoot(bi,n,void 0,64===(64&n.current.flags))}catch(R){}if(hc(e,Vi()),zs)throw zs=!1,e=Ys,Ys=null,e;return 0!==(8&ks)||Ki(),null}function Nc(){for(;null!==Hs;){var e=Hs.alternate;cc||null===sc||(0!==(8&Hs.flags)?et(Hs,sc)&&(cc=!0):13===Hs.tag&&Is(e,Hs)&&et(Hs,sc)&&(cc=!0));var t=Hs.flags;0!==(256&t)&&hs(e,Hs),0===(512&t)||Xs||(Xs=!0,qi(97,(function(){return Pc(),null}))),Hs=Hs.nextEffect}}function Pc(){if(90!==$s){var e=97<$s?97:$s;return $s=90,Gi(e,Lc)}return!1}function Dc(e,t){Zs.push(t,e),Xs||(Xs=!0,qi(97,(function(){return Pc(),null})))}function xc(e,t){ec.push(t,e),Xs||(Xs=!0,qi(97,(function(){return Pc(),null})))}function Lc(){if(null===Js)return!1;var e=Js;if(Js=null,0!==(48&ks))throw Error(a(331));var t=ks;ks|=32;var n=ec;ec=[];for(var r=0;r<n.length;r+=2){var i=n[r],o=n[r+1],s=i.destroy;if(i.destroy=void 0,"function"===typeof s)try{s()}catch(u){if(null===o)throw Error(a(330));Uc(o,u)}}for(n=Zs,Zs=[],r=0;r<n.length;r+=2){i=n[r],o=n[r+1];try{var c=i.create;i.destroy=c()}catch(u){if(null===o)throw Error(a(330));Uc(o,u)}}for(c=e.current.firstEffect;null!==c;)e=c.nextEffect,c.nextEffect=null,8&c.flags&&(c.sibling=null,c.stateNode=null),c=e;return ks=t,Ki(),!0}function Mc(e,t,n){co(e,t=us(0,t=as(n,t),1)),t=uc(),null!==(e=fc(e,1))&&(Gt(e,1,t),hc(e,t))}function Uc(e,t){if(3===e.tag)Mc(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){Mc(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Qs||!Qs.has(r))){var i=ls(n,e=as(t,e),1);if(co(n,i),i=uc(),null!==(n=fc(n,1)))Gt(n,1,i),hc(n,i);else if("function"===typeof r.componentDidCatch&&(null===Qs||!Qs.has(r)))try{r.componentDidCatch(t,e)}catch(o){}break}}n=n.return}}function jc(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=uc(),e.pingedLanes|=e.suspendedLanes&n,Os===e&&(Ps&n)===n&&(4===Ls||3===Ls&&(62914560&Ps)===Ps&&500>Vi()-Ws?Ec(e,0):Vs|=n),hc(e,t)}function Fc(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(0===(2&(t=e.mode))?t=1:0===(4&t)?t=99===Bi()?1:2:(0===oc&&(oc=Us),0===(t=Bt(62914560&~oc))&&(t=4194304))),n=uc(),null!==(e=fc(e,t))&&(Gt(e,t,n),hc(e,n))}function Vc(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function Bc(e,t,n,r){return new Vc(e,t,n,r)}function Wc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Gc(e,t){var n=e.alternate;return null===n?((n=Bc(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function qc(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Wc(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case S:return Kc(n.children,i,o,t);case M:s=8,i|=16;break;case I:s=8,i|=1;break;case R:return(e=Bc(12,n,t,8|i)).elementType=R,e.type=R,e.lanes=o,e;case O:return(e=Bc(13,n,t,i)).type=O,e.elementType=O,e.lanes=o,e;case N:return(e=Bc(19,n,t,i)).elementType=N,e.lanes=o,e;case U:return Hc(n,i,o,t);case j:return(e=Bc(24,n,t,i)).elementType=j,e.lanes=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case A:s=10;break e;case C:s=9;break e;case k:s=11;break e;case P:s=14;break e;case D:s=16,r=null;break e;case x:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Bc(s,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Kc(e,t,n,r){return(e=Bc(7,e,r,t)).lanes=n,e}function Hc(e,t,n,r){return(e=Bc(23,e,r,t)).elementType=U,e.lanes=n,e}function zc(e,t,n){return(e=Bc(6,e,null,t)).lanes=n,e}function Yc(e,t,n){return(t=Bc(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Qc(e,t,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Wt(0),this.expirationTimes=Wt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Wt(0),this.mutableSourceEagerHydrationData=null}function Xc(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:T,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function Jc(e,t,n,r){var i=t.current,o=uc(),s=lc(i);e:if(n){t:{if(Xe(n=n._reactInternals)!==n||1!==n.tag)throw Error(a(170));var c=n;do{switch(c.tag){case 3:c=c.stateNode.context;break t;case 1:if(pi(c.type)){c=c.stateNode.__reactInternalMemoizedMergedChildContext;break t}}c=c.return}while(null!==c);throw Error(a(171))}if(1===n.tag){var u=n.type;if(pi(u)){n=gi(n,u,c);break e}}n=c}else n=ui;return null===t.context?t.context=n:t.pendingContext=n,(t=so(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),co(i,t),dc(i,s,o),s}function $c(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Zc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function eu(e,t){Zc(e,t),(e=e.alternate)&&Zc(e,t)}function tu(e,t,n){var r=null!=n&&null!=n.hydrationOptions&&n.hydrationOptions.mutableSources||null;if(n=new Qc(e,t,null!=n&&!0===n.hydrate),t=Bc(3,null,null,2===t?7:1===t?3:0),n.current=t,t.stateNode=n,oo(t),e[Jr]=n.current,kr(8===e.nodeType?e.parentNode:e),r)for(e=0;e<r.length;e++){var i=(t=r[e])._getVersion;i=i(t._source),null==n.mutableSourceEagerHydrationData?n.mutableSourceEagerHydrationData=[t,i]:n.mutableSourceEagerHydrationData.push(t,i)}this._internalRoot=n}function nu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function ru(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof i){var s=i;i=function(){var e=$c(a);s.call(e)}}Jc(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new tu(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"===typeof i){var c=i;i=function(){var e=$c(a);c.call(e)}}yc((function(){Jc(t,a,e,i)}))}return $c(a)}function iu(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!nu(t))throw Error(a(200));return Xc(e,t,null,n)}Ks=function(e,t,n){var r=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||di.current)xa=!0;else{if(0===(n&r)){switch(xa=!1,t.tag){case 3:qa(t),Ko();break;case 5:Do(t);break;case 1:pi(t.type)&&yi(t);break;case 4:No(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value;var i=t.type._context;ci(Qi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(n&t.child.childLanes)?Qa(e,t,n):(ci(Lo,1&Lo.current),null!==(t=ns(e,t,n))?t.sibling:null);ci(Lo,1&Lo.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(64&e.flags)){if(r)return ts(e,t,n);t.flags|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),ci(Lo,Lo.current),r)break;return null;case 23:case 24:return t.lanes=0,Fa(e,t,n)}return ns(e,t,n)}xa=0!==(16384&e.flags)}else xa=!1;switch(t.lanes=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=hi(t,li.current),no(t,n),i=ia(null,t,r,e,i,n),t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,pi(r)){var o=!0;yi(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,oo(t);var s=r.getDerivedStateFromProps;"function"===typeof s&&po(t,r,s,e),i.updater=vo,t.stateNode=i,i._reactInternals=t,_o(t,r,e,n),t=Ga(null,t,r,!0,o,n)}else t.tag=0,La(null,t,i,n),t=t.child;return t;case 16:i=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,i=(o=i._init)(i._payload),t.type=i,o=t.tag=function(e){if("function"===typeof e)return Wc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===k)return 11;if(e===P)return 14}return 2}(i),e=Yi(i,e),o){case 0:t=Ba(null,t,i,e,n);break e;case 1:t=Wa(null,t,i,e,n);break e;case 11:t=Ma(null,t,i,e,n);break e;case 14:t=Ua(null,t,i,Yi(i.type,e),r,n);break e}throw Error(a(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,Ba(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 1:return r=t.type,i=t.pendingProps,Wa(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 3:if(qa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,ao(e,t),lo(t,r,null,n),(r=t.memoizedState.element)===i)Ko(),t=ns(e,t,n);else{if((o=(i=t.stateNode).hydrate)&&(jo=Kr(t.stateNode.containerInfo.firstChild),Uo=t,o=Fo=!0),o){if(null!=(e=i.mutableSourceEagerHydrationData))for(i=0;i<e.length;i+=2)(o=e[i])._workInProgressVersionPrimary=e[i+1],Ho.push(o);for(n=Io(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|1024,n=n.sibling}else La(e,t,r,n),Ko();t=t.child}return t;case 5:return Do(t),null===e&&Wo(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,Br(r,i)?s=null:null!==o&&Br(r,o)&&(t.flags|=16),Va(e,t),La(e,t,s,n),t.child;case 6:return null===e&&Wo(t),null;case 13:return Qa(e,t,n);case 4:return No(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=So(t,null,r,n):La(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ma(e,t,r,i=t.elementType===r?i:Yi(r,i),n);case 7:return La(e,t,t.pendingProps,n),t.child;case 8:case 12:return La(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value;var c=t.type._context;if(ci(Qi,c._currentValue),c._currentValue=o,null!==s)if(c=s.value,0===(o=sr(c,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(c,o):1073741823))){if(s.children===i.children&&!di.current){t=ns(e,t,n);break e}}else for(null!==(c=t.child)&&(c.return=t);null!==c;){var u=c.dependencies;if(null!==u){s=c.child;for(var l=u.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&o)){1===c.tag&&((l=so(-1,n&-n)).tag=2,co(c,l)),c.lanes|=n,null!==(l=c.alternate)&&(l.lanes|=n),to(c.return,n),u.lanes|=n;break}l=l.next}}else s=10===c.tag&&c.type===t.type?null:c.child;if(null!==s)s.return=c;else for(s=c;null!==s;){if(s===t){s=null;break}if(null!==(c=s.sibling)){c.return=s.return,s=c;break}s=s.return}c=s}La(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,no(t,n),r=r(i=ro(i,o.unstable_observedBits)),t.flags|=1,La(e,t,r,n),t.child;case 14:return o=Yi(i=t.type,t.pendingProps),Ua(e,t,i,o=Yi(i.type,o),r,n);case 15:return ja(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Yi(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,pi(r)?(e=!0,yi(t)):e=!1,no(t,n),go(t,r,i),_o(t,r,i,n),Ga(null,t,r,!0,e,n);case 19:return ts(e,t,n);case 23:case 24:return Fa(e,t,n)}throw Error(a(156,t.tag))},tu.prototype.render=function(e){Jc(e,this._internalRoot,null,null)},tu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Jc(null,e,null,(function(){t[Jr]=null}))},tt=function(e){13===e.tag&&(dc(e,4,uc()),eu(e,4))},nt=function(e){13===e.tag&&(dc(e,67108864,uc()),eu(e,67108864))},rt=function(e){if(13===e.tag){var t=uc(),n=lc(e);dc(e,n,t),eu(e,n)}},it=function(e,t){return t()},Ae=function(e,t,n){switch(t){case"input":if(ne(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=ni(r);if(!i)throw Error(a(90));J(r),ne(r,i)}}}break;case"textarea":ue(e,n);break;case"select":null!=(t=n.value)&&ae(e,!!n.multiple,t,!1)}},De=gc,xe=function(e,t,n,r,i){var o=ks;ks|=4;try{return Gi(98,e.bind(null,t,n,r,i))}finally{0===(ks=o)&&(qs(),Ki())}},Le=function(){0===(49&ks)&&(function(){if(null!==tc){var e=tc;tc=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,hc(e,Vi())}))}Ki()}(),Pc())},Me=function(e,t){var n=ks;ks|=2;try{return e(t)}finally{0===(ks=n)&&(qs(),Ki())}};var ou={Events:[ei,ti,ni,Ne,Pe,Pc,{current:!1}]},au={findFiberByHostInstance:Zr,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},su={bundleType:au.bundleType,version:au.version,rendererPackageName:au.rendererPackageName,rendererConfig:au.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:E.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ze(e))?null:e.stateNode},findFiberByHostInstance:au.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!cu.isDisabled&&cu.supportsFiber)try{bi=cu.inject(su),Ei=cu}catch(me){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ou,t.createPortal=iu,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return e=null===(e=Ze(t))?null:e.stateNode},t.flushSync=function(e,t){var n=ks;if(0!==(48&n))return e(t);ks|=1;try{if(e)return Gi(99,e.bind(null,t))}finally{ks=n,Ki()}},t.hydrate=function(e,t,n){if(!nu(t))throw Error(a(200));return ru(null,e,t,!0,n)},t.render=function(e,t,n){if(!nu(t))throw Error(a(200));return ru(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!nu(e))throw Error(a(40));return!!e._reactRootContainer&&(yc((function(){ru(null,null,e,!1,(function(){e._reactRootContainer=null,e[Jr]=null}))})),!0)},t.unstable_batchedUpdates=gc,t.unstable_createPortal=function(e,t){return iu(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!nu(n))throw Error(a(200));if(null==e||void 0===e._reactInternals)throw Error(a(38));return ru(e,t,n,!1,r)},t.version="17.0.2"},function(e,t,n){"use strict";e.exports=n(64)},function(e,t,n){"use strict";var r,i,o,a;if("object"===typeof performance&&"function"===typeof performance.now){var s=performance;t.unstable_now=function(){return s.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}if("undefined"===typeof window||"function"!==typeof MessageChannel){var l=null,d=null,f=function e(){if(null!==l)try{var n=t.unstable_now();l(!0,n),l=null}catch(r){throw setTimeout(e,0),r}};r=function(e){null!==l?setTimeout(r,0,e):(l=e,setTimeout(f,0))},i=function(e,t){d=setTimeout(e,t)},o=function(){clearTimeout(d)},t.unstable_shouldYield=function(){return!1},a=t.unstable_forceFrameRate=function(){}}else{var h=window.setTimeout,p=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills")}var m=!1,g=null,y=-1,_=5,b=0;t.unstable_shouldYield=function(){return t.unstable_now()>=b},a=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5};var E=new MessageChannel,w=E.port2;E.port1.onmessage=function(){if(null!==g){var e=t.unstable_now();b=e+_;try{g(!0,e)?w.postMessage(null):(m=!1,g=null)}catch(n){throw w.postMessage(null),n}}else m=!1},r=function(e){g=e,m||(m=!0,w.postMessage(null))},i=function(e,n){y=h((function(){e(t.unstable_now())}),n)},o=function(){p(y),y=-1}}function T(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<R(i,t)))break e;e[r]=t,e[n]=i,n=r}}function S(e){return void 0===(e=e[0])?null:e}function I(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],s=o+1,c=e[s];if(void 0!==a&&0>R(a,n))void 0!==c&&0>R(c,a)?(e[r]=c,e[s]=n,r=s):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==c&&0>R(c,n)))break e;e[r]=c,e[s]=n,r=s}}}return t}return null}function R(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var A=[],C=[],k=1,O=null,N=3,P=!1,D=!1,x=!1;function L(e){for(var t=S(C);null!==t;){if(null===t.callback)I(C);else{if(!(t.startTime<=e))break;I(C),t.sortIndex=t.expirationTime,T(A,t)}t=S(C)}}function M(e){if(x=!1,L(e),!D)if(null!==S(A))D=!0,r(U);else{var t=S(C);null!==t&&i(M,t.startTime-e)}}function U(e,n){D=!1,x&&(x=!1,o()),P=!0;var r=N;try{for(L(n),O=S(A);null!==O&&(!(O.expirationTime>n)||e&&!t.unstable_shouldYield());){var a=O.callback;if("function"===typeof a){O.callback=null,N=O.priorityLevel;var s=a(O.expirationTime<=n);n=t.unstable_now(),"function"===typeof s?O.callback=s:O===S(A)&&I(A),L(n)}else I(A);O=S(A)}if(null!==O)var c=!0;else{var u=S(C);null!==u&&i(M,u.startTime-n),c=!1}return c}finally{O=null,N=r,P=!1}}var j=a;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){D||P||(D=!0,r(U))},t.unstable_getCurrentPriorityLevel=function(){return N},t.unstable_getFirstCallbackNode=function(){return S(A)},t.unstable_next=function(e){switch(N){case 1:case 2:case 3:var t=3;break;default:t=N}var n=N;N=t;try{return e()}finally{N=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=j,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=N;N=e;try{return t()}finally{N=n}},t.unstable_scheduleCallback=function(e,n,a){var s=t.unstable_now();switch("object"===typeof a&&null!==a?a="number"===typeof(a=a.delay)&&0<a?s+a:s:a=s,e){case 1:var c=-1;break;case 2:c=250;break;case 5:c=1073741823;break;case 4:c=1e4;break;default:c=5e3}return e={id:k++,callback:n,priorityLevel:e,startTime:a,expirationTime:c=a+c,sortIndex:-1},a>s?(e.sortIndex=a,T(C,e),null===S(A)&&e===S(C)&&(x?o():x=!0,i(M,a-s))):(e.sortIndex=c,T(A,e),D||P||(D=!0,r(U))),e},t.unstable_wrapCallback=function(e){var t=N;return function(){var n=N;N=t;try{return e.apply(this,arguments)}finally{N=n}}}},function(e,t,n){"use strict";var r="function"===typeof Symbol&&Symbol.for,i=r?Symbol.for("react.element"):60103,o=r?Symbol.for("react.portal"):60106,a=r?Symbol.for("react.fragment"):60107,s=r?Symbol.for("react.strict_mode"):60108,c=r?Symbol.for("react.profiler"):60114,u=r?Symbol.for("react.provider"):60109,l=r?Symbol.for("react.context"):60110,d=r?Symbol.for("react.async_mode"):60111,f=r?Symbol.for("react.concurrent_mode"):60111,h=r?Symbol.for("react.forward_ref"):60112,p=r?Symbol.for("react.suspense"):60113,v=r?Symbol.for("react.suspense_list"):60120,m=r?Symbol.for("react.memo"):60115,g=r?Symbol.for("react.lazy"):60116,y=r?Symbol.for("react.block"):60121,_=r?Symbol.for("react.fundamental"):60117,b=r?Symbol.for("react.responder"):60118,E=r?Symbol.for("react.scope"):60119;function w(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case d:case f:case a:case c:case s:case p:return e;default:switch(e=e&&e.$$typeof){case l:case h:case g:case m:case u:return e;default:return t}}case o:return t}}}function T(e){return w(e)===f}t.AsyncMode=d,t.ConcurrentMode=f,t.ContextConsumer=l,t.ContextProvider=u,t.Element=i,t.ForwardRef=h,t.Fragment=a,t.Lazy=g,t.Memo=m,t.Portal=o,t.Profiler=c,t.StrictMode=s,t.Suspense=p,t.isAsyncMode=function(e){return T(e)||w(e)===d},t.isConcurrentMode=T,t.isContextConsumer=function(e){return w(e)===l},t.isContextProvider=function(e){return w(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return w(e)===h},t.isFragment=function(e){return w(e)===a},t.isLazy=function(e){return w(e)===g},t.isMemo=function(e){return w(e)===m},t.isPortal=function(e){return w(e)===o},t.isProfiler=function(e){return w(e)===c},t.isStrictMode=function(e){return w(e)===s},t.isSuspense=function(e){return w(e)===p},t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===f||e===c||e===s||e===p||e===v||"object"===typeof e&&null!==e&&(e.$$typeof===g||e.$$typeof===m||e.$$typeof===u||e.$$typeof===l||e.$$typeof===h||e.$$typeof===_||e.$$typeof===b||e.$$typeof===E||e.$$typeof===y)},t.typeOf=w},,function(e,t,n){"use strict";var r=n(68);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},function(e,t,n){"use strict";n(43);var r=n(2),i=60103;if(t.Fragment=60107,"function"===typeof Symbol&&Symbol.for){var o=Symbol.for;i=o("react.element"),t.Fragment=o("react.fragment")}var a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s=Object.prototype.hasOwnProperty,c={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,o={},u=null,l=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(l=t.ref),t)s.call(t,r)&&!c.hasOwnProperty(r)&&(o[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===o[r]&&(o[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:l,props:o,_owner:a.current}}t.jsx=u,t.jsxs=u},function(e,t,n){"use strict";(function(e){var t=n(5);(function(){var n,r="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){e!=Array.prototype&&e!=Object.prototype&&(e[t]=n.value)};var i=function(t){t=["object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof e&&e,t];for(var n=0;n<t.length;++n){var r=t[n];if(r&&r.Math==Math)return r}return globalThis}(this);function o(e){var t=0;return function(){return t<e.length?{done:!1,value:e[t++]}:{done:!0}}}function a(e){var t="undefined"!=typeof Symbol&&Symbol.iterator&&e[Symbol.iterator];return t?t.call(e):{next:o(e)}}!function(e,t){if(t){var n=i;e=e.split(".");for(var o=0;o<e.length-1;o++){var a=e[o];a in n||(n[a]={}),n=n[a]}(t=t(o=n[e=e[e.length-1]]))!=o&&null!=t&&r(n,e,{configurable:!0,writable:!0,value:t})}}("Promise",(function(e){function t(e){this.b=0,this.c=void 0,this.a=[];var t=this.f();try{e(t.resolve,t.reject)}catch(n){t.reject(n)}}function n(){this.a=null}function r(e){return e instanceof t?e:new t((function(t){t(e)}))}if(e)return e;n.prototype.b=function(e){if(null==this.a){this.a=[];var t=this;this.c((function(){t.g()}))}this.a.push(e)};var o=i.setTimeout;n.prototype.c=function(e){o(e,0)},n.prototype.g=function(){for(;this.a&&this.a.length;){var e=this.a;this.a=[];for(var t=0;t<e.length;++t){var n=e[t];e[t]=null;try{n()}catch(r){this.f(r)}}}this.a=null},n.prototype.f=function(e){this.c((function(){throw e}))},t.prototype.f=function(){function e(e){return function(r){n||(n=!0,e.call(t,r))}}var t=this,n=!1;return{resolve:e(this.m),reject:e(this.g)}},t.prototype.m=function(e){if(e===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(e instanceof t)this.s(e);else{e:switch(typeof e){case"object":var n=null!=e;break e;case"function":n=!0;break e;default:n=!1}n?this.v(e):this.h(e)}},t.prototype.v=function(e){var t=void 0;try{t=e.then}catch(n){return void this.g(n)}"function"==typeof t?this.u(t,e):this.h(e)},t.prototype.g=function(e){this.i(2,e)},t.prototype.h=function(e){this.i(1,e)},t.prototype.i=function(e,t){if(0!=this.b)throw Error("Cannot settle("+e+", "+t+"): Promise already settled in state"+this.b);this.b=e,this.c=t,this.l()},t.prototype.l=function(){if(null!=this.a){for(var e=0;e<this.a.length;++e)s.b(this.a[e]);this.a=null}};var s=new n;return t.prototype.s=function(e){var t=this.f();e.Qa(t.resolve,t.reject)},t.prototype.u=function(e,t){var n=this.f();try{e.call(t,n.resolve,n.reject)}catch(r){n.reject(r)}},t.prototype.then=function(e,n){function r(e,t){return"function"==typeof e?function(t){try{i(e(t))}catch(n){o(n)}}:t}var i,o,a=new t((function(e,t){i=e,o=t}));return this.Qa(r(e,i),r(n,o)),a},t.prototype.catch=function(e){return this.then(void 0,e)},t.prototype.Qa=function(e,t){function n(){switch(r.b){case 1:e(r.c);break;case 2:t(r.c);break;default:throw Error("Unexpected state: "+r.b)}}var r=this;null==this.a?s.b(n):this.a.push(n)},t.resolve=r,t.reject=function(e){return new t((function(t,n){n(e)}))},t.race=function(e){return new t((function(t,n){for(var i=a(e),o=i.next();!o.done;o=i.next())r(o.value).Qa(t,n)}))},t.all=function(e){var n=a(e),i=n.next();return i.done?r([]):new t((function(e,t){function o(t){return function(n){a[t]=n,0==--s&&e(a)}}var a=[],s=0;do{a.push(void 0),s++,r(i.value).Qa(o(a.length-1),t),i=n.next()}while(!i.done)}))},t}));var s=s||{},c=this||self,u=/^[\w+/_-]+[=]{0,2}$/,l=null;function d(e){return(e=e.querySelector&&e.querySelector("script[nonce]"))&&(e=e.nonce||e.getAttribute("nonce"))&&u.test(e)?e:""}function f(){}function h(e){var t=typeof e;return"object"!=t?t:e?Array.isArray(e)?"array":t:"null"}function p(e){var t=h(e);return"array"==t||"object"==t&&"number"==typeof e.length}function v(e){return"function"==h(e)}function m(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function g(e){return Object.prototype.hasOwnProperty.call(e,y)&&e[y]||(e[y]=++_)}var y="closure_uid_"+(1e9*Math.random()>>>0),_=0;function b(e,t,n){return e.call.apply(e.bind,arguments)}function E(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function w(e,t,n){return(w=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?b:E).apply(null,arguments)}function T(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}var S=Date.now;function I(e,t){function n(){}n.prototype=t.prototype,e.ab=t.prototype,e.prototype=new n,e.prototype.constructor=e}function R(e){return e}function A(e,t,n){this.code=O+e,this.message=t||N[e]||"",this.a=n||null}function C(e){var t=e&&e.code;return t?new A(t.substring(O.length),e.message,e.serverResponse):null}I(A,Error),A.prototype.w=function(){var e={code:this.code,message:this.message};return this.a&&(e.serverResponse=this.a),e},A.prototype.toJSON=function(){return this.w()};var k,O="auth/",N={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},P={ld:{Ta:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ta:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://securetoken.googleapis.com/v1/token",Wa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ta:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Za:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ta:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Za:"https://test-securetoken.sandbox.googleapis.com/v1/token",Wa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function D(e){for(var t in P)if(P[t].id===e)return{firebaseEndpoint:(e=P[t]).Ta,secureTokenEndpoint:e.Za,identityPlatformEndpoint:e.Wa};return null}function x(e){if(!e)return!1;try{return!!e.$goog_Thenable}catch(t){return!1}}function L(e){if(Error.captureStackTrace)Error.captureStackTrace(this,L);else{var t=Error().stack;t&&(this.stack=t)}e&&(this.message=String(e))}function M(e,t){for(var n="",r=(e=e.split("%s")).length-1,i=0;i<r;i++)n+=e[i]+(i<t.length?t[i]:"%s");L.call(this,n+e[r])}function U(e,t){throw new M("Failure"+(e?": "+e:""),Array.prototype.slice.call(arguments,1))}function j(e,t){this.c=e,this.f=t,this.b=0,this.a=null}function F(e,t){e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}function V(){this.b=this.a=null}k=D("__EID__")?"__EID__":void 0,I(L,Error),L.prototype.name="CustomError",I(M,L),M.prototype.name="AssertionError",j.prototype.get=function(){if(0<this.b){this.b--;var e=this.a;this.a=e.next,e.next=null}else e=this.c();return e};var B=new j((function(){return new G}),(function(e){e.reset()}));function W(){var e=bt,t=null;return e.a&&(t=e.a,e.a=e.a.next,e.a||(e.b=null),t.next=null),t}function G(){this.next=this.b=this.a=null}V.prototype.add=function(e,t){var n=B.get();n.set(e,t),this.b?this.b.next=n:this.a=n,this.b=n},G.prototype.set=function(e,t){this.a=e,this.b=t,this.next=null},G.prototype.reset=function(){this.next=this.b=this.a=null};var q=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"===typeof e)return"string"!==typeof t||1!=t.length?-1:e.indexOf(t,0);for(var n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return-1},K=Array.prototype.forEach?function(e,t,n){Array.prototype.forEach.call(e,t,n)}:function(e,t,n){for(var r=e.length,i="string"===typeof e?e.split(""):e,o=0;o<r;o++)o in i&&t.call(n,i[o],o,e)};var H=Array.prototype.filter?function(e,t){return Array.prototype.filter.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=[],i=0,o="string"===typeof e?e.split(""):e,a=0;a<n;a++)if(a in o){var s=o[a];t.call(void 0,s,a,e)&&(r[i++]=s)}return r},z=Array.prototype.map?function(e,t){return Array.prototype.map.call(e,t,void 0)}:function(e,t){for(var n=e.length,r=Array(n),i="string"===typeof e?e.split(""):e,o=0;o<n;o++)o in i&&(r[o]=t.call(void 0,i[o],o,e));return r},Y=Array.prototype.some?function(e,t){return Array.prototype.some.call(e,t,void 0)}:function(e,t){for(var n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e))return!0;return!1};function Q(e,t){return 0<=q(e,t)}function X(e,t){var n;return(n=0<=(t=q(e,t)))&&Array.prototype.splice.call(e,t,1),n}function J(e,t){!function(e,t){for(var n="string"===typeof e?e.split(""):e,r=e.length-1;0<=r;--r)r in n&&t.call(void 0,n[r],r,e)}(e,(function(n,r){t.call(void 0,n,r,e)&&1==Array.prototype.splice.call(e,r,1).length&&0}))}function $(e){return Array.prototype.concat.apply([],arguments)}function Z(e){var t=e.length;if(0<t){for(var n=Array(t),r=0;r<t;r++)n[r]=e[r];return n}return[]}var ee,te=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]},ne=/&/g,re=/</g,ie=/>/g,oe=/"/g,ae=/'/g,se=/\x00/g,ce=/[\x00&<>"']/;function ue(e,t){return-1!=e.indexOf(t)}function le(e,t){return e<t?-1:e>t?1:0}e:{var de=c.navigator;if(de){var fe=de.userAgent;if(fe){ee=fe;break e}}ee=""}function he(e){return ue(ee,e)}function pe(e,t){for(var n in e)t.call(void 0,e[n],n,e)}function ve(e){for(var t in e)return!1;return!0}function me(e){var t,n={};for(t in e)n[t]=e[t];return n}var ge="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ye(e,t){for(var n,r,i=1;i<arguments.length;i++){for(n in r=arguments[i])e[n]=r[n];for(var o=0;o<ge.length;o++)n=ge[o],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function _e(e,t){e:{try{var n=e&&e.ownerDocument,r=n&&(n.defaultView||n.parentWindow);if((r=r||c).Element&&r.Location){var i=r;break e}}catch(a){}i=null}if(i&&"undefined"!=typeof i[t]&&(!e||!(e instanceof i[t])&&(e instanceof i.Location||e instanceof i.Element))){if(m(e))try{var o=e.constructor.displayName||e.constructor.name||Object.prototype.toString.call(e)}catch(a){o="<object could not be stringified>"}else o=void 0===e?"undefined":null===e?"null":typeof e;U("Argument is not a %s (or a non-Element, non-Location mock); got: %s",t,o)}}function be(e,t){this.a=e===Se&&t||"",this.b=Te}function Ee(e){return e instanceof be&&e.constructor===be&&e.b===Te?e.a:(U("expected object of type Const, got '"+e+"'"),"type_error:Const")}be.prototype.sa=!0,be.prototype.ra=function(){return this.a},be.prototype.toString=function(){return"Const{"+this.a+"}"};var we,Te={},Se={};function Ie(){if(void 0===we){var e=null,t=c.trustedTypes;if(t&&t.createPolicy){try{e=t.createPolicy("goog#html",{createHTML:R,createScript:R,createScriptURL:R})}catch(n){c.console&&c.console.error(n.message)}we=e}else we=e}return we}function Re(e,t){this.a=t===Ne?e:""}function Ae(e){return e instanceof Re&&e.constructor===Re?e.a:(U("expected object of type TrustedResourceUrl, got '"+e+"' of type "+h(e)),"type_error:TrustedResourceUrl")}function Ce(e,t){var n=Ee(e);if(!Oe.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return function(e){var t=Ie();return new Re(e=t?t.createScriptURL(e):e,Ne)}(e=n.replace(ke,(function(e,r){if(!Object.prototype.hasOwnProperty.call(t,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(t));return(e=t[r])instanceof be?Ee(e):encodeURIComponent(String(e))})))}Re.prototype.sa=!0,Re.prototype.ra=function(){return this.a.toString()},Re.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var ke=/%{(\w+)}/g,Oe=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ne={};function Pe(e,t){this.a=t===Fe?e:""}function De(e){return e instanceof Pe&&e.constructor===Pe?e.a:(U("expected object of type SafeUrl, got '"+e+"' of type "+h(e)),"type_error:SafeUrl")}Pe.prototype.sa=!0,Pe.prototype.ra=function(){return this.a.toString()},Pe.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var xe=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,Le=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Me=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Ue(e){if(e instanceof Pe)return e;if(e="object"==typeof e&&e.sa?e.ra():String(e),Me.test(e))e=new Pe(e,Fe);else{var t=(e=(e=String(e)).replace(/(%0A|%0D)/g,"")).match(Le);e=t&&xe.test(t[1])?new Pe(e,Fe):null}return e}function je(e){return e instanceof Pe?e:(e="object"==typeof e&&e.sa?e.ra():String(e),Me.test(e)||(e="about:invalid#zClosurez"),new Pe(e,Fe))}var Fe={},Ve=new Pe("about:invalid#zClosurez",Fe);function Be(e,t,n){this.a=n===We?e:""}Be.prototype.sa=!0,Be.prototype.ra=function(){return this.a.toString()},Be.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var We={};function Ge(e,t,n,r){return e=e instanceof Pe?e:je(e),t=t||c,n=n instanceof be?Ee(n):n||"",t.open(De(e),n,r,void 0)}function qe(e,t){for(var n=e.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function Ke(e){return ce.test(e)&&(-1!=e.indexOf("&")&&(e=e.replace(ne,"&amp;")),-1!=e.indexOf("<")&&(e=e.replace(re,"&lt;")),-1!=e.indexOf(">")&&(e=e.replace(ie,"&gt;")),-1!=e.indexOf('"')&&(e=e.replace(oe,"&quot;")),-1!=e.indexOf("'")&&(e=e.replace(ae,"&#39;")),-1!=e.indexOf("\0")&&(e=e.replace(se,"&#0;"))),e}function He(e){return He[" "](e),e}He[" "]=f;var ze,Ye=he("Opera"),Qe=he("Trident")||he("MSIE"),Xe=he("Edge"),Je=Xe||Qe,$e=he("Gecko")&&!(ue(ee.toLowerCase(),"webkit")&&!he("Edge"))&&!(he("Trident")||he("MSIE"))&&!he("Edge"),Ze=ue(ee.toLowerCase(),"webkit")&&!he("Edge");function et(){var e=c.document;return e?e.documentMode:void 0}e:{var tt="",nt=function(){var e=ee;return $e?/rv:([^\);]+)(\)|;)/.exec(e):Xe?/Edge\/([\d\.]+)/.exec(e):Qe?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(e):Ze?/WebKit\/(\S+)/.exec(e):Ye?/(?:Version)[ \/]?(\S+)/.exec(e):void 0}();if(nt&&(tt=nt?nt[1]:""),Qe){var rt=et();if(null!=rt&&rt>parseFloat(tt)){ze=String(rt);break e}}ze=tt}var it,ot={};function at(e){return function(e,t){var n=ot;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(){for(var t=0,n=te(String(ze)).split("."),r=te(String(e)).split("."),i=Math.max(n.length,r.length),o=0;0==t&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;t=le(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||le(0==a[2].length,0==s[2].length)||le(a[2],s[2]),a=a[3],s=s[3]}while(0==t)}return 0<=t}))}if(c.document&&Qe){var st=et();it=st||(parseInt(ze,10)||void 0)}else it=void 0;var ct=it;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch(fa){}var ut=!Qe||9<=Number(ct);function lt(e){var t=document;return"string"===typeof e?t.getElementById(e):e}function dt(e,t){pe(t,(function(t,n){t&&"object"==typeof t&&t.sa&&(t=t.ra()),"style"==n?e.style.cssText=t:"class"==n?e.className=t:"for"==n?e.htmlFor=t:pt.hasOwnProperty(n)?e.setAttribute(pt[n],t):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?e.setAttribute(n,t):e[n]=t}))}var ft,ht,pt={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function vt(e,t,n){function r(n){n&&t.appendChild("string"===typeof n?e.createTextNode(n):n)}for(var i=2;i<n.length;i++){var o=n[i];if(!p(o)||m(o)&&0<o.nodeType)r(o);else{e:{if(o&&"number"==typeof o.length){if(m(o)){var a="function"==typeof o.item||"string"==typeof o.item;break e}if(v(o)){a="function"==typeof o.item;break e}}a=!1}K(a?Z(o):o,r)}}}function mt(e,t){return t=String(t),"application/xhtml+xml"===e.contentType&&(t=t.toLowerCase()),e.createElement(t)}function gt(e){c.setTimeout((function(){throw e}),0)}function yt(e,t){ht||function(){if(c.Promise&&c.Promise.resolve){var e=c.Promise.resolve(void 0);ht=function(){e.then(Et)}}else ht=function(){var e=Et;!v(c.setImmediate)||c.Window&&c.Window.prototype&&!he("Edge")&&c.Window.prototype.setImmediate==c.setImmediate?(ft||(ft=function(){var e=c.MessageChannel;if("undefined"===typeof e&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!he("Presto")&&(e=function(){var e=mt(document,"IFRAME");e.style.display="none",document.documentElement.appendChild(e);var t=e.contentWindow;(e=t.document).open(),e.close();var n="callImmediate"+Math.random(),r="file:"==t.location.protocol?"*":t.location.protocol+"//"+t.location.host;e=w((function(e){"*"!=r&&e.origin!=r||e.data!=n||this.port1.onmessage()}),this),t.addEventListener("message",e,!1),this.port1={},this.port2={postMessage:function(){t.postMessage(n,r)}}}),"undefined"!==typeof e&&!he("Trident")&&!he("MSIE")){var t=new e,n={},r=n;return t.port1.onmessage=function(){if(void 0!==n.next){var e=(n=n.next).Gb;n.Gb=null,e()}},function(e){r.next={Gb:e},r=r.next,t.port2.postMessage(0)}}return function(e){c.setTimeout(e,0)}}()),ft(e)):c.setImmediate(e)}}(),_t||(ht(),_t=!0),bt.add(e,t)}var _t=!1,bt=new V;function Et(){for(var e;e=W();){try{e.a.call(e.b)}catch(t){gt(t)}F(B,e)}_t=!1}function wt(e,t){if(this.a=Tt,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,e!=f)try{var n=this;e.call(t,(function(e){Mt(n,St,e)}),(function(e){if(!(e instanceof Gt))try{if(e instanceof Error)throw e;throw Error("Promise rejected.")}catch(t){}Mt(n,It,e)}))}catch(r){Mt(this,It,r)}}var Tt=0,St=2,It=3;function Rt(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}Rt.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var At=new j((function(){return new Rt}),(function(e){e.reset()}));function Ct(e,t,n){var r=At.get();return r.g=e,r.b=t,r.f=n,r}function kt(e){if(e instanceof wt)return e;var t=new wt(f);return Mt(t,St,e),t}function Ot(e){return new wt((function(t,n){n(e)}))}function Nt(e,t,n){Ut(e,t,n,null)||yt(T(t,e))}function Pt(e){return new wt((function(t){var n=e.length,r=[];if(n)for(var i=function(e,i,o){n--,r[e]=i?{Pb:!0,value:o}:{Pb:!1,reason:o},0==n&&t(r)},o=0;o<e.length;o++)Nt(e[o],T(i,o,!0),T(i,o,!1));else t(r)}))}function Dt(e,t){if(e.a==Tt)if(e.c){var n=e.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==e&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Tt&&1==r?Dt(n,t):(o?((r=o).next==n.f&&(n.f=r),r.next=r.next.next):Ft(n),Vt(n,i,It,t)))}e.c=null}else Mt(e,It,t)}function xt(e,t){e.b||e.a!=St&&e.a!=It||jt(e),e.f?e.f.next=t:e.b=t,e.f=t}function Lt(e,t,n,r){var i=Ct(null,null,null);return i.a=new wt((function(e,o){i.g=t?function(n){try{var i=t.call(r,n);e(i)}catch(a){o(a)}}:e,i.b=n?function(t){try{var i=n.call(r,t);void 0===i&&t instanceof Gt?o(t):e(i)}catch(a){o(a)}}:o})),i.a.c=e,xt(e,i),i.a}function Mt(e,t,n){e.a==Tt&&(e===n&&(t=It,n=new TypeError("Promise cannot resolve to itself")),e.a=1,Ut(n,e.$c,e.ad,e)||(e.i=n,e.a=t,e.c=null,jt(e),t!=It||n instanceof Gt||function(e,t){e.g=!0,yt((function(){e.g&&Wt.call(null,t)}))}(e,n)))}function Ut(e,t,n,r){if(e instanceof wt)return xt(e,Ct(t||f,n||null,r)),!0;if(x(e))return e.then(t,n,r),!0;if(m(e))try{var i=e.then;if(v(i))return function(e,t,n,r,i){function o(e){s||(s=!0,r.call(i,e))}function a(e){s||(s=!0,n.call(i,e))}var s=!1;try{t.call(e,a,o)}catch(c){o(c)}}(e,i,t,n,r),!0}catch(o){return n.call(r,o),!0}return!1}function jt(e){e.h||(e.h=!0,yt(e.gc,e))}function Ft(e){var t=null;return e.b&&(t=e.b,e.b=t.next,t.next=null),e.b||(e.f=null),t}function Vt(e,t,n,r){if(n==It&&t.b&&!t.c)for(;e&&e.g;e=e.c)e.g=!1;if(t.a)t.a.c=null,Bt(t,n,r);else try{t.c?t.g.call(t.f):Bt(t,n,r)}catch(i){Wt.call(null,i)}F(At,t)}function Bt(e,t,n){t==St?e.g.call(e.f,n):e.b&&e.b.call(e.f,n)}wt.prototype.then=function(e,t,n){return Lt(this,v(e)?e:null,v(t)?t:null,n)},wt.prototype.$goog_Thenable=!0,(n=wt.prototype).oa=function(e,t){return(e=Ct(e,e,t)).c=!0,xt(this,e),this},n.o=function(e,t){return Lt(this,null,e,t)},n.cancel=function(e){if(this.a==Tt){var t=new Gt(e);yt((function(){Dt(this,t)}),this)}},n.$c=function(e){this.a=Tt,Mt(this,St,e)},n.ad=function(e){this.a=Tt,Mt(this,It,e)},n.gc=function(){for(var e;e=Ft(this);)Vt(this,e,this.a,this.i);this.h=!1};var Wt=gt;function Gt(e){L.call(this,e)}function qt(){0!=Kt&&(Ht[g(this)]=this),this.xa=this.xa,this.pa=this.pa}I(Gt,L),Gt.prototype.name="cancel";var Kt=0,Ht={};function zt(e){if(!e.xa&&(e.xa=!0,e.Da(),0!=Kt)){var t=g(e);if(0!=Kt&&e.pa&&0<e.pa.length)throw Error(e+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Ht[t]}}qt.prototype.xa=!1,qt.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var Yt=Object.freeze||function(e){return e},Qt=!Qe||9<=Number(ct),Xt=Qe&&!at("9"),Jt=function(){if(!c.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{c.addEventListener("test",f,t),c.removeEventListener("test",f,t)}catch(n){}return e}();function $t(e,t){this.type=e,this.b=this.target=t,this.defaultPrevented=!1}function Zt(e,t){if($t.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=t,t=e.relatedTarget){if($e){e:{try{He(t.nodeName);var i=!0;break e}catch(o){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:en[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}$t.prototype.preventDefault=function(){this.defaultPrevented=!0},I(Zt,$t);var en=Yt({2:"touch",3:"pen",4:"mouse"});Zt.prototype.preventDefault=function(){Zt.ab.preventDefault.call(this);var e=this.a;if(e.preventDefault)e.preventDefault();else if(e.returnValue=!1,Xt)try{(e.ctrlKey||112<=e.keyCode&&123>=e.keyCode)&&(e.keyCode=-1)}catch(t){}},Zt.prototype.g=function(){return this.a};var tn="closure_listenable_"+(1e6*Math.random()|0),nn=0;function rn(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.Va=i,this.key=++nn,this.va=this.Pa=!1}function on(e){e.va=!0,e.listener=null,e.proxy=null,e.src=null,e.Va=null}function an(e){this.src=e,this.a={},this.b=0}function sn(e,t){var n=t.type;n in e.a&&X(e.a[n],t)&&(on(t),0==e.a[n].length&&(delete e.a[n],e.b--))}function cn(e,t,n,r){for(var i=0;i<e.length;++i){var o=e[i];if(!o.va&&o.listener==t&&o.capture==!!n&&o.Va==r)return i}return-1}an.prototype.add=function(e,t,n,r,i){var o=e.toString();(e=this.a[o])||(e=this.a[o]=[],this.b++);var a=cn(e,t,r,i);return-1<a?(t=e[a],n||(t.Pa=!1)):((t=new rn(t,this.src,o,!!r,i)).Pa=n,e.push(t)),t};var un="closure_lm_"+(1e6*Math.random()|0),ln={};function dn(e,t,n,r,i){if(r&&r.once)hn(e,t,n,r,i);else if(Array.isArray(t))for(var o=0;o<t.length;o++)dn(e,t[o],n,r,i);else n=wn(n),e&&e[tn]?Sn(e,t,n,m(r)?!!r.capture:!!r,i):fn(e,t,n,!1,r,i)}function fn(e,t,n,r,i,o){if(!t)throw Error("Invalid event type");var a=m(i)?!!i.capture:!!i,s=bn(e);if(s||(e[un]=s=new an(e)),!(n=s.add(t,n,r,a,o)).proxy){if(r=function(){var e=_n,t=Qt?function(n){return e.call(t.src,t.listener,n)}:function(n){if(!(n=e.call(t.src,t.listener,n)))return n};return t}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)Jt||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(mn(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}0}}function hn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)hn(e,t[o],n,r,i);else n=wn(n),e&&e[tn]?In(e,t,n,m(r)?!!r.capture:!!r,i):fn(e,t,n,!0,r,i)}function pn(e,t,n,r,i){if(Array.isArray(t))for(var o=0;o<t.length;o++)pn(e,t[o],n,r,i);else r=m(r)?!!r.capture:!!r,n=wn(n),e&&e[tn]?(e=e.v,(t=String(t).toString())in e.a&&(-1<(n=cn(o=e.a[t],n,r,i))&&(on(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete e.a[t],e.b--)))):e&&(e=bn(e))&&(t=e.a[t.toString()],e=-1,t&&(e=cn(t,n,r,i)),(n=-1<e?t[e]:null)&&vn(n))}function vn(e){if("number"!==typeof e&&e&&!e.va){var t=e.src;if(t&&t[tn])sn(t.v,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(mn(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=bn(t))?(sn(n,e),0==n.b&&(n.src=null,t[un]=null)):on(e)}}}function mn(e){return e in ln?ln[e]:ln[e]="on"+e}function gn(e,t,n,r){var i=!0;if((e=bn(e))&&(t=e.a[t.toString()]))for(t=t.concat(),e=0;e<t.length;e++){var o=t[e];o&&o.capture==n&&!o.va&&(o=yn(o,r),i=i&&!1!==o)}return i}function yn(e,t){var n=e.listener,r=e.Va||e.src;return e.Pa&&vn(e),n.call(r,t)}function _n(e,t){if(e.va)return!0;if(!Qt){if(!t)e:{t=["window","event"];for(var n=c,r=0;r<t.length;r++)if(null==(n=n[t[r]])){t=null;break e}t=n}if(t=new Zt(r=t,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){e:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break e}catch(a){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=t.b;i;i=i.parentNode)r.push(i);for(e=e.type,i=r.length-1;0<=i;i--){t.b=r[i];var o=gn(r[i],e,!0,t);n=n&&o}for(i=0;i<r.length;i++)t.b=r[i],o=gn(r[i],e,!1,t),n=n&&o}return n}return yn(e,new Zt(t,this))}function bn(e){return(e=e[un])instanceof an?e:null}var En="__closure_events_fn_"+(1e9*Math.random()>>>0);function wn(e){return v(e)?e:(e[En]||(e[En]=function(t){return e.handleEvent(t)}),e[En])}function Tn(){qt.call(this),this.v=new an(this),this.ac=this,this.gb=null}function Sn(e,t,n,r,i){e.v.add(String(t),n,!1,r,i)}function In(e,t,n,r,i){e.v.add(String(t),n,!0,r,i)}function Rn(e,t,n,r){if(!(t=e.v.a[String(t)]))return!0;t=t.concat();for(var i=!0,o=0;o<t.length;++o){var a=t[o];if(a&&!a.va&&a.capture==n){var s=a.listener,c=a.Va||a.src;a.Pa&&sn(e.v,a),i=!1!==s.call(c,r)&&i}}return i&&!r.defaultPrevented}function An(e,t,n){if(v(e))n&&(e=w(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=w(e.handleEvent,e)}return 2147483647<Number(t)?-1:c.setTimeout(e,t||0)}function Cn(e){var t=null;return new wt((function(n,r){-1==(t=An((function(){n(void 0)}),e))&&r(Error("Failed to schedule timer."))})).o((function(e){throw c.clearTimeout(t),e}))}function kn(e){if(e.W&&"function"==typeof e.W)return e.W();if("string"===typeof e)return e.split("");if(p(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}function On(e){if(e.Y&&"function"==typeof e.Y)return e.Y();if(!e.W||"function"!=typeof e.W){if(p(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(var r in t=[],n=0,e)t[n++]=r;return t}}function Nn(e,t){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(e)if(e instanceof Nn)for(n=e.Y(),r=0;r<n.length;r++)this.set(n[r],e.get(n[r]));else for(r in e)this.set(r,e[r])}function Pn(e){if(e.c!=e.a.length){for(var t=0,n=0;t<e.a.length;){var r=e.a[t];Dn(e.b,r)&&(e.a[n++]=r),t++}e.a.length=n}if(e.c!=e.a.length){var i={};for(n=t=0;t<e.a.length;)Dn(i,r=e.a[t])||(e.a[n++]=r,i[r]=1),t++;e.a.length=n}}function Dn(e,t){return Object.prototype.hasOwnProperty.call(e,t)}I(Tn,qt),Tn.prototype[tn]=!0,Tn.prototype.addEventListener=function(e,t,n,r){dn(this,e,t,n,r)},Tn.prototype.removeEventListener=function(e,t,n,r){pn(this,e,t,n,r)},Tn.prototype.dispatchEvent=function(e){var t,n=this.gb;if(n)for(t=[];n;n=n.gb)t.push(n);n=this.ac;var r=e.type||e;if("string"===typeof e)e=new $t(e,n);else if(e instanceof $t)e.target=e.target||n;else{var i=e;ye(e=new $t(r,n),i)}if(i=!0,t)for(var o=t.length-1;0<=o;o--){var a=e.b=t[o];i=Rn(a,r,!0,e)&&i}if(i=Rn(a=e.b=n,r,!0,e)&&i,i=Rn(a,r,!1,e)&&i,t)for(o=0;o<t.length;o++)i=Rn(a=e.b=t[o],r,!1,e)&&i;return i},Tn.prototype.Da=function(){if(Tn.ab.Da.call(this),this.v){var e,t=this.v;for(e in t.a){for(var n=t.a[e],r=0;r<n.length;r++)on(n[r]);delete t.a[e],t.b--}}this.gb=null},(n=Nn.prototype).W=function(){Pn(this);for(var e=[],t=0;t<this.a.length;t++)e.push(this.b[this.a[t]]);return e},n.Y=function(){return Pn(this),this.a.concat()},n.clear=function(){this.b={},this.c=this.a.length=0},n.get=function(e,t){return Dn(this.b,e)?this.b[e]:t},n.set=function(e,t){Dn(this.b,e)||(this.c++,this.a.push(e)),this.b[e]=t},n.forEach=function(e,t){for(var n=this.Y(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);e.call(t,o,i,this)}};var xn=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Ln(e,t){var n;this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1,e instanceof Ln?(this.i=void 0!==t?t:e.i,Mn(this,e.c),this.l=e.l,this.a=e.a,Un(this,e.g),this.f=e.f,jn(this,rr(e.b)),this.h=e.h):e&&(n=String(e).match(xn))?(this.i=!!t,Mn(this,n[1]||"",!0),this.l=Gn(n[2]||""),this.a=Gn(n[3]||"",!0),Un(this,n[4]),this.f=Gn(n[5]||"",!0),jn(this,n[6]||"",!0),this.h=Gn(n[7]||"")):(this.i=!!t,this.b=new Jn(null,this.i))}function Mn(e,t,n){e.c=n?Gn(t,!0):t,e.c&&(e.c=e.c.replace(/:$/,""))}function Un(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.g=t}else e.g=null}function jn(e,t,n){t instanceof Jn?(e.b=t,function(e,t){t&&!e.f&&($n(e),e.c=null,e.a.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(er(this,t),nr(this,n,e))}),e)),e.f=t}(e.b,e.i)):(n||(t=qn(t,Qn)),e.b=new Jn(t,e.i))}function Fn(e,t,n){e.b.set(t,n)}function Vn(e,t){return e.b.get(t)}function Bn(e){return e instanceof Ln?new Ln(e):new Ln(e,void 0)}function Wn(e,t,n,r){var i=new Ln(null,void 0);return e&&Mn(i,e),t&&(i.a=t),n&&Un(i,n),r&&(i.f=r),i}function Gn(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function qn(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,Kn),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function Kn(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Ln.prototype.toString=function(){var e=[],t=this.c;t&&e.push(qn(t,Hn,!0),":");var n=this.a;return(n||"file"==t)&&(e.push("//"),(t=this.l)&&e.push(qn(t,Hn,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.g)&&e.push(":",String(n))),(n=this.f)&&(this.a&&"/"!=n.charAt(0)&&e.push("/"),e.push(qn(n,"/"==n.charAt(0)?Yn:zn,!0))),(n=this.b.toString())&&e.push("?",n),(n=this.h)&&e.push("#",qn(n,Xn)),e.join("")},Ln.prototype.resolve=function(e){var t=new Ln(this),n=!!e.c;n?Mn(t,e.c):n=!!e.l,n?t.l=e.l:n=!!e.a,n?t.a=e.a:n=null!=e.g;var r=e.f;if(n)Un(t,e.g);else if(n=!!e.f){if("/"!=r.charAt(0))if(this.a&&!this.f)r="/"+r;else{var i=t.f.lastIndexOf("/");-1!=i&&(r=t.f.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(ue(i,"./")||ue(i,"/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?t.f=r:n=""!==e.b.toString(),n?jn(t,rr(e.b)):n=!!e.h,n&&(t.h=e.h),t};var Hn=/[#\/\?@]/g,zn=/[#\?:]/g,Yn=/[#\?]/g,Qn=/[#\?@]/g,Xn=/#/g;function Jn(e,t){this.b=this.a=null,this.c=e||null,this.f=!!t}function $n(e){e.a||(e.a=new Nn,e.b=0,e.c&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var o=e[n].substring(0,r);i=e[n].substring(r+1)}else o=e[n];t(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.c,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Zn(e){var t=On(e);if("undefined"==typeof t)throw Error("Keys are undefined");var n=new Jn(null,void 0);e=kn(e);for(var r=0;r<t.length;r++){var i=t[r],o=e[r];Array.isArray(o)?nr(n,i,o):n.add(i,o)}return n}function er(e,t){$n(e),t=ir(e,t),Dn(e.a.b,t)&&(e.c=null,e.b-=e.a.get(t).length,Dn((e=e.a).b,t)&&(delete e.b[t],e.c--,e.a.length>2*e.c&&Pn(e)))}function tr(e,t){return $n(e),t=ir(e,t),Dn(e.a.b,t)}function nr(e,t,n){er(e,t),0<n.length&&(e.c=null,e.a.set(ir(e,t),Z(n)),e.b+=n.length)}function rr(e){var t=new Jn;return t.c=e.c,e.a&&(t.a=new Nn(e.a),t.b=e.b),t}function ir(e,t){return t=String(t),e.f&&(t=t.toLowerCase()),t}function or(e){var t=[];return sr(new ar,e,t),t.join("")}function ar(){}function sr(e,t,n){if(null==t)n.push("null");else{if("object"==typeof t){if(Array.isArray(t)){var r=t;t=r.length,n.push("[");for(var i="",o=0;o<t;o++)n.push(i),sr(e,r[o],n),i=",";return void n.push("]")}if(!(t instanceof String||t instanceof Number||t instanceof Boolean)){for(r in n.push("{"),i="",t)Object.prototype.hasOwnProperty.call(t,r)&&("function"!=typeof(o=t[r])&&(n.push(i),lr(r,n),n.push(":"),sr(e,o,n),i=","));return void n.push("}")}t=t.valueOf()}switch(typeof t){case"string":lr(t,n);break;case"number":n.push(isFinite(t)&&!isNaN(t)?String(t):"null");break;case"boolean":n.push(String(t));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof t)}}}(n=Jn.prototype).add=function(e,t){$n(this),this.c=null,e=ir(this,e);var n=this.a.get(e);return n||this.a.set(e,n=[]),n.push(t),this.b+=1,this},n.clear=function(){this.a=this.c=null,this.b=0},n.forEach=function(e,t){$n(this),this.a.forEach((function(n,r){K(n,(function(n){e.call(t,n,r,this)}),this)}),this)},n.Y=function(){$n(this);for(var e=this.a.W(),t=this.a.Y(),n=[],r=0;r<t.length;r++)for(var i=e[r],o=0;o<i.length;o++)n.push(t[r]);return n},n.W=function(e){$n(this);var t=[];if("string"===typeof e)tr(this,e)&&(t=$(t,this.a.get(ir(this,e))));else{e=this.a.W();for(var n=0;n<e.length;n++)t=$(t,e[n])}return t},n.set=function(e,t){return $n(this),this.c=null,tr(this,e=ir(this,e))&&(this.b-=this.a.get(e).length),this.a.set(e,[t]),this.b+=1,this},n.get=function(e,t){return e&&0<(e=this.W(e)).length?String(e[0]):t},n.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var e=[],t=this.a.Y(),n=0;n<t.length;n++){var r=t[n],i=encodeURIComponent(String(r));r=this.W(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),e.push(a)}}return this.c=e.join("&")};var cr={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ur=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function lr(e,t){t.push('"',e.replace(ur,(function(e){var t=cr[e];return t||(t="\\u"+(65536|e.charCodeAt(0)).toString(16).substr(1),cr[e]=t),t})),'"')}function dr(){var e=Nr();return Qe&&!!ct&&11==ct||/Edge\/\d+/.test(e)}function fr(){return c.window&&c.window.location.href||self&&self.location&&self.location.href||""}function hr(e,t){t=t||c.window;var n="about:blank";e&&(n=De(Ue(e)||Ve)),t.location.href=n}function pr(e,t){var n,r=[];for(n in e)n in t?typeof e[n]!=typeof t[n]?r.push(n):"object"==typeof e[n]&&null!=e[n]&&null!=t[n]?0<pr(e[n],t[n]).length&&r.push(n):e[n]!==t[n]&&r.push(n):r.push(n);for(n in t)n in e||r.push(n);return r}function vr(e){return!!((e=(e||Nr()).toLowerCase()).match(/android/)||e.match(/webos/)||e.match(/iphone|ipad|ipod/)||e.match(/blackberry/)||e.match(/windows phone/)||e.match(/iemobile/))}function mr(e){e=e||c.window;try{e.close()}catch(t){}}function gr(e,t,n){var r=Math.floor(1e9*Math.random()).toString();t=t||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-t)/2;for(a in t={width:t,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Nr().toLowerCase(),r&&(t.target=r,ue(n,"crios/")&&(t.target="_blank")),Cr(Nr())==Rr&&(e=e||"http://localhost",t.scrollbars=!0),n=e||"",(e=t)||(e={}),r=window,t=n instanceof Pe?n:Ue("undefined"!=typeof n.href?n.href:String(n))||Ve,n=e.target||n.target,i=[],e)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+e[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(e[a]?1:0))}var a=i.join(",");if((he("iPhone")&&!he("iPod")&&!he("iPad")||he("iPad")||he("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(_e(a=mt(document,"A"),"HTMLAnchorElement"),t=t instanceof Pe?t:je(t),a.href=De(t),a.setAttribute("target",n),e.noreferrer&&a.setAttribute("rel","noreferrer"),(e=document.createEvent("MouseEvent")).initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(e),a={}):e.noreferrer?(a=Ge("",r,n,a),e=De(t),a&&(Je&&ue(e,";")&&(e="'"+e.replace(/'/g,"%27")+"'"),a.opener=null,e='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+Ke(e)+'">',e=new Be(e=(r=Ie())?r.createHTML(e):e,null,We),r=a.document)&&(r.write(function(e){return e instanceof Be&&e.constructor===Be?e.a:(U("expected object of type SafeHtml, got '"+e+"' of type "+h(e)),"type_error:SafeHtml")}(e)),r.close())):(a=Ge(t,r,n,a))&&e.noopener&&(a.opener=null),a)try{a.focus()}catch(s){}return a}var yr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_r=/^[^@]+@[^@]+$/;function br(){var e=null;return new wt((function(t){"complete"==c.document.readyState?t():(e=function(){t()},hn(window,"load",e))})).o((function(t){throw pn(window,"load",e),t}))}function Er(e){return e=e||Nr(),!("file:"!==Mr()&&"ionic:"!==Mr()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function wr(){var e=c.window;try{return!(!e||e==e.top)}catch(t){return!1}}function Tr(){return"undefined"!==typeof c.WorkerGlobalScope&&"function"===typeof c.importScripts}function Sr(){return t.a.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":t.a.INTERNAL.hasOwnProperty("node")?"Node":Tr()?"Worker":"Browser"}function Ir(){var e=Sr();return"ReactNative"===e||"Node"===e}var Rr="Firefox",Ar="Chrome";function Cr(e){var t=e.toLowerCase();return ue(t,"opera/")||ue(t,"opr/")||ue(t,"opios/")?"Opera":ue(t,"iemobile")?"IEMobile":ue(t,"msie")||ue(t,"trident/")?"IE":ue(t,"edge/")?"Edge":ue(t,"firefox/")?Rr:ue(t,"silk/")?"Silk":ue(t,"blackberry")?"Blackberry":ue(t,"webos")?"Webos":!ue(t,"safari/")||ue(t,"chrome/")||ue(t,"crios/")||ue(t,"android")?!ue(t,"chrome/")&&!ue(t,"crios/")||ue(t,"edge/")?ue(t,"android")?"Android":(e=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==e.length?e[1]:"Other":Ar:"Safari"}var kr={md:"FirebaseCore-web",od:"FirebaseUI-web"};function Or(e,t){t=t||[];var n,r=[],i={};for(n in kr)i[kr[n]]=!0;for(n=0;n<t.length;n++)"undefined"!==typeof i[t[n]]&&(delete i[t[n]],r.push(t[n]));return r.sort(),(t=r).length||(t=["FirebaseCore-web"]),"Browser"===(r=Sr())?r=Cr(i=Nr()):"Worker"===r&&(r=Cr(i=Nr())+"-"+r),r+"/JsCore/"+e+"/"+t.join(",")}function Nr(){return c.navigator&&c.navigator.userAgent||""}function Pr(e,t){e=e.split("."),t=t||c;for(var n=0;n<e.length&&"object"==typeof t&&null!=t;n++)t=t[e[n]];return n!=e.length&&(t=void 0),t}function Dr(){try{var e=c.localStorage,t=Br();if(e)return e.setItem(t,"1"),e.removeItem(t),!dr()||!!c.indexedDB}catch(n){return Tr()&&!!c.indexedDB}return!1}function xr(){return(Lr()||"chrome-extension:"===Mr()||Er())&&!Ir()&&Dr()&&!Tr()}function Lr(){return"http:"===Mr()||"https:"===Mr()}function Mr(){return c.location&&c.location.protocol||null}function Ur(e){return!vr(e=e||Nr())&&Cr(e)!=Rr}function jr(e){return"undefined"===typeof e?null:or(e)}function Fr(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&null!==e[t]&&void 0!==e[t]&&(n[t]=e[t]);return n}function Vr(e){if(null!==e)return JSON.parse(e)}function Br(e){return e||Math.floor(1e9*Math.random()).toString()}function Wr(e){return"Safari"!=Cr(e=e||Nr())&&!e.toLowerCase().match(/iphone|ipad|ipod/)}function Gr(){var e=c.___jsl;if(e&&e.H)for(var t in e.H)if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=e.H[t].L.concat(),e.CP)for(var n=0;n<e.CP.length;n++)e.CP[n]=null}function qr(e,t){if(e>t)throw Error("Short delay should be less than long delay!");this.a=e,this.c=t,e=Nr(),t=Sr(),this.b=vr(e)||"ReactNative"===t}function Kr(){var e=c.document;return!e||"undefined"===typeof e.visibilityState||"visible"==e.visibilityState}function Hr(e){try{var t=new Date(parseInt(e,10));if(!isNaN(t.getTime())&&!/[^0-9]/.test(e))return t.toUTCString()}catch(n){}return null}function zr(){return!(!Pr("fireauth.oauthhelper",c)&&!Pr("fireauth.iframe",c))}qr.prototype.get=function(){var e=c.navigator;return!e||"boolean"!==typeof e.onLine||!Lr()&&"chrome-extension:"!==Mr()&&"undefined"===typeof e.connection||e.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};var Yr,Qr={};function Xr(e){Qr[e]||(Qr[e]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn(e))}try{var Jr={};Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Jr,"abcd",{configurable:!0,enumerable:!0,value:2}),Yr=2==Jr.abcd}catch(fa){Yr=!1}function $r(e,t,n){Yr?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,value:n}):e[t]=n}function Zr(e,t){if(t)for(var n in t)t.hasOwnProperty(n)&&$r(e,n,t[n])}function ei(e){var t={};return Zr(t,e),t}function ti(e){var t=e;if("object"==typeof e&&null!=e)for(var n in t="length"in e?[]:{},e)$r(t,n,ti(e[n]));return t}function ni(e){var t=e&&(e[si]?"phone":null);if(!(t&&e&&e[ai]))throw new A("internal-error","Internal assert: invalid MultiFactorInfo object");$r(this,"uid",e[ai]),$r(this,"displayName",e[ii]||null);var n=null;e[oi]&&(n=new Date(e[oi]).toUTCString()),$r(this,"enrollmentTime",n),$r(this,"factorId",t)}function ri(e){try{var t=new ci(e)}catch(n){t=null}return t}ni.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};var ii="displayName",oi="enrolledAt",ai="mfaEnrollmentId",si="phoneInfo";function ci(e){ni.call(this,e),$r(this,"phoneNumber",e[si])}function ui(e){var t={},n=e[hi],r=e[vi],i=e[mi];if(e=ri(e[pi]),!i||i!=di&&i!=fi&&!n||i==fi&&!r||i==li&&!e)throw Error("Invalid checkActionCode response!");i==fi?(t[yi]=n||null,t[bi]=n||null,t[gi]=r):(t[yi]=r||null,t[bi]=r||null,t[gi]=n||null),t[_i]=e||null,$r(this,wi,i),$r(this,Ei,ti(t))}I(ci,ni),ci.prototype.w=function(){var e=ci.ab.w.call(this);return e.phoneNumber=this.phoneNumber,e};var li="REVERT_SECOND_FACTOR_ADDITION",di="EMAIL_SIGNIN",fi="VERIFY_AND_CHANGE_EMAIL",hi="email",pi="mfaInfo",vi="newEmail",mi="requestType",gi="email",yi="fromEmail",_i="multiFactorInfo",bi="previousEmail",Ei="data",wi="operation";function Ti(e){var t=Vn(e=Bn(e),Si)||null,n=Vn(e,Ii)||null,r=Vn(e,Ci)||null;if(r=r&&Oi[r]||null,!t||!n||!r)throw new A("argument-error",Si+", "+Ii+"and "+Ci+" are required in a valid action code URL.");Zr(this,{apiKey:t,operation:r,code:n,continueUrl:Vn(e,Ri)||null,languageCode:Vn(e,Ai)||null,tenantId:Vn(e,ki)||null})}var Si="apiKey",Ii="oobCode",Ri="continueUrl",Ai="languageCode",Ci="mode",ki="tenantId",Oi={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:li,signIn:di,verifyAndChangeEmail:fi,verifyEmail:"VERIFY_EMAIL"};function Ni(e){try{return new Ti(e)}catch(t){return null}}function Pi(e){var t=e[Ui];if("undefined"===typeof t)throw new A("missing-continue-uri");if("string"!==typeof t||"string"===typeof t&&!t.length)throw new A("invalid-continue-uri");this.h=t,this.b=this.a=null,this.g=!1;var n=e[Di];if(n&&"object"===typeof n){t=n[Vi];var r=n[ji];if(n=n[Fi],"string"===typeof t&&t.length){if(this.a=t,"undefined"!==typeof r&&"boolean"!==typeof r)throw new A("argument-error",ji+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new A("argument-error",Fi+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof t)throw new A("argument-error",Vi+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new A("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new A("argument-error",Di+" property must be a non null object when specified.");if(this.f=null,(t=e[Mi])&&"object"===typeof t){if("string"===typeof(t=t[Bi])&&t.length)this.f=t;else if("undefined"!==typeof t)throw new A("argument-error",Bi+" property must be a non empty string when specified.")}else if("undefined"!==typeof t)throw new A("argument-error",Mi+" property must be a non null object when specified.");if("undefined"!==typeof(t=e[Li])&&"boolean"!==typeof t)throw new A("argument-error",Li+" property must be a boolean when specified.");if(this.c=!!t,"undefined"!==typeof(e=e[xi])&&("string"!==typeof e||"string"===typeof e&&!e.length))throw new A("argument-error",xi+" property must be a non empty string when specified.");this.i=e||null}var Di="android",xi="dynamicLinkDomain",Li="handleCodeInApp",Mi="iOS",Ui="url",ji="installApp",Fi="minimumVersion",Vi="packageName",Bi="bundleId";function Wi(e){var t={};for(var n in t.continueUrl=e.h,t.canHandleCodeInApp=e.c,(t.androidPackageName=e.a)&&(t.androidMinimumVersion=e.b,t.androidInstallApp=e.g),t.iOSBundleId=e.f,t.dynamicLinkDomain=e.i,t)null===t[n]&&delete t[n];return t}var Gi=null;function qi(e){var t=[];return function(e,t){function n(t){for(;r<e.length;){var n=e.charAt(r++),i=Gi[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return t}!function(){if(!Gi){Gi={};for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),t=["+/=","+/","-_=","-_.","-_"],n=0;5>n;n++)for(var r=e.concat(t[n].split("")),i=0;i<r.length;i++){var o=r[i];void 0===Gi[o]&&(Gi[o]=i)}}}();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;t(i<<2|o>>4),64!=a&&(t(o<<4&240|a>>2),64!=s&&t(a<<6&192|s))}}(e,(function(e){t.push(e)})),t}function Ki(e){var t=zi(e);if(!(t&&t.sub&&t.iss&&t.aud&&t.exp))throw Error("Invalid JWT");this.h=e,this.a=t.exp,this.i=t.sub,e=Date.now()/1e3,this.g=t.iat||(e>this.a?this.a:e),this.b=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.f=t.firebase&&t.firebase.tenant||null,this.c=!!t.is_anonymous||"anonymous"==this.b}function Hi(e){try{return new Ki(e)}catch(t){return null}}function zi(e){if(!e)return null;if(3!=(e=e.split(".")).length)return null;for(var t=(4-(e=e[1]).length%4)%4,n=0;n<t;n++)e+=".";try{var r=qi(e);for(e=[],n=t=0;t<r.length;){var i=r[t++];if(128>i)e[n++]=String.fromCharCode(i);else if(191<i&&224>i){var o=r[t++];e[n++]=String.fromCharCode((31&i)<<6|63&o)}else if(239<i&&365>i){o=r[t++];var a=r[t++],s=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&r[t++])-65536;e[n++]=String.fromCharCode(55296+(s>>10)),e[n++]=String.fromCharCode(56320+(1023&s))}else o=r[t++],a=r[t++],e[n++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}return JSON.parse(e.join(""))}catch(c){}return null}Ki.prototype.T=function(){return this.f},Ki.prototype.l=function(){return this.c},Ki.prototype.toString=function(){return this.h};var Yi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Qi=["client_id","response_type","scope","redirect_uri","state"],Xi={nd:{Ja:"locale",ua:700,ta:600,fa:"facebook.com",Xa:Qi},pd:{Ja:null,ua:500,ta:750,fa:"github.com",Xa:Qi},qd:{Ja:"hl",ua:515,ta:680,fa:"google.com",Xa:Qi},wd:{Ja:"lang",ua:485,ta:705,fa:"twitter.com",Xa:Yi},kd:{Ja:"locale",ua:640,ta:600,fa:"apple.com",Xa:[]}};function Ji(e){for(var t in Xi)if(Xi[t].fa==e)return Xi[t];return null}function $i(e){var t={};t["facebook.com"]=ro,t["google.com"]=oo,t["github.com"]=io,t["twitter.com"]=ao;var n=e&&e[eo];try{if(n)return t[n]?new t[n](e):new no(e);if("undefined"!==typeof e[Zi])return new to(e)}catch(r){}return null}var Zi="idToken",eo="providerId";function to(e){var t=e[eo];if(!t&&e[Zi]){var n=Hi(e[Zi]);n&&n.b&&(t=n.b)}if(!t)throw Error("Invalid additional user info!");"anonymous"!=t&&"custom"!=t||(t=null),n=!1,"undefined"!==typeof e.isNewUser?n=!!e.isNewUser:"identitytoolkit#SignupNewUserResponse"===e.kind&&(n=!0),$r(this,"providerId",t),$r(this,"isNewUser",n)}function no(e){to.call(this,e),$r(this,"profile",ti((e=Vr(e.rawUserInfo||"{}"))||{}))}function ro(e){if(no.call(this,e),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function io(e){if(no.call(this,e),"github.com"!=this.providerId)throw Error("Invalid provider ID!");$r(this,"username",this.profile&&this.profile.login||null)}function oo(e){if(no.call(this,e),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function ao(e){if(no.call(this,e),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");$r(this,"username",e.screenName||null)}function so(e){var t=Bn(e),n=Vn(t,"link"),r=Vn(Bn(n),"link");return t=Vn(t,"deep_link_id"),Vn(Bn(t),"link")||t||r||n||e}function co(e,t){if(!e&&!t)throw new A("internal-error","Internal assert: no raw session string available");if(e&&t)throw new A("internal-error","Internal assert: unable to determine the session type");this.a=e||null,this.b=t||null,this.type=this.a?uo:lo}I(no,to),I(ro,no),I(io,no),I(oo,no),I(ao,no);var uo="enroll",lo="signin";function fo(){}function ho(e,t){return e.then((function(e){if(e[ns]){var n=Hi(e[ns]);if(!n||t!=n.i)throw new A("user-mismatch");return e}throw new A("user-mismatch")})).o((function(e){throw e&&e.code&&e.code==O+"user-not-found"?new A("user-mismatch"):e}))}function po(e,t){if(!t)throw new A("internal-error","failed to construct a credential");this.a=t,$r(this,"providerId",e),$r(this,"signInMethod",e)}function vo(e){return{pendingToken:e.a,requestUri:"http://localhost"}}function mo(e){if(e&&e.providerId&&e.signInMethod&&0==e.providerId.indexOf("saml.")&&e.pendingToken)try{return new po(e.providerId,e.pendingToken)}catch(t){}return null}function go(e,t,n){if(this.a=null,t.idToken||t.accessToken)t.idToken&&$r(this,"idToken",t.idToken),t.accessToken&&$r(this,"accessToken",t.accessToken),t.nonce&&!t.pendingToken&&$r(this,"nonce",t.nonce),t.pendingToken&&(this.a=t.pendingToken);else{if(!t.oauthToken||!t.oauthTokenSecret)throw new A("internal-error","failed to construct a credential");$r(this,"accessToken",t.oauthToken),$r(this,"secret",t.oauthTokenSecret)}$r(this,"providerId",e),$r(this,"signInMethod",n)}function yo(e){var t={};return e.idToken&&(t.id_token=e.idToken),e.accessToken&&(t.access_token=e.accessToken),e.secret&&(t.oauth_token_secret=e.secret),t.providerId=e.providerId,e.nonce&&!e.a&&(t.nonce=e.nonce),t={postBody:Zn(t).toString(),requestUri:"http://localhost"},e.a&&(delete t.postBody,t.pendingToken=e.a),t}function _o(e){if(e&&e.providerId&&e.signInMethod){var t={idToken:e.oauthIdToken,accessToken:e.oauthTokenSecret?null:e.oauthAccessToken,oauthTokenSecret:e.oauthTokenSecret,oauthToken:e.oauthTokenSecret&&e.oauthAccessToken,nonce:e.nonce,pendingToken:e.pendingToken};try{return new go(e.providerId,t,e.signInMethod)}catch(n){}}return null}function bo(e,t){this.Qc=t||[],Zr(this,{providerId:e,isOAuthProvider:!0}),this.Ib={},this.pb=(Ji(e)||{}).Ja||null,this.ob=null}function Eo(e){if("string"!==typeof e||0!=e.indexOf("saml."))throw new A("argument-error",'SAML provider IDs must be prefixed with "saml."');bo.call(this,e,[])}function wo(e){bo.call(this,e,Qi),this.a=[]}function To(){wo.call(this,"facebook.com")}function So(e){if(!e)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return m(e)&&(t=e.accessToken),(new To).credential({accessToken:t})}function Io(){wo.call(this,"github.com")}function Ro(e){if(!e)throw new A("argument-error","credential failed: expected 1 argument (the OAuth access token).");var t=e;return m(e)&&(t=e.accessToken),(new Io).credential({accessToken:t})}function Ao(){wo.call(this,"google.com"),this.Ca("profile")}function Co(e,t){var n=e;return m(e)&&(n=e.idToken,t=e.accessToken),(new Ao).credential({idToken:n,accessToken:t})}function ko(){bo.call(this,"twitter.com",Yi)}function Oo(e,t){var n=e;if(m(n)||(n={oauthToken:e,oauthTokenSecret:t}),!n.oauthToken||!n.oauthTokenSecret)throw new A("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new go("twitter.com",n,"twitter.com")}function No(e,t,n){this.a=e,this.f=t,$r(this,"providerId","password"),$r(this,"signInMethod",n===Do.EMAIL_LINK_SIGN_IN_METHOD?Do.EMAIL_LINK_SIGN_IN_METHOD:Do.EMAIL_PASSWORD_SIGN_IN_METHOD)}function Po(e){return e&&e.email&&e.password?new No(e.email,e.password,e.signInMethod):null}function Do(){Zr(this,{providerId:"password",isOAuthProvider:!1})}function xo(e,t){if(!(t=Lo(t)))throw new A("argument-error","Invalid email link!");return new No(e,t.code,Do.EMAIL_LINK_SIGN_IN_METHOD)}function Lo(e){return(e=Ni(e=so(e)))&&e.operation===di?e:null}function Mo(e){if(!(e.eb&&e.cb||e.La&&e.ea))throw new A("internal-error");this.a=e,$r(this,"providerId","phone"),this.fa="phone",$r(this,"signInMethod","phone")}function Uo(e){if(e&&"phone"===e.providerId&&(e.verificationId&&e.verificationCode||e.temporaryProof&&e.phoneNumber)){var t={};return K(["verificationId","verificationCode","temporaryProof","phoneNumber"],(function(n){e[n]&&(t[n]=e[n])})),new Mo(t)}return null}function jo(e){return e.a.La&&e.a.ea?{temporaryProof:e.a.La,phoneNumber:e.a.ea}:{sessionInfo:e.a.eb,code:e.a.cb}}function Fo(e){try{this.a=e||t.a.auth()}catch(n){throw new A("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Zr(this,{providerId:"phone",isOAuthProvider:!1})}function Vo(e,t){if(!e)throw new A("missing-verification-id");if(!t)throw new A("missing-verification-code");return new Mo({eb:e,cb:t})}function Bo(e){if(e.temporaryProof&&e.phoneNumber)return new Mo({La:e.temporaryProof,ea:e.phoneNumber});var t=e&&e.providerId;if(!t||"password"===t)return null;var n=e&&e.oauthAccessToken,r=e&&e.oauthTokenSecret,i=e&&e.nonce,o=e&&e.oauthIdToken,a=e&&e.pendingToken;try{switch(t){case"google.com":return Co(o,n);case"facebook.com":return So(n);case"github.com":return Ro(n);case"twitter.com":return Oo(n,r);default:return n||r||o||a?a?0==t.indexOf("saml.")?new po(t,a):new go(t,{pendingToken:a,idToken:e.oauthIdToken,accessToken:e.oauthAccessToken},t):new wo(t).credential({idToken:o,accessToken:n,rawNonce:i}):null}}catch(s){return null}}function Wo(e){if(!e.isOAuthProvider)throw new A("invalid-oauth-provider")}function Go(e,t,n,r,i,o,a){if(this.c=e,this.b=t||null,this.g=n||null,this.f=r||null,this.i=o||null,this.h=a||null,this.a=i||null,!this.g&&!this.a)throw new A("invalid-auth-event");if(this.g&&this.a)throw new A("invalid-auth-event");if(this.g&&!this.f)throw new A("invalid-auth-event")}function qo(e){return(e=e||{}).type?new Go(e.type,e.eventId,e.urlResponse,e.sessionId,e.error&&C(e.error),e.postBody,e.tenantId):null}function Ko(){this.b=null,this.a=[]}co.prototype.Ha=function(){return this.a?kt(this.a):kt(this.b)},co.prototype.w=function(){return this.type==uo?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}},fo.prototype.ka=function(){},fo.prototype.b=function(){},fo.prototype.c=function(){},fo.prototype.w=function(){},po.prototype.ka=function(e){return Ss(e,vo(this))},po.prototype.b=function(e,t){var n=vo(this);return n.idToken=t,Is(e,n)},po.prototype.c=function(e,t){return ho(Rs(e,vo(this)),t)},po.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}},go.prototype.ka=function(e){return Ss(e,yo(this))},go.prototype.b=function(e,t){var n=yo(this);return n.idToken=t,Is(e,n)},go.prototype.c=function(e,t){return ho(Rs(e,yo(this)),t)},go.prototype.w=function(){var e={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(e.oauthIdToken=this.idToken),this.accessToken&&(e.oauthAccessToken=this.accessToken),this.secret&&(e.oauthTokenSecret=this.secret),this.nonce&&(e.nonce=this.nonce),this.a&&(e.pendingToken=this.a),e},bo.prototype.Ka=function(e){return this.Ib=me(e),this},I(Eo,bo),I(wo,bo),wo.prototype.Ca=function(e){return Q(this.a,e)||this.a.push(e),this},wo.prototype.Qb=function(){return Z(this.a)},wo.prototype.credential=function(e,t){var n;if(!(n=m(e)?{idToken:e.idToken||null,accessToken:e.accessToken||null,nonce:e.rawNonce||null}:{idToken:e||null,accessToken:t||null}).idToken&&!n.accessToken)throw new A("argument-error","credential failed: must provide the ID token and/or the access token.");return new go(this.providerId,n,this.providerId)},I(To,wo),$r(To,"PROVIDER_ID","facebook.com"),$r(To,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),I(Io,wo),$r(Io,"PROVIDER_ID","github.com"),$r(Io,"GITHUB_SIGN_IN_METHOD","github.com"),I(Ao,wo),$r(Ao,"PROVIDER_ID","google.com"),$r(Ao,"GOOGLE_SIGN_IN_METHOD","google.com"),I(ko,bo),$r(ko,"PROVIDER_ID","twitter.com"),$r(ko,"TWITTER_SIGN_IN_METHOD","twitter.com"),No.prototype.ka=function(e){return this.signInMethod==Do.EMAIL_LINK_SIGN_IN_METHOD?sc(e,xs,{email:this.a,oobCode:this.f}):sc(e,nc,{email:this.a,password:this.f})},No.prototype.b=function(e,t){return this.signInMethod==Do.EMAIL_LINK_SIGN_IN_METHOD?sc(e,Ls,{idToken:t,email:this.a,oobCode:this.f}):sc(e,Ys,{idToken:t,email:this.a,password:this.f})},No.prototype.c=function(e,t){return ho(this.ka(e),t)},No.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}},Zr(Do,{PROVIDER_ID:"password"}),Zr(Do,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Zr(Do,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),Mo.prototype.ka=function(e){return e.fb(jo(this))},Mo.prototype.b=function(e,t){var n=jo(this);return n.idToken=t,sc(e,ic,n)},Mo.prototype.c=function(e,t){var n=jo(this);return n.operation="REAUTH",ho(e=sc(e,oc,n),t)},Mo.prototype.w=function(){var e={providerId:"phone"};return this.a.eb&&(e.verificationId=this.a.eb),this.a.cb&&(e.verificationCode=this.a.cb),this.a.La&&(e.temporaryProof=this.a.La),this.a.ea&&(e.phoneNumber=this.a.ea),e},Fo.prototype.fb=function(e,t){var n=this.a.a;return kt(t.verify()).then((function(r){if("string"!==typeof r)throw new A("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(t.type){case"recaptcha":var i=m(e)?e.session:null,o=m(e)?e.phoneNumber:e;return(i&&i.type==uo?i.Ha().then((function(e){return function(e,t){return sc(e,Xs,t).then((function(e){return e.phoneSessionInfo.sessionInfo}))}(n,{idToken:e,phoneEnrollmentInfo:{phoneNumber:o,recaptchaToken:r}})})):i&&i.type==lo?i.Ha().then((function(t){return function(e,t){return sc(e,Js,t).then((function(e){return e.phoneResponseInfo.sessionInfo}))}(n,{mfaPendingCredential:t,mfaEnrollmentId:e.multiFactorHint&&e.multiFactorHint.uid||e.multiFactorUid,phoneSignInInfo:{recaptchaToken:r}})})):function(e,t){return sc(e,Hs,t)}(n,{phoneNumber:o,recaptchaToken:r})).then((function(e){return"function"===typeof t.reset&&t.reset(),e}),(function(e){throw"function"===typeof t.reset&&t.reset(),e}));default:throw new A("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}}))},Zr(Fo,{PROVIDER_ID:"phone"}),Zr(Fo,{PHONE_SIGN_IN_METHOD:"phone"}),Go.prototype.getUid=function(){var e=[];return e.push(this.c),this.b&&e.push(this.b),this.f&&e.push(this.f),this.h&&e.push(this.h),e.join("-")},Go.prototype.T=function(){return this.h},Go.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};var Ho,zo=null;function Yo(e){var t="unauthorized-domain",n=void 0,r=Bn(e);e=r.a,"chrome-extension"==(r=r.c)?n=qe("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):"http"==r||"https"==r?n=qe("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",e):t="operation-not-supported-in-this-environment",A.call(this,t,n)}function Qo(e,t,n){A.call(this,e,n),(e=t||{}).Jb&&$r(this,"email",e.Jb),e.ea&&$r(this,"phoneNumber",e.ea),e.credential&&$r(this,"credential",e.credential),e.Zb&&$r(this,"tenantId",e.Zb)}function Xo(e){if(e.code){var t=e.code||"";0==t.indexOf(O)&&(t=t.substring(O.length));var n={credential:Bo(e),Zb:e.tenantId};if(e.email)n.Jb=e.email;else if(e.phoneNumber)n.ea=e.phoneNumber;else if(!n.credential)return new A(t,e.message||void 0);return new Qo(t,n,e.message)}return null}function Jo(){}function $o(e){return e.c||(e.c=e.b())}function Zo(){}function ea(e){if(!e.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var t=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<t.length;n++){var r=t[n];try{return new ActiveXObject(r),e.f=r}catch(i){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return e.f}function ta(){}function na(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=w(this.qc,this),this.a.onerror=w(this.Sb,this),this.a.onprogress=w(this.rc,this),this.a.ontimeout=w(this.vc,this)}function ra(e,t){e.readyState=t,e.onreadystatechange&&e.onreadystatechange()}function ia(e,t,n){this.reset(e,t,n,void 0,void 0)}I(Yo,A),I(Qo,A),Qo.prototype.w=function(){var e={code:this.code,message:this.message};this.email&&(e.email=this.email),this.phoneNumber&&(e.phoneNumber=this.phoneNumber),this.tenantId&&(e.tenantId=this.tenantId);var t=this.credential&&this.credential.w();return t&&ye(e,t),e},Qo.prototype.toJSON=function(){return this.w()},Jo.prototype.c=null,I(Zo,Jo),Zo.prototype.a=function(){var e=ea(this);return e?new ActiveXObject(e):new XMLHttpRequest},Zo.prototype.b=function(){var e={};return ea(this)&&(e[0]=!0,e[1]=!0),e},Ho=new Zo,I(ta,Jo),ta.prototype.a=function(){var e=new XMLHttpRequest;if("withCredentials"in e)return e;if("undefined"!=typeof XDomainRequest)return new na;throw Error("Unsupported browser")},ta.prototype.b=function(){return{}},(n=na.prototype).open=function(e,t,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(e,t)},n.send=function(e){if(e){if("string"!=typeof e)throw Error("Only string data is supported");this.a.send(e)}else this.a.send()},n.abort=function(){this.a.abort()},n.setRequestHeader=function(){},n.getResponseHeader=function(e){return"content-type"==e.toLowerCase()?this.a.contentType:""},n.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ra(this,4)},n.Sb=function(){this.status=500,this.response=this.responseText="",ra(this,4)},n.vc=function(){this.Sb()},n.rc=function(){this.status=200,ra(this,1)},n.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},ia.prototype.a=null;function oa(e){this.f=e,this.b=this.c=this.a=null}function aa(e,t){this.name=e,this.value=t}ia.prototype.reset=function(e,t,n,r,i){"number"==typeof i||0,r||S(),delete this.a},aa.prototype.toString=function(){return this.name};var sa=new aa("SEVERE",1e3),ca=new aa("WARNING",900),ua=new aa("CONFIG",700),la=new aa("FINE",500);function da(e){return e.c?e.c:e.a?da(e.a):(U("Root logger has no level set."),null)}oa.prototype.log=function(e,t,n){if(e.value>=da(this).value)for(v(t)&&(t=t()),e=new ia(e,String(t),this.f),n&&(e.a=n),n=this;n;)n=n.a};var fa,ha={},pa=null;function va(e){var t;if(pa||(pa=new oa(""),ha[""]=pa,pa.c=ua),!(t=ha[e])){t=new oa(e);var n=e.lastIndexOf("."),r=e.substr(n+1);(n=va(e.substr(0,n))).b||(n.b={}),n.b[r]=t,t.a=n,ha[e]=t}return t}function ma(e,t){e&&e.log(la,t,void 0)}function ga(e){this.f=e}function ya(e){Tn.call(this),this.u=e,this.h=void 0,this.readyState=_a,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=va("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}I(ga,Jo),ga.prototype.a=function(){return new ya(this.f)},ga.prototype.b=(fa={},function(){return fa}),I(ya,Tn);var _a=0;function ba(e){e.c.read().then(e.pc.bind(e)).catch(e.Ua.bind(e))}function Ea(e){e.readyState=4,e.g=null,e.c=null,e.m=null,wa(e)}function wa(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ta(e){Tn.call(this),this.headers=new Nn,this.D=e||null,this.c=!1,this.C=this.a=null,this.h=this.R=this.l="",this.f=this.O=this.i=this.J=!1,this.g=0,this.s=null,this.m=Sa,this.u=this.S=!1}(n=ya.prototype).open=function(e,t){if(this.readyState!=_a)throw this.abort(),Error("Error reopening a connection");this.s=e,this.f=t,this.readyState=1,wa(this)},n.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var t={headers:this.l,method:this.s,credentials:this.h,cache:void 0};e&&(t.body=e),this.u.fetch(new Request(this.f,t)).then(this.uc.bind(this),this.Ua.bind(this))},n.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&4!=this.readyState&&(this.a=!1,Ea(this)),this.readyState=_a},n.uc=function(e){this.a&&(this.g=e,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=e.headers,this.readyState=2,wa(this)),this.a&&(this.readyState=3,wa(this),this.a&&("arraybuffer"===this.responseType?e.arrayBuffer().then(this.sc.bind(this),this.Ua.bind(this)):"undefined"!==typeof c.ReadableStream&&"body"in e?(this.response=this.responseText="",this.c=e.body.getReader(),this.m=new TextDecoder,ba(this)):e.text().then(this.tc.bind(this),this.Ua.bind(this)))))},n.pc=function(e){if(this.a){var t=this.m.decode(e.value?e.value:new Uint8Array(0),{stream:!e.done});t&&(this.response=this.responseText+=t),e.done?Ea(this):wa(this),3==this.readyState&&ba(this)}},n.tc=function(e){this.a&&(this.response=this.responseText=e,Ea(this))},n.sc=function(e){this.a&&(this.response=e,Ea(this))},n.Ua=function(e){var t=this.i;t&&t.log(ca,"Failed to fetch url "+this.f,e instanceof Error?e:Error(e)),this.a&&Ea(this)},n.setRequestHeader=function(e,t){this.l.append(e,t)},n.getResponseHeader=function(e){return this.b?this.b.get(e.toLowerCase())||"":((e=this.i)&&e.log(ca,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},n.getAllResponseHeaders=function(){if(!this.b){var e=this.i;return e&&e.log(ca,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}e=[];for(var t=this.b.entries(),n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(ya.prototype,"withCredentials",{get:function(){return"include"===this.h},set:function(e){this.h=e?"include":"same-origin"}}),I(Ta,Tn);var Sa="";Ta.prototype.b=va("goog.net.XhrIo");var Ia=/^https?$/i,Ra=["POST","PUT"];function Aa(e,t,n,r,i){if(e.a)throw Error("[goog.net.XhrIo] Object is active with another request="+e.l+"; newUri="+t);n=n?n.toUpperCase():"GET",e.l=t,e.h="",e.R=n,e.J=!1,e.c=!0,e.a=e.D?e.D.a():Ho.a(),e.C=e.D?$o(e.D):$o(Ho),e.a.onreadystatechange=w(e.Vb,e);try{ma(e.b,Ma(e,"Opening Xhr")),e.O=!0,e.a.open(n,String(t),!0),e.O=!1}catch(a){return ma(e.b,Ma(e,"Error opening Xhr: "+a.message)),void ka(e,a)}t=r||"";var o=new Nn(e.headers);i&&function(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(p(e)||"string"===typeof e)K(e,t,void 0);else for(var n=On(e),r=kn(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}(i,(function(e,t){o.set(t,e)})),i=function(e){e:{for(var t=Ca,n=e.length,r="string"===typeof e?e.split(""):e,i=0;i<n;i++)if(i in r&&t.call(void 0,r[i],i,e)){t=i;break e}t=-1}return 0>t?null:"string"===typeof e?e.charAt(t):e[t]}(o.Y()),r=c.FormData&&t instanceof c.FormData,!Q(Ra,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach((function(e,t){this.a.setRequestHeader(t,e)}),e),e.m&&(e.a.responseType=e.m),"withCredentials"in e.a&&e.a.withCredentials!==e.S&&(e.a.withCredentials=e.S);try{Da(e),0<e.g&&(e.u=function(e){return Qe&&at(9)&&"number"===typeof e.timeout&&void 0!==e.ontimeout}(e.a),ma(e.b,Ma(e,"Will abort after "+e.g+"ms if incomplete, xhr2 "+e.u)),e.u?(e.a.timeout=e.g,e.a.ontimeout=w(e.Ma,e)):e.s=An(e.Ma,e.g,e)),ma(e.b,Ma(e,"Sending request")),e.i=!0,e.a.send(t),e.i=!1}catch(a){ma(e.b,Ma(e,"Send error: "+a.message)),ka(e,a)}}function Ca(e){return"content-type"==e.toLowerCase()}function ka(e,t){e.c=!1,e.a&&(e.f=!0,e.a.abort(),e.f=!1),e.h=t,Oa(e),Pa(e)}function Oa(e){e.J||(e.J=!0,e.dispatchEvent("complete"),e.dispatchEvent("error"))}function Na(e){if(e.c&&"undefined"!=typeof s)if(e.C[1]&&4==xa(e)&&2==La(e))ma(e.b,Ma(e,"Local request error detected and ignored"));else if(e.i&&4==xa(e))An(e.Vb,0,e);else if(e.dispatchEvent("readystatechange"),4==xa(e)){ma(e.b,Ma(e,"Request complete")),e.c=!1;try{var t,n=La(e);e:switch(n){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break e;default:r=!1}if(!(t=r)){var i;if(i=0===n){var o=String(e.l).match(xn)[1]||null;if(!o&&c.self&&c.self.location){var a=c.self.location.protocol;o=a.substr(0,a.length-1)}i=!Ia.test(o?o.toLowerCase():"")}t=i}if(t)e.dispatchEvent("complete"),e.dispatchEvent("success");else{try{var u=2<xa(e)?e.a.statusText:""}catch(l){ma(e.b,"Can not get status: "+l.message),u=""}e.h=u+" ["+La(e)+"]",Oa(e)}}finally{Pa(e)}}}function Pa(e,t){if(e.a){Da(e);var n=e.a,r=e.C[0]?f:null;e.a=null,e.C=null,t||e.dispatchEvent("ready");try{n.onreadystatechange=r}catch(i){(e=e.b)&&e.log(sa,"Problem encountered resetting onreadystatechange: "+i.message,void 0)}}}function Da(e){e.a&&e.u&&(e.a.ontimeout=null),e.s&&(c.clearTimeout(e.s),e.s=null)}function xa(e){return e.a?e.a.readyState:0}function La(e){try{return 2<xa(e)?e.a.status:-1}catch(t){return-1}}function Ma(e,t){return t+" ["+e.R+" "+e.l+" "+La(e)+"]"}function Ua(e){var t=Ya;this.g=[],this.u=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}function ja(e,t,n){e.a=!0,e.c=n,e.f=!t,Wa(e)}function Fa(e){if(e.a){if(!e.v)throw new Ga(e);e.v=!1}}function Va(e,t,n,r){e.g.push([t,n,r]),e.a&&Wa(e)}function Ba(e){return Y(e.g,(function(e){return v(e[1])}))}function Wa(e){if(e.h&&e.a&&Ba(e)){var t=e.h,n=Ha[t];n&&(c.clearTimeout(n.a),delete Ha[t]),e.h=0}e.b&&(e.b.l--,delete e.b),t=e.c;for(var r=n=!1;e.g.length&&!e.i;){var i=e.g.shift(),o=i[0],a=i[1];if(i=i[2],o=e.f?a:o)try{var s=o.call(i||e.s,t);void 0!==s&&(e.f=e.f&&(s==t||s instanceof Error),e.c=t=s),(x(t)||"function"===typeof c.Promise&&t instanceof c.Promise)&&(r=!0,e.i=!0)}catch(u){t=u,e.f=!0,Ba(e)||(n=!0)}}e.c=t,r&&(s=w(e.m,e,!0),r=w(e.m,e,!1),t instanceof Ua?(Va(t,s,r),t.C=!0):t.then(s,r)),n&&(t=new Ka(t),Ha[t.a]=t,e.h=t.a)}function Ga(){L.call(this)}function qa(){L.call(this)}function Ka(e){this.a=c.setTimeout(w(this.c,this),0),this.b=e}(n=Ta.prototype).Ma=function(){"undefined"!=typeof s&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",ma(this.b,Ma(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},n.abort=function(){this.a&&this.c&&(ma(this.b,Ma(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Pa(this))},n.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Pa(this,!0)),Ta.ab.Da.call(this)},n.Vb=function(){this.xa||(this.O||this.i||this.f?Na(this):this.Jc())},n.Jc=function(){Na(this)},n.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case Sa:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var e=this.b;return e&&e.log(sa,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(t){return ma(this.b,"Can not get response: "+t.message),null}},Ua.prototype.cancel=function(e){if(this.a)this.c instanceof Ua&&this.c.cancel();else{if(this.b){var t=this.b;delete this.b,e?t.cancel(e):(t.l--,0>=t.l&&t.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(e=new qa(this),Fa(this),ja(this,!1,e))}},Ua.prototype.m=function(e,t){this.i=!1,ja(this,e,t)},Ua.prototype.then=function(e,t,n){var r,i,o=new wt((function(e,t){r=e,i=t}));return Va(this,r,(function(e){e instanceof qa?o.cancel():i(e)})),o.then(e,t,n)},Ua.prototype.$goog_Thenable=!0,I(Ga,L),Ga.prototype.message="Deferred has already fired",Ga.prototype.name="AlreadyCalledError",I(qa,L),qa.prototype.message="Deferred was canceled",qa.prototype.name="CanceledError",Ka.prototype.c=function(){throw delete Ha[this.a],this.b};var Ha={};function za(e){var t={},n=t.document||document,r=Ae(e).toString(),i=mt(document,"SCRIPT"),o={Wb:i,Ma:void 0},a=new Ua(o),s=null,u=null!=t.timeout?t.timeout:5e3;return 0<u&&(s=window.setTimeout((function(){Qa(i,!0);var e=new $a(Ja,"Timeout reached for loading script "+r);Fa(a),ja(a,!1,e)}),u),o.Ma=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(Qa(i,t.xd||!1,s),Fa(a),ja(a,!0,null))},i.onerror=function(){Qa(i,!0,s);var e=new $a(Xa,"Error while loading script "+r);Fa(a),ja(a,!1,e)},ye(o=t.attributes||{},{type:"text/javascript",charset:"UTF-8"}),dt(i,o),function(e,t){_e(e,"HTMLScriptElement"),e.src=Ae(t),(t=e.ownerDocument&&e.ownerDocument.defaultView)&&t!=c?t=d(t.document):(null===l&&(l=d(c.document)),t=l),t&&e.setAttribute("nonce",t)}(i,e),function(e){var t;return(t=(e||document).getElementsByTagName("HEAD"))&&0!=t.length?t[0]:e.documentElement}(n).appendChild(i),a}function Ya(){if(this&&this.Wb){var e=this.Wb;e&&"SCRIPT"==e.tagName&&Qa(e,!0,this.Ma)}}function Qa(e,t,n){null!=n&&c.clearTimeout(n),e.onload=f,e.onerror=f,e.onreadystatechange=f,t&&window.setTimeout((function(){e&&e.parentNode&&e.parentNode.removeChild(e)}),0)}var Xa=0,Ja=1;function $a(e,t){var n="Jsloader error (code #"+e+")";t&&(n+=": "+t),L.call(this,n),this.code=e}function Za(e){this.f=e}function es(e,n,r){if(this.c=e,e=n||{},this.l=e.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=e.secureTokenTimeout||rs,this.g=me(e.secureTokenHeaders||is),this.h=e.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=e.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=e.firebaseTimeout||os,this.a=me(e.firebaseHeaders||as),r&&(this.a["X-Client-Version"]=r,this.g["X-Client-Version"]=r),r="Node"==Sr(),!(r=c.XMLHttpRequest||r&&t.a.INTERNAL.node&&t.a.INTERNAL.node.XMLHttpRequest)&&!Tr())throw new A("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,Tr()?this.f=new ga(self):Ir()?this.f=new Za(r):this.f=new ta,this.b=null}I($a,L),I(Za,Jo),Za.prototype.a=function(){return new this.f},Za.prototype.b=function(){return{}};var ts,ns="idToken",rs=new qr(3e4,6e4),is={"Content-Type":"application/x-www-form-urlencoded"},os=new qr(3e4,6e4),as={"Content-Type":"application/json"};function ss(e,t){t?e.a["X-Firebase-Locale"]=t:delete e.a["X-Firebase-Locale"]}function cs(e,t){t&&(e.l=us("https://securetoken.googleapis.com/v1/token",t),e.h=us("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",t),e.i=us("https://identitytoolkit.googleapis.com/v2/",t))}function us(e,t){return e=Bn(e),t=Bn(t.url),e.f=e.a+e.f,Mn(e,t.c),e.a=t.a,Un(e,t.g),e.toString()}function ls(e,t){t?(e.a["X-Client-Version"]=t,e.g["X-Client-Version"]=t):(delete e.a["X-Client-Version"],delete e.g["X-Client-Version"])}function ds(e,t,n,r,i,o,a){(function(){var e=Nr();return!((e=Cr(e)!=Ar?null:(e=e.match(/\sChrome\/(\d+)/i))&&2==e.length?parseInt(e[1],10):null)&&30>e)&&(!Qe||!ct||9<ct)})()||Tr()?e=w(e.u,e):(ts||(ts=new wt((function(e,t){!function(e,t){if(((window.gapi||{}).client||{}).request)e();else{c[hs]=function(){((window.gapi||{}).client||{}).request?e():t(Error("CORS_UNSUPPORTED"))},function(e,t){Va(e,null,t,void 0)}(za(Ce(fs,{onload:hs})),(function(){t(Error("CORS_UNSUPPORTED"))}))}}(e,t)}))),e=w(e.s,e)),e(t,n,r,i,o,a)}es.prototype.T=function(){return this.b},es.prototype.u=function(e,t,n,r,i,o){if(Tr()&&("undefined"===typeof c.fetch||"undefined"===typeof c.Headers||"undefined"===typeof c.Request))throw new A("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Ta(this.f);if(o){a.g=Math.max(0,o);var s=setTimeout((function(){a.dispatchEvent("timeout")}),o)}Sn(a,"complete",(function(){s&&clearTimeout(s);var e=null;try{e=JSON.parse(function(e){try{return e.a?e.a.responseText:""}catch(t){return ma(e.b,"Can not get responseText: "+t.message),""}}(this))||null}catch(n){e=null}t&&t(e)})),In(a,"ready",(function(){s&&clearTimeout(s),zt(this)})),In(a,"timeout",(function(){s&&clearTimeout(s),zt(this),t&&t(null)})),Aa(a,e,n,r,i)};var fs=new be(Se,"https://apis.google.com/js/client.js?onload=%{onload}"),hs="__fcb"+Math.floor(1e6*Math.random()).toString();function ps(e,t,n,r,i,o,a){var s=Bn(t+n);Fn(s,"key",e.c),a&&Fn(s,"cb",S().toString());var c="GET"==r;if(c)for(var u in i)i.hasOwnProperty(u)&&Fn(s,u,i[u]);return new wt((function(t,n){ds(e,s.toString(),(function(e){e?e.error?n(uc(e,o||{})):t(e):n(new A("network-request-failed"))}),r,c?void 0:or(Fr(i)),e.a,e.v.get())}))}function vs(e){if("string"!==typeof(e=e.email)||!_r.test(e))throw new A("invalid-email")}function ms(e){"email"in e&&vs(e)}function gs(e){if(!e[ns]){if(e.mfaPendingCredential)throw new A("multi-factor-auth-required",null,me(e));throw new A("internal-error")}}function ys(e){if(e.phoneNumber||e.temporaryProof){if(!e.phoneNumber||!e.temporaryProof)throw new A("internal-error")}else{if(!e.sessionInfo)throw new A("missing-verification-id");if(!e.code)throw new A("missing-verification-code")}}es.prototype.s=function(e,t,n,r,i){var o=this;ts.then((function(){window.gapi.client.setApiKey(o.c);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:e,method:n,body:r,headers:i,authType:"none",callback:function(e){window.gapi.auth.setToken(a),t&&t(e)}})})).o((function(e){t&&t({error:{message:e&&e.message||"CORS_UNSUPPORTED"}})}))},es.prototype.zb=function(){return sc(this,Qs,{})},es.prototype.Bb=function(e,t){return sc(this,zs,{idToken:e,email:t})},es.prototype.Cb=function(e,t){return sc(this,Ys,{idToken:e,password:t})};var _s={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};function bs(e){if(!e.phoneVerificationInfo)throw new A("internal-error");if(!e.phoneVerificationInfo.sessionInfo)throw new A("missing-verification-id");if(!e.phoneVerificationInfo.code)throw new A("missing-verification-code")}function Es(e){if(!e.requestUri||!e.sessionId&&!e.postBody&&!e.pendingToken)throw new A("internal-error")}function ws(e,t){return t.oauthIdToken&&t.providerId&&0==t.providerId.indexOf("oidc.")&&!t.pendingToken&&(e.sessionId?t.nonce=e.sessionId:e.postBody&&(tr(e=new Jn(e.postBody),"nonce")&&(t.nonce=e.get("nonce")))),t}function Ts(e){var t=null;if(e.needConfirmation?(e.code="account-exists-with-different-credential",t=Xo(e)):"FEDERATED_USER_ID_ALREADY_LINKED"==e.errorMessage?(e.code="credential-already-in-use",t=Xo(e)):"EMAIL_EXISTS"==e.errorMessage?(e.code="email-already-in-use",t=Xo(e)):e.errorMessage&&(t=cc(e.errorMessage)),t)throw t;gs(e)}function Ss(e,t){return t.returnIdpCredential=!0,sc(e,$s,t)}function Is(e,t){return t.returnIdpCredential=!0,sc(e,ec,t)}function Rs(e,t){return t.returnIdpCredential=!0,t.autoCreate=!1,sc(e,Zs,t)}function As(e){if(!e.oobCode)throw new A("invalid-action-code")}(n=es.prototype).Db=function(e,t){var n={idToken:e},r=[];return pe(_s,(function(e,i){var o=t[i];null===o?r.push(e):i in t&&(n[i]=o)})),r.length&&(n.deleteAttribute=r),sc(this,zs,n)},n.vb=function(e,t){return ye(e={requestType:"PASSWORD_RESET",email:e},t),sc(this,Ws,e)},n.wb=function(e,t){return ye(e={requestType:"EMAIL_SIGNIN",email:e},t),sc(this,Fs,e)},n.ub=function(e,t){return ye(e={requestType:"VERIFY_EMAIL",idToken:e},t),sc(this,Vs,e)},n.Eb=function(e,t,n){return ye(e={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:e,newEmail:t},n),sc(this,Bs,e)},n.fb=function(e){return sc(this,rc,e)},n.nb=function(e,t){return sc(this,Ks,{oobCode:e,newPassword:t})},n.Ra=function(e){return sc(this,ks,{oobCode:e})},n.jb=function(e){return sc(this,Cs,{oobCode:e})};var Cs={endpoint:"setAccountInfo",A:As,Z:"email",B:!0},ks={endpoint:"resetPassword",A:As,G:function(e){var t=e.requestType;if(!t||!e.email&&"EMAIL_SIGNIN"!=t&&"VERIFY_AND_CHANGE_EMAIL"!=t)throw new A("internal-error")},B:!0},Os={endpoint:"signupNewUser",A:function(e){if(vs(e),!e.password)throw new A("weak-password")},G:gs,V:!0,B:!0},Ns={endpoint:"createAuthUri",B:!0},Ps={endpoint:"deleteAccount",N:["idToken"]},Ds={endpoint:"setAccountInfo",N:["idToken","deleteProvider"],A:function(e){if(!Array.isArray(e.deleteProvider))throw new A("internal-error")}},xs={endpoint:"emailLinkSignin",N:["email","oobCode"],A:vs,G:gs,V:!0,B:!0},Ls={endpoint:"emailLinkSignin",N:["idToken","email","oobCode"],A:vs,G:gs,V:!0},Ms={endpoint:"accounts/mfaEnrollment:finalize",N:["idToken","phoneVerificationInfo"],A:bs,G:gs,B:!0,Na:!0},Us={endpoint:"accounts/mfaSignIn:finalize",N:["mfaPendingCredential","phoneVerificationInfo"],A:bs,G:gs,B:!0,Na:!0},js={endpoint:"getAccountInfo"},Fs={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(e){if("EMAIL_SIGNIN"!=e.requestType)throw new A("internal-error");vs(e)},Z:"email",B:!0},Vs={endpoint:"getOobConfirmationCode",N:["idToken","requestType"],A:function(e){if("VERIFY_EMAIL"!=e.requestType)throw new A("internal-error")},Z:"email",B:!0},Bs={endpoint:"getOobConfirmationCode",N:["idToken","newEmail","requestType"],A:function(e){if("VERIFY_AND_CHANGE_EMAIL"!=e.requestType)throw new A("internal-error")},Z:"email",B:!0},Ws={endpoint:"getOobConfirmationCode",N:["requestType"],A:function(e){if("PASSWORD_RESET"!=e.requestType)throw new A("internal-error");vs(e)},Z:"email",B:!0},Gs={lb:!0,endpoint:"getProjectConfig",Ub:"GET"},qs={lb:!0,endpoint:"getRecaptchaParam",Ub:"GET",G:function(e){if(!e.recaptchaSiteKey)throw new A("internal-error")}},Ks={endpoint:"resetPassword",A:As,Z:"email",B:!0},Hs={endpoint:"sendVerificationCode",N:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},zs={endpoint:"setAccountInfo",N:["idToken"],A:ms,V:!0},Ys={endpoint:"setAccountInfo",N:["idToken"],A:function(e){if(ms(e),!e.password)throw new A("weak-password")},G:gs,V:!0},Qs={endpoint:"signupNewUser",G:gs,V:!0,B:!0},Xs={endpoint:"accounts/mfaEnrollment:start",N:["idToken","phoneEnrollmentInfo"],A:function(e){if(!e.phoneEnrollmentInfo)throw new A("internal-error");if(!e.phoneEnrollmentInfo.phoneNumber)throw new A("missing-phone-number");if(!e.phoneEnrollmentInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(e){if(!e.phoneSessionInfo||!e.phoneSessionInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},Js={endpoint:"accounts/mfaSignIn:start",N:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(e){if(!e.phoneSignInInfo||!e.phoneSignInInfo.recaptchaToken)throw new A("missing-app-credential")},G:function(e){if(!e.phoneResponseInfo||!e.phoneResponseInfo.sessionInfo)throw new A("internal-error")},B:!0,Na:!0},$s={endpoint:"verifyAssertion",A:Es,Ya:ws,G:Ts,V:!0,B:!0},Zs={endpoint:"verifyAssertion",A:Es,Ya:ws,G:function(e){if(e.errorMessage&&"USER_NOT_FOUND"==e.errorMessage)throw new A("user-not-found");if(e.errorMessage)throw cc(e.errorMessage);gs(e)},V:!0,B:!0},ec={endpoint:"verifyAssertion",A:function(e){if(Es(e),!e.idToken)throw new A("internal-error")},Ya:ws,G:Ts,V:!0},tc={endpoint:"verifyCustomToken",A:function(e){if(!e.token)throw new A("invalid-custom-token")},G:gs,V:!0,B:!0},nc={endpoint:"verifyPassword",A:function(e){if(vs(e),!e.password)throw new A("wrong-password")},G:gs,V:!0,B:!0},rc={endpoint:"verifyPhoneNumber",A:ys,G:gs,B:!0},ic={endpoint:"verifyPhoneNumber",A:function(e){if(!e.idToken)throw new A("internal-error");ys(e)},G:function(e){if(e.temporaryProof)throw e.code="credential-already-in-use",Xo(e);gs(e)}},oc={Hb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:ys,G:gs,B:!0},ac={endpoint:"accounts/mfaEnrollment:withdraw",N:["idToken","mfaEnrollmentId"],G:function(e){if(!!e[ns]^!!e.refreshToken)throw new A("internal-error")},B:!0,Na:!0};function sc(e,t,n){if(!function(e,t){if(!t||!t.length)return!0;if(!e)return!1;for(var n=0;n<t.length;n++){var r=e[t[n]];if(void 0===r||null===r||""===r)return!1}return!0}(n,t.N))return Ot(new A("internal-error"));var r,i=!!t.Na,o=t.Ub||"POST";return kt(n).then(t.A).then((function(){return t.V&&(n.returnSecureToken=!0),t.B&&e.b&&"undefined"===typeof n.tenantId&&(n.tenantId=e.b),ps(e,i?e.i:e.h,t.endpoint,o,n,t.Hb,t.lb||!1)})).then((function(e){return r=e,t.Ya?t.Ya(n,r):r})).then(t.G).then((function(){if(!t.Z)return r;if(!(t.Z in r))throw new A("internal-error");return r[t.Z]}))}function cc(e){return uc({error:{errors:[{message:e}],code:400,message:e}})}function uc(e,t){var n=(e.error&&e.error.errors&&e.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new A(r[n]):null)return n;for(var i in n=e.error&&e.error.message||"",ye(r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},t||{}),t=(t=n.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<t.length?t[1]:void 0,r)if(0===n.indexOf(i))return new A(r[i],t);return!t&&e&&(t=jr(e)),new A("internal-error",t)}function lc(e){this.b=e,this.a=null,this.rb=function(e){return(pc||(pc=new wt((function(e,t){function n(){Gr(),Pr("gapi.load")("gapi.iframes",{callback:e,ontimeout:function(){Gr(),t(Error("Network Error"))},timeout:fc.get()})}if(Pr("gapi.iframes.Iframe"))e();else if(Pr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();c[r]=function(){Pr("gapi.load")?n():t(Error("Network Error"))},kt(za(r=Ce(dc,{onload:r}))).o((function(){t(Error("Network Error"))}))}})).o((function(e){throw pc=null,e})))).then((function(){return new wt((function(t,n){Pr("gapi.iframes.getContext")().open({where:document.body,url:e.b,messageHandlersFilter:Pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},(function(r){function i(){clearTimeout(o),t()}e.a=r,e.a.restyle({setHideOnLeave:!1});var o=setTimeout((function(){n(Error("Network Error"))}),hc.get());r.ping(i).then(i,(function(){n(Error("Network Error"))}))}))}))}))}(this)}var dc=new be(Se,"https://apis.google.com/js/api.js?onload=%{onload}"),fc=new qr(3e4,6e4),hc=new qr(5e3,15e3),pc=null;function vc(e,t,n,r){this.l=e,this.h=t,this.i=n,this.g=r,this.f=null,this.g?e=Wn((e=Bn(this.g.url)).c,e.a,e.g,"/emulator/auth/iframe"):e=Wn("https",this.l,null,"/__/auth/iframe"),this.a=e,Fn(this.a,"apiKey",this.h),Fn(this.a,"appName",this.i),this.b=null,this.c=[]}function mc(e,t,n,r,i,o){this.u=e,this.s=t,this.c=n,this.m=r,this.v=o,this.i=this.g=this.l=null,this.a=i,this.h=this.f=null}function gc(e){try{return t.a.app(e).auth().Ga()}catch(n){return[]}}function yc(e,t,n,r,i,o){this.s=e,this.g=t,this.b=n,this.f=o,this.c=r||null,this.i=i||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function _c(e){var t=fr();return function(e){return sc(e,Gs,{}).then((function(e){return e.authorizedDomains||[]}))}(e).then((function(e){e:{var n=Bn(t),r=n.c;n=n.a;for(var i=0;i<e.length;i++){var o=e[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=Bn(o).a==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:yr.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){e=!0;break e}}e=!1}if(!e)throw new Yo(fr())}))}function bc(e){return e.m||(e.m=br().then((function(){if(!e.u){var t=e.c,n=e.i,r=gc(e.b),i=new vc(e.s,e.g,e.b,e.f);i.f=t,i.b=n,i.c=Z(r||[]),e.u=i.toString()}e.v=new lc(e.u),function(e){if(!e.v)throw Error("IfcHandler must be initialized!");!function(e,t){e.rb.then((function(){e.a.register("authEvent",t,Pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}(e.v,(function(t){var n={};if(t&&t.authEvent){var r=!1;for(t=qo(t.authEvent),n=0;n<e.h.length;n++)r=e.h[n](t)||r;return(n={}).status=r?"ACK":"ERROR",kt(n)}return n.status="ERROR",kt(n)}))}(e)}))),e.m}function Ec(e){return e.l||(e.C=e.c?Or(e.c,gc(e.b)):null,e.l=new es(e.g,D(e.i),e.C),e.f&&cs(e.l,e.f)),e.l}function wc(e,t,n,r,i,o,a,s,c,u,l,d){return(e=new mc(e,t,n,r,i,d)).l=o,e.g=a,e.i=s,e.b=me(c||null),e.f=u,e.yb(l).toString()}function Tc(e){if(this.a=e||t.a.INTERNAL.reactNative&&t.a.INTERNAL.reactNative.AsyncStorage,!this.a)throw new A("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function Sc(e){this.b=e,this.a={},this.f=w(this.c,this)}vc.prototype.toString=function(){return this.f?Fn(this.a,"v",this.f):er(this.a.b,"v"),this.b?Fn(this.a,"eid",this.b):er(this.a.b,"eid"),this.c.length?Fn(this.a,"fw",this.c.join(",")):er(this.a.b,"fw"),this.a.toString()},mc.prototype.yb=function(e){return this.h=e,this},mc.prototype.toString=function(){if(this.v){var e=Bn(this.v.url);e=Wn(e.c,e.a,e.g,"/emulator/auth/handler")}else e=Wn("https",this.u,null,"/__/auth/handler");if(Fn(e,"apiKey",this.s),Fn(e,"appName",this.c),Fn(e,"authType",this.m),this.a.isOAuthProvider){var n=this.a;try{var r=t.a.app(this.c).auth().la()}catch(c){r=null}for(var i in n.ob=r,Fn(e,"providerId",this.a.providerId),n=Fr((r=this.a).Ib))n[i]=n[i].toString();i=r.Qc,n=me(n);for(var o=0;o<i.length;o++){var a=i[o];a in n&&delete n[a]}r.pb&&r.ob&&!n[r.pb]&&(n[r.pb]=r.ob),ve(n)||Fn(e,"customParameters",jr(n))}if("function"===typeof this.a.Qb&&((r=this.a.Qb()).length&&Fn(e,"scopes",r.join(","))),this.l?Fn(e,"redirectUrl",this.l):er(e.b,"redirectUrl"),this.g?Fn(e,"eventId",this.g):er(e.b,"eventId"),this.i?Fn(e,"v",this.i):er(e.b,"v"),this.b)for(var s in this.b)this.b.hasOwnProperty(s)&&!Vn(e,s)&&Fn(e,s,this.b[s]);return this.h?Fn(e,"tid",this.h):er(e.b,"tid"),this.f?Fn(e,"eid",this.f):er(e.b,"eid"),(s=gc(this.c)).length&&Fn(e,"fw",s.join(",")),e.toString()},(n=yc.prototype).Ob=function(e,t,n){var r=new A("popup-closed-by-user"),i=new A("web-storage-unsupported"),o=this,a=!1;return this.ma().then((function(){(function(e){var t={type:"webStorageSupport"};return bc(e).then((function(){return function(e,t){return e.rb.then((function(){return new wt((function(n){e.a.send(t.type,t,n,Pr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))}))}))}(e.v,t)})).then((function(e){if(e&&e.length&&"undefined"!==typeof e[0].webStorageSupport)return e[0].webStorageSupport;throw Error()}))})(o).then((function(n){n||(e&&mr(e),t(i),a=!0)}))})).o((function(){})).then((function(){if(!a)return function(e){return new wt((function(t){return function n(){Cn(2e3).then((function(){if(e&&!e.closed)return n();t()}))}()}))}(e)})).then((function(){if(!a)return Cn(n).then((function(){t(r)}))}))},n.Xb=function(){var e=Nr();return!Ur(e)&&!Wr(e)},n.Tb=function(){return!1},n.Mb=function(e,t,n,r,i,o,a,s){if(!e)return Ot(new A("popup-blocked"));if(a&&!Ur())return this.ma().o((function(t){mr(e),i(t)})),r(),kt();this.a||(this.a=_c(Ec(this)));var c=this;return this.a.then((function(){var t=c.ma().o((function(t){throw mr(e),i(t),t}));return r(),t})).then((function(){(Wo(n),a)||hr(wc(c.s,c.g,c.b,t,n,null,o,c.c,void 0,c.i,s,c.f),e)})).o((function(e){throw"auth/network-request-failed"==e.code&&(c.a=null),e}))},n.Nb=function(e,t,n,r){this.a||(this.a=_c(Ec(this)));var i=this;return this.a.then((function(){Wo(t),hr(wc(i.s,i.g,i.b,e,t,fr(),n,i.c,void 0,i.i,r,i.f))})).o((function(e){throw"auth/network-request-failed"==e.code&&(i.a=null),e}))},n.ma=function(){var e=this;return bc(this).then((function(){return e.v.rb})).o((function(){throw e.a=null,new A("network-request-failed")}))},n.$b=function(){return!0},n.Ea=function(e){this.h.push(e)},n.Sa=function(e){J(this.h,(function(t){return t==e}))},(n=Tc.prototype).get=function(e){return kt(this.a.getItem(e)).then((function(e){return e&&Vr(e)}))},n.set=function(e,t){return kt(this.a.setItem(e,jr(t)))},n.U=function(e){return kt(this.a.removeItem(e))},n.ca=function(){},n.ia=function(){};var Ic,Rc=[];function Ac(e,t,n){ve(e.a)&&e.b.addEventListener("message",e.f),"undefined"===typeof e.a[t]&&(e.a[t]=[]),e.a[t].push(n)}function Cc(e){this.a=e}function kc(e){this.c=e,this.b=!1,this.a=[]}function Oc(e,t,n,r){var i,o,a,s,c=n||{},u=null;if(e.b)return Ot(Error("connection_unavailable"));var l=r?800:50,d="undefined"!==typeof MessageChannel?new MessageChannel:null;return new wt((function(n,r){d?(i=Math.floor(Math.random()*Math.pow(10,20)).toString(),d.port1.start(),a=setTimeout((function(){r(Error("unsupported_event"))}),l),u={messageChannel:d,onMessage:o=function(e){e.data.eventId===i&&("ack"===e.data.status?(clearTimeout(a),s=setTimeout((function(){r(Error("timeout"))}),3e3)):"done"===e.data.status?(clearTimeout(s),"undefined"!==typeof e.data.response?n(e.data.response):r(Error("unknown_error"))):(clearTimeout(a),clearTimeout(s),r(Error("invalid_response"))))}},e.a.push(u),d.port1.addEventListener("message",o),e.c.postMessage({eventType:t,eventId:i,data:c},[d.port2])):r(Error("connection_unavailable"))})).then((function(t){return Nc(e,u),t})).o((function(t){throw Nc(e,u),t}))}function Nc(e,t){if(t){var n=t.messageChannel,r=t.onMessage;n&&(n.port1.removeEventListener("message",r),n.port1.close()),J(e.a,(function(e){return e==t}))}}function Pc(){if(!Mc())throw new A("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=c.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var e=this;Tr()&&self?(this.v=function(){var e=Tr()?self:null;if(K(Rc,(function(n){n.b==e&&(t=n)})),!t){var t=new Sc(e);Rc.push(t)}return t}(),Ac(this.v,"keyChanged",(function(t,n){return Bc(e).then((function(t){return 0<t.length&&K(e.a,(function(e){e(t)})),{keyProcessed:Q(t,n.key)}}))})),Ac(this.v,"ping",(function(){return kt(["keyChanged"])}))):function(){var e=c.navigator;return e&&e.serviceWorker?kt().then((function(){return e.serviceWorker.ready})).then((function(e){return e.active||null})).o((function(){return null})):kt(null)}().then((function(t){(e.h=t)&&(e.g=new kc(new Cc(t)),Oc(e.g,"ping",null,!0).then((function(t){t[0].fulfilled&&Q(t[0].value,"keyChanged")&&(e.s=!0)})).o((function(){})))}))}function Dc(e){return new wt((function(t,n){var r=e.m.open("firebaseLocalStorageDb",1);r.onerror=function(e){try{e.preventDefault()}catch(t){}n(Error(e.target.error))},r.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){(r=r.target.result).objectStoreNames.contains("firebaseLocalStorage")?t(r):function(e){return new wt((function(t,n){var r=e.m.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){t()},r.onerror=function(e){n(Error(e.target.error))}}))}(e).then((function(){return Dc(e)})).then((function(e){t(e)})).o((function(e){n(e)}))}}))}function xc(e){return e.i||(e.i=Dc(e)),e.i}function Lc(e,t){var n=0;return new wt((function r(i,o){xc(e).then(t).then(i).o((function(t){if(!(3<++n))return xc(e).then((function(t){return t.close(),e.i=void 0,r(i,o)})).o((function(e){o(e)}));o(t)}))}))}function Mc(){try{return!!c.indexedDB}catch(fa){return!1}}function Uc(e){return e.objectStore("firebaseLocalStorage")}function jc(e,t){return e.transaction(["firebaseLocalStorage"],t?"readwrite":"readonly")}function Fc(e){return new wt((function(t,n){e.onsuccess=function(e){e&&e.target?t(e.target.result):t()},e.onerror=function(e){n(e.target.error)}}))}function Vc(e,t){return e.g&&e.h&&function(){var e=c.navigator;return e&&e.serviceWorker&&e.serviceWorker.controller||null}()===e.h?Oc(e.g,"keyChanged",{key:t},e.s).then((function(){})).o((function(){})):kt()}function Bc(e){return xc(e).then((function(e){var t=Uc(jc(e,!1));return t.getAll?Fc(t.getAll()):new wt((function(e,n){var r=[],i=t.openCursor();i.onsuccess=function(t){(t=t.target.result)?(r.push(t.value),t.continue()):e(r)},i.onerror=function(e){n(e.target.error)}}))})).then((function(t){var n={},r=[];if(0==e.b){for(r=0;r<t.length;r++)n[t[r].fbase_key]=t[r].value;r=pr(e.c,n),e.c=n}return r}))}function Wc(e){e.l&&e.l.cancel("STOP_EVENT"),e.f&&(clearTimeout(e.f),e.f=null)}function Gc(e){var t=this,n=null;this.a=[],this.type="indexedDB",this.c=e,this.b=kt().then((function(){if(Mc()){var e=Br(),r="__sak"+e;return Ic||(Ic=new Pc),(n=Ic).set(r,e).then((function(){return n.get(r)})).then((function(t){if(t!==e)throw Error("indexedDB not supported!");return n.U(r)})).then((function(){return n})).o((function(){return t.c}))}return t.c})).then((function(e){return t.type=e.type,e.ca((function(e){K(t.a,(function(t){t(e)}))})),e}))}function qc(){this.a={},this.type="inMemory"}function Kc(){if(!function(){var e="Node"==Sr();if(!(e=Hc()||e&&t.a.INTERNAL.node&&t.a.INTERNAL.node.localStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(n){return!1}}()){if("Node"==Sr())throw new A("internal-error","The LocalStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Hc()||t.a.INTERNAL.node.localStorage,this.type="localStorage"}function Hc(){try{var e=c.localStorage,t=Br();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function zc(){this.type="nullStorage"}function Yc(){if(!function(){var e="Node"==Sr();if(!(e=Qc()||e&&t.a.INTERNAL.node&&t.a.INTERNAL.node.sessionStorage))return!1;try{return e.setItem("__sak","1"),e.removeItem("__sak"),!0}catch(n){return!1}}()){if("Node"==Sr())throw new A("internal-error","The SessionStorage compatibility library was not found.");throw new A("web-storage-unsupported")}this.a=Qc()||t.a.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function Qc(){try{var e=c.sessionStorage,t=Br();return e&&(e.setItem(t,"1"),e.removeItem(t)),e}catch(n){return null}}function Xc(){var e={};e.Browser=Zc,e.Node=eu,e.ReactNative=tu,e.Worker=nu,this.a=e[Sr()]}Sc.prototype.c=function(e){var t=e.data.eventType,n=e.data.eventId,r=this.a[t];if(r&&0<r.length){e.ports[0].postMessage({status:"ack",eventId:n,eventType:t,response:null});var i=[];K(r,(function(t){i.push(kt().then((function(){return t(e.origin,e.data.data)})))})),Pt(i).then((function(r){var i=[];K(r,(function(e){i.push({fulfilled:e.Pb,value:e.value,reason:e.reason?e.reason.message:void 0})})),K(i,(function(e){for(var t in e)"undefined"===typeof e[t]&&delete e[t]})),e.ports[0].postMessage({status:"done",eventId:n,eventType:t,response:i})}))}},Cc.prototype.postMessage=function(e,t){this.a.postMessage(e,t)},kc.prototype.close=function(){for(;0<this.a.length;)Nc(this,this.a[0]);this.b=!0},(n=Pc.prototype).set=function(e,t){var n=this,r=!1;return Lc(this,(function(t){return Fc((t=Uc(jc(t,!0))).get(e))})).then((function(i){return Lc(n,(function(o){if(o=Uc(jc(o,!0)),i)return i.value=t,Fc(o.put(i));n.b++,r=!0;var a={};return a.fbase_key=e,a.value=t,Fc(o.add(a))}))})).then((function(){return n.c[e]=t,Vc(n,e)})).oa((function(){r&&n.b--}))},n.get=function(e){return Lc(this,(function(t){return Fc(Uc(jc(t,!1)).get(e))})).then((function(e){return e&&e.value}))},n.U=function(e){var t=this,n=!1;return Lc(this,(function(r){return n=!0,t.b++,Fc(Uc(jc(r,!0)).delete(e))})).then((function(){return delete t.c[e],Vc(t,e)})).oa((function(){n&&t.b--}))},n.ca=function(e){0==this.a.length&&function(e){function t(){e.f=setTimeout((function(){e.l=Bc(e).then((function(t){0<t.length&&K(e.a,(function(e){e(t)}))})).then((function(){t()})).o((function(e){"STOP_EVENT"!=e.message&&t()}))}),800)}Wc(e),t()}(this),this.a.push(e)},n.ia=function(e){J(this.a,(function(t){return t==e})),0==this.a.length&&Wc(this)},(n=Gc.prototype).get=function(e){return this.b.then((function(t){return t.get(e)}))},n.set=function(e,t){return this.b.then((function(n){return n.set(e,t)}))},n.U=function(e){return this.b.then((function(t){return t.U(e)}))},n.ca=function(e){this.a.push(e)},n.ia=function(e){J(this.a,(function(t){return t==e}))},(n=qc.prototype).get=function(e){return kt(this.a[e])},n.set=function(e,t){return this.a[e]=t,kt()},n.U=function(e){return delete this.a[e],kt()},n.ca=function(){},n.ia=function(){},(n=Kc.prototype).get=function(e){var t=this;return kt().then((function(){return Vr(t.a.getItem(e))}))},n.set=function(e,t){var n=this;return kt().then((function(){var r=jr(t);null===r?n.U(e):n.a.setItem(e,r)}))},n.U=function(e){var t=this;return kt().then((function(){t.a.removeItem(e)}))},n.ca=function(e){c.window&&dn(c.window,"storage",e)},n.ia=function(e){c.window&&pn(c.window,"storage",e)},(n=zc.prototype).get=function(){return kt(null)},n.set=function(){return kt()},n.U=function(){return kt()},n.ca=function(){},n.ia=function(){},(n=Yc.prototype).get=function(e){var t=this;return kt().then((function(){return Vr(t.a.getItem(e))}))},n.set=function(e,t){var n=this;return kt().then((function(){var r=jr(t);null===r?n.U(e):n.a.setItem(e,r)}))},n.U=function(e){var t=this;return kt().then((function(){t.a.removeItem(e)}))},n.ca=function(){},n.ia=function(){};var Jc,$c,Zc={F:Kc,bb:Yc},eu={F:Kc,bb:Yc},tu={F:Tc,bb:zc},nu={F:Kc,bb:zc},ru={rd:"local",NONE:"none",td:"session"};function iu(){var e=!(Wr(Nr())||!wr()),t=Ur(),n=Dr();this.m=e,this.h=t,this.l=n,this.a={},Jc||(Jc=new Xc),e=Jc;try{this.g=!dr()&&zr()||!c.indexedDB?new e.a.F:new Gc(Tr()?new qc:new e.a.F)}catch(r){this.g=new qc,this.h=!0}try{this.i=new e.a.bb}catch(r){this.i=new qc}this.v=new qc,this.f=w(this.Yb,this),this.b={}}function ou(){return $c||($c=new iu),$c}function au(e,t){switch(t){case"session":return e.i;case"none":return e.v;default:return e.g}}function su(e,t){return"firebase:"+e.name+(t?":"+t:"")}function cu(e,t,n){return n=su(t,n),"local"==t.F&&(e.b[n]=null),au(e,t.F).U(n)}function uu(e){e.c&&(clearInterval(e.c),e.c=null)}function lu(e){this.a=e,this.b=ou()}(n=iu.prototype).get=function(e,t){return au(this,e.F).get(su(e,t))},n.set=function(e,t,n){var r=su(e,n),i=this,o=au(this,e.F);return o.set(r,t).then((function(){return o.get(r)})).then((function(t){"local"==e.F&&(i.b[r]=t)}))},n.addListener=function(e,t,n){e=su(e,t),this.l&&(this.b[e]=c.localStorage.getItem(e)),ve(this.a)&&(au(this,"local").ca(this.f),this.h||(dr()||!zr())&&c.indexedDB||!this.l||function(e){uu(e),e.c=setInterval((function(){for(var t in e.a){var n=c.localStorage.getItem(t),r=e.b[t];n!=r&&(e.b[t]=n,n=new Zt({type:"storage",key:t,target:window,oldValue:r,newValue:n,a:!0}),e.Yb(n))}}),1e3)}(this)),this.a[e]||(this.a[e]=[]),this.a[e].push(n)},n.removeListener=function(e,t,n){e=su(e,t),this.a[e]&&(J(this.a[e],(function(e){return e==n})),0==this.a[e].length&&delete this.a[e]),ve(this.a)&&(au(this,"local").ia(this.f),uu(this))},n.Yb=function(e){if(e&&e.g){var t=e.a.key;if(null==t)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=c.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.mb(n))}else if(0==t.indexOf("firebase:")&&this.a[t]){if("undefined"!==typeof e.a.a?au(this,"local").ia(this.f):uu(this),this.m)if(n=c.localStorage.getItem(t),(r=e.a.newValue)!==n)null!==r?c.localStorage.setItem(t,r):c.localStorage.removeItem(t);else if(this.b[t]===r&&"undefined"===typeof e.a.a)return;var o=this;n=function(){"undefined"===typeof e.a.a&&o.b[t]===c.localStorage.getItem(t)||(o.b[t]=c.localStorage.getItem(t),o.mb(t))},Qe&&ct&&10==ct&&c.localStorage.getItem(t)!==e.a.newValue&&e.a.newValue!==e.a.oldValue?setTimeout(n,10):n()}}else K(e,w(this.mb,this))},n.mb=function(e){this.a[e]&&K(this.a[e],(function(e){e()}))};var du,fu={name:"authEvent",F:"local"};function hu(){this.a=ou()}function pu(e,t){this.b=vu,this.f=c.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=e,this.h=t,this.l=c.Int32Array?new Int32Array(64):Array(64),void 0===du&&(du=c.Int32Array?new Int32Array(wu):wu),this.reset()}I(pu,(function(){this.b=-1}));for(var vu=64,mu=vu-1,gu=[],yu=0;yu<mu;yu++)gu[yu]=0;var _u=$(128,gu);function bu(e){for(var t=e.f,n=e.l,r=0,i=0;i<t.length;)n[r++]=t[i]<<24|t[i+1]<<16|t[i+2]<<8|t[i+3],i=4*r;for(t=16;64>t;t++){i=0|n[t-15],r=0|n[t-2];var o=(0|n[t-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[t-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[t]=o+a|0}r=0|e.a[0],i=0|e.a[1];var s=0|e.a[2],c=0|e.a[3],u=0|e.a[4],l=0|e.a[5],d=0|e.a[6];for(o=0|e.a[7],t=0;64>t;t++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=(o=o+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))|0)+((a=(a=u&l^~u&d)+(0|du[t])|0)+(0|n[t])|0)|0,o=d,d=l,l=u,u=c+a|0,c=s,s=i,i=r,r=a+f|0}e.a[0]=e.a[0]+r|0,e.a[1]=e.a[1]+i|0,e.a[2]=e.a[2]+s|0,e.a[3]=e.a[3]+c|0,e.a[4]=e.a[4]+u|0,e.a[5]=e.a[5]+l|0,e.a[6]=e.a[6]+d|0,e.a[7]=e.a[7]+o|0}function Eu(e,t,n){void 0===n&&(n=t.length);var r=0,i=e.c;if("string"===typeof t)for(;r<n;)e.f[i++]=t.charCodeAt(r++),i==e.b&&(bu(e),i=0);else{if(!p(t))throw Error("message must be string or array");for(;r<n;){var o=t[r++];if(!("number"==typeof o&&0<=o&&255>=o&&o==(0|o)))throw Error("message must be a byte array");e.f[i++]=o,i==e.b&&(bu(e),i=0)}}e.c=i,e.g+=n}pu.prototype.reset=function(){this.g=this.c=0,this.a=c.Int32Array?new Int32Array(this.h):Z(this.h)};var wu=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Tu(){pu.call(this,8,Su)}I(Tu,pu);var Su=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function Iu(e,t,n,r,i,o){this.v=e,this.i=t,this.l=n,this.m=r||null,this.u=i||null,this.s=o,this.h=t+":"+n,this.C=new hu,this.g=new lu(this.h),this.f=null,this.b=[],this.a=this.c=null}function Ru(e){return new A("invalid-cordova-configuration",e)}function Au(e){var t=new Tu;Eu(t,e),e=[];var n=8*t.g;56>t.c?Eu(t,_u,56-t.c):Eu(t,_u,t.b-(t.c-56));for(var r=63;56<=r;r--)t.f[r]=255&n,n/=256;for(bu(t),r=n=0;r<t.i;r++)for(var i=24;0<=i;i-=8)e[n++]=t.a[r]>>i&255;return function(e){return z(e,(function(e){return 1<(e=e.toString(16)).length?e:"0"+e})).join("")}(e)}function Cu(e,t){for(var n=0;n<e.b.length;n++)try{e.b[n](t)}catch(r){}}function ku(e){return e.f||(e.f=e.ma().then((function(){return new wt((function(t){e.Ea((function n(r){return t(r),e.Sa(n),!1})),function(e){function t(t){r=!0,i&&i.cancel(),Ou(e).then((function(r){var i=n;if(r&&t&&t.url){var o=null;-1!=(i=so(t.url)).indexOf("/__/auth/callback")&&(o=(o="object"===typeof(o=Vr(Vn(o=Bn(i),"firebaseError")||null))?C(o):null)?new Go(r.c,r.b,null,null,o,null,r.T()):new Go(r.c,r.b,i,r.f,null,null,r.T())),i=o||n}Cu(e,i)}))}var n=new Go("unknown",null,null,null,new A("no-auth-event")),r=!1,i=Cn(500).then((function(){return Ou(e).then((function(){r||Cu(e,n)}))})),o=c.handleOpenURL;c.handleOpenURL=function(e){if(0==e.toLowerCase().indexOf(Pr("BuildInfo.packageName",c).toLowerCase()+"://")&&t({url:e}),"function"===typeof o)try{o(e)}catch(n){console.error(n)}},zo||(zo=new Ko),function(e){var t=zo;t.a.push(e),t.b||(t.b=function(e){for(var n=0;n<t.a.length;n++)t.a[n](e)},"function"===typeof(e=Pr("universalLinks.subscribe",c))&&e(null,t.b))}(t)}(e)}))}))),e.f}function Ou(e){var t=null;return function(e){return e.b.get(fu,e.a).then((function(e){return qo(e)}))}(e.g).then((function(n){return t=n,cu((n=e.g).b,fu,n.a)})).then((function(){return t}))}function Nu(e){this.a=e,this.b=ou()}(n=Iu.prototype).ma=function(){return this.Ia?this.Ia:this.Ia=(Er(void 0)?br().then((function(){return new wt((function(e,t){var n=c.document,r=setTimeout((function(){t(Error("Cordova framework is not ready."))}),1e3);n.addEventListener("deviceready",(function(){clearTimeout(r),e()}),!1)}))})):Ot(Error("Cordova must run in an Android or iOS file scheme."))).then((function(){if("function"!==typeof Pr("universalLinks.subscribe",c))throw Ru("cordova-universal-links-plugin-fix is not installed");if("undefined"===typeof Pr("BuildInfo.packageName",c))throw Ru("cordova-plugin-buildinfo is not installed");if("function"!==typeof Pr("cordova.plugins.browsertab.openUrl",c))throw Ru("cordova-plugin-browsertab is not installed");if("function"!==typeof Pr("cordova.InAppBrowser.open",c))throw Ru("cordova-plugin-inappbrowser is not installed")}),(function(){throw new A("cordova-not-ready")}))},n.Ob=function(e,t){return t(new A("operation-not-supported-in-this-environment")),kt()},n.Mb=function(){return Ot(new A("operation-not-supported-in-this-environment"))},n.$b=function(){return!1},n.Xb=function(){return!0},n.Tb=function(){return!0},n.Nb=function(e,t,n,r){if(this.c)return Ot(new A("redirect-operation-pending"));var i=this,o=c.document,a=null,s=null,u=null,l=null;return this.c=kt().then((function(){return Wo(t),ku(i)})).then((function(){return function(e,t,n,r,i){var o=function(){for(var e=20,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}(),a=new Go(t,r,null,o,new A("no-auth-event"),null,i),s=Pr("BuildInfo.packageName",c);if("string"!==typeof s)throw new A("invalid-cordova-configuration");var u=Pr("BuildInfo.displayName",c),l={};if(Nr().toLowerCase().match(/iphone|ipad|ipod/))l.ibi=s;else{if(!Nr().toLowerCase().match(/android/))return Ot(new A("operation-not-supported-in-this-environment"));l.apn=s}u&&(l.appDisplayName=u),o=Au(o),l.sessionId=o;var d=wc(e.v,e.i,e.l,t,n,null,r,e.m,l,e.u,i,e.s);return e.ma().then((function(){var t=e.h;return e.C.a.set(fu,a.w(),t)})).then((function(){var t=Pr("cordova.plugins.browsertab.isAvailable",c);if("function"!==typeof t)throw new A("invalid-cordova-configuration");var n=null;t((function(t){if(t){if("function"!==typeof(n=Pr("cordova.plugins.browsertab.openUrl",c)))throw new A("invalid-cordova-configuration");n(d)}else{if("function"!==typeof(n=Pr("cordova.InAppBrowser.open",c)))throw new A("invalid-cordova-configuration");t=Nr(),e.a=n(d,t.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||t.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}}))}))}(i,e,t,n,r)})).then((function(){return new wt((function(e,t){s=function(){var t=Pr("cordova.plugins.browsertab.close",c);return e(),"function"===typeof t&&t(),i.a&&"function"===typeof i.a.close&&(i.a.close(),i.a=null),!1},i.Ea(s),u=function(){a||(a=Cn(2e3).then((function(){t(new A("redirect-cancelled-by-user"))})))},l=function(){Kr()&&u()},o.addEventListener("resume",u,!1),Nr().toLowerCase().match(/android/)||o.addEventListener("visibilitychange",l,!1)})).o((function(e){return Ou(i).then((function(){throw e}))}))})).oa((function(){u&&o.removeEventListener("resume",u,!1),l&&o.removeEventListener("visibilitychange",l,!1),a&&a.cancel(),s&&i.Sa(s),i.c=null}))},n.Ea=function(e){this.b.push(e),ku(this).o((function(t){"auth/invalid-cordova-configuration"===t.code&&(t=new Go("unknown",null,null,null,new A("no-auth-event")),e(t))}))},n.Sa=function(e){J(this.b,(function(t){return t==e}))};var Pu={name:"pendingRedirect",F:"session"};function Du(e){return cu(e.b,Pu,e.a)}function xu(e,t,n,r){this.i={},this.u=0,this.D=e,this.v=t,this.m=n,this.J=r,this.h=[],this.f=!1,this.l=w(this.s,this),this.b=new Qu,this.C=new el,this.g=new Nu(zu(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=Lu(this.D,this.v,this.m,k,this.J)}function Lu(e,n,r,i,o){var a=t.a.SDK_VERSION||null;return Er()?new Iu(e,n,r,a,i,o):new yc(e,n,r,a,i,o)}function Mu(e){e.f||(e.f=!0,e.a.Ea(e.l));var t=e.a;return e.a.ma().o((function(n){throw e.a==t&&e.reset(),n}))}function Uu(e){e.a.Xb()&&Mu(e).o((function(t){var n=new Go("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Gu(t)&&e.s(n)})),e.a.Tb()||Xu(e.b)}function ju(e,t){Q(e.h,t)||e.h.push(t),e.f||function(e){return e.b.get(Pu,e.a).then((function(e){return"pending"==e}))}(e.g).then((function(t){t?Du(e.g).then((function(){Mu(e).o((function(t){var n=new Go("unknown",null,null,null,new A("operation-not-supported-in-this-environment"));Gu(t)&&e.s(n)}))})):Uu(e)})).o((function(){Uu(e)}))}function Fu(e,t){J(e.h,(function(e){return e==t}))}xu.prototype.reset=function(){this.f=!1,this.a.Sa(this.l),this.a=Lu(this.D,this.v,this.m,null,this.J),this.i={}},xu.prototype.s=function(e){if(!e)throw new A("invalid-auth-event");if(6e5<=S()-this.u&&(this.i={},this.u=0),e&&e.getUid()&&this.i.hasOwnProperty(e.getUid()))return!1;for(var t=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.Fb(e.c,e.b)){(t=this.c[e.c])&&(t.h(e,r),e&&(e.f||e.b)&&(this.i[e.getUid()]=!0,this.u=S())),t=!0;break}}return Xu(this.b),t};var Vu=new qr(2e3,1e4),Bu=new qr(3e4,6e4);function Wu(e,t,n,r,i,o,a){return e.a.Mb(t,n,r,(function(){e.f||(e.f=!0,e.a.Ea(e.l))}),(function(){e.reset()}),i,o,a)}function Gu(e){return!(!e||"auth/cordova-not-ready"!=e.code)}function qu(e,t,n,r,i){var o;return function(e){return e.b.set(Pu,"pending",e.a)}(e.g).then((function(){return e.a.Nb(t,n,r,i).o((function(t){if(Gu(t))throw new A("operation-not-supported-in-this-environment");return o=t,Du(e.g).then((function(){throw o}))})).then((function(){return e.a.$b()?new wt((function(){})):Du(e.g).then((function(){return e.qa()})).then((function(){})).o((function(){}))}))}))}function Ku(e,t,n,r,i){return e.a.Ob(r,(function(e){t.na(n,null,e,i)}),Vu.get())}xu.prototype.qa=function(){return this.b.qa()};var Hu={};function zu(e,t,n){return e=e+":"+t,n&&(e=e+":"+n.url),e}function Yu(e,t,n,r){var i=zu(t,n,r);return Hu[i]||(Hu[i]=new xu(e,t,n,r)),Hu[i]}function Qu(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}function Xu(e){e.g||(e.g=!0,Zu(e,!1,null,null))}function Ju(e){e.g&&!e.i&&Zu(e,!1,null,null)}function $u(e,t){if(e.b=function(){return kt(t)},e.f.length)for(var n=0;n<e.f.length;n++)e.f[n](t)}function Zu(e,t,n,r){t?r?function(e,t){if(e.b=function(){return Ot(t)},e.c.length)for(var n=0;n<e.c.length;n++)e.c[n](t)}(e,r):$u(e,n):$u(e,{user:null}),e.f=[],e.c=[]}function el(){}function tl(){this.ib=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.ib},set:function(e){this.ib=e},enumerable:!1})}function nl(e,t){this.a=t,$r(this,"verificationId",e)}function rl(e,t,n,r){return new Fo(e).fb(t,n).then((function(e){return new nl(e,r)}))}function il(e){var t=zi(e);if(!(t&&t.exp&&t.auth_time&&t.iat))throw new A("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Zr(this,{token:e,expirationTime:Hr(1e3*t.exp),authTime:Hr(1e3*t.auth_time),issuedAtTime:Hr(1e3*t.iat),signInProvider:t.firebase&&t.firebase.sign_in_provider?t.firebase.sign_in_provider:null,signInSecondFactor:t.firebase&&t.firebase.sign_in_second_factor?t.firebase.sign_in_second_factor:null,claims:t})}function ol(e,t,n){var r=t&&t[sl];if(!r)throw new A("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=e,this.f=me(t),this.g=n,this.c=new co(null,r),this.b=[];var i=this;K(t[al]||[],(function(e){(e=ri(e))&&i.b.push(e)})),$r(this,"auth",this.a),$r(this,"session",this.c),$r(this,"hints",this.b)}Qu.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},Qu.prototype.h=function(e,t){if(e){this.reset(),this.g=!0;var n=e.c,r=e.b,i=e.a&&"auth/web-storage-unsupported"==e.a.code,o=e.a&&"auth/operation-not-supported-in-this-environment"==e.a.code;this.i=!(!i&&!o),"unknown"!=n||i||o?e.a?(Zu(this,!0,null,e.a),kt()):t.Fa(n,r)?function(e,t,n){n=n.Fa(t.c,t.b);var r=t.g,i=t.f,o=t.i,a=t.T(),s=!!t.c.match(/Redirect$/);n(r,i,a,o).then((function(t){Zu(e,s,t,null)})).o((function(t){Zu(e,s,null,t)}))}(this,e,t):Ot(new A("invalid-auth-event")):(Zu(this,!1,null,null),kt())}else Ot(new A("invalid-auth-event"))},Qu.prototype.qa=function(){var e=this;return new wt((function(t,n){e.b?e.b().then(t,n):(e.f.push(t),e.c.push(n),function(e){var t=new A("timeout");e.a&&e.a.cancel(),e.a=Cn(Bu.get()).then((function(){e.b||(e.g=!0,Zu(e,!0,null,t))}))}(e))}))},el.prototype.h=function(e,t){if(e){var n=e.c,r=e.b;e.a?(t.na(e.c,null,e.a,e.b),kt()):t.Fa(n,r)?function(e,t){var n=e.b,r=e.c;t.Fa(r,n)(e.g,e.f,e.T(),e.i).then((function(e){t.na(r,e,null,n)})).o((function(e){t.na(r,null,e,n)}))}(e,t):Ot(new A("invalid-auth-event"))}else Ot(new A("invalid-auth-event"))},nl.prototype.confirm=function(e){return e=Vo(this.verificationId,e),this.a(e)};var al="mfaInfo",sl="mfaPendingCredential";function cl(e,t,n,r){A.call(this,"multi-factor-auth-required",r,t),this.b=new ol(e,t,n),$r(this,"resolver",this.b)}function ul(e,t,n){if(e&&m(e.serverResponse)&&"auth/multi-factor-auth-required"===e.code)try{return new cl(t,e.serverResponse,n,e.message)}catch(r){}return null}function ll(){}function dl(e){$r(this,"factorId",e.fa),this.a=e}function fl(e){if(dl.call(this,e),this.a.fa!=Fo.PROVIDER_ID)throw new A("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}function hl(e,t){for(var n in $t.call(this,e),t)this[n]=t[n]}function pl(e,t){this.a=e,this.b=[],this.c=w(this.yc,this),dn(this.a,"userReloaded",this.c);var n=[];t&&t.multiFactor&&t.multiFactor.enrolledFactors&&K(t.multiFactor.enrolledFactors,(function(e){var t=null,r={};if(e){e.uid&&(r[ai]=e.uid),e.displayName&&(r[ii]=e.displayName),e.enrollmentTime&&(r[oi]=new Date(e.enrollmentTime).toISOString()),e.phoneNumber&&(r[si]=e.phoneNumber);try{t=new ci(r)}catch(i){}e=t}else e=null;e&&n.push(e)})),vl(this,n)}function vl(e,t){e.b=t,$r(e,"enrolledFactors",t)}function ml(e,t,n){if(this.h=e,this.i=t,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function gl(e,t){e.stop(),e.b=Cn(function(e,t){return t?(e.a=e.c,e.g()):(t=e.a,e.a*=2,e.a>e.f&&(e.a=e.f),t)}(e,t)).then((function(){return function(){var e=c.document,t=null;return Kr()||!e?kt():new wt((function(n){t=function(){Kr()&&(e.removeEventListener("visibilitychange",t,!1),n())},e.addEventListener("visibilitychange",t,!1)})).o((function(n){throw e.removeEventListener("visibilitychange",t,!1),n}))}()})).then((function(){return e.h()})).then((function(){gl(e,!0)})).o((function(t){e.i(t)&&gl(e,!1)}))}function yl(e){this.f=e,this.b=this.a=null,this.c=Date.now()}function _l(e,t){"undefined"===typeof t&&(e.b?t=(t=e.b).a-t.g:t=0),e.c=Date.now()+1e3*t}function bl(e,t){e.b=Hi(t[ns]||""),e.a=t.refreshToken,_l(e,"undefined"!==typeof(t=t.expiresIn)?Number(t):void 0)}function El(e,t){return function(e,t){return new wt((function(n,r){"refresh_token"==t.grant_type&&t.refresh_token||"authorization_code"==t.grant_type&&t.code?ds(e,e.l+"?key="+encodeURIComponent(e.c),(function(e){e?e.error?r(uc(e)):e.access_token&&e.refresh_token?n(e):r(new A("internal-error")):r(new A("network-request-failed"))}),"POST",Zn(t).toString(),e.g,e.m.get()):r(new A("internal-error"))}))}(e.f,t).then((function(t){return e.b=Hi(t.access_token),e.a=t.refresh_token,_l(e,t.expires_in),{accessToken:e.b.toString(),refreshToken:e.a}})).o((function(t){throw"auth/user-token-expired"==t.code&&(e.a=null),t}))}function wl(e,t){this.a=e||null,this.b=t||null,Zr(this,{lastSignInTime:Hr(t||null),creationTime:Hr(e||null)})}function Tl(e,t,n,r,i,o){Zr(this,{uid:e,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:t})}function Sl(e,n,r){this.J=[],this.l=e.apiKey,this.m=e.appName,this.s=e.authDomain||null;var i=t.a.SDK_VERSION?Or(t.a.SDK_VERSION):null;this.a=new es(this.l,D(k),i),e.emulatorConfig&&cs(this.a,e.emulatorConfig),this.b=new yl(this.a),Pl(this,n[ns]),bl(this.b,n),$r(this,"refreshToken",this.b.a),Ll(this,r||{}),Tn.call(this),this.R=!1,this.s&&xr()&&(this.i=Yu(this.s,this.l,this.m)),this.S=[],this.h=null,this.u=function(e){return new ml((function(){return e.I(!0)}),(function(e){return!(!e||"auth/network-request-failed"!=e.code)}),(function(){var t=e.b.c-Date.now()-3e5;return 0<t?t:0}))}(this),this.aa=w(this.hb,this);var o=this;this.ya=null,this.Oa=function(e){o.wa(e.h)},this.ja=null,this.Aa=function(e){cs(o.a,e.c)},this.X=null,this.$=[],this.Ba=function(e){Al(o,e.f)},this.ba=null,this.O=new pl(this,r),$r(this,"multiFactor",this.O)}function Il(e,t){e.ja&&pn(e.ja,"languageCodeChanged",e.Oa),(e.ja=t)&&dn(t,"languageCodeChanged",e.Oa)}function Rl(e,t){e.X&&pn(e.X,"emulatorConfigChanged",e.Aa),(e.X=t)&&dn(t,"emulatorConfigChanged",e.Aa)}function Al(e,n){e.$=n,ls(e.a,t.a.SDK_VERSION?Or(t.a.SDK_VERSION,e.$):null)}function Cl(e,t){e.ba&&pn(e.ba,"frameworkChanged",e.Ba),(e.ba=t)&&dn(t,"frameworkChanged",e.Ba)}function kl(e){try{return t.a.app(e.m).auth()}catch(n){throw new A("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+e.m+"'!")}}function Ol(e){e.D||e.u.b||(e.u.start(),pn(e,"tokenChanged",e.aa),dn(e,"tokenChanged",e.aa))}function Nl(e){pn(e,"tokenChanged",e.aa),e.u.stop()}function Pl(e,t){e.za=t,$r(e,"_lat",t)}function Dl(e){for(var t=[],n=0;n<e.S.length;n++)t.push(e.S[n](e));return Pt(t).then((function(){return e}))}function xl(e){e.i&&!e.R&&(e.R=!0,ju(e.i,e))}function Ll(e,t){Zr(e,{uid:t.uid,displayName:t.displayName||null,photoURL:t.photoURL||null,email:t.email||null,emailVerified:t.emailVerified||!1,phoneNumber:t.phoneNumber||null,isAnonymous:t.isAnonymous||!1,tenantId:t.tenantId||null,metadata:new wl(t.createdAt,t.lastLoginAt),providerData:[]}),e.a.b=e.tenantId}function Ml(){}function Ul(e){return kt().then((function(){if(e.D)throw new A("app-deleted")}))}function jl(e){return z(e.providerData,(function(e){return e.providerId}))}function Fl(e,t){t&&(Vl(e,t.providerId),e.providerData.push(t))}function Vl(e,t){J(e.providerData,(function(e){return e.providerId==t}))}function Bl(e,t,n){("uid"!=t||n)&&e.hasOwnProperty(t)&&$r(e,t,n)}function Wl(e,t){e!=t&&(Zr(e,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,tenantId:t.tenantId,providerData:[]}),t.metadata?$r(e,"metadata",function(e){return new wl(e.a,e.b)}(t.metadata)):$r(e,"metadata",new wl),K(t.providerData,(function(t){Fl(e,t)})),function(e,t){e.b=t.b,e.a=t.a,e.c=t.c}(e.b,t.b),$r(e,"refreshToken",e.b.a),vl(e.O,t.O.b))}function Gl(e){return e.I().then((function(t){var n=e.isAnonymous;return function(e,t){return sc(e.a,js,{idToken:t}).then(w(e.Kc,e))}(e,t).then((function(){return n||Bl(e,"isAnonymous",!1),t}))}))}function ql(e,t){t[ns]&&e.za!=t[ns]&&(bl(e.b,t),e.dispatchEvent(new hl("tokenChanged")),Pl(e,t[ns]),Bl(e,"refreshToken",e.b.a))}function Kl(e,t){return Gl(e).then((function(){if(Q(jl(e),t))return Dl(e).then((function(){throw new A("provider-already-linked")}))}))}function Hl(e,t,n){return ei({user:e,credential:Bo(t),additionalUserInfo:t=$i(t),operationType:n})}function zl(e,t){return ql(e,t),e.reload().then((function(){return e}))}function Yl(e,n,r,i,o){if(!xr())return Ot(new A("operation-not-supported-in-this-environment"));if(e.h&&!o)return Ot(e.h);var a=Ji(r.providerId),s=Br(e.uid+":::"),c=null;(!Ur()||wr())&&e.s&&r.isOAuthProvider&&(c=wc(e.s,e.l,e.m,n,r,null,s,t.a.SDK_VERSION||null,null,null,e.tenantId));var u=gr(c,a&&a.ua,a&&a.ta);return i=i().then((function(){if(Xl(e),!o)return e.I().then((function(){}))})).then((function(){return Wu(e.i,u,n,r,s,!!c,e.tenantId)})).then((function(){return new wt((function(t,r){e.na(n,null,new A("cancelled-popup-request"),e.g||null),e.f=t,e.C=r,e.g=s,e.c=Ku(e.i,e,n,u,s)}))})).then((function(e){return u&&mr(u),e?ei(e):null})).o((function(e){throw u&&mr(u),e})),Jl(e,i,o)}function Ql(e,t,n,r,i){if(!xr())return Ot(new A("operation-not-supported-in-this-environment"));if(e.h&&!i)return Ot(e.h);var o=null,a=Br(e.uid+":::");return r=r().then((function(){if(Xl(e),!i)return e.I().then((function(){}))})).then((function(){return e.ga=a,Dl(e)})).then((function(t){return e.ha&&(t=(t=e.ha).b.set(ed,e.w(),t.a)),t})).then((function(){return qu(e.i,t,n,a,e.tenantId)})).o((function(t){if(o=t,e.ha)return td(e.ha);throw o})).then((function(){if(o)throw o})),Jl(e,r,i)}function Xl(e){if(!e.i||!e.R){if(e.i&&!e.R)throw new A("internal-error");throw new A("auth-domain-config-required")}}function Jl(e,t,n){var r=function(e,t,n){return e.h&&!n?(t.cancel(),Ot(e.h)):t.o((function(t){throw!t||"auth/user-disabled"!=t.code&&"auth/user-token-expired"!=t.code||(e.h||e.dispatchEvent(new hl("userInvalidated")),e.h=t),t}))}(e,t,n);return e.J.push(r),r.oa((function(){X(e.J,r)})),r.o((function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=ul(t.w(),kl(e),w(e.jc,e))),n||t}))}function $l(e){if(!e.apiKey)return null;var t={apiKey:e.apiKey,authDomain:e.authDomain,appName:e.appName,emulatorConfig:e.emulatorConfig},n={};if(!e.stsTokenManager||!e.stsTokenManager.accessToken)return null;n[ns]=e.stsTokenManager.accessToken,n.refreshToken=e.stsTokenManager.refreshToken||null;var r=e.stsTokenManager.expirationTime;r&&(n.expiresIn=(r-Date.now())/1e3);var i=new Sl(t,n,e);return e.providerData&&K(e.providerData,(function(e){e&&Fl(i,ei(e))})),e.redirectEventId&&(i.ga=e.redirectEventId),i}function Zl(e){this.a=e,this.b=ou()}ol.prototype.Rc=function(e){var t=this;return e.sb(this.a.a,this.c).then((function(e){var n=me(t.f);return delete n[al],delete n[sl],ye(n,e),t.g(n)}))},I(cl,A),ll.prototype.sb=function(e,t,n){return t.type==uo?function(e,t,n,r){return n.Ha().then((function(n){return n={idToken:n},"undefined"!==typeof r&&(n.displayName=r),ye(n,{phoneVerificationInfo:jo(e.a)}),sc(t,Ms,n)}))}(this,e,t,n):function(e,t,n){return n.Ha().then((function(n){return ye(n={mfaPendingCredential:n},{phoneVerificationInfo:jo(e.a)}),sc(t,Us,n)}))}(this,e,t)},I(dl,ll),I(fl,dl),I(hl,$t),(n=pl.prototype).yc=function(e){vl(this,function(e){var t=[];return K(e.mfaInfo||[],(function(e){(e=ri(e))&&t.push(e)})),t}(e.hd))},n.Rb=function(){return this.a.I().then((function(e){return new co(e,null)}))},n.fc=function(e,t){var n=this,r=this.a.a;return this.Rb().then((function(n){return e.sb(r,n,t)})).then((function(e){return ql(n.a,e),n.a.reload()}))},n.bd=function(e){var t=this,n="string"===typeof e?e:e.uid,r=this.a.a;return this.a.I().then((function(e){return sc(r,ac,{idToken:e,mfaEnrollmentId:n})})).then((function(e){var r=H(t.b,(function(e){return e.uid!=n}));return vl(t,r),ql(t.a,e),t.a.reload().o((function(e){if("auth/user-token-expired"!=e.code)throw e}))}))},n.w=function(){return{multiFactor:{enrolledFactors:z(this.b,(function(e){return e.w()}))}}},ml.prototype.start=function(){this.a=this.c,gl(this,!0)},ml.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},yl.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}},yl.prototype.getToken=function(e){return e=!!e,this.b&&!this.a?Ot(new A("user-token-expired")):e||!this.b||Date.now()>this.c-3e4?this.a?El(this,{grant_type:"refresh_token",refresh_token:this.a}):kt(null):kt({accessToken:this.b.toString(),refreshToken:this.a})},wl.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}},I(Sl,Tn),Sl.prototype.wa=function(e){this.ya=e,ss(this.a,e)},Sl.prototype.la=function(){return this.ya},Sl.prototype.Ga=function(){return Z(this.$)},Sl.prototype.hb=function(){this.u.b&&(this.u.stop(),this.u.start())},$r(Sl.prototype,"providerId","firebase"),(n=Sl.prototype).reload=function(){var e=this;return Jl(this,Ul(this).then((function(){return Gl(e).then((function(){return Dl(e)})).then(Ml)})))},n.oc=function(e){return this.I(e).then((function(e){return new il(e)}))},n.I=function(e){var t=this;return Jl(this,Ul(this).then((function(){return t.b.getToken(e)})).then((function(e){if(!e)throw new A("internal-error");return e.accessToken!=t.za&&(Pl(t,e.accessToken),t.dispatchEvent(new hl("tokenChanged"))),Bl(t,"refreshToken",e.refreshToken),e.accessToken})))},n.Kc=function(e){if(!(e=e.users)||!e.length)throw new A("internal-error");Ll(this,{uid:(e=e[0]).localId,displayName:e.displayName,photoURL:e.photoUrl,email:e.email,emailVerified:!!e.emailVerified,phoneNumber:e.phoneNumber,lastLoginAt:e.lastLoginAt,createdAt:e.createdAt,tenantId:e.tenantId});for(var t=function(e){return(e=e.providerUserInfo)&&e.length?z(e,(function(e){return new Tl(e.rawId,e.providerId,e.email,e.displayName,e.photoUrl,e.phoneNumber)})):[]}(e),n=0;n<t.length;n++)Fl(this,t[n]);Bl(this,"isAnonymous",!(this.email&&e.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new hl("userReloaded",{hd:e}))},n.Lc=function(e){return Xr("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.tb(e)},n.tb=function(e){var t=this,n=null;return Jl(this,e.c(this.a,this.uid).then((function(e){return ql(t,e),n=Hl(t,e,"reauthenticate"),t.h=null,t.reload()})).then((function(){return n})),!0)},n.Cc=function(e){return Xr("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.qb(e)},n.qb=function(e){var t=this,n=null;return Jl(this,Kl(this,e.providerId).then((function(){return t.I()})).then((function(n){return e.b(t.a,n)})).then((function(e){return n=Hl(t,e,"link"),zl(t,e)})).then((function(){return n})))},n.Dc=function(e,t){var n=this;return Jl(this,Kl(this,"phone").then((function(){return rl(kl(n),e,t,w(n.qb,n))})))},n.Mc=function(e,t){var n=this;return Jl(this,kt().then((function(){return rl(kl(n),e,t,w(n.tb,n))})),!0)},n.Bb=function(e){var t=this;return Jl(this,this.I().then((function(n){return t.a.Bb(n,e)})).then((function(e){return ql(t,e),t.reload()})))},n.ed=function(e){var t=this;return Jl(this,this.I().then((function(n){return e.b(t.a,n)})).then((function(e){return ql(t,e),t.reload()})))},n.Cb=function(e){var t=this;return Jl(this,this.I().then((function(n){return t.a.Cb(n,e)})).then((function(e){return ql(t,e),t.reload()})))},n.Db=function(e){if(void 0===e.displayName&&void 0===e.photoURL)return Ul(this);var t=this;return Jl(this,this.I().then((function(n){return t.a.Db(n,{displayName:e.displayName,photoUrl:e.photoURL})})).then((function(e){return ql(t,e),Bl(t,"displayName",e.displayName||null),Bl(t,"photoURL",e.photoUrl||null),K(t.providerData,(function(e){"password"===e.providerId&&($r(e,"displayName",t.displayName),$r(e,"photoURL",t.photoURL))})),Dl(t)})).then(Ml))},n.cd=function(e){var t=this;return Jl(this,Gl(this).then((function(n){return Q(jl(t),e)?function(e,t,n){return sc(e,Ds,{idToken:t,deleteProvider:n})}(t.a,n,[e]).then((function(e){var n={};return K(e.providerUserInfo||[],(function(e){n[e.providerId]=!0})),K(jl(t),(function(e){n[e]||Vl(t,e)})),n[Fo.PROVIDER_ID]||$r(t,"phoneNumber",null),Dl(t)})):Dl(t).then((function(){throw new A("no-such-provider")}))})))},n.delete=function(){var e=this;return Jl(this,this.I().then((function(t){return sc(e.a,Ps,{idToken:t})})).then((function(){e.dispatchEvent(new hl("userDeleted"))}))).then((function(){for(var t=0;t<e.J.length;t++)e.J[t].cancel("app-deleted");Il(e,null),Rl(e,null),Cl(e,null),e.J=[],e.D=!0,Nl(e),$r(e,"refreshToken",null),e.i&&Fu(e.i,e)}))},n.Fb=function(e,t){return!!("linkViaPopup"==e&&(this.g||null)==t&&this.f||"reauthViaPopup"==e&&(this.g||null)==t&&this.f||"linkViaRedirect"==e&&(this.ga||null)==t||"reauthViaRedirect"==e&&(this.ga||null)==t)},n.na=function(e,t,n,r){"linkViaPopup"!=e&&"reauthViaPopup"!=e||r!=(this.g||null)||(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},n.Fa=function(e,t){return"linkViaPopup"==e&&t==(this.g||null)?w(this.Kb,this):"reauthViaPopup"==e&&t==(this.g||null)?w(this.Lb,this):"linkViaRedirect"==e&&(this.ga||null)==t?w(this.Kb,this):"reauthViaRedirect"==e&&(this.ga||null)==t?w(this.Lb,this):null},n.Ec=function(e){var t=this;return Yl(this,"linkViaPopup",e,(function(){return Kl(t,e.providerId).then((function(){return Dl(t)}))}),!1)},n.Nc=function(e){return Yl(this,"reauthViaPopup",e,(function(){return kt()}),!0)},n.Fc=function(e){var t=this;return Ql(this,"linkViaRedirect",e,(function(){return Kl(t,e.providerId)}),!1)},n.Oc=function(e){return Ql(this,"reauthViaRedirect",e,(function(){return kt()}),!0)},n.Kb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,this.I().then((function(n){return Is(i.a,{requestUri:e,postBody:r,sessionId:t,idToken:n})})).then((function(e){return o=Hl(i,e,"link"),zl(i,e)})).then((function(){return o})))},n.Lb=function(e,t,n,r){var i=this;this.c&&(this.c.cancel(),this.c=null);var o=null;return Jl(this,kt().then((function(){return ho(Rs(i.a,{requestUri:e,sessionId:t,postBody:r,tenantId:n}),i.uid)})).then((function(e){return o=Hl(i,e,"reauthenticate"),ql(i,e),i.h=null,i.reload()})).then((function(){return o})),!0)},n.ub=function(e){var t=this,n=null;return Jl(this,this.I().then((function(t){return n=t,"undefined"===typeof e||ve(e)?{}:Wi(new Pi(e))})).then((function(e){return t.a.ub(n,e)})).then((function(e){if(t.email!=e)return t.reload()})).then((function(){})))},n.Eb=function(e,t){var n=this,r=null;return Jl(this,this.I().then((function(e){return r=e,"undefined"===typeof t||ve(t)?{}:Wi(new Pi(t))})).then((function(t){return n.a.Eb(r,e,t)})).then((function(e){if(n.email!=e)return n.reload()})).then((function(){})))},n.jc=function(e){var t=null,n=this;return Jl(this,e=ho(kt(e),n.uid).then((function(e){return t=Hl(n,e,"reauthenticate"),ql(n,e),n.h=null,n.reload()})).then((function(){return t})),!0)},n.toJSON=function(){return this.w()},n.w=function(){var e={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.b.w(),redirectEventId:this.ga||null};return this.metadata&&ye(e,this.metadata.w()),K(this.providerData,(function(t){e.providerData.push(function(e){var t,n={};for(t in e)e.hasOwnProperty(t)&&(n[t]=e[t]);return n}(t))})),ye(e,this.O.w()),e};var ed={name:"redirectUser",F:"session"};function td(e){return cu(e.b,ed,e.a)}function nd(e){this.a=e,this.b=ou(),this.c=null,this.f=function(e){var t=od("local"),n=od("session"),r=od("none");return function(e,t,n){var r=su(t,n),i=au(e,t.F);return e.get(t,n).then((function(o){var a=null;try{a=Vr(c.localStorage.getItem(r))}catch(s){}if(a&&!o)return c.localStorage.removeItem(r),e.set(t,a,n);a&&o&&"localStorage"!=i.type&&c.localStorage.removeItem(r)}))}(e.b,t,e.a).then((function(){return e.b.get(n,e.a)})).then((function(i){return i?n:e.b.get(r,e.a).then((function(n){return n?r:e.b.get(t,e.a).then((function(n){return n?t:e.b.get(id,e.a).then((function(e){return e?od(e):t}))}))}))})).then((function(t){return e.c=t,rd(e,t.F)})).o((function(){e.c||(e.c=t)}))}(this),this.b.addListener(od("local"),this.a,w(this.g,this))}function rd(e,t){var n,r=[];for(n in ru)ru[n]!==t&&r.push(cu(e.b,od(ru[n]),e.a));return r.push(cu(e.b,id,e.a)),function(e){return new wt((function(t,n){var r=e.length,i=[];if(r)for(var o=function(e,n){r--,i[e]=n,0==r&&t(i)},a=function(e){n(e)},s=0;s<e.length;s++)Nt(e[s],T(o,s),a);else t(i)}))}(r)}nd.prototype.g=function(){var e=this,t=od("local");ud(this,(function(){return kt().then((function(){return e.c&&"local"!=e.c.F?e.b.get(t,e.a):null})).then((function(n){if(n)return rd(e,"local").then((function(){e.c=t}))}))}))};var id={name:"persistence",F:"session"};function od(e){return{name:"authUser",F:e}}function ad(e,t){return ud(e,(function(){return e.b.set(e.c,t.w(),e.a)}))}function sd(e){return ud(e,(function(){return cu(e.b,e.c,e.a)}))}function cd(e,t,n){return ud(e,(function(){return e.b.get(e.c,e.a).then((function(e){return e&&t&&(e.authDomain=t),e&&n&&(e.emulatorConfig=n),$l(e||{})}))}))}function ud(e,t){return e.f=e.f.then(t,t),e.f}function ld(e){if(this.l=!1,$r(this,"settings",new tl),$r(this,"app",e),!_d(this).options||!_d(this).options.apiKey)throw new A("invalid-api-key");e=t.a.SDK_VERSION?Or(t.a.SDK_VERSION):null,this.a=new es(_d(this).options&&_d(this).options.apiKey,D(k),e),this.R=[],this.s=[],this.O=[],this.hb=t.a.INTERNAL.createSubscribe(w(this.zc,this)),this.X=void 0,this.bc=t.a.INTERNAL.createSubscribe(w(this.Ac,this)),gd(this,null),this.i=new nd(_d(this).options.apiKey+":"+_d(this).name),this.D=new Zl(_d(this).options.apiKey+":"+_d(this).name),this.$=Td(this,function(e){var t=_d(e).options.authDomain,n=function(e){var t=function(e,t){return e.b.get(ed,e.a).then((function(e){return e&&t&&(e.authDomain=t),$l(e||{})}))}(e.D,_d(e).options.authDomain).then((function(t){return(e.m=t)&&(t.ha=e.D),td(e.D)}));return Td(e,t)}(e).then((function(){return cd(e.i,t,e.P)})).then((function(t){return t?(t.ha=e.D,e.m&&(e.m.ga||null)==(t.ga||null)?t:t.reload().then((function(){return ad(e.i,t).then((function(){return t}))})).o((function(n){return"auth/network-request-failed"==n.code?t:sd(e.i)}))):null})).then((function(t){gd(e,t||null)}));return Td(e,n)}(this)),this.h=Td(this,function(e){return e.$.then((function(){return vd(e)})).o((function(){})).then((function(){if(!e.l)return e.ja()})).o((function(){})).then((function(){if(!e.l){e.ba=!0;var t=e.i;t.b.addListener(od("local"),t.a,e.ja)}}))}(this)),this.ba=!1,this.ja=w(this.Zc,this),this.Ba=w(this.da,this),this.ya=w(this.mc,this),this.za=w(this.wc,this),this.Aa=w(this.xc,this),this.b=null,function(e){var t=_d(e).options.authDomain,n=_d(e).options.apiKey;t&&xr()&&(e.Oa=e.$.then((function(){if(!e.l){if(e.b=Yu(t,n,_d(e).name,e.P),ju(e.b,e),bd(e)&&xl(bd(e)),e.m){xl(e.m);var r=e.m;r.wa(e.la()),Il(r,e),Al(r=e.m,e.J),Cl(r,e),cs((r=e.m).a,e.P),Rl(r,e),e.m=null}return e.b}})))}(this),this.INTERNAL={},this.INTERNAL.delete=w(this.delete,this),this.INTERNAL.logFramework=w(this.Gc,this),this.u=0,Tn.call(this),function(e){Object.defineProperty(e,"lc",{get:function(){return this.la()},set:function(e){this.wa(e)},enumerable:!1}),e.aa=null,Object.defineProperty(e,"ti",{get:function(){return this.T()},set:function(e){this.yb(e)},enumerable:!1}),e.S=null,Object.defineProperty(e,"emulatorConfig",{get:function(){if(this.P){var e=Bn(this.P.url);e=ei({protocol:e.c,host:e.a,port:e.g,options:ei({disableWarnings:this.P.ec})})}else e=null;return e},enumerable:!1})}(this),this.J=[],this.P=null}function dd(e){$t.call(this,"languageCodeChanged"),this.h=e}function fd(e){$t.call(this,"emulatorConfigChanged"),this.c=e}function hd(e){$t.call(this,"frameworkChanged"),this.f=e}function pd(e){return e.Oa||Ot(new A("auth-domain-config-required"))}function vd(e){if(!xr())return Ot(new A("operation-not-supported-in-this-environment"));var t=pd(e).then((function(){return e.b.qa()})).then((function(e){return e?ei(e):null}));return Td(e,t)}function md(e,t){var n={};return n.apiKey=_d(e).options.apiKey,n.authDomain=_d(e).options.authDomain,n.appName=_d(e).name,e.P&&(n.emulatorConfig=e.P),e.$.then((function(){return function(e,t,n,r){var i=new Sl(e,t);return n&&(i.ha=n),r&&Al(i,r),i.reload().then((function(){return i}))}(n,t,e.D,e.Ga())})).then((function(t){return bd(e)&&t.uid==bd(e).uid?(Wl(bd(e),t),e.da(t)):(gd(e,t),xl(t),e.da(t))})).then((function(){wd(e)}))}function gd(e,t){bd(e)&&(function(e,t){J(e.S,(function(e){return e==t}))}(bd(e),e.Ba),pn(bd(e),"tokenChanged",e.ya),pn(bd(e),"userDeleted",e.za),pn(bd(e),"userInvalidated",e.Aa),Nl(bd(e))),t&&(t.S.push(e.Ba),dn(t,"tokenChanged",e.ya),dn(t,"userDeleted",e.za),dn(t,"userInvalidated",e.Aa),0<e.u&&Ol(t)),$r(e,"currentUser",t),t&&(t.wa(e.la()),Il(t,e),Al(t,e.J),Cl(t,e),cs(t.a,e.P),Rl(t,e))}function yd(e,t){var n=null,r=null;return Td(e,t.then((function(t){return n=Bo(t),r=$i(t),md(e,t)}),(function(t){var n=null;throw t&&"auth/multi-factor-auth-required"===t.code&&(n=ul(t.w(),e,w(e.kc,e))),n||t})).then((function(){return ei({user:bd(e),credential:n,additionalUserInfo:r,operationType:"signIn"})})))}function _d(e){return e.app}function bd(e){return e.currentUser}function Ed(e){return bd(e)&&bd(e)._lat||null}function wd(e){if(e.ba){for(var t=0;t<e.s.length;t++)e.s[t]&&e.s[t](Ed(e));if(e.X!==e.getUid()&&e.O.length)for(e.X=e.getUid(),t=0;t<e.O.length;t++)e.O[t]&&e.O[t](Ed(e))}}function Td(e,t){return e.R.push(t),t.oa((function(){X(e.R,t)})),t}function Sd(){}function Id(){this.a={},this.b=1e12}nd.prototype.xb=function(e){var t=null,n=this;return function(e){var t=new A("invalid-persistence-type"),n=new A("unsupported-persistence-type");e:{for(r in ru)if(ru[r]==e){var r=!0;break e}r=!1}if(!r||"string"!==typeof e)throw t;switch(Sr()){case"ReactNative":if("session"===e)throw n;break;case"Node":if("none"!==e)throw n;break;case"Worker":if("session"===e||!Mc()&&"none"!==e)throw n;break;default:if(!Dr()&&"none"!==e)throw n}}(e),ud(this,(function(){return e!=n.c.F?n.b.get(n.c,n.a).then((function(r){return t=r,rd(n,e)})).then((function(){if(n.c=od(e),t)return n.b.set(n.c,t,n.a)})):kt()}))},I(ld,Tn),I(dd,$t),I(fd,$t),I(hd,$t),(n=ld.prototype).xb=function(e){return Td(this,e=this.i.xb(e))},n.wa=function(e){this.aa===e||this.l||(this.aa=e,ss(this.a,this.aa),this.dispatchEvent(new dd(this.la())))},n.la=function(){return this.aa},n.fd=function(){var e=c.navigator;this.wa(e&&(e.languages&&e.languages[0]||e.language||e.userLanguage)||null)},n.gd=function(e,t){if(!this.P){if(!/^https?:\/\//.test(e))throw new A("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");(function(e){"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),c.document&&!e&&br().then((function(){var e=c.document.createElement("div");e.innerText="Running in emulator mode. Do not use with production credentials.",e.style.position="fixed",e.style.width="100%",e.style.backgroundColor="#ffffff",e.style.border=".1em solid #000000",e.style.color="#ff0000",e.style.bottom="0px",e.style.left="0px",e.style.margin="0px",e.style.zIndex=1e4,e.style.textAlign="center",e.classList.add("firebase-emulator-warning"),c.document.body.appendChild(e)}))})(t=!!t&&!!t.disableWarnings),this.P={url:e,ec:t},this.settings.ib=!0,cs(this.a,this.P),this.dispatchEvent(new fd(this.P))}},n.Gc=function(e){this.J.push(e),ls(this.a,t.a.SDK_VERSION?Or(t.a.SDK_VERSION,this.J):null),this.dispatchEvent(new hd(this.J))},n.Ga=function(){return Z(this.J)},n.yb=function(e){this.S===e||this.l||(this.S=e,this.a.b=this.S)},n.T=function(){return this.S},n.toJSON=function(){return{apiKey:_d(this).options.apiKey,authDomain:_d(this).options.authDomain,appName:_d(this).name,currentUser:bd(this)&&bd(this).w()}},n.Fb=function(e,t){switch(e){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==t&&!!this.f;default:return!1}},n.na=function(e,t,n,r){"signInViaPopup"==e&&this.g==r&&(n&&this.C?this.C(n):t&&!n&&this.f&&this.f(t),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},n.Fa=function(e,t){return"signInViaRedirect"==e||"signInViaPopup"==e&&this.g==t&&this.f?w(this.ic,this):null},n.ic=function(e,t,n,r){var i=this,o={requestUri:e,postBody:r,sessionId:t,tenantId:n};return this.c&&(this.c.cancel(),this.c=null),i.$.then((function(){return yd(i,Ss(i.a,o))}))},n.Xc=function(e){if(!xr())return Ot(new A("operation-not-supported-in-this-environment"));var n=this,r=Ji(e.providerId),i=Br(),o=null;(!Ur()||wr())&&_d(this).options.authDomain&&e.isOAuthProvider&&(o=wc(_d(this).options.authDomain,_d(this).options.apiKey,_d(this).name,"signInViaPopup",e,null,i,t.a.SDK_VERSION||null,null,null,this.T(),this.P));var a=gr(o,r&&r.ua,r&&r.ta);return Td(this,r=pd(this).then((function(t){return Wu(t,a,"signInViaPopup",e,i,!!o,n.T())})).then((function(){return new wt((function(e,t){n.na("signInViaPopup",null,new A("cancelled-popup-request"),n.g),n.f=e,n.C=t,n.g=i,n.c=Ku(n.b,n,"signInViaPopup",a,i)}))})).then((function(e){return a&&mr(a),e?ei(e):null})).o((function(e){throw a&&mr(a),e})))},n.Yc=function(e){if(!xr())return Ot(new A("operation-not-supported-in-this-environment"));var t=this;return Td(this,pd(this).then((function(){return function(e){return ud(e,(function(){return e.b.set(id,e.c.F,e.a)}))}(t.i)})).then((function(){return qu(t.b,"signInViaRedirect",e,void 0,t.T())})))},n.qa=function(){var e=this;return vd(this).then((function(t){return e.b&&Ju(e.b.b),t})).o((function(t){throw e.b&&Ju(e.b.b),t}))},n.dd=function(e){if(!e)return Ot(new A("null-user"));if(this.S!=e.tenantId)return Ot(new A("tenant-id-mismatch"));var t=this,n={};n.apiKey=_d(this).options.apiKey,n.authDomain=_d(this).options.authDomain,n.appName=_d(this).name;var r=function(e,t,n,r){var i=e.b,o={};return o[ns]=i.b&&i.b.toString(),o.refreshToken=i.a,t=new Sl(t||{apiKey:e.l,authDomain:e.s,appName:e.m},o),n&&(t.ha=n),r&&Al(t,r),Wl(t,e),t}(e,n,t.D,t.Ga());return Td(this,this.h.then((function(){if(_d(t).options.apiKey!=e.l)return r.reload()})).then((function(){return bd(t)&&e.uid==bd(t).uid?(Wl(bd(t),e),t.da(e)):(gd(t,r),xl(r),t.da(r))})).then((function(){wd(t)})))},n.Ab=function(){var e=this;return Td(this,this.h.then((function(){return e.b&&Ju(e.b.b),bd(e)?(gd(e,null),sd(e.i).then((function(){wd(e)}))):kt()})))},n.Zc=function(){var e=this;return cd(this.i,_d(this).options.authDomain).then((function(t){if(!e.l){var n;if(n=bd(e)&&t){n=bd(e).uid;var r=t.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Wl(bd(e),t),bd(e).I();(bd(e)||t)&&(gd(e,t),t&&(xl(t),t.ha=e.D),e.b&&ju(e.b,e),wd(e))}}))},n.da=function(e){return ad(this.i,e)},n.mc=function(){wd(this),this.da(bd(this))},n.wc=function(){this.Ab()},n.xc=function(){this.Ab()},n.kc=function(e){var t=this;return this.h.then((function(){return yd(t,kt(e))}))},n.zc=function(e){var t=this;this.addAuthTokenListener((function(){e.next(bd(t))}))},n.Ac=function(e){var t=this;!function(e,t){e.O.push(t),Td(e,e.h.then((function(){!e.l&&Q(e.O,t)&&e.X!==e.getUid()&&(e.X=e.getUid(),t(Ed(e)))})))}(this,(function(){e.next(bd(t))}))},n.Ic=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then((function(){"function"===typeof e?e(bd(r)):"function"===typeof e.next&&e.next(bd(r))})),this.hb(e,t,n)},n.Hc=function(e,t,n){var r=this;return this.ba&&Promise.resolve().then((function(){r.X=r.getUid(),"function"===typeof e?e(bd(r)):"function"===typeof e.next&&e.next(bd(r))})),this.bc(e,t,n)},n.nc=function(e){var t=this;return Td(this,this.h.then((function(){return bd(t)?bd(t).I(e).then((function(e){return{accessToken:e}})):null})))},n.Tc=function(e){var t=this;return this.h.then((function(){return yd(t,sc(t.a,tc,{token:e}))})).then((function(e){var n=e.user;return Bl(n,"isAnonymous",!1),t.da(n),e}))},n.Uc=function(e,t){var n=this;return this.h.then((function(){return yd(n,sc(n.a,nc,{email:e,password:t}))}))},n.dc=function(e,t){var n=this;return this.h.then((function(){return yd(n,sc(n.a,Os,{email:e,password:t}))}))},n.$a=function(e){var t=this;return this.h.then((function(){return yd(t,e.ka(t.a))}))},n.Sc=function(e){return Xr("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.$a(e)},n.zb=function(){var e=this;return this.h.then((function(){var t=bd(e);if(t&&t.isAnonymous){var n=ei({providerId:null,isNewUser:!1});return ei({user:t,credential:null,additionalUserInfo:n,operationType:"signIn"})}return yd(e,e.a.zb()).then((function(t){var n=t.user;return Bl(n,"isAnonymous",!0),e.da(n),t}))}))},n.getUid=function(){return bd(this)&&bd(this).uid||null},n.cc=function(e){this.addAuthTokenListener(e),this.u++,0<this.u&&bd(this)&&Ol(bd(this))},n.Pc=function(e){var t=this;K(this.s,(function(n){n==e&&t.u--})),0>this.u&&(this.u=0),0==this.u&&bd(this)&&Nl(bd(this)),this.removeAuthTokenListener(e)},n.addAuthTokenListener=function(e){var t=this;this.s.push(e),Td(this,this.h.then((function(){t.l||Q(t.s,e)&&e(Ed(t))})))},n.removeAuthTokenListener=function(e){J(this.s,(function(t){return t==e}))},n.delete=function(){this.l=!0;for(var e=0;e<this.R.length;e++)this.R[e].cancel("app-deleted");return this.R=[],this.i&&(e=this.i).b.removeListener(od("local"),e.a,this.ja),this.b&&(Fu(this.b,this),Ju(this.b.b)),Promise.resolve()},n.hc=function(e){return Td(this,function(e,t){return sc(e,Ns,{identifier:t,continueUri:Lr()?fr():"http://localhost"}).then((function(e){return e.signinMethods||[]}))}(this.a,e))},n.Bc=function(e){return!!Lo(e)},n.wb=function(e,t){var n=this;return Td(this,kt().then((function(){var e=new Pi(t);if(!e.c)throw new A("argument-error",Li+" must be true when sending sign in link to email");return Wi(e)})).then((function(t){return n.a.wb(e,t)})).then((function(){})))},n.jd=function(e){return this.Ra(e).then((function(e){return e.data.email}))},n.nb=function(e,t){return Td(this,this.a.nb(e,t).then((function(){})))},n.Ra=function(e){return Td(this,this.a.Ra(e).then((function(e){return new ui(e)})))},n.jb=function(e){return Td(this,this.a.jb(e).then((function(){})))},n.vb=function(e,t){var n=this;return Td(this,kt().then((function(){return"undefined"===typeof t||ve(t)?{}:Wi(new Pi(t))})).then((function(t){return n.a.vb(e,t)})).then((function(){})))},n.Wc=function(e,t){return Td(this,rl(this,e,t,w(this.$a,this)))},n.Vc=function(e,t){var n=this;return Td(this,kt().then((function(){var r=t||fr(),i=xo(e,r);if(!(r=Lo(r)))throw new A("argument-error","Invalid email link!");if(r.tenantId!==n.T())throw new A("tenant-id-mismatch");return n.$a(i)})))},Sd.prototype.render=function(){},Sd.prototype.reset=function(){},Sd.prototype.getResponse=function(){},Sd.prototype.execute=function(){};var Rd=null;function Ad(e,t){return(t=Cd(t))&&e.a[t]||null}function Cd(e){return(e="undefined"===typeof e?1e12:e)?e.toString():null}function kd(e,t){this.g=!1,this.c=t,this.a=this.b=null,this.h="invisible"!==this.c.size,this.f=lt(e);var n=this;this.i=function(){n.execute()},this.h?this.execute():dn(this.f,"click",this.i)}function Od(e){if(e.g)throw Error("reCAPTCHA mock was already deleted!")}function Nd(){}function Pd(){}Id.prototype.render=function(e,t){return this.a[this.b.toString()]=new kd(e,t),this.b++},Id.prototype.reset=function(e){var t=Ad(this,e);e=Cd(e),t&&e&&(t.delete(),delete this.a[e])},Id.prototype.getResponse=function(e){return(e=Ad(this,e))?e.getResponse():null},Id.prototype.execute=function(e){(e=Ad(this,e))&&e.execute()},kd.prototype.getResponse=function(){return Od(this),this.b},kd.prototype.execute=function(){Od(this);var e=this;this.a||(this.a=setTimeout((function(){e.b=function(){for(var e=50,t=[];0<e;)t.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),e--;return t.join("")}();var t=e.c.callback,n=e.c["expired-callback"];if(t)try{t(e.b)}catch(r){}e.a=setTimeout((function(){if(e.a=null,e.b=null,n)try{n()}catch(r){}e.h&&e.execute()}),6e4)}),500))},kd.prototype.delete=function(){Od(this),this.g=!0,clearTimeout(this.a),this.a=null,pn(this.f,"click",this.i)},$r(Nd,"FACTOR_ID","phone"),Pd.prototype.g=function(){return Rd||(Rd=new Id),kt(Rd)},Pd.prototype.c=function(){};var Dd=null;function xd(){this.b=c.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var Ld=new be(Se,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Md=new qr(3e4,6e4);xd.prototype.g=function(e){var t=this;return new wt((function(n,r){var i=setTimeout((function(){r(new A("network-request-failed"))}),Md.get());!c.grecaptcha||e!==t.f&&!t.b?(c[t.a]=function(){if(c.grecaptcha){t.f=e;var o=c.grecaptcha.render;c.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n(c.grecaptcha)}else clearTimeout(i),r(new A("internal-error"));delete c[t.a]},kt(za(Ce(Ld,{onload:t.a,hl:e||""}))).o((function(){clearTimeout(i),r(new A("internal-error","Unable to load external reCAPTCHA dependencies!"))}))):(clearTimeout(i),n(c.grecaptcha))}))},xd.prototype.c=function(){this.b--};var Ud=null;function jd(e,t,n,r,i,o,a){if($r(this,"type","recaptcha"),this.c=this.f=null,this.D=!1,this.v=t,this.g=null,a?(Dd||(Dd=new Pd),a=Dd):(Ud||(Ud=new xd),a=Ud),this.m=a,this.a=n||{theme:"light",type:"image"},this.h=[],this.a[Bd])throw new A("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i="invisible"===this.a[Wd],!c.document)throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!lt(t)||!this.i&&lt(t).hasChildNodes())throw new A("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new es(e,o||null,i||null),this.u=r||function(){return null};var s=this;this.l=[];var u=this.a[Fd];this.a[Fd]=function(e){if(Gd(s,e),"function"===typeof u)u(e);else if("string"===typeof u){var t=Pr(u,c);"function"===typeof t&&t(e)}};var l=this.a[Vd];this.a[Vd]=function(){if(Gd(s,null),"function"===typeof l)l();else if("string"===typeof l){var e=Pr(l,c);"function"===typeof e&&e()}}}var Fd="callback",Vd="expired-callback",Bd="sitekey",Wd="size";function Gd(e,t){for(var n=0;n<e.l.length;n++)try{e.l[n](t)}catch(r){}}function qd(e,t){return e.h.push(t),t.oa((function(){X(e.h,t)})),t}function Kd(e){if(e.D)throw new A("internal-error","RecaptchaVerifier instance has been destroyed.")}function Hd(e,n,r){var i=!1;try{this.b=r||t.a.app()}catch(s){throw new A("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.b.options||!this.b.options.apiKey)throw new A("invalid-api-key");r=this.b.options.apiKey;var o=this,a=null;try{a=this.b.auth().Ga()}catch(s){}try{i=this.b.auth().settings.appVerificationDisabledForTesting}catch(s){}a=t.a.SDK_VERSION?Or(t.a.SDK_VERSION,a):null,jd.call(this,r,e,n,(function(){try{var e=o.b.auth().la()}catch(t){e=null}return e}),a,D(k),i)}function zd(e,t,n,r){e:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<t.length;a++)if(t[a].optional)o=!0;else{if(o)throw new A("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=t.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=t[i].optional&&void 0===n[i],!t[i].M(n[i])&&!o){if(t=t[i],0>i||i>=Yd.length)throw new A("internal-error","Argument validator received an unsupported number of arguments.");n=Yd[i],r=(r?"":n+" argument ")+(t.name?'"'+t.name+'" ':"")+"must be "+t.K+".";break e}r=null}}if(r)throw new A("argument-error",e+" failed: "+r)}(n=jd.prototype).Ia=function(){var e=this;return this.f?this.f:this.f=qd(this,kt().then((function(){if(Lr()&&!Tr())return br();throw new A("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")})).then((function(){return e.m.g(e.u())})).then((function(t){return e.g=t,sc(e.s,qs,{})})).then((function(t){e.a[Bd]=t.recaptchaSiteKey})).o((function(t){throw e.f=null,t})))},n.render=function(){Kd(this);var e=this;return qd(this,this.Ia().then((function(){if(null===e.c){var t=e.v;if(!e.i){var n=lt(t);t=function(e,t,n){var r=arguments,i=document,o=String(r[0]),a=r[1];if(!ut&&a&&(a.name||a.type)){if(o=["<",o],a.name&&o.push(' name="',Ke(a.name),'"'),a.type){o.push(' type="',Ke(a.type),'"');var s={};ye(s,a),delete s.type,a=s}o.push(">"),o=o.join("")}return o=mt(i,o),a&&("string"===typeof a?o.className=a:Array.isArray(a)?o.className=a.join(" "):dt(o,a)),2<r.length&&vt(i,o,r),o}("DIV"),n.appendChild(t)}e.c=e.g.render(t,e.a)}return e.c})))},n.verify=function(){Kd(this);var e=this;return qd(this,this.render().then((function(t){return new wt((function(n){var r=e.g.getResponse(t);if(r)n(r);else{e.l.push((function t(r){r&&(function(e,t){J(e.l,(function(e){return e==t}))}(e,t),n(r))})),e.i&&e.g.execute(e.c)}}))})))},n.reset=function(){Kd(this),null!==this.c&&this.g.reset(this.c)},n.clear=function(){Kd(this),this.D=!0,this.m.c();for(var e=0;e<this.h.length;e++)this.h[e].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){e=lt(this.v);for(var t;t=e.firstChild;)e.removeChild(t)}},I(Hd,jd);var Yd="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function Qd(e,t){return{name:e||"",K:"a valid string",optional:!!t,M:function(e){return"string"===typeof e}}}function Xd(e,t){return{name:e||"",K:"a boolean",optional:!!t,M:function(e){return"boolean"===typeof e}}}function Jd(e,t){return{name:e||"",K:"a valid object",optional:!!t,M:m}}function $d(e,t){return{name:e||"",K:"a function",optional:!!t,M:function(e){return"function"===typeof e}}}function Zd(e,t){return{name:e||"",K:"null",optional:!!t,M:function(e){return null===e}}}function ef(e){return{name:e?e+"Credential":"credential",K:e?"a valid "+e+" credential":"a valid credential",optional:!1,M:function(t){if(!t)return!1;var n=!e||t.providerId===e;return!(!t.ka||!n)}}}function tf(e,t){return m(e)&&"string"===typeof e.type&&e.type===t&&"function"===typeof e.Ha}function nf(e){return m(e)&&"string"===typeof e.uid}function rf(e,t,n,r){return{name:n||"",K:e.K+" or "+t.K,optional:!!r,M:function(n){return e.M(n)||t.M(n)}}}function of(e,t){for(var n in t){var r=t[n].name;e[r]=cf(r,e[n],t[n].j)}}function af(e,t){for(var n in t){var r=t[n].name;r!==n&&Object.defineProperty(e,r,{get:T((function(e){return this[e]}),n),set:T((function(e,t,n,r){zd(e,[n],[r],!0),this[t]=r}),r,n,t[n].kb),enumerable:!0})}}function sf(e,t,n,r){e[t]=cf(t,n,r)}function cf(e,t,n){function r(){var e=Array.prototype.slice.call(arguments);return zd(o,n,e),t.apply(this,e)}if(!n)return t;var i,o=function(e){return(e=e.split("."))[e.length-1]}(e);for(i in t)r[i]=t[i];for(i in t.prototype)r.prototype[i]=t.prototype[i];return r}of(ld.prototype,{jb:{name:"applyActionCode",j:[Qd("code")]},Ra:{name:"checkActionCode",j:[Qd("code")]},nb:{name:"confirmPasswordReset",j:[Qd("code"),Qd("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[Qd("email"),Qd("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[Qd("email")]},qa:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[Qd("emailLink")]},Hc:{name:"onAuthStateChanged",j:[rf(Jd(),$d(),"nextOrObserver"),$d("opt_error",!0),$d("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[rf(Jd(),$d(),"nextOrObserver"),$d("opt_error",!0),$d("opt_completed",!0)]},vb:{name:"sendPasswordResetEmail",j:[Qd("email"),rf(Jd("opt_actionCodeSettings",!0),Zd(null,!0),"opt_actionCodeSettings",!0)]},wb:{name:"sendSignInLinkToEmail",j:[Qd("email"),Jd("actionCodeSettings")]},xb:{name:"setPersistence",j:[Qd("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[ef()]},zb:{name:"signInAnonymously",j:[]},$a:{name:"signInWithCredential",j:[ef()]},Tc:{name:"signInWithCustomToken",j:[Qd("token")]},Uc:{name:"signInWithEmailAndPassword",j:[Qd("email"),Qd("password")]},Vc:{name:"signInWithEmailLink",j:[Qd("email"),Qd("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[Qd("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!==typeof e.type||"function"!==typeof e.verify)}}]},Xc:{name:"signInWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Yc:{name:"signInWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},dd:{name:"updateCurrentUser",j:[rf({name:"user",K:"an instance of Firebase User",optional:!1,M:function(e){return!!(e&&e instanceof Sl)}},Zd(),"user")]},Ab:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[Qd(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[Qd("url"),Jd("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[Qd("code")]}}),af(ld.prototype,{lc:{name:"languageCode",kb:rf(Qd(),Zd(),"languageCode")},ti:{name:"tenantId",kb:rf(Qd(),Zd(),"tenantId")}}),ld.Persistence=ru,ld.Persistence.LOCAL="local",ld.Persistence.SESSION="session",ld.Persistence.NONE="none",of(Sl.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Xd("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Xd("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[ef()]},qb:{name:"linkWithCredential",j:[ef()]},Dc:{name:"linkWithPhoneNumber",j:[Qd("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!==typeof e.type||"function"!==typeof e.verify)}}]},Ec:{name:"linkWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Fc:{name:"linkWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[ef()]},tb:{name:"reauthenticateWithCredential",j:[ef()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[Qd("phoneNumber"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!==typeof e.type||"function"!==typeof e.verify)}}]},Nc:{name:"reauthenticateWithPopup",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},Oc:{name:"reauthenticateWithRedirect",j:[{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(e){return!!(e&&e.providerId&&e.hasOwnProperty&&e.hasOwnProperty("isOAuthProvider"))}}]},reload:{name:"reload",j:[]},ub:{name:"sendEmailVerification",j:[rf(Jd("opt_actionCodeSettings",!0),Zd(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[Qd(null,!0)]},cd:{name:"unlink",j:[Qd("provider")]},Bb:{name:"updateEmail",j:[Qd("email")]},Cb:{name:"updatePassword",j:[Qd("password")]},ed:{name:"updatePhoneNumber",j:[ef("phone")]},Db:{name:"updateProfile",j:[Jd("profile")]},Eb:{name:"verifyBeforeUpdateEmail",j:[Qd("email"),rf(Jd("opt_actionCodeSettings",!0),Zd(null,!0),"opt_actionCodeSettings",!0)]}}),of(Id.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),of(Sd.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),of(wt.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),af(tl.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",kb:Xd("appVerificationDisabledForTesting")}}),of(nl.prototype,{confirm:{name:"confirm",j:[Qd("verificationCode")]}}),sf(fo,"fromJSON",(function(e){e="string"===typeof e?JSON.parse(e):e;for(var t,n=[_o,Po,Uo,mo],r=0;r<n.length;r++)if(t=n[r](e))return t;return null}),[rf(Qd(),Jd(),"json")]),sf(Do,"credential",(function(e,t){return new No(e,t)}),[Qd("email"),Qd("password")]),of(No.prototype,{w:{name:"toJSON",j:[Qd(null,!0)]}}),of(To.prototype,{Ca:{name:"addScope",j:[Qd("scope")]},Ka:{name:"setCustomParameters",j:[Jd("customOAuthParameters")]}}),sf(To,"credential",So,[rf(Qd(),Jd(),"token")]),sf(Do,"credentialWithLink",xo,[Qd("email"),Qd("emailLink")]),of(Io.prototype,{Ca:{name:"addScope",j:[Qd("scope")]},Ka:{name:"setCustomParameters",j:[Jd("customOAuthParameters")]}}),sf(Io,"credential",Ro,[rf(Qd(),Jd(),"token")]),of(Ao.prototype,{Ca:{name:"addScope",j:[Qd("scope")]},Ka:{name:"setCustomParameters",j:[Jd("customOAuthParameters")]}}),sf(Ao,"credential",Co,[rf(Qd(),rf(Jd(),Zd()),"idToken"),rf(Qd(),Zd(),"accessToken",!0)]),of(ko.prototype,{Ka:{name:"setCustomParameters",j:[Jd("customOAuthParameters")]}}),sf(ko,"credential",Oo,[rf(Qd(),Jd(),"token"),Qd("secret",!0)]),of(wo.prototype,{Ca:{name:"addScope",j:[Qd("scope")]},credential:{name:"credential",j:[rf(Qd(),rf(Jd(),Zd()),"optionsOrIdToken"),rf(Qd(),Zd(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Jd("customOAuthParameters")]}}),of(go.prototype,{w:{name:"toJSON",j:[Qd(null,!0)]}}),of(po.prototype,{w:{name:"toJSON",j:[Qd(null,!0)]}}),sf(Fo,"credential",Vo,[Qd("verificationId"),Qd("verificationCode")]),of(Fo.prototype,{fb:{name:"verifyPhoneNumber",j:[rf(Qd(),{name:"phoneInfoOptions",K:"valid phone info options",optional:!1,M:function(e){return!!e&&(e.session&&e.phoneNumber?tf(e.session,uo)&&"string"===typeof e.phoneNumber:e.session&&e.multiFactorHint?tf(e.session,lo)&&nf(e.multiFactorHint):e.session&&e.multiFactorUid?tf(e.session,lo)&&"string"===typeof e.multiFactorUid:!!e.phoneNumber&&"string"===typeof e.phoneNumber)}},"phoneInfoOptions"),{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!(!e||"string"!==typeof e.type||"function"!==typeof e.verify)}}]}}),of(Mo.prototype,{w:{name:"toJSON",j:[Qd(null,!0)]}}),of(A.prototype,{toJSON:{name:"toJSON",j:[Qd(null,!0)]}}),of(Qo.prototype,{toJSON:{name:"toJSON",j:[Qd(null,!0)]}}),of(Yo.prototype,{toJSON:{name:"toJSON",j:[Qd(null,!0)]}}),of(cl.prototype,{toJSON:{name:"toJSON",j:[Qd(null,!0)]}}),of(ol.prototype,{Rc:{name:"resolveSignIn",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.sb}}]}}),of(pl.prototype,{Rb:{name:"getSession",j:[]},fc:{name:"enroll",j:[{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(e){return!!e&&!!e.sb}},Qd("displayName",!0)]},bd:{name:"unenroll",j:[rf({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:nf},Qd(),"multiFactorInfoIdentifier")]}}),of(Hd.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),sf(Ti,"parseLink",Ni,[Qd("link")]),sf(Nd,"assertion",(function(e){return new fl(e)}),[ef("phone")]),function(){if("undefined"===typeof t.a||!t.a.INTERNAL||!t.a.INTERNAL.registerComponent)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var e={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:di,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:li,VERIFY_AND_CHANGE_EMAIL:fi,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:ld,AuthCredential:fo,Error:A};sf(e,"EmailAuthProvider",Do,[]),sf(e,"FacebookAuthProvider",To,[]),sf(e,"GithubAuthProvider",Io,[]),sf(e,"GoogleAuthProvider",Ao,[]),sf(e,"TwitterAuthProvider",ko,[]),sf(e,"OAuthProvider",wo,[Qd("providerId")]),sf(e,"SAMLAuthProvider",Eo,[Qd("providerId")]),sf(e,"PhoneAuthProvider",Fo,[{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(e){return!!(e&&e instanceof ld)}}]),sf(e,"RecaptchaVerifier",Hd,[rf(Qd(),{name:"",K:"an HTML element",optional:!1,M:function(e){return!!(e&&e instanceof Element)}},"recaptchaContainer"),Jd("recaptchaParameters",!0),{name:"app",K:"an instance of Firebase App",optional:!0,M:function(e){return!!(e&&e instanceof t.a.app.App)}}]),sf(e,"ActionCodeURL",Ti,[]),sf(e,"PhoneMultiFactorGenerator",Nd,[]),t.a.INTERNAL.registerComponent({name:"auth",instanceFactory:function(e){return new ld(e=e.getProvider("app").getImmediate())},multipleInstances:!1,serviceProps:e,instantiationMode:"LAZY",type:"PUBLIC"}),t.a.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(e){return{getUid:w((e=e.getProvider("auth").getImmediate()).getUid,e),getToken:w(e.nc,e),addAuthTokenListener:w(e.cc,e),removeAuthTokenListener:w(e.Pc,e)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),t.a.registerVersion("@firebase/auth","0.16.4"),t.a.INTERNAL.extendNamespace({User:Sl})}()}).apply("undefined"!==typeof e?e:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}).call(this,n(33))},function(e,t,n){"use strict";(function(e,t){var r=n(5),i=n(16),o=n(0),a=n(7),s=n(14),c=function(){function e(e){this.domStorage_=e,this.prefix_="firebase:"}return e.prototype.set=function(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Object(o.K)(t))},e.prototype.get=function(e){var t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:Object(o.E)(t)},e.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},e.prototype.prefixedName_=function(e){return this.prefix_+e},e.prototype.toString=function(){return this.domStorage_.toString()},e}(),u=function(){function e(){this.cache_={},this.isInMemoryStorage=!0}return e.prototype.set=function(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t},e.prototype.get=function(e){return Object(o.k)(this.cache_,e)?this.cache_[e]:null},e.prototype.remove=function(e){delete this.cache_[e]},e}(),l=function(e){try{if("undefined"!==typeof window&&"undefined"!==typeof window[e]){var t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new c(t)}}catch(n){}return new u},d=l("localStorage"),f=l("sessionStorage"),h=new s.b("@firebase/database"),p=function(){var e=1;return function(){return e++}}(),v=function(e){var t=Object(o.J)(e),n=new o.d;n.update(t);var r=n.digest();return o.h.encodeByteArray(r)},m=function e(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r="",i=0;i<t.length;i++){var a=t[i];Array.isArray(a)||a&&"object"===typeof a&&"number"===typeof a.length?r+=e.apply(null,a):r+="object"===typeof a?Object(o.K)(a):a,r+=" "}return r},g=null,y=!0,_=function(e,t){Object(o.f)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(h.logLevel=s.a.VERBOSE,g=h.log.bind(h),t&&f.set("logging_enabled",!0)):"function"===typeof e?g=e:(g=null,f.remove("logging_enabled"))},b=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!0===y&&(y=!1,null===g&&!0===f.get("logging_enabled")&&_(!0)),g){var n=m.apply(null,e);g(n)}},E=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];b.apply(void 0,Object(a.d)([e],Object(a.c)(t)))}},w=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE INTERNAL ERROR: "+m.apply(void 0,Object(a.d)([],Object(a.c)(e)));h.error(n)},T=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE FATAL ERROR: "+m.apply(void 0,Object(a.d)([],Object(a.c)(e)));throw h.error(n),new Error(n)},S=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n="FIREBASE WARNING: "+m.apply(void 0,Object(a.d)([],Object(a.c)(e)));h.warn(n)},I=function(e){return"number"===typeof e&&(e!==e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},R="[MIN_NAME]",A="[MAX_NAME]",C=function(e,t){if(e===t)return 0;if(e===R||t===A)return-1;if(t===R||e===A)return 1;var n=j(e),r=j(t);return null!==n?null!==r?n-r===0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1},k=function(e,t){return e===t?0:e<t?-1:1},O=function(e,t){if(t&&e in t)return t[e];throw new Error("Missing required key ("+e+") in object: "+Object(o.K)(t))},N=function e(t){if("object"!==typeof t||null===t)return Object(o.K)(t);var n=[];for(var r in t)n.push(r);n.sort();for(var i="{",a=0;a<n.length;a++)0!==a&&(i+=","),i+=Object(o.K)(n[a]),i+=":",i+=e(t[n[a]]);return i+="}"},P=function(e,t){var n=e.length;if(n<=t)return[e];for(var r=[],i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function D(e,t){for(var n in e)e.hasOwnProperty(n)&&t(n,e[n])}var x=function(e){Object(o.f)(!I(e),"Invalid JSON number");var t,n,r,i,a,s=1023;0===e?(n=0,r=0,t=1/e===-1/0?1:0):(t=e<0,(e=Math.abs(e))>=Math.pow(2,-1022)?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),s))+s,r=Math.round(e*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(e/Math.pow(2,-1074))));var c=[];for(a=52;a;a-=1)c.push(r%2?1:0),r=Math.floor(r/2);for(a=11;a;a-=1)c.push(n%2?1:0),n=Math.floor(n/2);c.push(t?1:0),c.reverse();var u=c.join(""),l="";for(a=0;a<64;a+=8){var d=parseInt(u.substr(a,8),2).toString(16);1===d.length&&(d="0"+d),l+=d}return l.toLowerCase()};var L=new RegExp("^-?(0*)\\d{1,10}$"),M=-2147483648,U=2147483647,j=function(e){if(L.test(e)){var t=Number(e);if(t>=M&&t<=U)return t}return null},F=function(e){try{e()}catch(t){setTimeout((function(){var e=t.stack||"";throw S("Exception was thrown by user callback.",e),t}),Math.floor(0))}},V=function(e,t){var n=setTimeout(e,t);return"object"===typeof n&&n.unref&&n.unref(),n},B=function(){function e(e,t,n){var r=this;this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.get().then((function(e){return r.auth_=e}))}return e.prototype.getToken=function(e){return this.auth_?this.auth_.getToken(e).catch((function(e){return e&&"auth/token-not-initialized"===e.code?(b("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)})):Promise.resolve(null)},e.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):(setTimeout((function(){return e(null)}),0),this.authProvider_.get().then((function(t){return t.addAuthTokenListener(e)})))},e.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then((function(t){return t.removeAuthTokenListener(e)}))},e.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',S(e)},e}(),W=function(){function e(){}return e.prototype.getToken=function(t){return Promise.resolve({accessToken:e.EMULATOR_AUTH_TOKEN})},e.prototype.addTokenChangeListener=function(t){t(e.EMULATOR_AUTH_TOKEN)},e.prototype.removeTokenChangeListener=function(e){},e.prototype.notifyForInvalidToken=function(){},e.EMULATOR_AUTH_TOKEN="owner",e}(),G="5",q=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,K="websocket",H="long_polling",z=function(){function e(e,t,n,r,i,o,a){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=!1),this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=o,this.includeNamespaceInQueryParams=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=d.get("host:"+e)||this._host}return e.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},e.prototype.isCustomHost=function(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain},Object.defineProperty(e.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&d.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),e.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},e.prototype.toURLString=function(){var e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+t},e}();function Y(e,t,n){var r;if(Object(o.f)("string"===typeof t,"typeof type must == string"),Object(o.f)("object"===typeof n,"typeof params must == object"),t===K)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else{if(t!==H)throw new Error("Unknown connection type: "+t);r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?"}(function(e){return e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams})(e)&&(n.ns=e.namespace);var i=[];return D(n,(function(e,t){i.push(e+"="+t)})),r+i.join("&")}var Q=function(){function e(){this.counters_={}}return e.prototype.incrementCounter=function(e,t){void 0===t&&(t=1),Object(o.k)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t},e.prototype.get=function(){return Object(o.m)(this.counters_)},e}(),X={},J={};function $(e){var t=e.toString();return X[t]||(X[t]=new Q),X[t]}var Z=function(){function e(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return e.prototype.closeAfter=function(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},e.prototype.handleResponse=function(e,t){var n=this;this.pendingResponses[e]=t;for(var r=function(){var e=i.pendingResponses[i.currentResponseNum];delete i.pendingResponses[i.currentResponseNum];for(var t=function(t){e[t]&&F((function(){n.onMessage_(e[t])}))},r=0;r<e.length;++r)t(r);if(i.currentResponseNum===i.closeAfterResponse)return i.onClose&&(i.onClose(),i.onClose=null),"break";i.currentResponseNum++},i=this;this.pendingResponses[this.currentResponseNum];){if("break"===r())break}},e}(),ee="start",te="close",ne=function(){function e(e,t,n,r,i){this.connId=e,this.repoInfo=t,this.applicationId=n,this.transportSessionId=r,this.lastSessionId=i,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=E(e),this.stats_=$(t),this.urlFn=function(e){return Y(t,H,e)}}return e.prototype.open=function(e,t){var n=this;this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new Z(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout((function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null}),Math.floor(3e4)),function(e){if(Object(o.A)()||"complete"===document.readyState)e();else{var t=!1,n=function n(){document.body?t||(t=!0,e()):setTimeout(n,Math.floor(10))};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",(function(){"complete"===document.readyState&&n()})),window.attachEvent("onload",n))}}((function(){if(!n.isClosed_){n.scriptTagHolder=new re((function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(a.c)(e,5),i=r[0],o=r[1],s=r[2];r[3],r[4];if(n.incrementIncomingBytes_(e),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,i===ee)n.id=o,n.password=s;else{if(i!==te)throw new Error("Unrecognized command received: "+i);o?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(o,(function(){n.onClosed_()}))):n.onClosed_()}}),(function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=Object(a.c)(e,2),i=r[0],o=r[1];n.incrementIncomingBytes_(e),n.myPacketOrderer.handleResponse(i,o)}),(function(){n.onClosed_()}),n.urlFn);var e={start:"t"};e.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=n.scriptTagHolder.uniqueCallbackIdentifier),e.v=G,n.transportSessionId&&(e.s=n.transportSessionId),n.lastSessionId&&(e.ls=n.lastSessionId),n.applicationId&&(e.p=n.applicationId),"undefined"!==typeof location&&location.hostname&&q.test(location.hostname)&&(e.r="f");var t=n.urlFn(e);n.log_("Connecting via long-poll to "+t),n.scriptTagHolder.addTag(t,(function(){}))}}))},e.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},e.forceAllow=function(){e.forceAllow_=!0},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){return!Object(o.A)()&&(!!e.forceAllow_||!e.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!("object"===typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"===typeof Windows&&"object"===typeof Windows.UI))},e.prototype.markConnectionHealthy=function(){},e.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},e.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},e.prototype.send=function(e){var t=Object(o.K)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);for(var n=Object(o.i)(t),r=P(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},e.prototype.addDisconnectPingFrame=function(e,t){if(!Object(o.A)()){this.myDisconnFrame=document.createElement("iframe");var n={dframe:"t"};n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},e.prototype.incrementIncomingBytes_=function(e){var t=Object(o.K)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)},e}(),re=function(){function e(t,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,Object(o.A)())this.commandCB=t,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=p(),window["pLPCommand"+this.uniqueCallbackIdentifier]=t,window["pRTLPCB"+this.uniqueCallbackIdentifier]=n,this.myIFrame=e.createIFrame_();var a="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length))a='<script>document.domain="'+document.domain+'";<\/script>';var s="<html><body>"+a+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(s),this.myIFrame.doc.close()}catch(c){b("frame writing exception"),c.stack&&b(c.stack),b(c)}}}return e.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(e);try{e.contentWindow.document||b("No IE domain setting required")}catch(n){var t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},e.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout((function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)}),Math.floor(0)));var t=this.onDisconnect;t&&(this.onDisconnect=null,t())},e.prototype.startLongPoll=function(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););},e.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;for(var t=this.urlFn(e),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}return!1},e.prototype.enqueueSegment=function(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()},e.prototype.addLongPollTag_=function(e,t){var n=this;this.outstandingRequests.add(t);var r=function(){n.outstandingRequests.delete(t),n.newRequest_()},i=setTimeout(r,Math.floor(25e3));this.addTag(e,(function(){clearTimeout(i),r()}))},e.prototype.addTag=function(e,t){var n=this;Object(o.A)()?this.doNodeLongPoll(e,t):setTimeout((function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,r.onload=r.onreadystatechange=function(){var e=r.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),t())},r.onerror=function(){b("Long-poll script failed to load: "+e),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(i){}}),Math.floor(1))},e}(),ie="";function oe(e){ie=e}var ae=null;"undefined"!==typeof MozWebSocket?ae=MozWebSocket:"undefined"!==typeof WebSocket&&(ae=WebSocket);var se=function(){function t(e,n,r,i,o){this.connId=e,this.applicationId=r,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=E(this.connId),this.stats_=$(n),this.connURL=t.connectionURL_(n,i,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(e,t,n){var r={};return r.v=G,!Object(o.A)()&&"undefined"!==typeof location&&location.hostname&&q.test(location.hostname)&&(r.r="f"),t&&(r.s=t),n&&(r.ls=n),Y(e,K,r)},t.prototype.open=function(t,n){var r=this;this.onDisconnect=n,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,d.set("previous_websocket_failure",!0);try{if(Object(o.A)()){var i=this.nodeAdmin?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/5/"+ie+"/"+e.platform+"/"+i,"X-Firebase-GMPID":this.applicationId||""}},s=Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}),c=0===this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;c&&(a.proxy={origin:c}),this.mySock=new ae(this.connURL,[],a)}else{a={headers:{"X-Firebase-GMPID":this.applicationId||""}};this.mySock=new ae(this.connURL,[],a)}}catch(l){this.log_("Error instantiating WebSocket.");var u=l.message||l.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(e){r.handleIncomingFrame(e)},this.mySock.onerror=function(e){r.log_("WebSocket error.  Closing connection.");var t=e.message||e.data;t&&r.log_(t),r.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);n&&n.length>1&&parseFloat(n[1])<4.4&&(e=!0)}return!e&&null!==ae&&!t.forceDisallow_},t.previouslyFailed=function(){return d.isInMemoryStorage||!0===d.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){d.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var t=this.frames.join("");this.frames=null;var n=Object(o.E)(t);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},t.prototype.extractFrameCount_=function(e){if(Object(o.f)(null===this.frames,"We already have a frame buffer"),e.length<=6){var t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e},t.prototype.handleIncomingFrame=function(e){if(null!==this.mySock){var t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{var n=this.extractFrameCount_(t);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(e){this.resetKeepAlive();var t=Object(o.K)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);var n=P(t,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval((function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()}),Math.floor(45e3))},t.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),ce=function(){function e(e){this.initTransports_(e)}return Object.defineProperty(e,"ALL_TRANSPORTS",{get:function(){return[ne,se]},enumerable:!1,configurable:!0}),e.prototype.initTransports_=function(t){var n,r,i=se&&se.isAvailable(),o=i&&!se.previouslyFailed();if(t.webSocketOnly&&(i||S("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[se];else{var s=this.transports_=[];try{for(var c=Object(a.e)(e.ALL_TRANSPORTS),u=c.next();!u.done;u=c.next()){var l=u.value;l&&l.isAvailable()&&s.push(l)}}catch(d){n={error:d}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}},e.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},e.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},e}(),ue=function(){function e(e,t,n,r,i,o,a,s){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.onMessage_=r,this.onReady_=i,this.onDisconnect_=o,this.onKill_=a,this.lastSessionId=s,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=E("c:"+this.id+":"),this.transportManager_=new ce(t),this.log_("Connection created"),this.start_()}return e.prototype.start_=function(){var e=this,t=this.transportManager_.initialTransport();this.conn_=new t(this.nextTransportId_(),this.repoInfo_,this.applicationId_,void 0,this.lastSessionId),this.primaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout((function(){e.conn_&&e.conn_.open(n,r)}),Math.floor(0));var i=t.healthyTimeout||0;i>0&&(this.healthyTimeout_=V((function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>102400?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>10240?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))}),Math.floor(i)))},e.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},e.prototype.disconnReceiver_=function(e){var t=this;return function(n){e===t.conn_?t.onConnectionLost_(n):e===t.secondaryConn_?(t.log_("Secondary connection lost."),t.onSecondaryConnectionLost_()):t.log_("closing an old connection")}},e.prototype.connReceiver_=function(e){var t=this;return function(n){2!==t.state_&&(e===t.rx_?t.onPrimaryMessageReceived_(n):e===t.secondaryConn_?t.onSecondaryMessageReceived_(n):t.log_("message on old connection"))}},e.prototype.sendRequest=function(e){var t={t:"d",d:e};this.sendData_(t)},e.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},e.prototype.onSecondaryControl_=function(e){if("t"in e){var t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},e.prototype.onSecondaryMessageReceived_=function(e){var t=O("t",e),n=O("d",e);if("c"===t)this.onSecondaryControl_(n);else{if("d"!==t)throw new Error("Unknown protocol layer: "+t);this.pendingDataMessages.push(n)}},e.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},e.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},e.prototype.onPrimaryMessageReceived_=function(e){var t=O("t",e),n=O("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)},e.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},e.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},e.prototype.onControl_=function(e){var t=O("t",e);if("d"in e){var n=e.d;if("h"===t)this.onHandshake_(n);else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?w("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):w("Unknown control packet command: "+t)}},e.prototype.onHandshake_=function(e){var t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),G!==n&&S("Protocol version mismatch detected"),this.tryStartUpgrade_())},e.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},e.prototype.startUpgrade_=function(e){var t=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),V((function(){t.secondaryConn_&&(t.log_("Timed out trying to upgrade."),t.secondaryConn_.close())}),Math.floor(6e4))},e.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())},e.prototype.onConnectionEstablished_=function(e,t){var n=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):V((function(){n.sendPingOnPrimaryIfNecessary_()}),Math.floor(5e3))},e.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},e.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==e&&this.rx_!==e||this.close()},e.prototype.onConnectionLost_=function(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(d.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},e.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},e.prototype.sendData_=function(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)},e.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},e.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},e}(),le=function(){function e(){}return e.prototype.put=function(e,t,n,r){},e.prototype.merge=function(e,t,n,r){},e.prototype.refreshAuthToken=function(e){},e.prototype.onDisconnectPut=function(e,t,n){},e.prototype.onDisconnectMerge=function(e,t,n){},e.prototype.onDisconnectCancel=function(e,t){},e.prototype.reportStats=function(e){},e}(),de=function(){function e(e){this.allowedEvents_=e,this.listeners_={},Object(o.f)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(Array.isArray(this.listeners_[e]))for(var r=Object(a.d)([],Object(a.c)(this.listeners_[e])),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,t)},e.prototype.on=function(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});var r=this.getInitialEvent(e);r&&t.apply(n,r)},e.prototype.off=function(e,t,n){this.validateEventType_(e);for(var r=this.listeners_[e]||[],i=0;i<r.length;i++)if(r[i].callback===t&&(!n||n===r[i].context))return void r.splice(i,1)},e.prototype.validateEventType_=function(e){Object(o.f)(this.allowedEvents_.find((function(t){return t===e})),"Unknown event: "+e)},e}(),fe=function(e){function t(){var t=e.call(this,["online"])||this;return t.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||Object(o.y)()||(window.addEventListener("online",(function(){t.online_||(t.online_=!0,t.trigger("online",!0))}),!1),window.addEventListener("offline",(function(){t.online_&&(t.online_=!1,t.trigger("online",!1))}),!1)),t}return Object(a.b)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(o.f)("online"===e,"Unknown event type: "+e),[this.online_]},t.prototype.currentlyOnline=function(){return this.online_},t}(de),he=function(){function e(e,t){if(void 0===t){this.pieces_=e.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}return e.prototype.toString=function(){for(var e="",t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"},e}();function pe(){return new he("")}function ve(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function me(e){return e.pieces_.length-e.pieceNum_}function ge(e){var t=e.pieceNum_;return t<e.pieces_.length&&t++,new he(e.pieces_,t)}function ye(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function _e(e,t){return void 0===t&&(t=0),e.pieces_.slice(e.pieceNum_+t)}function be(e){if(e.pieceNum_>=e.pieces_.length)return null;for(var t=[],n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new he(t,0)}function Ee(e,t){for(var n=[],r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);if(t instanceof he)for(r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);else{var i=t.split("/");for(r=0;r<i.length;r++)i[r].length>0&&n.push(i[r])}return new he(n,0)}function we(e){return e.pieceNum_>=e.pieces_.length}function Te(e,t){var n=ve(e),r=ve(t);if(null===n)return t;if(n===r)return Te(ge(e),ge(t));throw new Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function Se(e,t){for(var n=_e(e,0),r=_e(t,0),i=0;i<n.length&&i<r.length;i++){var o=C(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1}function Ie(e,t){if(me(e)!==me(t))return!1;for(var n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function Re(e,t){var n=e.pieceNum_,r=t.pieceNum_;if(me(e)>me(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}var Ae=function(e,t){this.errorPrefix_=t,this.parts_=_e(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=Object(o.I)(this.parts_[n]);Ce(this)};function Ce(e){if(e.byteLength_>768)throw new Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw new Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+ke(e))}function ke(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}var Oe,Ne,Pe=function(e){function t(){var t,n,r=e.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(n="visibilitychange",t="hidden"):"undefined"!==typeof document.mozHidden?(n="mozvisibilitychange",t="mozHidden"):"undefined"!==typeof document.msHidden?(n="msvisibilitychange",t="msHidden"):"undefined"!==typeof document.webkitHidden&&(n="webkitvisibilitychange",t="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,(function(){var e=!document[t];e!==r.visible_&&(r.visible_=e,r.trigger("visible",e))}),!1),r}return Object(a.b)(t,e),t.getInstance=function(){return new t},t.prototype.getInitialEvent=function(e){return Object(o.f)("visible"===e,"Unknown event type: "+e),[this.visible_]},t}(de),De=1e3,xe=function(e){function t(n,r,i,a,s,c,u){var l=e.call(this)||this;if(l.repoInfo_=n,l.applicationId_=r,l.onDataUpdate_=i,l.onConnectStatus_=a,l.onServerInfoUpdate_=s,l.authTokenProvider_=c,l.authOverride_=u,l.id=t.nextPersistentConnectionId_++,l.log_=E("p:"+l.id+":"),l.interruptReasons_={},l.listens=new Map,l.outstandingPuts_=[],l.outstandingGets_=[],l.outstandingPutCount_=0,l.outstandingGetCount_=0,l.onDisconnectRequestQueue_=[],l.connected_=!1,l.reconnectDelay_=De,l.maxReconnectDelay_=3e5,l.securityDebugCallback_=null,l.lastSessionId=null,l.establishConnectionTimer_=null,l.visible_=!1,l.requestCBHash_={},l.requestNumber_=0,l.realtime_=null,l.authToken_=null,l.forceTokenRefresh_=!1,l.invalidAuthTokenCount_=0,l.firstConnection_=!0,l.lastConnectionAttemptTime_=null,l.lastConnectionEstablishedTime_=null,u&&!Object(o.A)())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return l.scheduleConnect_(0),Pe.getInstance().on("visible",l.onVisible_,l),-1===n.host.indexOf("fblocal")&&fe.getInstance().on("online",l.onOnline_,l),l}return Object(a.b)(t,e),t.prototype.sendRequest=function(e,t,n){var r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_(Object(o.K)(i)),Object(o.f)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},t.prototype.get=function(e){var t=this,n=new o.a,r={p:e._path.toString(),q:e._queryObject},i={action:"g",request:r,onComplete:function(e){var i=e.d;"ok"===e.s?(t.onDataUpdate_(r.p,i,!1,null),n.resolve(i)):n.reject(i)}};this.outstandingGets_.push(i),this.outstandingGetCount_++;var a=this.outstandingGets_.length-1;return this.connected_||setTimeout((function(){var e=t.outstandingGets_[a];void 0!==e&&i===e&&(delete t.outstandingGets_[a],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),t.log_("get "+a+" timed out on connection"),n.reject(new Error("Client is offline.")))}),3e3),this.connected_&&this.sendGet_(a),n.promise},t.prototype.listen=function(e,t,n,r){var i=e._queryIdentifier,a=e._path.toString();this.log_("Listen called for "+a+" "+i),this.listens.has(a)||this.listens.set(a,new Map),Object(o.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),Object(o.f)(!this.listens.get(a).has(i),"listen() called twice for same path/queryId.");var s={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(a).set(i,s),this.connected_&&this.sendListen_(s)},t.prototype.sendGet_=function(e){var t=this,n=this.outstandingGets_[e];this.sendRequest("g",n.request,(function(r){delete t.outstandingGets_[e],t.outstandingGetCount_--,0===t.outstandingGetCount_&&(t.outstandingGets_=[]),n.onComplete&&n.onComplete(r)}))},t.prototype.sendListen_=function(e){var n=this,r=e.query,i=r._path.toString(),o=r._queryIdentifier;this.log_("Listen on "+i+" for "+o);var a={p:i};e.tag&&(a.q=r._queryObject,a.t=e.tag),a.h=e.hashFn(),this.sendRequest("q",a,(function(a){var s=a.d,c=a.s;t.warnOnListenWarnings_(s,r),(n.listens.get(i)&&n.listens.get(i).get(o))===e&&(n.log_("listen response",a),"ok"!==c&&n.removeListen_(i,o),e.onComplete&&e.onComplete(c,s))}))},t.warnOnListenWarnings_=function(e,t){if(e&&"object"===typeof e&&Object(o.k)(e,"w")){var n=Object(o.H)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+t._queryParams.getIndex().toString()+'"',i=t._path.toString();S("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},t.prototype.refreshAuthToken=function(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},(function(){})),this.reduceReconnectDelayIfAdminCredential_(e)},t.prototype.reduceReconnectDelayIfAdminCredential_=function(e){(e&&40===e.length||Object(o.r)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},t.prototype.tryAuth=function(){var e=this;if(this.connected_&&this.authToken_){var t=this.authToken_,n=Object(o.D)(t)?"auth":"gauth",r={cred:t};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,(function(n){var r=n.s,i=n.d||"error";e.authToken_===t&&("ok"===r?e.invalidAuthTokenCount_=0:e.onAuthRevoked_(r,i))}))}},t.prototype.unlisten=function(e,t){var n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),Object(o.f)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)},t.prototype.sendUnlisten_=function(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);var i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},t.prototype.onDisconnectPut=function(e,t,n){this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})},t.prototype.onDisconnectMerge=function(e,t,n){this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})},t.prototype.onDisconnectCancel=function(e,t){this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})},t.prototype.sendOnDisconnect_=function(e,t,n,r){var i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,(function(e){r&&setTimeout((function(){r(e.s,e.d)}),Math.floor(0))}))},t.prototype.put=function(e,t,n,r){this.putInternal("p",e,t,n,r)},t.prototype.merge=function(e,t,n,r){this.putInternal("m",e,t,n,r)},t.prototype.putInternal=function(e,t,n,r,i){var o={p:t,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:e,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+t)},t.prototype.sendPut_=function(e){var t=this,n=this.outstandingPuts_[e].action,r=this.outstandingPuts_[e].request,i=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(n,r,(function(r){t.log_(n+" response",r),delete t.outstandingPuts_[e],t.outstandingPutCount_--,0===t.outstandingPutCount_&&(t.outstandingPuts_=[]),i&&i(r.s,r.d)}))},t.prototype.reportStats=function(e){var t=this;if(this.connected_){var n={c:e};this.log_("reportStats",n),this.sendRequest("s",n,(function(e){if("ok"!==e.s){var n=e.d;t.log_("reportStats","Error sending stats: "+n)}}))}},t.prototype.onDataMessage_=function(e){if("r"in e){this.log_("from server: "+Object(o.K)(e));var t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else{if("error"in e)throw"A server-side error has occurred: "+e.error;"a"in e&&this.onDataPush_(e.a,e.b)}},t.prototype.onDataPush_=function(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):w("Unrecognized action received from server: "+Object(o.K)(e)+"\nAre you using the latest client?")},t.prototype.onReady_=function(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},t.prototype.scheduleConnect_=function(e){var t=this;Object(o.f)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout((function(){t.establishConnectionTimer_=null,t.establishConnection_()}),Math.floor(e))},t.prototype.onVisible_=function(e){e&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0)),this.visible_=e},t.prototype.onOnline_=function(e){e?(this.log_("Browser went online."),this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},t.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){(new Date).getTime()-this.lastConnectionEstablishedTime_>3e4&&(this.reconnectDelay_=De),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},t.prototype.establishConnection_=function(){var e=this;if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),i=this.onRealtimeDisconnect_.bind(this),a=this.id+":"+t.nextConnectionId_++,s=this,c=this.lastSessionId,u=!1,l=null,d=function(){l?l.close():(u=!0,i())};this.realtime_={close:d,sendRequest:function(e){Object(o.f)(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(e)}};var f=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(f).then((function(e){u?b("getToken() completed but was canceled"):(b("getToken() completed. Creating connection."),s.authToken_=e&&e.accessToken,l=new ue(a,s.repoInfo_,s.applicationId_,n,r,i,(function(e){S(e+" ("+s.repoInfo_.toString()+")"),s.interrupt("server_kill")}),c))})).then(null,(function(t){s.log_("Failed to get token: "+t),u||(e.repoInfo_.nodeAdmin&&S(t),d())}))}},t.prototype.interrupt=function(e){b("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},t.prototype.resume=function(e){b("Resuming connection for reason: "+e),delete this.interruptReasons_[e],Object(o.v)(this.interruptReasons_)&&(this.reconnectDelay_=De,this.realtime_||this.scheduleConnect_(0))},t.prototype.handleTimestamp_=function(e){var t=e-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:t})},t.prototype.cancelSentTransactions_=function(){for(var e=0;e<this.outstandingPuts_.length;e++){var t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},t.prototype.onListenRevoked_=function(e,t){var n;n=t?t.map((function(e){return N(e)})).join("$"):"default";var r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")},t.prototype.removeListen_=function(e,t){var n,r=new he(e).toString();if(this.listens.has(r)){var i=this.listens.get(r);n=i.get(t),i.delete(t),0===i.size&&this.listens.delete(r)}else n=void 0;return n},t.prototype.onAuthRevoked_=function(e,t){b("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==e&&"permission_denied"!==e||(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))},t.prototype.onSecurityDebugPacket_=function(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))},t.prototype.restoreState_=function(){var e,t,n,r;this.tryAuth();try{for(var i=Object(a.e)(this.listens.values()),o=i.next();!o.done;o=i.next()){var s=o.value;try{for(var c=(n=void 0,Object(a.e)(s.values())),u=c.next();!u.done;u=c.next()){var l=u.value;this.sendListen_(l)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}}}catch(p){e={error:p}}finally{try{o&&!o.done&&(t=i.return)&&t.call(i)}finally{if(e)throw e.error}}for(var d=0;d<this.outstandingPuts_.length;d++)this.outstandingPuts_[d]&&this.sendPut_(d);for(;this.onDisconnectRequestQueue_.length;){var f=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(f.action,f.pathString,f.data,f.onComplete)}for(d=0;d<this.outstandingGets_.length;d++)this.outstandingGets_[d]&&this.sendGet_(d)},t.prototype.sendConnectStats_=function(){var e={},t="js";Object(o.A)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+ie.replace(/\./g,"-")]=1,Object(o.y)()?e["framework.cordova"]=1:Object(o.B)()&&(e["framework.reactnative"]=1),this.reportStats(e)},t.prototype.shouldReconnect_=function(){var e=fe.getInstance().currentlyOnline();return Object(o.v)(this.interruptReasons_)&&e},t.nextPersistentConnectionId_=0,t.nextConnectionId_=0,t}(le),Le=function(){function e(e,t){this.name=e,this.node=t}return e.Wrap=function(t,n){return new e(t,n)},e}(),Me=function(){function e(){}return e.prototype.getCompare=function(){return this.compare.bind(this)},e.prototype.indexedValueChanged=function(e,t){var n=new Le(R,e),r=new Le(R,t);return 0!==this.compare(n,r)},e.prototype.minPost=function(){return Le.MIN},e}(),Ue=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),Object.defineProperty(t,"__EMPTY_NODE",{get:function(){return Oe},set:function(e){Oe=e},enumerable:!1,configurable:!0}),t.prototype.compare=function(e,t){return C(e.name,t.name)},t.prototype.isDefinedOn=function(e){throw Object(o.g)("KeyIndex.isDefinedOn not expected to be called.")},t.prototype.indexedValueChanged=function(e,t){return!1},t.prototype.minPost=function(){return Le.MIN},t.prototype.maxPost=function(){return new Le(A,Oe)},t.prototype.makePost=function(e,t){return Object(o.f)("string"===typeof e,"KeyIndex indexValue must always be a string."),new Le(e,Oe)},t.prototype.toString=function(){return".key"},t}(Me),je=new Ue,Fe=function(){function e(e,t,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!e.isEmpty();)if(e=e,o=t?n(e.key,t):1,r&&(o*=-1),o<0)e=this.isReverse_?e.left:e.right;else{if(0===o){this.nodeStack_.push(e);break}this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}}return e.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var e,t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e},e.prototype.hasNext=function(){return this.nodeStack_.length>0},e.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},e}(),Ve=function(){function e(t,n,r,i,o){this.key=t,this.value=n,this.color=null!=r?r:e.RED,this.left=null!=i?i:We.EMPTY_NODE,this.right=null!=o?o:We.EMPTY_NODE}return e.prototype.copy=function(t,n,r,i,o){return new e(null!=t?t:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},e.prototype.count=function(){return this.left.count()+1+this.right.count()},e.prototype.isEmpty=function(){return!1},e.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},e.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},e.prototype.minKey=function(){return this.min_().key},e.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},e.prototype.insert=function(e,t,n){var r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()},e.prototype.removeMin_=function(){if(this.left.isEmpty())return We.EMPTY_NODE;var e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()},e.prototype.remove=function(e,t){var n,r;if(t(e,(n=this).key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return We.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()},e.prototype.isRed_=function(){return this.color},e.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},e.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e},e.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e},e.prototype.rotateLeft_=function(){var t=this.copy(null,null,e.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)},e.prototype.rotateRight_=function(){var t=this.copy(null,null,e.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)},e.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)},e.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},e.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},e.RED=!0,e.BLACK=!1,e}(),Be=function(){function e(){}return e.prototype.copy=function(e,t,n,r,i){return this},e.prototype.insert=function(e,t,n){return new Ve(e,t,null)},e.prototype.remove=function(e,t){return this},e.prototype.count=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.inorderTraversal=function(e){return!1},e.prototype.reverseTraversal=function(e){return!1},e.prototype.minKey=function(){return null},e.prototype.maxKey=function(){return null},e.prototype.check_=function(){return 0},e.prototype.isRed_=function(){return!1},e}(),We=function(){function e(t,n){void 0===n&&(n=e.EMPTY_NODE),this.comparator_=t,this.root_=n}return e.prototype.insert=function(t,n){return new e(this.comparator_,this.root_.insert(t,n,this.comparator_).copy(null,null,Ve.BLACK,null,null))},e.prototype.remove=function(t){return new e(this.comparator_,this.root_.remove(t,this.comparator_).copy(null,null,Ve.BLACK,null,null))},e.prototype.get=function(e){for(var t,n=this.root_;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null},e.prototype.getPredecessorKey=function(e){for(var t,n=this.root_,r=null;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},e.prototype.isEmpty=function(){return this.root_.isEmpty()},e.prototype.count=function(){return this.root_.count()},e.prototype.minKey=function(){return this.root_.minKey()},e.prototype.maxKey=function(){return this.root_.maxKey()},e.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},e.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},e.prototype.getIterator=function(e){return new Fe(this.root_,null,this.comparator_,!1,e)},e.prototype.getIteratorFrom=function(e,t){return new Fe(this.root_,e,this.comparator_,!1,t)},e.prototype.getReverseIteratorFrom=function(e,t){return new Fe(this.root_,e,this.comparator_,!0,t)},e.prototype.getReverseIterator=function(e){return new Fe(this.root_,null,this.comparator_,!0,e)},e.EMPTY_NODE=new Be,e}();function Ge(e,t){return C(e.name,t.name)}function qe(e,t){return C(e,t)}var Ke,He,ze,Ye=function(e){return"number"===typeof e?"number:"+x(e):"string:"+e},Qe=function(e){if(e.isLeafNode()){var t=e.val();Object(o.f)("string"===typeof t||"number"===typeof t||"object"===typeof t&&Object(o.k)(t,".sv"),"Priority must be a string or number.")}else Object(o.f)(e===Ne||e.isEmpty(),"priority of unexpected type.");Object(o.f)(e===Ne||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Xe=function(){function e(t,n){void 0===n&&(n=e.__childrenNodeConstructor.EMPTY_NODE),this.value_=t,this.priorityNode_=n,this.lazyHash_=null,Object(o.f)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Qe(this.priorityNode_)}return Object.defineProperty(e,"__childrenNodeConstructor",{get:function(){return Ke},set:function(e){Ke=e},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!0},e.prototype.getPriority=function(){return this.priorityNode_},e.prototype.updatePriority=function(t){return new e(this.value_,t)},e.prototype.getImmediateChild=function(t){return".priority"===t?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.getChild=function(t){return we(t)?this:".priority"===ve(t)?this.priorityNode_:e.__childrenNodeConstructor.EMPTY_NODE},e.prototype.hasChild=function(){return!1},e.prototype.getPredecessorChildName=function(e,t){return null},e.prototype.updateImmediateChild=function(t,n){return".priority"===t?this.updatePriority(n):n.isEmpty()&&".priority"!==t?this:e.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(t,n).updatePriority(this.priorityNode_)},e.prototype.updateChild=function(t,n){var r=ve(t);return null===r?n:n.isEmpty()&&".priority"!==r?this:(Object(o.f)(".priority"!==r||1===me(t),".priority must be the last token in a path"),this.updateImmediateChild(r,e.__childrenNodeConstructor.EMPTY_NODE.updateChild(ge(t),n)))},e.prototype.isEmpty=function(){return!1},e.prototype.numChildren=function(){return 0},e.prototype.forEachChild=function(e,t){return!1},e.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+Ye(this.priorityNode_.val())+":");var t=typeof this.value_;e+=t+":",e+="number"===t?x(this.value_):this.value_,this.lazyHash_=v(e)}return this.lazyHash_},e.prototype.getValue=function(){return this.value_},e.prototype.compareTo=function(t){return t===e.__childrenNodeConstructor.EMPTY_NODE?1:t instanceof e.__childrenNodeConstructor?-1:(Object(o.f)(t.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(t))},e.prototype.compareToLeafNode_=function(t){var n=typeof t.value_,r=typeof this.value_,i=e.VALUE_TYPE_ORDER.indexOf(n),a=e.VALUE_TYPE_ORDER.indexOf(r);return Object(o.f)(i>=0,"Unknown leaf type: "+n),Object(o.f)(a>=0,"Unknown leaf type: "+r),i===a?"object"===r?0:this.value_<t.value_?-1:this.value_===t.value_?0:1:a-i},e.prototype.withIndex=function(){return this},e.prototype.isIndexed=function(){return!0},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var t=e;return this.value_===t.value_&&this.priorityNode_.equals(t.priorityNode_)}return!1},e.VALUE_TYPE_ORDER=["object","boolean","number","string"],e}();var Je,$e,Ze=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.compare=function(e,t){var n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?C(e.name,t.name):i},t.prototype.isDefinedOn=function(e){return!e.getPriority().isEmpty()},t.prototype.indexedValueChanged=function(e,t){return!e.getPriority().equals(t.getPriority())},t.prototype.minPost=function(){return Le.MIN},t.prototype.maxPost=function(){return new Le(A,new Xe("[PRIORITY-POST]",ze))},t.prototype.makePost=function(e,t){var n=He(e);return new Le(t,new Xe("[PRIORITY-POST]",n))},t.prototype.toString=function(){return".priority"},t}(Me)),et=Math.log(2),tt=function(){function e(e){var t;this.count=(t=e+1,parseInt(Math.log(t)/et,10)),this.current_=this.count-1;var n,r=(n=this.count,parseInt(Array(n+1).join("1"),2));this.bits_=e+1&r}return e.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},e}(),nt=function(e,t,n,r){e.sort(t);var i=function t(r,i){var o,a,s=i-r;if(0===s)return null;if(1===s)return o=e[r],a=n?n(o):o,new Ve(a,o.node,Ve.BLACK,null,null);var c=parseInt(s/2,10)+r,u=t(r,c),l=t(c+1,i);return o=e[c],a=n?n(o):o,new Ve(a,o.node,Ve.BLACK,u,l)},o=function(t){for(var r=null,o=null,a=e.length,s=function(t,r){var o=a-t,s=a;a-=t;var u=i(o+1,s),l=e[o],d=n?n(l):l;c(new Ve(d,l.node,r,null,u))},c=function(e){r?(r.left=e,r=e):(o=e,r=e)},u=0;u<t.count;++u){var l=t.nextBitIsOne(),d=Math.pow(2,t.count-(u+1));l?s(d,Ve.BLACK):(s(d,Ve.BLACK),s(d,Ve.RED))}return o}(new tt(e.length));return new We(r||t,o)},rt={},it=function(){function e(e,t){this.indexes_=e,this.indexSet_=t}return Object.defineProperty(e,"Default",{get:function(){return Object(o.f)(rt&&Ze,"ChildrenNode.ts has not been loaded"),Je=Je||new e({".priority":rt},{".priority":Ze})},enumerable:!1,configurable:!0}),e.prototype.get=function(e){var t=Object(o.H)(this.indexes_,e);if(!t)throw new Error("No index defined for "+e);return t instanceof We?t:null},e.prototype.hasIndex=function(e){return Object(o.k)(this.indexSet_,e.toString())},e.prototype.addIndex=function(t,n){Object(o.f)(t!==je,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r,i=[],s=!1,c=n.getIterator(Le.Wrap),u=c.getNext();u;)s=s||t.isDefinedOn(u.node),i.push(u),u=c.getNext();r=s?nt(i,t.getCompare()):rt;var l=t.toString(),d=Object(a.a)({},this.indexSet_);d[l]=t;var f=Object(a.a)({},this.indexes_);return f[l]=r,new e(f,d)},e.prototype.addToIndexes=function(t,n){var r=this;return new e(Object(o.F)(this.indexes_,(function(e,i){var a=Object(o.H)(r.indexSet_,i);if(Object(o.f)(a,"Missing index implementation for "+i),e===rt){if(a.isDefinedOn(t.node)){for(var s=[],c=n.getIterator(Le.Wrap),u=c.getNext();u;)u.name!==t.name&&s.push(u),u=c.getNext();return s.push(t),nt(s,a.getCompare())}return rt}var l=n.get(t.name),d=e;return l&&(d=d.remove(new Le(t.name,l))),d.insert(t,t.node)})),this.indexSet_)},e.prototype.removeFromIndexes=function(t,n){return new e(Object(o.F)(this.indexes_,(function(e){if(e===rt)return e;var r=n.get(t.name);return r?e.remove(new Le(t.name,r)):e})),this.indexSet_)},e}(),ot=function(){function e(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Qe(this.priorityNode_),this.children_.isEmpty()&&Object(o.f)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(e,"EMPTY_NODE",{get:function(){return $e||($e=new e(new We(qe),null,it.Default))},enumerable:!1,configurable:!0}),e.prototype.isLeafNode=function(){return!1},e.prototype.getPriority=function(){return this.priorityNode_||$e},e.prototype.updatePriority=function(t){return this.children_.isEmpty()?this:new e(this.children_,t,this.indexMap_)},e.prototype.getImmediateChild=function(e){if(".priority"===e)return this.getPriority();var t=this.children_.get(e);return null===t?$e:t},e.prototype.getChild=function(e){var t=ve(e);return null===t?this:this.getImmediateChild(t).getChild(ge(e))},e.prototype.hasChild=function(e){return null!==this.children_.get(e)},e.prototype.updateImmediateChild=function(t,n){if(Object(o.f)(n,"We should always be passing snapshot nodes"),".priority"===t)return this.updatePriority(n);var r=new Le(t,n),i=void 0,a=void 0;n.isEmpty()?(i=this.children_.remove(t),a=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(t,n),a=this.indexMap_.addToIndexes(r,this.children_));var s=i.isEmpty()?$e:this.priorityNode_;return new e(i,s,a)},e.prototype.updateChild=function(e,t){var n=ve(e);if(null===n)return t;Object(o.f)(".priority"!==ve(e)||1===me(e),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(ge(e),t);return this.updateImmediateChild(n,r)},e.prototype.isEmpty=function(){return this.children_.isEmpty()},e.prototype.numChildren=function(){return this.children_.count()},e.prototype.val=function(t){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Ze,(function(a,s){n[a]=s.val(t),r++,o&&e.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1})),!t&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return t&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},e.prototype.hash=function(){if(null===this.lazyHash_){var e="";this.getPriority().isEmpty()||(e+="priority:"+Ye(this.getPriority().val())+":"),this.forEachChild(Ze,(function(t,n){var r=n.hash();""!==r&&(e+=":"+t+":"+r)})),this.lazyHash_=""===e?"":v(e)}return this.lazyHash_},e.prototype.getPredecessorChildName=function(e,t,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Le(e,t));return i?i.name:null}return this.children_.getPredecessorKey(e)},e.prototype.getFirstChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.minKey();return n&&n.name}return this.children_.minKey()},e.prototype.getFirstChild=function(e){var t=this.getFirstChildName(e);return t?new Le(t,this.children_.get(t)):null},e.prototype.getLastChildName=function(e){var t=this.resolveIndex_(e);if(t){var n=t.maxKey();return n&&n.name}return this.children_.maxKey()},e.prototype.getLastChild=function(e){var t=this.getLastChildName(e);return t?new Le(t,this.children_.get(t)):null},e.prototype.forEachChild=function(e,t){var n=this.resolveIndex_(e);return n?n.inorderTraversal((function(e){return t(e.name,e.node)})):this.children_.inorderTraversal(t)},e.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},e.prototype.getIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getIteratorFrom(e.name,Le.Wrap),i=r.peek();null!=i&&t.compare(i,e)<0;)r.getNext(),i=r.peek();return r},e.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},e.prototype.getReverseIteratorFrom=function(e,t){var n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,(function(e){return e}));for(var r=this.children_.getReverseIteratorFrom(e.name,Le.Wrap),i=r.peek();null!=i&&t.compare(i,e)>0;)r.getNext(),i=r.peek();return r},e.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===at?-1:0},e.prototype.withIndex=function(t){if(t===je||this.indexMap_.hasIndex(t))return this;var n=this.indexMap_.addIndex(t,this.children_);return new e(this.children_,this.priorityNode_,n)},e.prototype.isIndexed=function(e){return e===je||this.indexMap_.hasIndex(e)},e.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var t=e;if(this.getPriority().equals(t.getPriority())){if(this.children_.count()===t.children_.count()){for(var n=this.getIterator(Ze),r=t.getIterator(Ze),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},e.prototype.resolveIndex_=function(e){return e===je?null:this.indexMap_.get(e.toString())},e.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,e}(),at=new(function(e){function t(){return e.call(this,new We(qe),ot.EMPTY_NODE,it.Default)||this}return Object(a.b)(t,e),t.prototype.compareTo=function(e){return e===this?0:1},t.prototype.equals=function(e){return e===this},t.prototype.getPriority=function(){return this},t.prototype.getImmediateChild=function(e){return ot.EMPTY_NODE},t.prototype.isEmpty=function(){return!1},t}(ot));Object.defineProperties(Le,{MIN:{value:new Le(R,ot.EMPTY_NODE)},MAX:{value:new Le(A,at)}}),Ue.__EMPTY_NODE=ot.EMPTY_NODE,Xe.__childrenNodeConstructor=ot,Ne=at,function(e){ze=e}(at);function st(e,t){if(void 0===t&&(t=null),null===e)return ot.EMPTY_NODE;if("object"===typeof e&&".priority"in e&&(t=e[".priority"]),Object(o.f)(null===t||"string"===typeof t||"number"===typeof t||"object"===typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"===typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!==typeof e||".sv"in e)return new Xe(e,st(t));if(e instanceof Array){var n=ot.EMPTY_NODE;return D(e,(function(t,r){if(Object(o.k)(e,t)&&"."!==t.substring(0,1)){var i=st(r);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}})),n.updatePriority(st(t))}var r=[],i=!1;if(D(e,(function(e,t){if("."!==e.substring(0,1)){var n=st(t);n.isEmpty()||(i=i||!n.getPriority().isEmpty(),r.push(new Le(e,n)))}})),0===r.length)return ot.EMPTY_NODE;var a=nt(r,Ge,(function(e){return e.name}),qe);if(i){var s=nt(r,Ze.getCompare());return new ot(a,st(t),new it({".priority":s},{".priority":Ze}))}return new ot(a,st(t),it.Default)}!function(e){He=e}(st);var ct=function(e){function t(t){var n=e.call(this)||this;return n.indexPath_=t,Object(o.f)(!we(t)&&".priority"!==ve(t),"Can't create PathIndex with empty path or .priority key"),n}return Object(a.b)(t,e),t.prototype.extractChild=function(e){return e.getChild(this.indexPath_)},t.prototype.isDefinedOn=function(e){return!e.getChild(this.indexPath_).isEmpty()},t.prototype.compare=function(e,t){var n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?C(e.name,t.name):i},t.prototype.makePost=function(e,t){var n=st(e),r=ot.EMPTY_NODE.updateChild(this.indexPath_,n);return new Le(t,r)},t.prototype.maxPost=function(){var e=ot.EMPTY_NODE.updateChild(this.indexPath_,at);return new Le(A,e)},t.prototype.toString=function(){return _e(this.indexPath_,0).join("/")},t}(Me),ut=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype.compare=function(e,t){var n=e.node.compareTo(t.node);return 0===n?C(e.name,t.name):n},t.prototype.isDefinedOn=function(e){return!0},t.prototype.indexedValueChanged=function(e,t){return!e.equals(t)},t.prototype.minPost=function(){return Le.MIN},t.prototype.maxPost=function(){return Le.MAX},t.prototype.makePost=function(e,t){var n=st(e);return new Le(t,n)},t.prototype.toString=function(){return".value"},t}(Me)),lt="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",dt=function(){var e=0,t=[];return function(n){var r,i=n===e;e=n;var a=new Array(8);for(r=7;r>=0;r--)a[r]=lt.charAt(n%64),n=Math.floor(n/64);Object(o.f)(0===n,"Cannot push at time == 0");var s=a.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)s+=lt.charAt(t[r]);return Object(o.f)(20===s.length,"nextPushId: Length should be 20."),s}}(),ft=function(e){if("2147483647"===e)return"-";var t=j(e);if(null!=t)return""+(t+1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);if(n.length<786)return n.push("-"),n.join("");for(var i=n.length-1;i>=0&&"z"===n[i];)i--;if(-1===i)return A;var o=n[i],a=lt.charAt(lt.indexOf(o)+1);return n[i]=a,n.slice(0,i+1).join("")},ht=function(e){if("-2147483648"===e)return R;var t=j(e);if(null!=t)return""+(t-1);for(var n=new Array(e.length),r=0;r<n.length;r++)n[r]=e.charAt(r);return"-"===n[n.length-1]?1===n.length?"2147483647":(delete n[n.length-1],n.join("")):(n[n.length-1]=lt.charAt(lt.indexOf(n[n.length-1])-1),n.join("")+"z".repeat(786-n.length))};function pt(e){return{type:"value",snapshotNode:e}}function vt(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function mt(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function gt(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}var yt=function(){function e(e){this.index_=e}return e.prototype.updateChild=function(e,t,n,r,i,a){Object(o.f)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var s=e.getImmediateChild(t);return s.getChild(r).equals(n.getChild(r))&&s.isEmpty()===n.isEmpty()?e:(null!=a&&(n.isEmpty()?e.hasChild(t)?a.trackChildChange(mt(t,s)):Object(o.f)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):s.isEmpty()?a.trackChildChange(vt(t,n)):a.trackChildChange(gt(t,n,s))),e.isLeafNode()&&n.isEmpty()?e:e.updateImmediateChild(t,n).withIndex(this.index_))},e.prototype.updateFullNode=function(e,t,n){return null!=n&&(e.isLeafNode()||e.forEachChild(Ze,(function(e,r){t.hasChild(e)||n.trackChildChange(mt(e,r))})),t.isLeafNode()||t.forEachChild(Ze,(function(t,r){if(e.hasChild(t)){var i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(gt(t,r,i))}else n.trackChildChange(vt(t,r))}))),t.withIndex(this.index_)},e.prototype.updatePriority=function(e,t){return e.isEmpty()?ot.EMPTY_NODE:e.updatePriority(t)},e.prototype.filtersNodes=function(){return!1},e.prototype.getIndexedFilter=function(){return this},e.prototype.getIndex=function(){return this.index_},e}(),_t=function(){function e(t){this.indexedFilter_=new yt(t.getIndex()),this.index_=t.getIndex(),this.startPost_=e.getStartPost_(t),this.endPost_=e.getEndPost_(t)}return e.prototype.getStartPost=function(){return this.startPost_},e.prototype.getEndPost=function(){return this.endPost_},e.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},e.prototype.updateChild=function(e,t,n,r,i,o){return this.matches(new Le(t,n))||(n=ot.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,o)},e.prototype.updateFullNode=function(e,t,n){t.isLeafNode()&&(t=ot.EMPTY_NODE);var r=t.withIndex(this.index_);r=r.updatePriority(ot.EMPTY_NODE);var i=this;return t.forEachChild(Ze,(function(e,t){i.matches(new Le(e,t))||(r=r.updateImmediateChild(e,ot.EMPTY_NODE))})),this.indexedFilter_.updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.indexedFilter_},e.prototype.getIndex=function(){return this.index_},e.getStartPost_=function(e){if(e.hasStart()){var t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}return e.getIndex().minPost()},e.getEndPost_=function(e){if(e.hasEnd()){var t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}return e.getIndex().maxPost()},e}(),bt=function(){function e(e){this.rangedFilter_=new _t(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return e.prototype.updateChild=function(e,t,n,r,i,o){return this.rangedFilter_.matches(new Le(t,n))||(n=ot.EMPTY_NODE),e.getImmediateChild(t).equals(n)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,o):this.fullLimitUpdateChild_(e,t,n,i,o)},e.prototype.updateFullNode=function(e,t,n){var r;if(t.isLeafNode()||t.isEmpty())r=ot.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){r=ot.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext();if(!(this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=(r=t.withIndex(this.index_)).updatePriority(ot.EMPTY_NODE);var s=void 0,c=void 0,u=void 0;i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),s=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var l=this.index_.getCompare();u=function(e,t){return l(t,e)}}else i=r.getIterator(this.index_),s=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),u=this.index_.getCompare();o=0;for(var d=!1;i.hasNext();){a=i.getNext();!d&&u(s,a)<=0&&(d=!0),d&&o<this.limit_&&u(a,c)<=0?o++:r=r.updateImmediateChild(a.name,ot.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)},e.prototype.updatePriority=function(e,t){return e},e.prototype.filtersNodes=function(){return!0},e.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},e.prototype.getIndex=function(){return this.index_},e.prototype.fullLimitUpdateChild_=function(e,t,n,r,i){var a;if(this.reverse_){var s=this.index_.getCompare();a=function(e,t){return s(t,e)}}else a=this.index_.getCompare();var c=e;Object(o.f)(c.numChildren()===this.limit_,"");var u=new Le(t,n),l=this.reverse_?c.getFirstChild(this.index_):c.getLastChild(this.index_),d=this.rangedFilter_.matches(u);if(c.hasChild(t)){for(var f=c.getImmediateChild(t),h=r.getChildAfterChild(this.index_,l,this.reverse_);null!=h&&(h.name===t||c.hasChild(h.name));)h=r.getChildAfterChild(this.index_,h,this.reverse_);var p=null==h?1:a(h,u);if(d&&!n.isEmpty()&&p>=0)return null!=i&&i.trackChildChange(gt(t,n,f)),c.updateImmediateChild(t,n);null!=i&&i.trackChildChange(mt(t,f));var v=c.updateImmediateChild(t,ot.EMPTY_NODE);return null!=h&&this.rangedFilter_.matches(h)?(null!=i&&i.trackChildChange(vt(h.name,h.node)),v.updateImmediateChild(h.name,h.node)):v}return n.isEmpty()?e:d&&a(l,u)>=0?(null!=i&&(i.trackChildChange(mt(l.name,l.node)),i.trackChildChange(vt(t,n))),c.updateImmediateChild(t,n).updateImmediateChild(l.name,ot.EMPTY_NODE)):e},e}(),Et=function(){function e(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Ze}return e.prototype.hasStart=function(){return this.startSet_},e.prototype.hasStartAfter=function(){return this.startAfterSet_},e.prototype.hasEndBefore=function(){return this.endBeforeSet_},e.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_},e.prototype.getIndexStartValue=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},e.prototype.getIndexStartName=function(){return Object(o.f)(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:R},e.prototype.hasEnd=function(){return this.endSet_},e.prototype.getIndexEndValue=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},e.prototype.getIndexEndName=function(){return Object(o.f)(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:A},e.prototype.hasLimit=function(){return this.limitSet_},e.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},e.prototype.getLimit=function(){return Object(o.f)(this.limitSet_,"Only valid if limit has been set"),this.limit_},e.prototype.getIndex=function(){return this.index_},e.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},e.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Ze},e.prototype.copy=function(){var t=new e;return t.limitSet_=this.limitSet_,t.limit_=this.limit_,t.startSet_=this.startSet_,t.indexStartValue_=this.indexStartValue_,t.startNameSet_=this.startNameSet_,t.indexStartName_=this.indexStartName_,t.endSet_=this.endSet_,t.indexEndValue_=this.indexEndValue_,t.endNameSet_=this.endNameSet_,t.indexEndName_=this.indexEndName_,t.index_=this.index_,t.viewFrom_=this.viewFrom_,t},e}();function wt(e,t,n){var r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function Tt(e,t,n){var r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function St(e,t){var n=e.copy();return n.index_=t,n}function It(e){var t,n={};return e.isDefault()||(e.index_===Ze?t="$priority":e.index_===ut?t="$value":e.index_===je?t="$key":(Object(o.f)(e.index_ instanceof ct,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=Object(o.K)(t),e.startSet_&&(n.startAt=Object(o.K)(e.indexStartValue_),e.startNameSet_&&(n.startAt+=","+Object(o.K)(e.indexStartName_))),e.endSet_&&(n.endAt=Object(o.K)(e.indexEndValue_),e.endNameSet_&&(n.endAt+=","+Object(o.K)(e.indexEndName_))),e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_)),n}function Rt(e){var t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_)),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_)),e.limitSet_){t.l=e.limit_;var n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==Ze&&(t.i=e.index_.toString()),t}var At=function(e){function t(t,n,r){var i=e.call(this)||this;return i.repoInfo_=t,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=E("p:rest:"),i.listens_={},i}return Object(a.b)(t,e),t.prototype.reportStats=function(e){throw new Error("Method not implemented.")},t.getListenId_=function(e,t){return void 0!==t?"tag$"+t:(Object(o.f)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())},t.prototype.listen=function(e,n,r,i){var a=this,s=e._path.toString();this.log_("Listen called for "+s+" "+e._queryIdentifier);var c=t.getListenId_(e,r),u={};this.listens_[c]=u;var l=It(e._queryParams);this.restRequest_(s+".json",l,(function(e,t){var n=t;(404===e&&(n=null,e=null),null===e&&a.onDataUpdate_(s,n,!1,r),Object(o.H)(a.listens_,c)===u)&&i(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)}))},t.prototype.unlisten=function(e,n){var r=t.getListenId_(e,n);delete this.listens_[r]},t.prototype.get=function(e){var t=this,n=It(e._queryParams),r=e._path.toString(),i=new o.a;return this.restRequest_(r+".json",n,(function(e,n){var o=n;404===e&&(o=null,e=null),null===e?(t.onDataUpdate_(r,o,!1,null),i.resolve(o)):i.reject(new Error(o))})),i.promise},t.prototype.refreshAuthToken=function(e){},t.prototype.restRequest_=function(e,t,n){var r=this;void 0===t&&(t={}),t.format="export",this.authTokenProvider_.getToken(!1).then((function(i){var a=i&&i.accessToken;a&&(t.auth=a);var s=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+e+"?ns="+r.repoInfo_.namespace+Object(o.G)(t);r.log_("Sending REST request for "+s);var c=new XMLHttpRequest;c.onreadystatechange=function(){if(n&&4===c.readyState){r.log_("REST Response for "+s+" received. status:",c.status,"response:",c.responseText);var e=null;if(c.status>=200&&c.status<300){try{e=Object(o.E)(c.responseText)}catch(t){S("Failed to parse JSON response for "+s+": "+c.responseText)}n(null,e)}else 401!==c.status&&404!==c.status&&S("Got unsuccessful REST response for "+s+" Status: "+c.status),n(c.status);n=null}},c.open("GET",s,!0),c.send()}))},t}(le),Ct=function(){function e(){this.rootNode_=ot.EMPTY_NODE}return e.prototype.getNode=function(e){return this.rootNode_.getChild(e)},e.prototype.updateSnapshot=function(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)},e}();function kt(){return{value:null,children:new Map}}function Ot(e,t,n){if(we(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{var r=ve(t);e.children.has(r)||e.children.set(r,kt()),Ot(e.children.get(r),t=ge(t),n)}}function Nt(e,t){if(we(t))return e.value=null,e.children.clear(),!0;if(null!==e.value){if(e.value.isLeafNode())return!1;var n=e.value;return e.value=null,n.forEachChild(Ze,(function(t,n){Ot(e,new he(t),n)})),Nt(e,t)}if(e.children.size>0){var r=ve(t);if(t=ge(t),e.children.has(r))Nt(e.children.get(r),t)&&e.children.delete(r);return 0===e.children.size}return!0}function Pt(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((function(e,n){t(n,e)}))}(e,(function(e,r){Pt(r,new he(t.toString()+"/"+e),n)}))}var Dt,xt=function(){function e(e){this.collection_=e,this.last_=null}return e.prototype.get=function(){var e=this.collection_.get(),t=Object(a.a)({},e);return this.last_&&D(this.last_,(function(e,n){t[e]=t[e]-n})),this.last_=e,t},e}(),Lt=function(){function e(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new xt(e);var n=1e4+2e4*Math.random();V(this.reportStats_.bind(this),Math.floor(n))}return e.prototype.reportStats_=function(){var e=this,t=this.statsListener_.get(),n={},r=!1;D(t,(function(t,i){i>0&&Object(o.k)(e.statsToReport_,t)&&(n[t]=i,r=!0)})),r&&this.server_.reportStats(n),V(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},e}();function Mt(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}!function(e){e[e.OVERWRITE=0]="OVERWRITE",e[e.MERGE=1]="MERGE",e[e.ACK_USER_WRITE=2]="ACK_USER_WRITE",e[e.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(Dt||(Dt={}));var Ut,jt=function(){function e(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=Dt.ACK_USER_WRITE,this.source={fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}return e.prototype.operationForChild=function(t){if(we(this.path)){if(null!=this.affectedTree.value)return Object(o.f)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new he(t));return new e(pe(),n,this.revert)}return Object(o.f)(ve(this.path)===t,"operationForChild called for unrelated child."),new e(ge(this.path),this.affectedTree,this.revert)},e}(),Ft=function(){function e(e,t){this.source=e,this.path=t,this.type=Dt.LISTEN_COMPLETE}return e.prototype.operationForChild=function(t){return we(this.path)?new e(this.source,pe()):new e(this.source,ge(this.path))},e}(),Vt=function(){function e(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=Dt.OVERWRITE}return e.prototype.operationForChild=function(t){return we(this.path)?new e(this.source,pe(),this.snap.getImmediateChild(t)):new e(this.source,ge(this.path),this.snap)},e}(),Bt=function(){function e(e,t,n){this.source=e,this.path=t,this.children=n,this.type=Dt.MERGE}return e.prototype.operationForChild=function(t){if(we(this.path)){var n=this.children.subtree(new he(t));return n.isEmpty()?null:n.value?new Vt(this.source,pe(),n.value):new e(this.source,pe(),n)}return Object(o.f)(ve(this.path)===t,"Can't get a merge for a child not on the path of the operation"),new e(this.source,ge(this.path),this.children)},e.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},e}(),Wt=function(){function e(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}return e.prototype.isFullyInitialized=function(){return this.fullyInitialized_},e.prototype.isFiltered=function(){return this.filtered_},e.prototype.isCompleteForPath=function(e){if(we(e))return this.isFullyInitialized()&&!this.filtered_;var t=ve(e);return this.isCompleteForChild(t)},e.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},e.prototype.getNode=function(){return this.node_},e}(),Gt=function(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()};function qt(e,t,n,r,i,a){var s=r.filter((function(e){return e.type===n}));s.sort((function(t,n){return function(e,t,n){if(null==t.childName||null==n.childName)throw Object(o.g)("Should only compare child_ events.");var r=new Le(t.childName,t.snapshotNode),i=new Le(n.childName,n.snapshotNode);return e.index_.compare(r,i)}(e,t,n)})),s.forEach((function(n){var r=function(e,t,n){return"value"===t.type||"child_removed"===t.type||(t.prevName=n.getPredecessorChildName(t.childName,t.snapshotNode,e.index_)),t}(e,n,a);i.forEach((function(i){i.respondsTo(n.type)&&t.push(i.createEvent(r,e.query_))}))}))}function Kt(e,t){return{eventCache:e,serverCache:t}}function Ht(e,t,n,r){return Kt(new Wt(t,n,r),e.serverCache)}function zt(e,t,n,r){return Kt(e.eventCache,new Wt(t,n,r))}function Yt(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function Qt(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}var Xt=function(){function e(e,t){void 0===t&&(Ut||(Ut=new We(k)),t=Ut),this.value=e,this.children=t}return e.fromObject=function(t){var n=new e(null);return D(t,(function(e,t){n=n.set(new he(e),t)})),n},e.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},e.prototype.findRootMostMatchingPathAndValue=function(e,t){if(null!=this.value&&t(this.value))return{path:pe(),value:this.value};if(we(e))return null;var n=ve(e),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(ge(e),t);return null!=i?{path:Ee(new he(n),i.path),value:i.value}:null}return null},e.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,(function(){return!0}))},e.prototype.subtree=function(t){if(we(t))return this;var n=ve(t),r=this.children.get(n);return null!==r?r.subtree(ge(t)):new e(null)},e.prototype.set=function(t,n){if(we(t))return new e(n,this.children);var r=ve(t),i=(this.children.get(r)||new e(null)).set(ge(t),n),o=this.children.insert(r,i);return new e(this.value,o)},e.prototype.remove=function(t){if(we(t))return this.children.isEmpty()?new e(null):new e(null,this.children);var n=ve(t),r=this.children.get(n);if(r){var i=r.remove(ge(t)),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?new e(null):new e(this.value,o)}return this},e.prototype.get=function(e){if(we(e))return this.value;var t=ve(e),n=this.children.get(t);return n?n.get(ge(e)):null},e.prototype.setTree=function(t,n){if(we(t))return n;var r=ve(t),i=(this.children.get(r)||new e(null)).setTree(ge(t),n),o=void 0;return o=i.isEmpty()?this.children.remove(r):this.children.insert(r,i),new e(this.value,o)},e.prototype.fold=function(e){return this.fold_(pe(),e)},e.prototype.fold_=function(e,t){var n={};return this.children.inorderTraversal((function(r,i){n[r]=i.fold_(Ee(e,r),t)})),t(e,this.value,n)},e.prototype.findOnPath=function(e,t){return this.findOnPath_(e,pe(),t)},e.prototype.findOnPath_=function(e,t,n){var r=!!this.value&&n(t,this.value);if(r)return r;if(we(e))return null;var i=ve(e),o=this.children.get(i);return o?o.findOnPath_(ge(e),Ee(t,i),n):null},e.prototype.foreachOnPath=function(e,t){return this.foreachOnPath_(e,pe(),t)},e.prototype.foreachOnPath_=function(t,n,r){if(we(t))return this;this.value&&r(n,this.value);var i=ve(t),o=this.children.get(i);return o?o.foreachOnPath_(ge(t),Ee(n,i),r):new e(null)},e.prototype.foreach=function(e){this.foreach_(pe(),e)},e.prototype.foreach_=function(e,t){this.children.inorderTraversal((function(n,r){r.foreach_(Ee(e,n),t)})),this.value&&t(e,this.value)},e.prototype.foreachChild=function(e){this.children.inorderTraversal((function(t,n){n.value&&e(t,n.value)}))},e}(),Jt=function(){function e(e){this.writeTree_=e}return e.empty=function(){return new e(new Xt(null))},e}();function $t(e,t,n){if(we(t))return new Jt(new Xt(n));var r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){var i=r.path,o=r.value,a=Te(i,t);return o=o.updateChild(a,n),new Jt(e.writeTree_.set(i,o))}var s=new Xt(n),c=e.writeTree_.setTree(t,s);return new Jt(c)}function Zt(e,t,n){var r=e;return D(n,(function(e,n){r=$t(r,Ee(t,e),n)})),r}function en(e,t){if(we(t))return Jt.empty();var n=e.writeTree_.setTree(t,new Xt(null));return new Jt(n)}function tn(e,t){return null!=nn(e,t)}function nn(e,t){var n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(Te(n.path,t)):null}function rn(e){var t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(Ze,(function(e,n){t.push(new Le(e,n))})):e.writeTree_.children.inorderTraversal((function(e,n){null!=n.value&&t.push(new Le(e,n.value))})),t}function on(e,t){if(we(t))return e;var n=nn(e,t);return new Jt(null!=n?new Xt(n):e.writeTree_.subtree(t))}function an(e){return e.writeTree_.isEmpty()}function sn(e,t){return cn(pe(),e.writeTree_,t)}function cn(e,t,n){if(null!=t.value)return n.updateChild(e,t.value);var r=null;return t.children.inorderTraversal((function(t,i){".priority"===t?(Object(o.f)(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):n=cn(Ee(e,t),i,n)})),n.getChild(e).isEmpty()||null===r||(n=n.updateChild(Ee(e,".priority"),r)),n}function un(e,t){return wn(t,e)}function ln(e,t){var n=e.allWrites.findIndex((function(e){return e.writeId===t}));Object(o.f)(n>=0,"removeWrite called with nonexistent writeId.");var r=e.allWrites[n];e.allWrites.splice(n,1);for(var i=r.visible,a=!1,s=e.allWrites.length-1;i&&s>=0;){var c=e.allWrites[s];c.visible&&(s>=n&&dn(c,r.path)?i=!1:Re(r.path,c.path)&&(a=!0)),s--}if(i){if(a)return function(e){e.visibleWrites=hn(e.allWrites,fn,pe()),e.allWrites.length>0?e.lastWriteId=e.allWrites[e.allWrites.length-1].writeId:e.lastWriteId=-1}(e),!0;r.snap?e.visibleWrites=en(e.visibleWrites,r.path):D(r.children,(function(t){e.visibleWrites=en(e.visibleWrites,Ee(r.path,t))}));return!0}return!1}function dn(e,t){if(e.snap)return Re(e.path,t);for(var n in e.children)if(e.children.hasOwnProperty(n)&&Re(Ee(e.path,n),t))return!0;return!1}function fn(e){return e.visible}function hn(e,t,n){for(var r=Jt.empty(),i=0;i<e.length;++i){var a=e[i];if(t(a)){var s=a.path,c=void 0;if(a.snap)Re(n,s)?r=$t(r,c=Te(n,s),a.snap):Re(s,n)&&(c=Te(s,n),r=$t(r,pe(),a.snap.getChild(c)));else{if(!a.children)throw Object(o.g)("WriteRecord should have .snap or .children");if(Re(n,s))r=Zt(r,c=Te(n,s),a.children);else if(Re(s,n))if(we(c=Te(s,n)))r=Zt(r,pe(),a.children);else{var u=Object(o.H)(a.children,ve(c));if(u){var l=u.getChild(ge(c));r=$t(r,pe(),l)}}}}}return r}function pn(e,t,n,r,i){if(r||i){var o=on(e.visibleWrites,t);if(!i&&an(o))return n;if(i||null!=n||tn(o,pe())){return sn(hn(e.allWrites,(function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(Re(e.path,t)||Re(t,e.path))}),t),n||ot.EMPTY_NODE)}return null}var a=nn(e.visibleWrites,t);if(null!=a)return a;var s=on(e.visibleWrites,t);return an(s)?n:null!=n||tn(s,pe())?sn(s,n||ot.EMPTY_NODE):null}function vn(e,t,n,r){return pn(e.writeTree,e.treePath,t,n,r)}function mn(e,t){return function(e,t,n){var r=ot.EMPTY_NODE,i=nn(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(Ze,(function(e,t){r=r.updateImmediateChild(e,t)})),r;if(n){var o=on(e.visibleWrites,t);return n.forEachChild(Ze,(function(e,t){var n=sn(on(o,new he(e)),t);r=r.updateImmediateChild(e,n)})),rn(o).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}return rn(on(e.visibleWrites,t)).forEach((function(e){r=r.updateImmediateChild(e.name,e.node)})),r}(e.writeTree,e.treePath,t)}function gn(e,t,n,r){return function(e,t,n,r,i){Object(o.f)(r||i,"Either existingEventSnap or existingServerSnap must exist");var a=Ee(t,n);if(tn(e.visibleWrites,a))return null;var s=on(e.visibleWrites,a);return an(s)?i.getChild(n):sn(s,i.getChild(n))}(e.writeTree,e.treePath,t,n,r)}function yn(e,t){return function(e,t){return nn(e.visibleWrites,t)}(e.writeTree,Ee(e.treePath,t))}function _n(e,t,n,r,i,o){return function(e,t,n,r,i,o,a){var s,c=on(e.visibleWrites,t),u=nn(c,pe());if(null!=u)s=u;else{if(null==n)return[];s=sn(c,n)}if((s=s.withIndex(a)).isEmpty()||s.isLeafNode())return[];for(var l=[],d=a.getCompare(),f=o?s.getReverseIteratorFrom(r,a):s.getIteratorFrom(r,a),h=f.getNext();h&&l.length<i;)0!==d(h,r)&&l.push(h),h=f.getNext();return l}(e.writeTree,e.treePath,t,n,r,i,o)}function bn(e,t,n){return function(e,t,n,r){var i=Ee(t,n),o=nn(e.visibleWrites,i);return null!=o?o:r.isCompleteForChild(n)?sn(on(e.visibleWrites,i),r.getNode().getImmediateChild(n)):null}(e.writeTree,e.treePath,t,n)}function En(e,t){return wn(Ee(e.treePath,t),e.writeTree)}function wn(e,t){return{treePath:e,writeTree:t}}var Tn=function(){function e(){this.changeMap=new Map}return e.prototype.trackChildChange=function(e){var t=e.type,n=e.childName;Object(o.f)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),Object(o.f)(".priority"!==n,"Only non-priority child changes can be tracked.");var r=this.changeMap.get(n);if(r){var i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,gt(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,mt(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,vt(n,e.snapshotNode));else{if("child_changed"!==t||"child_changed"!==i)throw Object(o.g)("Illegal combination of changes: "+e+" occurred after "+r);this.changeMap.set(n,gt(n,e.snapshotNode,r.oldSnap))}}else this.changeMap.set(n,e)},e.prototype.getChanges=function(){return Array.from(this.changeMap.values())},e}(),Sn=new(function(){function e(){}return e.prototype.getCompleteChild=function(e){return null},e.prototype.getChildAfterChild=function(e,t,n){return null},e}()),In=function(){function e(e,t,n){void 0===n&&(n=null),this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}return e.prototype.getCompleteChild=function(e){var t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);var n=null!=this.optCompleteServerCache_?new Wt(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return bn(this.writes_,e,n)},e.prototype.getChildAfterChild=function(e,t,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:Qt(this.viewCache_),i=_n(this.writes_,r,t,1,n,e);return 0===i.length?null:i[0]},e}();function Rn(e,t,n,r,i){var a,s,c=new Tn;if(n.type===Dt.OVERWRITE){var u=n;u.source.fromUser?a=kn(e,t,u.path,u.snap,r,i,c):(Object(o.f)(u.source.fromServer,"Unknown source."),s=u.source.tagged||t.serverCache.isFiltered()&&!we(u.path),a=Cn(e,t,u.path,u.snap,r,i,s,c))}else if(n.type===Dt.MERGE){var l=n;l.source.fromUser?a=function(e,t,n,r,i,o,a){var s=t;return r.foreach((function(r,c){var u=Ee(n,r);On(t,ve(u))&&(s=kn(e,s,u,c,i,o,a))})),r.foreach((function(r,c){var u=Ee(n,r);On(t,ve(u))||(s=kn(e,s,u,c,i,o,a))})),s}(e,t,l.path,l.children,r,i,c):(Object(o.f)(l.source.fromServer,"Unknown source."),s=l.source.tagged||t.serverCache.isFiltered(),a=Pn(e,t,l.path,l.children,r,i,s,c))}else if(n.type===Dt.ACK_USER_WRITE){var d=n;a=d.revert?function(e,t,n,r,i,a){var s;if(null!=yn(r,n))return t;var c=new In(r,t,i),u=t.eventCache.getNode(),l=void 0;if(we(n)||".priority"===ve(n)){var d=void 0;if(t.serverCache.isFullyInitialized())d=vn(r,Qt(t));else{var f=t.serverCache.getNode();Object(o.f)(f instanceof ot,"serverChildren would be complete if leaf node"),d=mn(r,f)}d=d,l=e.filter.updateFullNode(u,d,a)}else{var h=ve(n),p=bn(r,h,t.serverCache);null==p&&t.serverCache.isCompleteForChild(h)&&(p=u.getImmediateChild(h)),(l=null!=p?e.filter.updateChild(u,h,p,ge(n),c,a):t.eventCache.getNode().hasChild(h)?e.filter.updateChild(u,h,ot.EMPTY_NODE,ge(n),c,a):u).isEmpty()&&t.serverCache.isFullyInitialized()&&(s=vn(r,Qt(t))).isLeafNode()&&(l=e.filter.updateFullNode(l,s,a))}return s=t.serverCache.isFullyInitialized()||null!=yn(r,pe()),Ht(t,l,s,e.filter.filtersNodes())}(e,t,d.path,r,i,c):function(e,t,n,r,i,o,a){if(null!=yn(i,n))return t;var s=t.serverCache.isFiltered(),c=t.serverCache;if(null!=r.value){if(we(n)&&c.isFullyInitialized()||c.isCompleteForPath(n))return Cn(e,t,n,c.getNode().getChild(n),i,o,s,a);if(we(n)){var u=new Xt(null);return c.getNode().forEachChild(je,(function(e,t){u=u.set(new he(e),t)})),Pn(e,t,n,u,i,o,s,a)}return t}var l=new Xt(null);return r.foreach((function(e,t){var r=Ee(n,e);c.isCompleteForPath(r)&&(l=l.set(e,c.getNode().getChild(r)))})),Pn(e,t,n,l,i,o,s,a)}(e,t,d.path,d.affectedTree,r,i,c)}else{if(n.type!==Dt.LISTEN_COMPLETE)throw Object(o.g)("Unknown operation type: "+n.type);a=function(e,t,n,r,i){var o=t.serverCache,a=zt(t,o.getNode(),o.isFullyInitialized()||we(n),o.isFiltered());return An(e,a,n,r,Sn,i)}(e,t,n.path,r,c)}var f=c.getChanges();return function(e,t,n){var r=t.eventCache;if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=Yt(e);(n.length>0||!e.eventCache.isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(pt(Yt(t)))}}(t,a,f),{viewCache:a,changes:f}}function An(e,t,n,r,i,a){var s=t.eventCache;if(null!=yn(r,n))return t;var c=void 0,u=void 0;if(we(n))if(Object(o.f)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){var l=Qt(t),d=mn(r,l instanceof ot?l:ot.EMPTY_NODE);c=e.filter.updateFullNode(t.eventCache.getNode(),d,a)}else{var f=vn(r,Qt(t));c=e.filter.updateFullNode(t.eventCache.getNode(),f,a)}else{var h=ve(n);if(".priority"===h){Object(o.f)(1===me(n),"Can't have a priority with additional path components");var p=s.getNode(),v=gn(r,n,p,u=t.serverCache.getNode());c=null!=v?e.filter.updatePriority(p,v):s.getNode()}else{var m=ge(n),g=void 0;if(s.isCompleteForChild(h)){u=t.serverCache.getNode();var y=gn(r,n,s.getNode(),u);g=null!=y?s.getNode().getImmediateChild(h).updateChild(m,y):s.getNode().getImmediateChild(h)}else g=bn(r,h,t.serverCache);c=null!=g?e.filter.updateChild(s.getNode(),h,g,m,i,a):s.getNode()}}return Ht(t,c,s.isFullyInitialized()||we(n),e.filter.filtersNodes())}function Cn(e,t,n,r,i,o,a,s){var c,u=t.serverCache,l=a?e.filter:e.filter.getIndexedFilter();if(we(n))c=l.updateFullNode(u.getNode(),r,null);else if(l.filtersNodes()&&!u.isFiltered()){var d=u.getNode().updateChild(n,r);c=l.updateFullNode(u.getNode(),d,null)}else{var f=ve(n);if(!u.isCompleteForPath(n)&&me(n)>1)return t;var h=ge(n),p=u.getNode().getImmediateChild(f).updateChild(h,r);c=".priority"===f?l.updatePriority(u.getNode(),p):l.updateChild(u.getNode(),f,p,h,Sn,null)}var v=zt(t,c,u.isFullyInitialized()||we(n),l.filtersNodes());return An(e,v,n,i,new In(i,v,o),s)}function kn(e,t,n,r,i,o,a){var s,c,u=t.eventCache,l=new In(i,t,o);if(we(n))c=e.filter.updateFullNode(t.eventCache.getNode(),r,a),s=Ht(t,c,!0,e.filter.filtersNodes());else{var d=ve(n);if(".priority"===d)c=e.filter.updatePriority(t.eventCache.getNode(),r),s=Ht(t,c,u.isFullyInitialized(),u.isFiltered());else{var f=ge(n),h=u.getNode().getImmediateChild(d),p=void 0;if(we(f))p=r;else{var v=l.getCompleteChild(d);p=null!=v?".priority"===ye(f)&&v.getChild(be(f)).isEmpty()?v:v.updateChild(f,r):ot.EMPTY_NODE}if(h.equals(p))s=t;else s=Ht(t,e.filter.updateChild(u.getNode(),d,p,f,l,a),u.isFullyInitialized(),e.filter.filtersNodes())}}return s}function On(e,t){return e.eventCache.isCompleteForChild(t)}function Nn(e,t,n){return n.foreach((function(e,n){t=t.updateChild(e,n)})),t}function Pn(e,t,n,r,i,o,a,s){if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;var c,u=t;c=we(n)?r:new Xt(null).setTree(n,r);var l=t.serverCache.getNode();return c.children.inorderTraversal((function(n,r){if(l.hasChild(n)){var c=Nn(0,t.serverCache.getNode().getImmediateChild(n),r);u=Cn(e,u,new he(n),c,i,o,a,s)}})),c.children.inorderTraversal((function(n,r){var c=!t.serverCache.isCompleteForChild(n)&&void 0===r.value;if(!l.hasChild(n)&&!c){var d=Nn(0,t.serverCache.getNode().getImmediateChild(n),r);u=Cn(e,u,new he(n),d,i,o,a,s)}})),u}var Dn,xn=function(){function e(e,t){this.query_=e,this.eventRegistrations_=[];var n,r=this.query_._queryParams,i=new yt(r.getIndex()),o=(n=r).loadsAllData()?new yt(n.getIndex()):n.hasLimit()?new bt(n):new _t(n);this.processor_=function(e){return{filter:e}}(o);var a=t.serverCache,s=t.eventCache,c=i.updateFullNode(ot.EMPTY_NODE,a.getNode(),null),u=o.updateFullNode(ot.EMPTY_NODE,s.getNode(),null),l=new Wt(c,a.isFullyInitialized(),i.filtersNodes()),d=new Wt(u,s.isFullyInitialized(),o.filtersNodes());this.viewCache_=Kt(d,l),this.eventGenerator_=new Gt(this.query_)}return Object.defineProperty(e.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),e}();function Ln(e,t){var n=Qt(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!we(t)&&!n.getImmediateChild(ve(t)).isEmpty())?n.getChild(t):null}function Mn(e){return 0===e.eventRegistrations_.length}function Un(e,t,n){var r=[];if(n){Object(o.f)(null==t,"A cancel should cancel all event registrations.");var i=e.query._path;e.eventRegistrations_.forEach((function(e){var t=e.createCancelEvent(n,i);t&&r.push(t)}))}if(t){for(var a=[],s=0;s<e.eventRegistrations_.length;++s){var c=e.eventRegistrations_[s];if(c.matches(t)){if(t.hasAnyCallback()){a=a.concat(e.eventRegistrations_.slice(s+1));break}}else a.push(c)}e.eventRegistrations_=a}else e.eventRegistrations_=[];return r}function jn(e,t,n,r){t.type===Dt.MERGE&&null!==t.source.queryId&&(Object(o.f)(Qt(e.viewCache_),"We should always have a full cache before handling merges"),Object(o.f)(Yt(e.viewCache_),"Missing event cache, even though we have a server cache"));var i,a,s=e.viewCache_,c=Rn(e.processor_,s,t,n,r);return i=e.processor_,a=c.viewCache,Object(o.f)(a.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),Object(o.f)(a.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),Object(o.f)(c.viewCache.serverCache.isFullyInitialized()||!s.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=c.viewCache,Fn(e,c.changes,c.viewCache.eventCache.getNode(),null)}function Fn(e,t,n,r){var i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){var i=[],o=[];return t.forEach((function(t){var n;"child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))})),qt(e,i,"child_removed",t,r,n),qt(e,i,"child_added",t,r,n),qt(e,i,"child_moved",o,r,n),qt(e,i,"child_changed",t,r,n),qt(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}var Vn,Bn=function(){this.views=new Map};function Wn(e,t,n,r){var i,s,c=t.source.queryId;if(null!==c){var u=e.views.get(c);return Object(o.f)(null!=u,"SyncTree gave us an op for an invalid query."),jn(u,t,n,r)}var l=[];try{for(var d=Object(a.e)(e.views.values()),f=d.next();!f.done;f=d.next()){u=f.value;l=l.concat(jn(u,t,n,r))}}catch(h){i={error:h}}finally{try{f&&!f.done&&(s=d.return)&&s.call(d)}finally{if(i)throw i.error}}return l}function Gn(e,t,n,r,i){var o=t._queryIdentifier,a=e.views.get(o);if(!a){var s=vn(n,i?r:null),c=!1;s?c=!0:r instanceof ot?(s=mn(n,r),c=!1):(s=ot.EMPTY_NODE,c=!1);var u=Kt(new Wt(s,c,!1),new Wt(r,i,!1));return new xn(t,u)}return a}function qn(e,t,n,r,i,o){var a=Gn(e,t,r,i,o);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,a),function(e,t){e.eventRegistrations_.push(t)}(a,n),function(e,t){var n=e.viewCache_.eventCache,r=[];return n.getNode().isLeafNode()||n.getNode().forEachChild(Ze,(function(e,t){r.push(vt(e,t))})),n.isFullyInitialized()&&r.push(pt(n.getNode())),Fn(e,r,n.getNode(),t)}(a,n)}function Kn(e,t,n,r){var i,s,c=t._queryIdentifier,u=[],l=[],d=Xn(e);if("default"===c)try{for(var f=Object(a.e)(e.views.entries()),h=f.next();!h.done;h=f.next()){var p=Object(a.c)(h.value,2),v=p[0],m=p[1];l=l.concat(Un(m,n,r)),Mn(m)&&(e.views.delete(v),m.query._queryParams.loadsAllData()||u.push(m.query))}}catch(g){i={error:g}}finally{try{h&&!h.done&&(s=f.return)&&s.call(f)}finally{if(i)throw i.error}}else(m=e.views.get(c))&&(l=l.concat(Un(m,n,r)),Mn(m)&&(e.views.delete(c),m.query._queryParams.loadsAllData()||u.push(m.query)));return d&&!Xn(e)&&u.push(new(Object(o.f)(Dn,"Reference.ts has not been loaded"),Dn)(t._repo,t._path)),{removed:u,events:l}}function Hn(e){var t,n,r=[];try{for(var i=Object(a.e)(e.views.values()),o=i.next();!o.done;o=i.next()){var s=o.value;s.query._queryParams.loadsAllData()||r.push(s)}}catch(c){t={error:c}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}function zn(e,t){var n,r,i=null;try{for(var o=Object(a.e)(e.views.values()),s=o.next();!s.done;s=o.next()){var c=s.value;i=i||Ln(c,t)}}catch(u){n={error:u}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return i}function Yn(e,t){if(t._queryParams.loadsAllData())return Jn(e);var n=t._queryIdentifier;return e.views.get(n)}function Qn(e,t){return null!=Yn(e,t)}function Xn(e){return null!=Jn(e)}function Jn(e){var t,n;try{for(var r=Object(a.e)(e.views.values()),i=r.next();!i.done;i=r.next()){var o=i.value;if(o.query._queryParams.loadsAllData())return o}}catch(s){t={error:s}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return null}var $n=1,Zn=function(e){this.listenProvider_=e,this.syncPointTree_=new Xt(null),this.pendingWriteTree_={visibleWrites:Jt.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map};function er(e,t,n,r,i){return function(e,t,n,r,i){Object(o.f)(r>e.lastWriteId,"Stacking an older write on top of newer ones"),void 0===i&&(i=!0),e.allWrites.push({path:t,snap:n,writeId:r,visible:i}),i&&(e.visibleWrites=$t(e.visibleWrites,t,n)),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r,i),i?cr(e,new Vt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,n)):[]}function tr(e,t,n,r){!function(e,t,n,r){Object(o.f)(r>e.lastWriteId,"Stacking an older merge on top of newer ones"),e.allWrites.push({path:t,children:n,writeId:r,visible:!0}),e.visibleWrites=Zt(e.visibleWrites,t,n),e.lastWriteId=r}(e.pendingWriteTree_,t,n,r);var i=Xt.fromObject(n);return cr(e,new Bt({fromUser:!0,fromServer:!1,queryId:null,tagged:!1},t,i))}function nr(e,t,n){void 0===n&&(n=!1);var r=function(e,t){for(var n=0;n<e.allWrites.length;n++){var r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t);if(ln(e.pendingWriteTree_,t)){var i=new Xt(null);return null!=r.snap?i=i.set(pe(),!0):D(r.children,(function(e){i=i.set(new he(e),!0)})),cr(e,new jt(r.path,i,n))}return[]}function rr(e,t,n){return cr(e,new Vt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,n))}function ir(e,t,n,r){var i=t._path,o=e.syncPointTree_.get(i),a=[];if(o&&("default"===t._queryIdentifier||Qn(o,t))){var s=Kn(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(i));var c=s.removed;a=s.events;var u=-1!==c.findIndex((function(e){return e._queryParams.loadsAllData()})),l=e.syncPointTree_.findOnPath(i,(function(e,t){return Xn(t)}));if(u&&!l){var d=e.syncPointTree_.subtree(i);if(!d.isEmpty())for(var f=function(e){return e.fold((function(e,t,n){if(t&&Xn(t))return[Jn(t)];var r=[];return t&&(r=Hn(t)),D(n,(function(e,t){r=r.concat(t)})),r}))}(d),h=0;h<f.length;++h){var p=f[h],v=p.query,m=dr(e,p);e.listenProvider_.startListening(gr(v),fr(e,v),m.hashFn,m.onComplete)}}if(!l&&c.length>0&&!r)if(u){e.listenProvider_.stopListening(gr(t),null)}else c.forEach((function(t){var n=e.queryToTagMap.get(hr(t));e.listenProvider_.stopListening(gr(t),n)}));!function(e,t){for(var n=0;n<t.length;++n){var r=t[n];if(!r._queryParams.loadsAllData()){var i=hr(r),o=e.queryToTagMap.get(i);e.queryToTagMap.delete(i),e.tagToQueryMap.delete(o)}}}(e,c)}return a}function or(e,t,n){var r=t._path,i=null,a=!1;e.syncPointTree_.foreachOnPath(r,(function(e,t){var n=Te(e,r);i=i||zn(t,n),a=a||Xn(t)}));var s,c=e.syncPointTree_.get(r);(c?(a=a||Xn(c),i=i||zn(c,pe())):(c=new Bn,e.syncPointTree_=e.syncPointTree_.set(r,c)),null!=i)?s=!0:(s=!1,i=ot.EMPTY_NODE,e.syncPointTree_.subtree(r).foreachChild((function(e,t){var n=zn(t,pe());n&&(i=i.updateImmediateChild(e,n))})));var u=Qn(c,t);if(!u&&!t._queryParams.loadsAllData()){var l=hr(t);Object(o.f)(!e.queryToTagMap.has(l),"View does not exist, but we have a tag");var d=$n++;e.queryToTagMap.set(l,d),e.tagToQueryMap.set(d,l)}var f=qn(c,t,n,un(e.pendingWriteTree_,r),i,s);if(!u&&!a){var h=Yn(c,t);f=f.concat(function(e,t,n){var r=t._path,i=fr(e,t),a=dr(e,n),s=e.listenProvider_.startListening(gr(t),i,a.hashFn,a.onComplete),c=e.syncPointTree_.subtree(r);if(i)Object(o.f)(!Xn(c.value),"If we're adding a query, it shouldn't be shadowed");else for(var u=c.fold((function(e,t,n){if(!we(e)&&t&&Xn(t))return[Jn(t).query];var r=[];return t&&(r=r.concat(Hn(t).map((function(e){return e.query})))),D(n,(function(e,t){r=r.concat(t)})),r})),l=0;l<u.length;++l){var d=u[l];e.listenProvider_.stopListening(gr(d),fr(e,d))}return s}(e,t,h))}return f}function ar(e,t,n){var r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(function(e,n){var r=zn(n,Te(e,t));if(r)return r}));return pn(r,t,i,n,!0)}function sr(e,t){var n=t._path,r=null;e.syncPointTree_.foreachOnPath(n,(function(e,t){var i=Te(e,n);r=r||zn(t,i)}));var i=e.syncPointTree_.get(n);i?r=r||zn(i,pe()):(i=new Bn,e.syncPointTree_=e.syncPointTree_.set(n,i));var o=null!=r,a=o?new Wt(r,!0,!1):null;return function(e){return Yt(e.viewCache_)}(Gn(i,t,un(e.pendingWriteTree_,t._path),o?a.getNode():ot.EMPTY_NODE,o))}function cr(e,t){return ur(t,e.syncPointTree_,null,un(e.pendingWriteTree_,pe()))}function ur(e,t,n,r){if(we(e.path))return lr(e,t,n,r);var i=t.get(pe());null==n&&null!=i&&(n=zn(i,pe()));var o=[],a=ve(e.path),s=e.operationForChild(a),c=t.children.get(a);if(c&&s){var u=n?n.getImmediateChild(a):null,l=En(r,a);o=o.concat(ur(s,c,u,l))}return i&&(o=o.concat(Wn(i,e,r,n))),o}function lr(e,t,n,r){var i=t.get(pe());null==n&&null!=i&&(n=zn(i,pe()));var o=[];return t.children.inorderTraversal((function(t,i){var a=n?n.getImmediateChild(t):null,s=En(r,t),c=e.operationForChild(t);c&&(o=o.concat(lr(c,i,a,s)))})),i&&(o=o.concat(Wn(i,e,r,n))),o}function dr(e,t){var n=t.query,r=fr(e,n);return{hashFn:function(){return(function(e){return e.viewCache_.serverCache.getNode()}(t)||ot.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?function(e,t,n){var r=pr(e,n);if(r){var i=vr(r),o=i.path,a=i.queryId,s=Te(o,t);return mr(e,o,new Ft(Mt(a),s))}return[]}(e,n._path,r):function(e,t){return cr(e,new Ft({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t))}(e,n._path);var i=function(e,t){var n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");var r=new Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return ir(e,n,null,i)}}}function fr(e,t){var n=hr(t);return e.queryToTagMap.get(n)}function hr(e){return e._path.toString()+"$"+e._queryIdentifier}function pr(e,t){return e.tagToQueryMap.get(t)}function vr(e){var t=e.indexOf("$");return Object(o.f)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new he(e.substr(0,t))}}function mr(e,t,n){var r=e.syncPointTree_.get(t);return Object(o.f)(r,"Missing sync point for query tag that we're tracking"),Wn(r,n,un(e.pendingWriteTree_,t),null)}function gr(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new(Object(o.f)(Vn,"Reference.ts has not been loaded"),Vn)(e._repo,e._path):e}var yr=function(){function e(e){this.node_=e}return e.prototype.getImmediateChild=function(t){return new e(this.node_.getImmediateChild(t))},e.prototype.node=function(){return this.node_},e}(),_r=function(){function e(e,t){this.syncTree_=e,this.path_=t}return e.prototype.getImmediateChild=function(t){var n=Ee(this.path_,t);return new e(this.syncTree_,n)},e.prototype.node=function(){return ar(this.syncTree_,this.path_)},e}(),br=function(e,t,n){return e&&"object"===typeof e?(Object(o.f)(".sv"in e,"Unexpected leaf node or priority contents"),"string"===typeof e[".sv"]?Er(e[".sv"],t,n):"object"===typeof e[".sv"]?wr(e[".sv"],t):void Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2))):e},Er=function(e,t,n){switch(e){case"timestamp":return n.timestamp;default:Object(o.f)(!1,"Unexpected server value: "+e)}},wr=function(e,t,n){e.hasOwnProperty("increment")||Object(o.f)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));var r=e.increment;"number"!==typeof r&&Object(o.f)(!1,"Unexpected increment value: "+r);var i=t.node();if(Object(o.f)(null!==i&&"undefined"!==typeof i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;var a=i.getValue();return"number"!==typeof a?r:a+r},Tr=function(e,t,n,r){return Ir(t,new _r(n,e),r)},Sr=function(e,t,n){return Ir(e,new yr(t),n)};function Ir(e,t,n){var r,i=e.getPriority().val(),o=br(i,t.getImmediateChild(".priority"),n);if(e.isLeafNode()){var a=e,s=br(a.getValue(),t,n);return s!==a.getValue()||o!==a.getPriority().val()?new Xe(s,st(o)):e}var c=e;return r=c,o!==c.getPriority().val()&&(r=r.updatePriority(new Xe(o))),c.forEachChild(Ze,(function(e,i){var o=Ir(i,t.getImmediateChild(e),n);o!==i&&(r=r.updateImmediateChild(e,o))})),r}var Rr=function(e,t,n){void 0===e&&(e=""),void 0===t&&(t=null),void 0===n&&(n={children:{},childCount:0}),this.name=e,this.parent=t,this.node=n};function Ar(e,t){for(var n=t instanceof he?t:new he(t),r=e,i=ve(n);null!==i;){var a=Object(o.H)(r.node.children,i)||{children:{},childCount:0};r=new Rr(i,r,a),i=ve(n=ge(n))}return r}function Cr(e){return e.node.value}function kr(e,t){e.node.value=t,xr(e)}function Or(e){return e.node.childCount>0}function Nr(e,t){D(e.node.children,(function(n,r){t(new Rr(n,e,r))}))}function Pr(e,t,n,r){n&&!r&&t(e),Nr(e,(function(e){Pr(e,t,!0,r)})),n&&r&&t(e)}function Dr(e){return new he(null===e.parent?e.name:Dr(e.parent)+"/"+e.name)}function xr(e){null!==e.parent&&function(e,t,n){var r=function(e){return void 0===Cr(e)&&!Or(e)}(n),i=Object(o.k)(e.node.children,t);r&&i?(delete e.node.children[t],e.node.childCount--,xr(e)):r||i||(e.node.children[t]=n.node,e.node.childCount++,xr(e))}(e.parent,e.name,e)}var Lr=/[\[\].#$\/\u0000-\u001F\u007F]/,Mr=/[\[\].#$\u0000-\u001F\u007F]/,Ur=10485760,jr=function(e){return"string"===typeof e&&0!==e.length&&!Lr.test(e)},Fr=function(e){return"string"===typeof e&&0!==e.length&&!Mr.test(e)},Vr=function(e){return null===e||"string"===typeof e||"number"===typeof e&&!I(e)||e&&"object"===typeof e&&Object(o.k)(e,".sv")},Br=function(e,t,n,r){r&&void 0===t||Wr(Object(o.o)(e,"value"),t,n)},Wr=function e(t,n,r){var i=r instanceof he?new Ae(r,t):r;if(void 0===n)throw new Error(t+"contains undefined "+ke(i));if("function"===typeof n)throw new Error(t+"contains a function "+ke(i)+" with contents = "+n.toString());if(I(n))throw new Error(t+"contains "+n.toString()+" "+ke(i));if("string"===typeof n&&n.length>Ur/3&&Object(o.I)(n)>Ur)throw new Error(t+"contains a string greater than "+"10485760 utf8 bytes "+ke(i)+" ('"+n.substring(0,50)+"...')");if(n&&"object"===typeof n){var a=!1,s=!1;if(D(n,(function(n,r){if(".value"===n)a=!0;else if(".priority"!==n&&".sv"!==n&&(s=!0,!jr(n)))throw new Error(t+" contains an invalid key ("+n+") "+ke(i)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');!function(e,t){e.parts_.length>0&&(e.byteLength_+=1),e.parts_.push(t),e.byteLength_+=Object(o.I)(t),Ce(e)}(i,n),e(t,r,i),function(e){var t=e.parts_.pop();e.byteLength_-=Object(o.I)(t),e.parts_.length>0&&(e.byteLength_-=1)}(i)})),a&&s)throw new Error(t+' contains ".value" child '+ke(i)+" in addition to actual children.")}},Gr=function(e,t,n,r){if(!r||void 0!==t){var i=Object(o.o)(e,"values");if(!t||"object"!==typeof t||Array.isArray(t))throw new Error(i+" must be an object containing the children to replace.");var a=[];D(t,(function(e,t){var r=new he(e);if(Wr(i,t,Ee(n,r)),".priority"===ye(r)&&!Vr(t))throw new Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(r)})),function(e,t){var n,r;for(n=0;n<t.length;n++)for(var i=_e(r=t[n]),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!jr(i[o]))throw new Error(e+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');t.sort(Se);var a=null;for(n=0;n<t.length;n++){if(r=t[n],null!==a&&Re(a,r))throw new Error(e+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}}(i,a)}},qr=function(e,t,n){if(!n||void 0!==t){if(I(t))throw new Error(Object(o.o)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!Vr(t))throw new Error(Object(o.o)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},Kr=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(Object(o.o)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Hr=function(e,t,n,r){if((!r||void 0!==n)&&!jr(n))throw new Error(Object(o.o)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},zr=function(e,t,n,r){if((!r||void 0!==n)&&!Fr(n))throw new Error(Object(o.o)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Yr=function(e,t){if(".info"===ve(t))throw new Error(e+" failed = Can't modify data under /.info/")},Qr=function(e,t){var n=t.path.toString();if("string"!==typeof t.repoInfo.host||0===t.repoInfo.host.length||!jr(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==n.length&&!function(e){return e&&(e=e.replace(/^\/*\.info(\/|$)/,"/")),Fr(e)}(n))throw new Error(Object(o.o)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Xr=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(Object(o.o)(e,t)+"must be a boolean.")},Jr=function(){this.eventLists_=[],this.recursionDepth_=0};function $r(e,t){for(var n=null,r=0;r<t.length;r++){var i=t[r],o=i.getPath();null===n||Ie(o,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:o}),n.events.push(i)}n&&e.eventLists_.push(n)}function Zr(e,t,n){$r(e,n),ti(e,(function(e){return Ie(e,t)}))}function ei(e,t,n){$r(e,n),ti(e,(function(e){return Re(e,t)||Re(t,e)}))}function ti(e,t){e.recursionDepth_++;for(var n=!0,r=0;r<e.eventLists_.length;r++){var i=e.eventLists_[r];if(i)t(i.path)?(ni(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}n&&(e.eventLists_=[]),e.recursionDepth_--}function ni(e){for(var t=0;t<e.events.length;t++){var n=e.events[t];if(null!==n){e.events[t]=null;var r=n.getEventRunner();g&&b("event: "+n.toString()),F(r)}}}var ri="repo_interrupt",ii=function(){function e(e,t,n){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Jr,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=kt(),this.transactionQueueTree_=new Rr,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return e.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},e}();function oi(e,t,n){if(e.stats_=$(e.repoInfo_),e.forceRestClient_||("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0)e.server_=new At(e.repoInfo_,(function(t,n,r,i){ci(e,t,n,r,i)}),e.authTokenProvider_),setTimeout((function(){return ui(e,!0)}),0);else{if("undefined"!==typeof n&&null!==n){if("object"!==typeof n)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Object(o.K)(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}e.persistentConnection_=new xe(e.repoInfo_,t,(function(t,n,r,i){ci(e,t,n,r,i)}),(function(t){ui(e,t)}),(function(t){!function(e,t){D(t,(function(t,n){li(e,t,n)}))}(e,t)}),e.authTokenProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener((function(t){e.server_.refreshAuthToken(t)})),e.statsReporter_=function(e,t){var n=e.toString();return J[n]||(J[n]=t()),J[n]}(e.repoInfo_,(function(){return new Lt(e.stats_,e.server_)})),e.infoData_=new Ct,e.infoSyncTree_=new Zn({startListening:function(t,n,r,i){var o=[],a=e.infoData_.getNode(t._path);return a.isEmpty()||(o=rr(e.infoSyncTree_,t._path,a),setTimeout((function(){i("ok")}),0)),o},stopListening:function(){}}),li(e,"connected",!1),e.serverSyncTree_=new Zn({startListening:function(t,n,r,i){return e.server_.listen(t,r,n,(function(n,r){var o=i(n,r);ei(e.eventQueue_,t._path,o)})),[]},stopListening:function(t,n){e.server_.unlisten(t,n)}})}function ai(e){var t=e.infoData_.getNode(new he(".info/serverTimeOffset")).val()||0;return(new Date).getTime()+t}function si(e){return(t=(t={timestamp:ai(e)})||{}).timestamp=t.timestamp||(new Date).getTime(),t;var t}function ci(e,t,n,r,i){e.dataUpdateCount++;var a=new he(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;var s=[];if(i)if(r){var c=Object(o.F)(n,(function(e){return st(e)}));s=function(e,t,n,r){var i=pr(e,r);if(i){var o=vr(i),a=o.path,s=o.queryId,c=Te(a,t),u=Xt.fromObject(n);return mr(e,a,new Bt(Mt(s),c,u))}return[]}(e.serverSyncTree_,a,c,i)}else{var u=st(n);s=function(e,t,n,r){var i=pr(e,r);if(null!=i){var o=vr(i),a=o.path,s=o.queryId,c=Te(a,t);return mr(e,a,new Vt(Mt(s),c,n))}return[]}(e.serverSyncTree_,a,u,i)}else if(r){var l=Object(o.F)(n,(function(e){return st(e)}));s=function(e,t,n){var r=Xt.fromObject(n);return cr(e,new Bt({fromUser:!1,fromServer:!0,queryId:null,tagged:!1},t,r))}(e.serverSyncTree_,a,l)}else{var d=st(n);s=rr(e.serverSyncTree_,a,d)}var f=a;s.length>0&&(f=Ei(e,a)),ei(e.eventQueue_,f,s)}function ui(e,t){li(e,"connected",t),!1===t&&function(e){gi(e,"onDisconnectEvents");var t=si(e),n=kt();Pt(e.onDisconnect_,pe(),(function(r,i){var o=Tr(r,i,e.serverSyncTree_,t);Ot(n,r,o)}));var r=[];Pt(n,pe(),(function(t,n){r=r.concat(rr(e.serverSyncTree_,t,n));var i=Ri(e,t);Ei(e,i)})),e.onDisconnect_=kt(),ei(e.eventQueue_,pe(),r)}(e)}function li(e,t,n){var r=new he("/.info/"+t),i=st(n);e.infoData_.updateSnapshot(r,i);var o=rr(e.infoSyncTree_,r,i);ei(e.eventQueue_,r,o)}function di(e){return e.nextWriteId_++}function fi(e,t,n,r,i){gi(e,"set",{path:t.toString(),value:n,priority:r});var o=si(e),a=st(n,r),s=ar(e.serverSyncTree_,t),c=Sr(a,s,o),u=di(e),l=er(e.serverSyncTree_,t,c,u,!0);$r(e.eventQueue_,l),e.server_.put(t.toString(),a.val(!0),(function(n,r){var o="ok"===n;o||S("set at "+t+" failed: "+n);var a=nr(e.serverSyncTree_,u,!o);ei(e.eventQueue_,t,a),yi(e,i,n,r)}));var d=Ri(e,t);Ei(e,d),ei(e.eventQueue_,d,[])}function hi(e,t,n){e.server_.onDisconnectCancel(t.toString(),(function(r,i){"ok"===r&&Nt(e.onDisconnect_,t),yi(e,n,r,i)}))}function pi(e,t,n,r){var i=st(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(function(n,o){"ok"===n&&Ot(e.onDisconnect_,t,i),yi(e,r,n,o)}))}function vi(e,t,n){var r;r=".info"===ve(t._path)?ir(e.infoSyncTree_,t,n):ir(e.serverSyncTree_,t,n),Zr(e.eventQueue_,t._path,r)}function mi(e){e.persistentConnection_&&e.persistentConnection_.interrupt(ri)}function gi(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r="";e.persistentConnection_&&(r=e.persistentConnection_.id+":"),b.apply(void 0,Object(a.d)([r],Object(a.c)(t)))}function yi(e,t,n,r){t&&F((function(){if("ok"===n)t(null);else{var e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);var o=new Error(i);o.code=e,t(o)}}))}function _i(e,t,n){return ar(e.serverSyncTree_,t,n)||ot.EMPTY_NODE}function bi(e,t){if(void 0===t&&(t=e.transactionQueueTree_),t||Ii(e,t),Cr(t)){var n=Ti(e,t);Object(o.f)(n.length>0,"Sending zero length transaction queue"),n.every((function(e){return 0===e.status}))&&function(e,t,n){for(var r=n.map((function(e){return e.currentWriteId})),i=_i(e,t,r),a=i,s=i.hash(),c=0;c<n.length;c++){var u=n[c];Object(o.f)(0===u.status,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=1,u.retryCount++;var l=Te(t,u.path);a=a.updateChild(l,u.currentOutputSnapshotRaw)}var d=a.val(!0),f=t;e.server_.put(f.toString(),d,(function(r){gi(e,"transaction put response",{path:f.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=function(t){n[t].status=2,i=i.concat(nr(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&o.push((function(){return n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)})),n[t].unwatcher()},s=0;s<n.length;s++)a(s);Ii(e,Ar(e.transactionQueueTree_,t)),bi(e,e.transactionQueueTree_),ei(e.eventQueue_,t,i);for(s=0;s<o.length;s++)F(o[s])}else{if("datastale"===r)for(s=0;s<n.length;s++)3===n[s].status?n[s].status=4:n[s].status=0;else{S("transaction at "+f.toString()+" failed: "+r);for(s=0;s<n.length;s++)n[s].status=4,n[s].abortReason=r}Ei(e,t)}}),s)}(e,Dr(t),n)}else Or(t)&&Nr(t,(function(t){bi(e,t)}))}function Ei(e,t){var n=wi(e,t),r=Dr(n);return function(e,t,n){if(0===t.length)return;for(var r=[],i=[],a=t.filter((function(e){return 0===e.status})).map((function(e){return e.currentWriteId})),s=function(s){var c,u,l=t[s],d=Te(n,l.path),f=!1;if(Object(o.f)(null!==d,"rerunTransactionsUnderNode_: relativePath should not be null."),4===l.status)f=!0,c=l.abortReason,i=i.concat(nr(e.serverSyncTree_,l.currentWriteId,!0));else if(0===l.status)if(l.retryCount>=25)f=!0,c="maxretry",i=i.concat(nr(e.serverSyncTree_,l.currentWriteId,!0));else{var h=_i(e,l.path,a);l.currentInputSnapshot=h;var p=t[s].update(h.val());if(void 0!==p){Wr("transaction failed: Data returned ",p,l.path);var v=st(p);"object"===typeof p&&null!=p&&Object(o.k)(p,".priority")||(v=v.updatePriority(h.getPriority()));var m=l.currentWriteId,g=si(e),y=Sr(v,h,g);l.currentOutputSnapshotRaw=v,l.currentOutputSnapshotResolved=y,l.currentWriteId=di(e),a.splice(a.indexOf(m),1),i=(i=i.concat(er(e.serverSyncTree_,l.path,y,l.currentWriteId,l.applyLocally))).concat(nr(e.serverSyncTree_,m,!0))}else f=!0,c="nodata",i=i.concat(nr(e.serverSyncTree_,l.currentWriteId,!0))}ei(e.eventQueue_,n,i),i=[],f&&(t[s].status=2,u=t[s].unwatcher,setTimeout(u,Math.floor(0)),t[s].onComplete&&("nodata"===c?r.push((function(){return t[s].onComplete(null,!1,t[s].currentInputSnapshot)})):r.push((function(){return t[s].onComplete(new Error(c),!1,null)}))))},c=0;c<t.length;c++)s(c);Ii(e,e.transactionQueueTree_);for(c=0;c<r.length;c++)F(r[c]);bi(e,e.transactionQueueTree_)}(e,Ti(e,n),r),r}function wi(e,t){var n,r=e.transactionQueueTree_;for(n=ve(t);null!==n&&void 0===Cr(r);)r=Ar(r,n),n=ve(t=ge(t));return r}function Ti(e,t){var n=[];return Si(e,t,n),n.sort((function(e,t){return e.order-t.order})),n}function Si(e,t,n){var r=Cr(t);if(r)for(var i=0;i<r.length;i++)n.push(r[i]);Nr(t,(function(t){Si(e,t,n)}))}function Ii(e,t){var n=Cr(t);if(n){for(var r=0,i=0;i<n.length;i++)2!==n[i].status&&(n[r]=n[i],r++);n.length=r,kr(t,n.length>0?n:void 0)}Nr(t,(function(t){Ii(e,t)}))}function Ri(e,t){var n=Dr(wi(e,t)),r=Ar(e.transactionQueueTree_,t);return function(e,t,n){for(var r=n?e:e.parent;null!==r;){if(t(r))return!0;r=r.parent}}(r,(function(t){Ai(e,t)})),Ai(e,r),Pr(r,(function(t){Ai(e,t)})),n}function Ai(e,t){var n=Cr(t);if(n){for(var r=[],i=[],a=-1,s=0;s<n.length;s++)3===n[s].status||(1===n[s].status?(Object(o.f)(a===s-1,"All SENT items should be at beginning of queue."),a=s,n[s].status=3,n[s].abortReason="set"):(Object(o.f)(0===n[s].status,"Unexpected transaction status in abort"),n[s].unwatcher(),i=i.concat(nr(e.serverSyncTree_,n[s].currentWriteId,!0)),n[s].onComplete&&r.push(n[s].onComplete.bind(null,new Error("set"),!1,null))));-1===a?kr(t,void 0):n.length=a+1,ei(e.eventQueue_,Dr(t),i);for(s=0;s<r.length;s++)F(r[s])}}var Ci=function(e,t){var n=ki(e),r=n.namespace;"firebase.com"===n.domain&&T(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||T("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&S("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().");var i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new z(n.host,n.secure,r,t,i,"",r!==n.subdomain),path:new he(n.pathString)}},ki=function(e){var t="",n="",r="",i="",o="",s=!0,c="https",u=443;if("string"===typeof e){var l=e.indexOf("//");l>=0&&(c=e.substring(0,l-1),e=e.substring(l+2));var d=e.indexOf("/");-1===d&&(d=e.length);var f=e.indexOf("?");-1===f&&(f=e.length),t=e.substring(0,Math.min(d,f)),d<f&&(i=function(e){for(var t="",n=e.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(o){}t+="/"+i}return t}(e.substring(d,f)));var h=function(e){var t,n,r={};"?"===e.charAt(0)&&(e=e.substring(1));try{for(var i=Object(a.e)(e.split("&")),o=i.next();!o.done;o=i.next()){var s=o.value;if(0!==s.length){var c=s.split("=");2===c.length?r[decodeURIComponent(c[0])]=decodeURIComponent(c[1]):S("Invalid query segment '"+s+"' in query '"+e+"'")}}}catch(u){t={error:u}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r}(e.substring(Math.min(e.length,f)));(l=t.indexOf(":"))>=0?(s="https"===c||"wss"===c,u=parseInt(t.substring(l+1),10)):l=t.length;var p=t.slice(0,l);if("localhost"===p.toLowerCase())n="localhost";else if(p.split(".").length<=2)n=p;else{var v=t.indexOf(".");r=t.substring(0,v).toLowerCase(),n=t.substring(v+1),o=r}"ns"in h&&(o=h.ns)}return{host:t,port:u,domain:n,subdomain:r,secure:s,scheme:c,pathString:i,namespace:o}},Oi=function(){function e(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}return e.prototype.getPath=function(){var e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path},e.prototype.getEventType=function(){return this.eventType},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Object(o.K)(this.snapshot.exportVal())},e}(),Ni=function(){function e(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}return e.prototype.getPath=function(){return this.path},e.prototype.getEventType=function(){return"cancel"},e.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},e.prototype.toString=function(){return this.path.toString()+":cancel"},e}(),Pi=function(){function e(e,t){this.snapshotCallback=e,this.cancelCallback=t}return e.prototype.onValue=function(e,t){this.snapshotCallback.call(null,e,t)},e.prototype.onCancel=function(e){return Object(o.f)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(e.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),e.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},e}(),Di=function(){function e(e,t){this._repo=e,this._path=t}return e.prototype.cancel=function(){var e=new o.a;return hi(this._repo,this._path,e.wrapCallback((function(){}))),e.promise},e.prototype.remove=function(){Yr("OnDisconnect.remove",this._path);var e=new o.a;return pi(this._repo,this._path,null,e.wrapCallback((function(){}))),e.promise},e.prototype.set=function(e){Yr("OnDisconnect.set",this._path),Br("OnDisconnect.set",e,this._path,!1);var t=new o.a;return pi(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e.prototype.setWithPriority=function(e,t){Yr("OnDisconnect.setWithPriority",this._path),Br("OnDisconnect.setWithPriority",e,this._path,!1),qr("OnDisconnect.setWithPriority",t,!1);var n=new o.a;return function(e,t,n,r,i){var o=st(n,r);e.server_.onDisconnectPut(t.toString(),o.val(!0),(function(n,r){"ok"===n&&Ot(e.onDisconnect_,t,o),yi(0,i,n,r)}))}(this._repo,this._path,e,t,n.wrapCallback((function(){}))),n.promise},e.prototype.update=function(e){Yr("OnDisconnect.update",this._path),Gr("OnDisconnect.update",e,this._path,!1);var t=new o.a;return function(e,t,n,r){if(Object(o.v)(n))return b("onDisconnect().update() called with empty data.  Don't do anything."),void yi(0,r,"ok",void 0);e.server_.onDisconnectMerge(t.toString(),n,(function(i,o){"ok"===i&&D(n,(function(n,r){var i=st(r);Ot(e.onDisconnect_,Ee(t,n),i)})),yi(0,r,i,o)}))}(this._repo,this._path,e,t.wrapCallback((function(){}))),t.promise},e}(),xi=function(){function e(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}return Object.defineProperty(e.prototype,"key",{get:function(){return we(this._path)?null:ye(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ref",{get:function(){return new ji(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryIdentifier",{get:function(){var e=Rt(this._queryParams),t=N(e);return"{}"===t?"default":t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_queryObject",{get:function(){return Rt(this._queryParams)},enumerable:!1,configurable:!0}),e.prototype.isEqual=function(t){if(!((t=Object(o.p)(t))instanceof e))return!1;var n=this._repo===t._repo,r=Ie(this._path,t._path),i=this._queryIdentifier===t._queryIdentifier;return n&&r&&i},e.prototype.toJSON=function(){return this.toString()},e.prototype.toString=function(){return this._repo.toString()+function(e){for(var t="",n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)},e}();function Li(e,t){if(!0===e._orderByCalled)throw new Error(t+": You can't combine multiple orderBy calls.")}function Mi(e){var t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===je){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){if(e.getIndexStartName()!==R)throw new Error(r);if("string"!==typeof t)throw new Error(i)}if(e.hasEnd()){if(e.getIndexEndName()!==A)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(e.getIndex()===Ze){if(null!=t&&!Vr(t)||null!=n&&!Vr(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(Object(o.f)(e.getIndex()instanceof ct||e.getIndex()===ut,"unknown index type."),null!=t&&"object"===typeof t||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Ui(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var ji=function(e){function t(t,n){return e.call(this,t,n,new Et,!1)||this}return Object(a.b)(t,e),Object.defineProperty(t.prototype,"parent",{get:function(){var e=be(this._path);return null===e?null:new t(this._repo,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),t}(xi),Fi=function(){function e(e,t,n){this._node=e,this.ref=t,this._index=n}return Object.defineProperty(e.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),e.prototype.child=function(t){var n=new he(t),r=Wi(this.ref,t);return new e(this._node.getChild(n),r,Ze)},e.prototype.exists=function(){return!this._node.isEmpty()},e.prototype.exportVal=function(){return this._node.val(!0)},e.prototype.forEach=function(t){var n=this;return!this._node.isLeafNode()&&!!this._node.forEachChild(this._index,(function(r,i){return t(new e(i,Wi(n.ref,r),Ze))}))},e.prototype.hasChild=function(e){var t=new he(e);return!this._node.getChild(t).isEmpty()},e.prototype.hasChildren=function(){return!this._node.isLeafNode()&&!this._node.isEmpty()},e.prototype.toJSON=function(){return this.exportVal()},e.prototype.val=function(){return this._node.val()},e}();function Vi(e,t){return(e=Object(o.p)(e))._checkNotDeleted("ref"),void 0!==t?Wi(e._root,t):e._root}function Bi(e,t){(e=Object(o.p)(e))._checkNotDeleted("refFromURL");var n=Ci(t,e._repo.repoInfo_.nodeAdmin);Qr("refFromURL",n);var r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||T("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),Vi(e,n.path.toString())}function Wi(e,t){var n,r,i,a;return null===ve((e=Object(o.p)(e))._path)?(n="child",r="path",a=!1,(i=t)&&(i=i.replace(/^\/*\.info(\/|$)/,"/")),zr(n,r,i,a)):zr("child","path",t,!1),new ji(e._repo,Ee(e._path,t))}function Gi(e,t){e=Object(o.p)(e),Yr("push",e._path),Br("push",t,e._path,!0);var n,r=ai(e._repo),i=dt(r),a=Wi(e,i),s=Wi(e,i);return n=null!=t?Ki(s,t).then((function(){return s})):Promise.resolve(s),a.then=n.then.bind(n),a.catch=n.then.bind(n,void 0),a}function qi(e){return Yr("remove",e._path),Ki(e,null)}function Ki(e,t){e=Object(o.p)(e),Yr("set",e._path),Br("set",t,e._path,!1);var n=new o.a;return fi(e._repo,e._path,t,null,n.wrapCallback((function(){}))),n.promise}function Hi(e,t){e=Object(o.p)(e),Yr("setPriority",e._path),qr("setPriority",t,!1);var n=new o.a;return fi(e._repo,Ee(e._path,".priority"),t,null,n.wrapCallback((function(){}))),n.promise}function zi(e,t,n){if(Yr("setWithPriority",e._path),Br("setWithPriority",t,e._path,!1),qr("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";var r=new o.a;return fi(e._repo,e._path,t,n,r.wrapCallback((function(){}))),r.promise}function Yi(e,t){Gr("update",t,e._path,!1);var n=new o.a;return function(e,t,n,r){gi(e,"update",{path:t.toString(),value:n});var i=!0,o=si(e),a={};if(D(n,(function(n,r){i=!1,a[n]=Tr(Ee(t,n),st(r),e.serverSyncTree_,o)})),i)b("update() called with empty data.  Don't do anything."),yi(0,r,"ok",void 0);else{var s=di(e),c=tr(e.serverSyncTree_,t,a,s);$r(e.eventQueue_,c),e.server_.merge(t.toString(),n,(function(n,i){var o="ok"===n;o||S("update at "+t+" failed: "+n);var a=nr(e.serverSyncTree_,s,!o),c=a.length>0?Ei(e,t):t;ei(e.eventQueue_,c,a),yi(0,r,n,i)})),D(n,(function(n){var r=Ri(e,Ee(t,n));Ei(e,r)})),ei(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback((function(){}))),n.promise}function Qi(e){return function(e,t){var n=sr(e.serverSyncTree_,t);return null!=n?Promise.resolve(n):e.server_.get(t).then((function(n){var r=st(n),i=rr(e.serverSyncTree_,t._path,r);return Zr(e.eventQueue_,t._path,i),Promise.resolve(r)}),(function(n){return gi(e,"get for query "+Object(o.K)(t)+" failed: "+n),Promise.reject(new Error(n))}))}((e=Object(o.p)(e))._repo,e).then((function(t){return new Fi(t,new ji(e._repo,e._path),e._queryParams.getIndex())}))}var Xi=function(){function e(e){this.callbackContext=e}return e.prototype.respondsTo=function(e){return"value"===e},e.prototype.createEvent=function(e,t){var n=t._queryParams.getIndex();return new Oi("value",this,new Fi(e.snapshotNode,new ji(t._repo,t._path),n))},e.prototype.getEventRunner=function(e){var t=this;return"cancel"===e.getEventType()?function(){return t.callbackContext.onCancel(e.error)}:function(){return t.callbackContext.onValue(e.snapshot,null)}},e.prototype.createCancelEvent=function(e,t){return this.callbackContext.hasCancelCallback?new Ni(this,e,t):null},e.prototype.matches=function(t){return t instanceof e&&(!t.callbackContext||!this.callbackContext||t.callbackContext.matches(this.callbackContext))},e.prototype.hasAnyCallback=function(){return null!==this.callbackContext},e}(),Ji=function(){function e(e){this.callbacks=e}return e.prototype.respondsTo=function(e){var t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,Object(o.k)(this.callbacks,t)},e.prototype.createCancelEvent=function(e,t){return this.callbacks.cancel.hasCancelCallback?new Ni(this,e,t):null},e.prototype.createEvent=function(e,t){Object(o.f)(null!=e.childName,"Child events should have a childName.");var n=Wi(new ji(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new Oi(e.type,this,new Fi(e.snapshotNode,n,r),e.prevName)},e.prototype.getEventRunner=function(e){if("cancel"===e.getEventType()){var t=this.callbacks.cancel;return function(){return t.onCancel(e.error)}}var n=this.callbacks[e.eventType];return function(){return n.onValue(e.snapshot,e.prevName)}},e.prototype.matches=function(t){var n=this;if(t instanceof e){if(!this.callbacks||!t.callbacks)return!0;var r=Object.keys(t.callbacks),i=Object.keys(this.callbacks),o=r.length;if(o===i.length){if(1===o){var a=r[0],s=i[0];return s===a&&(!t.callbacks[a]||!this.callbacks[s]||t.callbacks[a].matches(this.callbacks[s]))}return i.every((function(e){return t.callbacks[e].matches(n.callbacks[e])}))}}return!1},e.prototype.hasAnyCallback=function(){return null!==this.callbacks},e}();function $i(e,t,n,r,i){var o,a;if("object"===typeof r&&(a=void 0,i=r),"function"===typeof r&&(a=r),i&&i.onlyOnce){var s=n,c=function(t,n){s(t,n),vi(e._repo,e,l)};c.userCallback=n.userCallback,c.context=n.context,n=c}var u=new Pi(n,a||void 0),l="value"===t?new Xi(u):new Ji(((o={})[t]=u,o));return function(e,t,n){var r;r=".info"===ve(t._path)?or(e.infoSyncTree_,t,n):or(e.serverSyncTree_,t,n),Zr(e.eventQueue_,t._path,r)}(e._repo,e,l),function(){return vi(e._repo,e,l)}}function Zi(e,t,n,r){return $i(e,"value",t,n,r)}function eo(e,t,n,r){return $i(e,"child_added",t,n,r)}function to(e,t,n,r){return $i(e,"child_changed",t,n,r)}function no(e,t,n,r){return $i(e,"child_moved",t,n,r)}function ro(e,t,n,r){return $i(e,"child_removed",t,n,r)}function io(e,t,n){var r=null,i=null,o=n?new Pi(n):null;"value"===t?r=new Xi(o):t&&(n&&((i={})[t]=o),r=new Ji(i)),vi(e._repo,e,r)}var oo=function(){},ao=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(a.b)(t,e),t.prototype._apply=function(e){Br("endAt",this._value,e._path,!0);var t=Tt(e._queryParams,this._value,this._key);if(Ui(t),Mi(t),e._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new xi(e._repo,e._path,t,e._orderByCalled)},t}(oo);function so(e,t){return Hr("endAt","key",t,!0),new ao(e,t)}var co=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(a.b)(t,e),t.prototype._apply=function(e){Br("endBefore",this._value,e._path,!1);var t=function(e,t,n){var r;return e.index_===je?("string"===typeof t&&(t=ht(t)),r=Tt(e,t,n)):r=Tt(e,t,null==n?R:ht(n)),r.endBeforeSet_=!0,r}(e._queryParams,this._value,this._key);if(Ui(t),Mi(t),e._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new xi(e._repo,e._path,t,e._orderByCalled)},t}(oo);function uo(e,t){return Hr("endBefore","key",t,!0),new co(e,t)}var lo=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(a.b)(t,e),t.prototype._apply=function(e){Br("startAt",this._value,e._path,!0);var t=wt(e._queryParams,this._value,this._key);if(Ui(t),Mi(t),e._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new xi(e._repo,e._path,t,e._orderByCalled)},t}(oo);function fo(e,t){return void 0===e&&(e=null),Hr("startAt","key",t,!0),new lo(e,t)}var ho=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(a.b)(t,e),t.prototype._apply=function(e){Br("startAfter",this._value,e._path,!1);var t=function(e,t,n){var r;e.index_===je?("string"===typeof t&&(t=ft(t)),r=wt(e,t,n)):r=wt(e,t,null==n?A:ft(n));return r.startAfterSet_=!0,r}(e._queryParams,this._value,this._key);if(Ui(t),Mi(t),e._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new xi(e._repo,e._path,t,e._orderByCalled)},t}(oo);function po(e,t){return Hr("startAfter","key",t,!0),new ho(e,t)}var vo=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(a.b)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new xi(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)},t}(oo);function mo(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new vo(e)}var go=function(e){function t(t){var n=e.call(this)||this;return n._limit=t,n}return Object(a.b)(t,e),t.prototype._apply=function(e){if(e._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new xi(e._repo,e._path,function(e,t){var n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)},t}(oo);function yo(e){if("number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new go(e)}var _o=function(e){function t(t){var n=e.call(this)||this;return n._path=t,n}return Object(a.b)(t,e),t.prototype._apply=function(e){Li(e,"orderByChild");var t=new he(this._path);if(we(t))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var n=new ct(t),r=St(e._queryParams,n);return Mi(r),new xi(e._repo,e._path,r,!0)},t}(oo);function bo(e){if("$key"===e)throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return zr("orderByChild","path",e,!1),new _o(e)}var Eo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype._apply=function(e){Li(e,"orderByKey");var t=St(e._queryParams,je);return Mi(t),new xi(e._repo,e._path,t,!0)},t}(oo);function wo(){return new Eo}var To=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype._apply=function(e){Li(e,"orderByPriority");var t=St(e._queryParams,Ze);return Mi(t),new xi(e._repo,e._path,t,!0)},t}(oo);function So(){return new To}var Io=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(a.b)(t,e),t.prototype._apply=function(e){Li(e,"orderByValue");var t=St(e._queryParams,ut);return Mi(t),new xi(e._repo,e._path,t,!0)},t}(oo);function Ro(){return new Io}var Ao=function(e){function t(t,n){var r=e.call(this)||this;return r._value=t,r._key=n,r}return Object(a.b)(t,e),t.prototype._apply=function(e){if(Br("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new ao(this._value,this._key)._apply(new lo(this._value,this._key)._apply(e))},t}(oo);function Co(e,t){return Hr("equalTo","key",t,!0),new Ao(e,t)}function ko(e){for(var t,n,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var s=Object(o.p)(e);try{for(var c=Object(a.e)(r),u=c.next();!u.done;u=c.next()){var l=u.value;s=l._apply(s)}}catch(d){t={error:d}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}return s}!function(e){Object(o.f)(!Dn,"__referenceConstructor has already been defined"),Dn=e}(ji),function(e){Object(o.f)(!Vn,"__referenceConstructor has already been defined"),Vn=e}(ji);var Oo={},No=!1;function Po(t,n,r,i){var o=r||t.options.databaseURL;void 0===o&&(t.options.projectId||T("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),b("Using default host for project ",t.options.projectId),o=t.options.projectId+"-default-rtdb.firebaseio.com");var a,s=Ci(o,i),c=s.repoInfo,u=void 0;"undefined"!==typeof e&&(u=Object({NODE_ENV:"production",PUBLIC_URL:"/reactWebRTC",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_AGORA_appId:"bbd7163630ad44b1be26800d4a20d5eb",REACT_APP_FIREBASE_appId:"1:308314822178:web:c4b49794d7305f9bec1c7b",REACT_APP_FIREBASE_authDomain:"test-0414-2021.firebaseapp.com",REACT_APP_FIREBASE_KEY:"AIzaSyCnvcvMLPgIJL2GLhQ4hkwcpO5dFPY0wIs",REACT_APP_FIREBASE_messagingSenderId:"308314822178",REACT_APP_FIREBASE_projectId:"test-0414-2021",REACT_APP_FIREBASE_storageBucket:"test-0414-2021.appspot.com"}).FIREBASE_DATABASE_EMULATOR_HOST),u?(a=!0,o="http://"+u+"?ns="+c.namespace,c=(s=Ci(o,i)).repoInfo):a=!s.repoInfo.secure;var l=i&&a?new W:new B(t.name,t.options,n);Qr("Invalid Firebase Database URL",s),we(s.path)||T("Database URL must point to the root of a Firebase Database (not including a child path).");var d=function(e,t,n){var r=Oo[t.name];r||(r={},Oo[t.name]=r);var i=r[e.toURLString()];i&&T("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call.");return i=new ii(e,No,n),r[e.toURLString()]=i,i}(c,t,l);return new Do(d,t)}var Do=function(){function e(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}return Object.defineProperty(e.prototype,"_repo",{get:function(){return this._instanceStarted||(oi(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new ji(this._repo,pe())),this._rootInternal},enumerable:!1,configurable:!0}),e.prototype._delete=function(){return this._checkNotDeleted("delete"),function(e,t){var n=Oo[t];n&&n[e.key]===e||T("Database "+t+"("+e.repoInfo_+") has already been deleted."),mi(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null,Promise.resolve()},e.prototype._checkNotDeleted=function(e){null===this._rootInternal&&T("Cannot call "+e+" on a deleted database.")},e}();function xo(e,t,n){(e=Object(o.p)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&T("Cannot call useEmulator() after instance has already been initialized."),function(e,t,n){e.repoInfo_=new z(t+":"+n,!1,e.repoInfo_.namespace,e.repoInfo_.webSocketOnly,e.repoInfo_.nodeAdmin,e.repoInfo_.persistenceKey,e.repoInfo_.includeNamespaceInQueryParams),e.repoInfo_.nodeAdmin&&(e.authTokenProvider_=new W)}(e._repo,t,n)}function Lo(e){(e=Object(o.p)(e))._checkNotDeleted("goOffline"),mi(e._repo)}function Mo(e){var t;(e=Object(o.p)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(ri)}function Uo(e,t){_(e,t)}var jo={".sv":"timestamp"};var Fo=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}();function Vo(e,t,n){var r;if(e=Object(o.p)(e),Yr("Reference.transaction",e._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";var i=null===(r=null===n||void 0===n?void 0:n.applyLocally)||void 0===r||r,a=new o.a,s=Zi(e,(function(){}));return function(e,t,n,r,i,a){gi(e,"transaction on "+t);var s={path:t,update:n,onComplete:r,status:null,order:p(),applyLocally:a,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=_i(e,t,void 0);s.currentInputSnapshot=c;var u=s.update(c.val());if(void 0===u)s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete&&s.onComplete(null,!1,s.currentInputSnapshot);else{Wr("transaction failed: Data returned ",u,s.path),s.status=0;var l=Ar(e.transactionQueueTree_,t),d=Cr(l)||[];d.push(s),kr(l,d);var f=void 0;"object"===typeof u&&null!==u&&Object(o.k)(u,".priority")?(f=Object(o.H)(u,".priority"),Object(o.f)(Vr(f),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.")):f=(ar(e.serverSyncTree_,t)||ot.EMPTY_NODE).getPriority().val();var h=si(e),v=st(u,f),m=Sr(v,c,h);s.currentOutputSnapshotRaw=v,s.currentOutputSnapshotResolved=m,s.currentWriteId=di(e);var g=er(e.serverSyncTree_,t,m,s.currentWriteId,s.applyLocally);ei(e.eventQueue_,t,g),bi(e,e.transactionQueueTree_)}}(e._repo,e._path,t,(function(t,n,r){var i=null;t?a.reject(t):(i=new Fi(r,new ji(e._repo,e._path),Ze),a.resolve(new Fo(n,i)))}),s,i),a.promise}var Bo=function(){function e(e){this._delegate=e}return e.prototype.cancel=function(e){Object(o.L)("OnDisconnect.cancel",0,1,arguments.length),Object(o.M)("OnDisconnect.cancel","onComplete",e,!0);var t=this._delegate.cancel();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.remove=function(e){Object(o.L)("OnDisconnect.remove",0,1,arguments.length),Object(o.M)("OnDisconnect.remove","onComplete",e,!0);var t=this._delegate.remove();return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},e.prototype.set=function(e,t){Object(o.L)("OnDisconnect.set",1,2,arguments.length),Object(o.M)("OnDisconnect.set","onComplete",t,!0);var n=this._delegate.set(e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},e.prototype.setWithPriority=function(e,t,n){Object(o.L)("OnDisconnect.setWithPriority",2,3,arguments.length),Object(o.M)("OnDisconnect.setWithPriority","onComplete",n,!0);var r=this._delegate.setWithPriority(e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},e.prototype.update=function(e,t){if(Object(o.L)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,S("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Object(o.M)("OnDisconnect.update","onComplete",t,!0);var i=this._delegate.update(e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},e}(),Wo=function(){function e(e,t){this.committed=e,this.snapshot=t}return e.prototype.toJSON=function(){return Object(o.L)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},e}(),Go=function(){function e(e,t){this._database=e,this._delegate=t}return e.prototype.val=function(){return Object(o.L)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},e.prototype.exportVal=function(){return Object(o.L)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},e.prototype.toJSON=function(){return Object(o.L)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.exists=function(){return Object(o.L)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},e.prototype.child=function(t){return Object(o.L)("DataSnapshot.child",0,1,arguments.length),t=String(t),zr("DataSnapshot.child","path",t,!1),new e(this._database,this._delegate.child(t))},e.prototype.hasChild=function(e){return Object(o.L)("DataSnapshot.hasChild",1,1,arguments.length),zr("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)},e.prototype.getPriority=function(){return Object(o.L)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},e.prototype.forEach=function(t){var n=this;return Object(o.L)("DataSnapshot.forEach",1,1,arguments.length),Object(o.M)("DataSnapshot.forEach","action",t,!1),this._delegate.forEach((function(r){return t(new e(n._database,r))}))},e.prototype.hasChildren=function(){return Object(o.L)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(e.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),e.prototype.numChildren=function(){return Object(o.L)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},e.prototype.getRef=function(){return Object(o.L)("DataSnapshot.ref",0,0,arguments.length),new Ko(this._database,this._delegate.ref)},Object.defineProperty(e.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),e}(),qo=function(){function e(e,t){this.database=e,this._delegate=t}return e.prototype.on=function(t,n,r,i){var a,s=this;Object(o.L)("Query.on",2,4,arguments.length),Object(o.M)("Query.on","callback",n,!1);var c=e.getCancelAndContextArgs_("Query.on",r,i),u=function(e,t){n.call(c.context,new Go(s.database,e),t)};u.userCallback=n,u.context=c.context;var l=null===(a=c.cancel)||void 0===a?void 0:a.bind(c.context);switch(t){case"value":return Zi(this._delegate,u,l),n;case"child_added":return eo(this._delegate,u,l),n;case"child_removed":return ro(this._delegate,u,l),n;case"child_changed":return to(this._delegate,u,l),n;case"child_moved":return no(this._delegate,u,l),n;default:throw new Error(Object(o.o)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.prototype.off=function(e,t,n){if(Object(o.L)("Query.off",0,3,arguments.length),Kr("Query.off",e,!0),Object(o.M)("Query.off","callback",t,!0),Object(o.N)("Query.off","context",n,!0),t){var r=function(){};r.userCallback=t,r.context=n,io(this._delegate,e,r)}else io(this._delegate,e)},e.prototype.get=function(){var e=this;return Qi(this._delegate).then((function(t){return new Go(e.database,t)}))},e.prototype.once=function(t,n,r,i){var a=this;Object(o.L)("Query.once",1,4,arguments.length),Object(o.M)("Query.once","callback",n,!0);var s=e.getCancelAndContextArgs_("Query.on",r,i),c=new o.a,u=function(e,t){var r=new Go(a.database,e);n&&n.call(s.context,r,t),c.resolve(r)};u.userCallback=n,u.context=s.context;var l=function(e){s.cancel&&s.cancel.call(s.context,e),c.reject(e)};switch(t){case"value":Zi(this._delegate,u,l,{onlyOnce:!0});break;case"child_added":eo(this._delegate,u,l,{onlyOnce:!0});break;case"child_removed":ro(this._delegate,u,l,{onlyOnce:!0});break;case"child_changed":to(this._delegate,u,l,{onlyOnce:!0});break;case"child_moved":no(this._delegate,u,l,{onlyOnce:!0});break;default:throw new Error(Object(o.o)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return c.promise},e.prototype.limitToFirst=function(t){return Object(o.L)("Query.limitToFirst",1,1,arguments.length),new e(this.database,ko(this._delegate,mo(t)))},e.prototype.limitToLast=function(t){return Object(o.L)("Query.limitToLast",1,1,arguments.length),new e(this.database,ko(this._delegate,yo(t)))},e.prototype.orderByChild=function(t){return Object(o.L)("Query.orderByChild",1,1,arguments.length),new e(this.database,ko(this._delegate,bo(t)))},e.prototype.orderByKey=function(){return Object(o.L)("Query.orderByKey",0,0,arguments.length),new e(this.database,ko(this._delegate,wo()))},e.prototype.orderByPriority=function(){return Object(o.L)("Query.orderByPriority",0,0,arguments.length),new e(this.database,ko(this._delegate,So()))},e.prototype.orderByValue=function(){return Object(o.L)("Query.orderByValue",0,0,arguments.length),new e(this.database,ko(this._delegate,Ro()))},e.prototype.startAt=function(t,n){return void 0===t&&(t=null),Object(o.L)("Query.startAt",0,2,arguments.length),new e(this.database,ko(this._delegate,fo(t,n)))},e.prototype.startAfter=function(t,n){return void 0===t&&(t=null),Object(o.L)("Query.startAfter",0,2,arguments.length),new e(this.database,ko(this._delegate,po(t,n)))},e.prototype.endAt=function(t,n){return void 0===t&&(t=null),Object(o.L)("Query.endAt",0,2,arguments.length),new e(this.database,ko(this._delegate,so(t,n)))},e.prototype.endBefore=function(t,n){return void 0===t&&(t=null),Object(o.L)("Query.endBefore",0,2,arguments.length),new e(this.database,ko(this._delegate,uo(t,n)))},e.prototype.equalTo=function(t,n){return Object(o.L)("Query.equalTo",1,2,arguments.length),new e(this.database,ko(this._delegate,Co(t,n)))},e.prototype.toString=function(){return Object(o.L)("Query.toString",0,0,arguments.length),this._delegate.toString()},e.prototype.toJSON=function(){return Object(o.L)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},e.prototype.isEqual=function(t){if(Object(o.L)("Query.isEqual",1,1,arguments.length),!(t instanceof e)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(t._delegate)},e.getCancelAndContextArgs_=function(e,t,n){var r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,Object(o.M)(e,"cancel",r.cancel,!0),r.context=n,Object(o.N)(e,"context",r.context,!0);else if(t)if("object"===typeof t&&null!==t)r.context=t;else{if("function"!==typeof t)throw new Error(Object(o.o)(e,"cancelOrContext")+" must either be a cancel callback or a context object.");r.cancel=t}return r},Object.defineProperty(e.prototype,"ref",{get:function(){return new Ko(this.database,new ji(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),e}(),Ko=function(e){function t(t,n){var r=e.call(this,t,new xi(n._repo,n._path,new Et,!1))||this;return r.database=t,r._delegate=n,r}return Object(a.b)(t,e),t.prototype.getKey=function(){return Object(o.L)("Reference.key",0,0,arguments.length),this._delegate.key},t.prototype.child=function(e){return Object(o.L)("Reference.child",1,1,arguments.length),"number"===typeof e&&(e=String(e)),new t(this.database,Wi(this._delegate,e))},t.prototype.getParent=function(){Object(o.L)("Reference.parent",0,0,arguments.length);var e=this._delegate.parent;return e?new t(this.database,e):null},t.prototype.getRoot=function(){return Object(o.L)("Reference.root",0,0,arguments.length),new t(this.database,this._delegate.root)},t.prototype.set=function(e,t){Object(o.L)("Reference.set",1,2,arguments.length),Object(o.M)("Reference.set","onComplete",t,!0);var n=Ki(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.update=function(e,t){if(Object(o.L)("Reference.update",1,2,arguments.length),Array.isArray(e)){for(var n={},r=0;r<e.length;++r)n[""+r]=e[r];e=n,S("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}Yr("Reference.update",this._delegate._path),Object(o.M)("Reference.update","onComplete",t,!0);var i=Yi(this._delegate,e);return t&&i.then((function(){return t(null)}),(function(e){return t(e)})),i},t.prototype.setWithPriority=function(e,t,n){Object(o.L)("Reference.setWithPriority",2,3,arguments.length),Object(o.M)("Reference.setWithPriority","onComplete",n,!0);var r=zi(this._delegate,e,t);return n&&r.then((function(){return n(null)}),(function(e){return n(e)})),r},t.prototype.remove=function(e){Object(o.L)("Reference.remove",0,1,arguments.length),Object(o.M)("Reference.remove","onComplete",e,!0);var t=qi(this._delegate);return e&&t.then((function(){return e(null)}),(function(t){return e(t)})),t},t.prototype.transaction=function(e,t,n){var r=this;Object(o.L)("Reference.transaction",1,3,arguments.length),Object(o.M)("Reference.transaction","transactionUpdate",e,!1),Object(o.M)("Reference.transaction","onComplete",t,!0),Xr("Reference.transaction","applyLocally",n,!0);var i=Vo(this._delegate,e,{applyLocally:n}).then((function(e){return new Wo(e.committed,new Go(r.database,e.snapshot))}));return t&&i.then((function(e){return t(null,e.committed,e.snapshot)}),(function(e){return t(e,!1,null)})),i},t.prototype.setPriority=function(e,t){Object(o.L)("Reference.setPriority",1,2,arguments.length),Object(o.M)("Reference.setPriority","onComplete",t,!0);var n=Hi(this._delegate,e);return t&&n.then((function(){return t(null)}),(function(e){return t(e)})),n},t.prototype.push=function(e,n){var r=this;Object(o.L)("Reference.push",0,2,arguments.length),Object(o.M)("Reference.push","onComplete",n,!0);var i=Gi(this._delegate,e),a=i.then((function(e){return new t(r.database,e)}));n&&a.then((function(){return n(null)}),(function(e){return n(e)}));var s=new t(this.database,i);return s.then=a.then.bind(a),s.catch=a.catch.bind(a,void 0),s},t.prototype.onDisconnect=function(){return Yr("Reference.onDisconnect",this._delegate._path),new Bo(new Di(this._delegate._repo,this._delegate._path))},Object.defineProperty(t.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),t}(qo),Ho=function(){function e(e,t){var n=this;this._delegate=e,this.app=t,this.INTERNAL={delete:function(){return n._delegate._delete()}}}return e.prototype.useEmulator=function(e,t){xo(this._delegate,e,t)},e.prototype.ref=function(e){if(Object(o.L)("database.ref",0,1,arguments.length),e instanceof Ko){var t=Bi(this._delegate,e.toString());return new Ko(this,t)}t=Vi(this._delegate,e);return new Ko(this,t)},e.prototype.refFromURL=function(e){var t="database.refFromURL";Object(o.L)(t,1,1,arguments.length);var n=Bi(this._delegate,e);return new Ko(this,n)},e.prototype.goOffline=function(){return Object(o.L)("database.goOffline",0,0,arguments.length),Lo(this._delegate)},e.prototype.goOnline=function(){return Object(o.L)("database.goOnline",0,0,arguments.length),Mo(this._delegate)},e.ServerValue={TIMESTAMP:jo,increment:function(e){return function(e){return{".sv":{increment:e}}}(e)}},e}();var zo=Object.freeze({__proto__:null,forceLongPolling:function(){se.forceDisallow(),ne.forceAllow()},forceWebSockets:function(){ne.forceDisallow()},isWebSocketsAvailable:function(){return se.isAvailable()},setSecurityDebugCallback:function(e,t){e._delegate._repo.persistentConnection_.securityDebugCallback_=t},stats:function(e,t){!function(e,t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var n;t?(e.statsListener_||(e.statsListener_=new xt(e.stats_)),n=e.statsListener_.get()):n=e.stats_.get();var r=Object.keys(n).reduce((function(e,t){return Math.max(t.length,e)}),0);D(n,(function(e,t){for(var n=e,i=e.length;i<r+2;i++)n+=" ";console.log(n+t)}))}}(e._delegate._repo,t)},statsIncrementCounter:function(e,t){!function(e,t){var n,r;e.stats_.incrementCounter(t),n=e.statsReporter_,r=t,n.statsToReport_[r]=!0}(e._delegate._repo,t)},dataUpdateCount:function(e){return e._delegate._repo.dataUpdateCount},interceptServerData:function(e,t){return function(e,t){e.interceptServerDataCallback_=t}(e._delegate._repo,t)},initStandalone:function(e){var t=e.app,n=e.url,r=e.version,o=e.customAuthImpl,a=e.namespace,s=e.nodeAdmin,c=void 0!==s&&s;oe(r);var u=new i.c("auth-internal",new i.b("database-standalone"));return u.setComponent(new i.a("auth-internal",(function(){return o}),"PRIVATE")),{instance:new Ho(Po(t,u,n,c),t),namespace:a}}}),Yo=xe;xe.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},xe.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)};var Qo=ue,Xo=z,Jo=Object.freeze({__proto__:null,DataConnection:Yo,RealTimeConnection:Qo,hijackHash:function(e){var t=xe.prototype.put;return xe.prototype.put=function(n,r,i,o){void 0!==o&&(o=e()),t.call(this,n,r,i,o)},function(){xe.prototype.put=t}},ConnectionTarget:Xo,queryIdentifier:function(e){return e._delegate._queryIdentifier},forceRestClient:function(e){!function(e){No=e}(e)}}),$o=Ho.ServerValue;!function(e){oe(e.SDK_VERSION);var n=e.INTERNAL.registerComponent(new i.a("database",(function(e,t){var n=t.instanceIdentifier,r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal");return new Ho(Po(r,i,n),r)}),"PUBLIC").setServiceProps({Reference:Ko,Query:qo,Database:Ho,DataSnapshot:Go,enableLogging:Uo,INTERNAL:zo,ServerValue:$o,TEST_ACCESS:Jo}).setMultipleInstances(!0));e.registerVersion("@firebase/database","0.9.10"),Object(o.A)()&&(t.exports=n)}(r.a)}).call(this,n(38),n(50)(e))},function(e,t){e.exports=Array.isArray||function(e){return"[object Array]"==Object.prototype.toString.call(e)}},function(e,t,n){var r=function(e){"use strict";var t,n=Object.prototype,r=n.hasOwnProperty,i="function"===typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",a=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(N){c=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof m?t:m,o=Object.create(i.prototype),a=new C(r||[]);return o._invoke=function(e,t,n){var r=d;return function(i,o){if(r===h)throw new Error("Generator is already running");if(r===p){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=I(a,n);if(s){if(s===v)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===d)throw r=p,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=h;var c=l(e,t,n);if("normal"===c.type){if(r=n.done?p:f,c.arg===v)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=p,n.method="throw",n.arg=c.arg)}}}(e,n,a),o}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(N){return{type:"throw",arg:N}}}e.wrap=u;var d="suspendedStart",f="suspendedYield",h="executing",p="completed",v={};function m(){}function g(){}function y(){}var _={};_[o]=function(){return this};var b=Object.getPrototypeOf,E=b&&b(b(k([])));E&&E!==n&&r.call(E,o)&&(_=E);var w=y.prototype=m.prototype=Object.create(_);function T(e){["next","throw","return"].forEach((function(t){c(e,t,(function(e){return this._invoke(t,e)}))}))}function S(e,t){function n(i,o,a,s){var c=l(e[i],e,o);if("throw"!==c.type){var u=c.arg,d=u.value;return d&&"object"===typeof d&&r.call(d,"__await")?t.resolve(d.__await).then((function(e){n("next",e,a,s)}),(function(e){n("throw",e,a,s)})):t.resolve(d).then((function(e){u.value=e,a(u)}),(function(e){return n("throw",e,a,s)}))}s(c.arg)}var i;this._invoke=function(e,r){function o(){return new t((function(t,i){n(e,r,t,i)}))}return i=i?i.then(o,o):o()}}function I(e,n){var r=e.iterator[n.method];if(r===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,I(e,n),"throw"===n.method))return v;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=l(r,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var o=i.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function R(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function A(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(R,this),this.reset(!0)}function k(e){if(e){var n=e[o];if(n)return n.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:O}}function O(){return{value:t,done:!0}}return g.prototype=w.constructor=y,y.constructor=g,g.displayName=c(y,s,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,c(e,s,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},T(S.prototype),S.prototype[a]=function(){return this},e.AsyncIterator=S,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new S(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},T(w),c(w,s,"Generator"),w[o]=function(){return this},w.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=k,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return s.type="throw",s.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return i("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return i(a.catchLoc,!0);if(this.prev<a.finallyLoc)return i(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return i(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return i(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),A(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;A(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:k(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var r=n(75),i=n(76),o=n(44),a=n(77);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(c){i=!0,o=c}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){var r=n(80);function i(t,n,o){return"undefined"!==typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t,n){var r=n(45);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t,n){var r=n(82),i=n(83),o=n(44),a=n(84);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t,n){var r=n(51);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var r=n(86);e.exports=function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(45),i=n(88),o=n(52);e.exports=function(e){var t=i();return function(){var n,i=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(i,arguments,a)}else n=i.apply(this,arguments);return o(this,n)}}},function(e,t){e.exports=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(44);e.exports=function(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=r(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==n.return||n.return()}finally{if(c)throw a}}}}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,c,"next",e)}function c(e){n(a,i,o,s,c,"throw",e)}s(void 0)}))}}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}}]]);
//# sourceMappingURL=2.fd016085.chunk.js.map